<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Getting and Cleaning Data Course - Module 3</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Aprendiendo ciencia de datos con R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-hand-spock"></span>
     
    Resumen del contenido
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bars"></span>
     
    Contenido
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Data Science Toolbox</li>
    <li class="divider"></li>
    <li>
      <a href="1_DataScienceToolBox_Resumen.html">Módulo único</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">R</li>
    <li class="divider"></li>
    <li>
      <a href="2_R_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="2_R_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt_PrevPract.html">_práctica</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="2_R_Module3_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module4_Resumen.html">Módulo 4</a>
    </li>
    <li>
      <a href="2_R_Module4_ProgAssmt.html">Ejercicio final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Getting &amp; Cleaning Data</li>
    <li class="divider"></li>
    <li>
      <a href="3_GettingAndCleaningData_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Exploratory Data Analysis</li>
    <li class="divider"></li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Reproducible Research</li>
    <li class="divider"></li>
    <li>
      <a href="5_ReproducibleResearch_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_FinalProj.html">Proyectos finales</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html">
    <span class="fa fa-gears"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Getting and Cleaning Data Course - Module
3</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#subsetting-sorting-and-ordering."
id="toc-subsetting-sorting-and-ordering."><span
class="toc-section-number">1</span> Subsetting, Sorting and
Ordering.</a></li>
<li><a href="#summarizing-data---revisited."
id="toc-summarizing-data---revisited."><span
class="toc-section-number">2</span> Summarizing data - Revisited.</a>
<ul>
<li><a href="#getting-an-example-dataset."
id="toc-getting-an-example-dataset."><span
class="toc-section-number">2.1</span> Getting an example
dataset.</a></li>
<li><a
href="#looking-at-the-size-of-the-data-object.size-units-parameter-of-print."
id="toc-looking-at-the-size-of-the-data-object.size-units-parameter-of-print."><span
class="toc-section-number">2.2</span> Looking at the size of the data:
<code>object.size()</code>, <code>units</code> parameter of
<code>print()</code>.</a></li>
<li><a href="#looking-at-a-bit-of-the-data-dim-names-head-tail."
id="toc-looking-at-a-bit-of-the-data-dim-names-head-tail."><span
class="toc-section-number">2.3</span> Looking at a bit of the data:
<code>dim()</code>, <code>names()</code>, <code>head()</code>,
<code>tail()</code>.</a></li>
<li><a
href="#summarizing-all-variables-and-getting-a-complete-information-about-the-structure-of-the-dataset-summarize-and-str."
id="toc-summarizing-all-variables-and-getting-a-complete-information-about-the-structure-of-the-dataset-summarize-and-str."><span
class="toc-section-number">2.4</span> Summarizing all variables and
getting a complete information about the structure of the dataset:
<code>summarize()</code> and <code>str()</code>.</a></li>
<li><a href="#quantiles-of-quantitative-variables."
id="toc-quantiles-of-quantitative-variables."><span
class="toc-section-number">2.5</span> Quantiles of quantitative
variables.</a></li>
<li><a href="#check-for-missing-values."
id="toc-check-for-missing-values."><span
class="toc-section-number">2.6</span> Check for missing values.</a>
<ul>
<li><a
href="#checking-how-many-missing-values-in-a-single-variable-is.na-sum."
id="toc-checking-how-many-missing-values-in-a-single-variable-is.na-sum."><span
class="toc-section-number">2.6.1</span> Checking how many missing values
in a single variable: <code>is.na()</code> +
<code>sum()</code>.</a></li>
<li><a
href="#globally-checking-existance-of-missing-values-in-a-single-variable-is.na-any."
id="toc-globally-checking-existance-of-missing-values-in-a-single-variable-is.na-any."><span
class="toc-section-number">2.6.2</span> Globally checking existance of
missing values in a single variable: <code>is.na()</code> +
<code>any()</code>.</a></li>
<li><a
href="#checking-that-all-values-of-a-single-variable-meet-a-logical-condition-all."
id="toc-checking-that-all-values-of-a-single-variable-meet-a-logical-condition-all."><span
class="toc-section-number">2.6.3</span> Checking that all values of a
single variable meet a logical condition: <code>all()</code>.</a></li>
<li><a
href="#checking-at-once-how-many-missing-values-in-all-variables-is.na-to-the-entire-data-frame-colsums."
id="toc-checking-at-once-how-many-missing-values-in-all-variables-is.na-to-the-entire-data-frame-colsums."><span
class="toc-section-number">2.6.4</span> Checking AT ONCE how many
missing values in ALL variables: <code>is.na()</code> to the entire data
frame + <code>colSums()</code>.</a></li>
<li><a
href="#globally-checking-at-once-existance-of-missing-values-in-the-entire-data-frame-is.na-to-the-entire-data-frame-colsums-all-zero-condition."
id="toc-globally-checking-at-once-existance-of-missing-values-in-the-entire-data-frame-is.na-to-the-entire-data-frame-colsums-all-zero-condition."><span
class="toc-section-number">2.6.5</span> Globally checking AT ONCE
existance of missing values in the entire data frame:
<code>is.na()</code> to the entire data frame + <code>colSums()</code> +
<code>all()</code> “zero” condition.</a></li>
</ul></li>
<li><a
href="#finding-values-within-a-variable-with-specific-characteristics-operator-in."
id="toc-finding-values-within-a-variable-with-specific-characteristics-operator-in."><span
class="toc-section-number">2.7</span> Finding values within a variable
with specific characteristics: operator <code>%in%</code>.</a></li>
<li><a
href="#making-tables-contingency-and-complexflat-tables-with-table-function-and-cross-tables-with-xtabs-function."
id="toc-making-tables-contingency-and-complexflat-tables-with-table-function-and-cross-tables-with-xtabs-function."><span
class="toc-section-number">2.8</span> Making tables: contingency and
complex/flat tables with <code>table()</code> function and cross tables
with <code>xtabs()</code> function.</a>
<ul>
<li><a href="#contingency-tables." id="toc-contingency-tables."><span
class="toc-section-number">2.8.1</span> Contingency tables.</a>
<ul>
<li><a href="#one-dimensional-contingency-tables."
id="toc-one-dimensional-contingency-tables."><span
class="toc-section-number">2.8.1.1</span> One dimensional contingency
tables.</a></li>
<li><a
href="#two-dimensional-contingency-tables-relationship-between-two-variables."
id="toc-two-dimensional-contingency-tables-relationship-between-two-variables."><span
class="toc-section-number">2.8.1.2</span> Two dimensional contingency
tables (relationship between two variables).</a></li>
</ul></li>
<li><a href="#cross-tables-xtab-function."
id="toc-cross-tables-xtab-function."><span
class="toc-section-number">2.8.2</span> Cross tables:
<code>xtab()</code> function.</a></li>
<li><a
href="#cross-tables-with-more-than-two-cross-classifying-variables-often-hard-to-see.-example."
id="toc-cross-tables-with-more-than-two-cross-classifying-variables-often-hard-to-see.-example."><span
class="toc-section-number">2.8.3</span> Cross tables with more than two
cross-classifying variables, often hard to see. Example.</a></li>
<li><a href="#flat-tables." id="toc-flat-tables."><span
class="toc-section-number">2.8.4</span> Flat tables.</a></li>
</ul></li>
</ul></li>
<li><a href="#creating-new-variables.-transforming-the-data."
id="toc-creating-new-variables.-transforming-the-data."><span
class="toc-section-number">3</span> Creating new variables. Transforming
the data.</a>
<ul>
<li><a
href="#recall-creating-sequences-with-seq-and-its-importance-for-indexing."
id="toc-recall-creating-sequences-with-seq-and-its-importance-for-indexing."><span
class="toc-section-number">3.1</span> Recall creating sequences with
<code>seq()</code> and it’s importance for indexing.</a></li>
<li><a
href="#creating-a-new-logical-variable-indicating-a-subset-of-others-operator-in.-handy-for-subsetting."
id="toc-creating-a-new-logical-variable-indicating-a-subset-of-others-operator-in.-handy-for-subsetting."><span
class="toc-section-number">3.2</span> Creating a new logical variable
indicating a subset of others: operator <code>%in%</code>. Handy for
subsetting.</a></li>
<li><a
href="#creating-binary-variables-ifelse-command.-handy-for-filtering-or-subsetting-based-on-specific-values-such-as-wrong-values-values-of-interest-etc."
id="toc-creating-binary-variables-ifelse-command.-handy-for-filtering-or-subsetting-based-on-specific-values-such-as-wrong-values-values-of-interest-etc."><span
class="toc-section-number">3.3</span> Creating binary variables:
<code>ifelse()</code> command. Handy for filtering or subsetting based
on specific values (such as “wrong” values, values of interest,
etc).</a></li>
<li><a
href="#nesting-the-ifelse-command-to-create-three-levels-from-a-certian-variable."
id="toc-nesting-the-ifelse-command-to-create-three-levels-from-a-certian-variable."><span
class="toc-section-number">3.4</span> Nesting the <code>ifelse()</code>
command to create three levels from a certian variable.</a></li>
<li><a
href="#creating-a-categorical-variable-for-cutting-up-quantitative-variables-cut-command."
id="toc-creating-a-categorical-variable-for-cutting-up-quantitative-variables-cut-command."><span
class="toc-section-number">3.5</span> Creating a categorical variable
for “cutting up” quantitative variables: <code>cut()</code>
command.</a></li>
<li><a href="#easier-cutting-cut2-function-of-the-hmisc-package."
id="toc-easier-cutting-cut2-function-of-the-hmisc-package."><span
class="toc-section-number">3.6</span> Easier cutting:
<code>cut2()</code> function of the <code>Hmisc</code> package.</a></li>
<li><a
href="#transforming-numerical-variables-into-categorical-factor-variables-factor-command.-re-leveling-with-relevel-and-levels-and-going-back-with-as.numeric."
id="toc-transforming-numerical-variables-into-categorical-factor-variables-factor-command.-re-leveling-with-relevel-and-levels-and-going-back-with-as.numeric."><span
class="toc-section-number">3.7</span> Transforming numerical variables
into categorical (factor) variables: <code>factor()</code> command.
Re-leveling with <code>relevel()</code> and <code>levels()</code>, and
going back with <code>as.numeric()</code>.</a></li>
<li><a
href="#creating-a-new-data-frame-by-mutating-the-old-one-mutate-function-from-plyr-package."
id="toc-creating-a-new-data-frame-by-mutating-the-old-one-mutate-function-from-plyr-package."><span
class="toc-section-number">3.8</span> Creating a new data frame by
mutating the old one: <code>mutate()</code> function, from
<code>plyr package</code>.</a></li>
<li><a href="#common-transformations-to-quantitative-data."
id="toc-common-transformations-to-quantitative-data."><span
class="toc-section-number">3.9</span> Common transformations to
quantitative data.</a></li>
<li><a href="#further-resources." id="toc-further-resources."><span
class="toc-section-number">3.10</span> Further resources.</a></li>
</ul></li>
<li><a href="#reshaping-data." id="toc-reshaping-data."><span
class="toc-section-number">4</span> Reshaping data.</a>
<ul>
<li><a href="#melting-data-frames-melt-function-from-reshape2-package."
id="toc-melting-data-frames-melt-function-from-reshape2-package."><span
class="toc-section-number">4.1</span> Melting data frames:
<code>melt()</code> function, from
<code>reshape2 package</code>.</a></li>
<li><a href="#casting-data-frames-dcast-function-from-reshape2-package."
id="toc-casting-data-frames-dcast-function-from-reshape2-package."><span
class="toc-section-number">4.2</span> Casting data frames:
<code>dcast()</code> function, from
<code>reshape2 package</code>.</a></li>
</ul></li>
<li><a href="#averaging-data-tapply-split-lapply-unlist-sapply."
id="toc-averaging-data-tapply-split-lapply-unlist-sapply."><span
class="toc-section-number">5</span> Averaging data:
<code>tapply()</code>, <code>split()</code>, <code>lapply()</code>,
<code>unlist()</code>, <code>sapply()</code>.</a>
<ul>
<li><a href="#a-split-apply-combine-s-a-c-type-of-problem."
id="toc-a-split-apply-combine-s-a-c-type-of-problem."><span
class="toc-section-number">5.1</span> A Split-Apply-Combine (S-A-C) type
of problem.</a></li>
<li><a href="#putting-the-data-into-the-right-format."
id="toc-putting-the-data-into-the-right-format."><span
class="toc-section-number">5.2</span> Putting the data into the right
format.</a></li>
<li><a
href="#a-one-function-solution-to-these-s-a-c-problems-tapply-by-or-aggregate-functions."
id="toc-a-one-function-solution-to-these-s-a-c-problems-tapply-by-or-aggregate-functions."><span
class="toc-section-number">5.3</span> A one-function solution to these
S-A-C problems: <code>tapply()</code>, <code>by()</code> or
<code>aggregate()</code> functions.</a></li>
<li><a
href="#the-s-a-c-strategy-using-separate-functions-split-lapply-unlist-and-sapply."
id="toc-the-s-a-c-strategy-using-separate-functions-split-lapply-unlist-and-sapply."><span
class="toc-section-number">5.4</span> The S-A-C strategy using separate
functions: <code>split()</code>, <code>lapply()</code>,
<code>unlist()</code> and <code>sapply()</code>.</a>
<ul>
<li><a href="#split-step." id="toc-split-step."><span
class="toc-section-number">5.4.1</span> <em>Split</em> step.</a></li>
<li><a
href="#apply-step-and-a-combine-step-that-gathers-the-results-into-a-list-lapply."
id="toc-apply-step-and-a-combine-step-that-gathers-the-results-into-a-list-lapply."><span
class="toc-section-number">5.4.2</span> <em>Apply</em> step and a
<em>combine</em> step that gathers the results into a list:
<code>lapply()</code>.</a>
<ul>
<li><a href="#trying-to-recombine-the-list-as-a-vector-unlist."
id="toc-trying-to-recombine-the-list-as-a-vector-unlist."><span
class="toc-section-number">5.4.2.1</span> Trying to <em>recombine</em>
the list as a vector: <code>unlist()</code>.</a></li>
</ul></li>
<li><a
href="#apply-step-and-a-combine-step-that-tries-to-simplify-the-result-sapply-and-vapply."
id="toc-apply-step-and-a-combine-step-that-tries-to-simplify-the-result-sapply-and-vapply."><span
class="toc-section-number">5.4.3</span> <em>Apply</em> step and a
<em>combine</em> step that tries to simplify the result:
<code>sapply()</code> and <code>vapply()</code>.</a></li>
</ul></li>
<li><a
href="#another-one-function-solution-to-these-s-a-c-problems-ddply-function-from-plyr-package."
id="toc-another-one-function-solution-to-these-s-a-c-problems-ddply-function-from-plyr-package."><span
class="toc-section-number">5.5</span> Another one-function solution to
these S-A-C problems: <code>ddply()</code> function, from
<code>plyr package</code>.</a>
<ul>
<li><a
href="#making-the-summary-output-to-be-of-the-same-length-as-the-grouping-variable-passing-the-summary-function-through-the-ave-function-as-parameter-of-ddply."
id="toc-making-the-summary-output-to-be-of-the-same-length-as-the-grouping-variable-passing-the-summary-function-through-the-ave-function-as-parameter-of-ddply."><span
class="toc-section-number">5.5.1</span> Making the summary output to be
of the same length as the grouping variable: passing the summary
function through the <code>ave()</code> function as parameter of
<code>ddply()</code>.</a></li>
<li><a href="#why-would-we-want-to-do-that"
id="toc-why-would-we-want-to-do-that"><span
class="toc-section-number">5.5.2</span> Why would we want to do
that?</a></li>
</ul></li>
</ul></li>
<li><a href="#further-resourses-about-reshape2-and-plyr."
id="toc-further-resourses-about-reshape2-and-plyr."><span
class="toc-section-number">6</span> Further resourses about
<code>reshape2</code> and <code>plyr</code>.</a></li>
<li><a href="#managing-data-frames-with-dplyr-package."
id="toc-managing-data-frames-with-dplyr-package."><span
class="toc-section-number">7</span> Managing Data Frames with
<code>dplyr</code> package.</a>
<ul>
<li><a href="#introduction." id="toc-introduction."><span
class="toc-section-number">7.1</span> Introduction.</a>
<ul>
<li><a href="#an-improoved-version-of-plyr-package."
id="toc-an-improoved-version-of-plyr-package."><span
class="toc-section-number">7.1.1</span> An improoved version of
<code>plyr</code> package.</a></li>
<li><a
href="#provides-a-grammar-in-particular-verbs-for-data-frame-manipulation."
id="toc-provides-a-grammar-in-particular-verbs-for-data-frame-manipulation."><span
class="toc-section-number">7.1.2</span> Provides a <em>grammar</em> (in
particular <em>verbs</em>) for data frame manipulation.</a></li>
<li><a href="#additional-benefits-of-dplyr-grammar."
id="toc-additional-benefits-of-dplyr-grammar."><span
class="toc-section-number">7.1.3</span> Additional benefits of
<code>dplyr</code> <em>grammar</em>.</a></li>
<li><a href="#the-goal-is-always-tidy-data."
id="toc-the-goal-is-always-tidy-data."><span
class="toc-section-number">7.1.4</span> The goal is always tidy
data.</a></li>
<li><a
href="#the-tidyverse-set-of-packages-and-tibbles-data-frames-that-has-the-tbl_df-class-as-its-central-data-structure-tibble-and-as_tibble."
id="toc-the-tidyverse-set-of-packages-and-tibbles-data-frames-that-has-the-tbl_df-class-as-its-central-data-structure-tibble-and-as_tibble."><span
class="toc-section-number">7.1.5</span> The
<em><code>tidyverse</code></em> set of packages and <em>“tibbles”</em>
(data frames that has the <code>tbl_df</code> class) as its central data
structure: <code>tibble()</code> and <code>as_tibble()</code>.</a></li>
<li><a href="#all-dplyr-functions-have-basically-the-same-format."
id="toc-all-dplyr-functions-have-basically-the-same-format."><span
class="toc-section-number">7.1.6</span> All <code>dplyr</code> functions
have basically the same format.</a></li>
</ul></li>
<li><a href="#basic-tools." id="toc-basic-tools."><span
class="toc-section-number">7.2</span> Basic tools.</a>
<ul>
<li><a href="#getting-a-sample-dataset."
id="toc-getting-a-sample-dataset."><span
class="toc-section-number">7.2.1</span> Getting a sample
dataset.</a></li>
<li><a
href="#inspecting-the-chicago-data-frame-and-turning-it-into-a-tibble."
id="toc-inspecting-the-chicago-data-frame-and-turning-it-into-a-tibble."><span
class="toc-section-number">7.2.2</span> Inspecting the
<code>chicago</code> data frame and turning it into a
<em>tibble</em>.</a></li>
<li><a href="#select-function---column-subsetting."
id="toc-select-function---column-subsetting."><span
class="toc-section-number">7.2.3</span> <code>select()</code> function -
Column subsetting.</a>
<ul>
<li><a
href="#using-the-colon-notation-with-variable-names-to-select-a-range-of-columns."
id="toc-using-the-colon-notation-with-variable-names-to-select-a-range-of-columns."><span
class="toc-section-number">7.2.3.1</span> Using the colon notation with
variable names to select a range of columns.</a></li>
<li><a href="#the-output-is-in-the-order-user-specifies."
id="toc-the-output-is-in-the-order-user-specifies."><span
class="toc-section-number">7.2.3.2</span> The output is in the order
user specifies.</a></li>
<li><a href="#selecting-columns-using-comma-or-a-vector-of-names."
id="toc-selecting-columns-using-comma-or-a-vector-of-names."><span
class="toc-section-number">7.2.3.3</span> Selecting columns using comma
or a vector of names.</a></li>
<li><a href="#and-the-minus-sing-to-specify-columns-to-throw-away."
id="toc-and-the-minus-sing-to-specify-columns-to-throw-away."><span
class="toc-section-number">7.2.3.4</span> And the minus sing to specify
columns to “throw away”.</a></li>
<li><a
href="#the-equivalent-tricky-way-in-regular-r-if-we-dont-know-column-positions."
id="toc-the-equivalent-tricky-way-in-regular-r-if-we-dont-know-column-positions."><span
class="toc-section-number">7.2.3.5</span> The equivalent <em>tricky</em>
way in regular R, if we don’t know column positions.</a></li>
<li><a
href="#therere-also-very-useful-selection-helpers-a-special-syntax."
id="toc-therere-also-very-useful-selection-helpers-a-special-syntax."><span
class="toc-section-number">7.2.3.6</span> There’re also very useful
<em>selection helpers</em> (a special syntax).</a>
<ul>
<li><a
href="#selection-helpers-for-selecting-specific-columns-everything-last_col."
id="toc-selection-helpers-for-selecting-specific-columns-everything-last_col."><span
class="toc-section-number">7.2.3.6.1</span> Selection helpers for
selecting <em>specific columns</em>: <code>everything()</code>,
<code>last_col()</code>.</a></li>
<li><a
href="#selection-helpers-for-selecting-variables-by-matching-patterns-in-their-names-ends_with-starts_with-contains-matches."
id="toc-selection-helpers-for-selecting-variables-by-matching-patterns-in-their-names-ends_with-starts_with-contains-matches."><span
class="toc-section-number">7.2.3.6.2</span> Selection helpers for
selecting variables by matching <em>patterns</em> in their names:
<code>ends_with()</code>, <code>starts_with()</code>,
<code>contains()</code>, <code>matches()</code>.</a></li>
<li><a
href="#helpers-that-select-variables-from-a-character-vector-all_of-any_of."
id="toc-helpers-that-select-variables-from-a-character-vector-all_of-any_of."><span
class="toc-section-number">7.2.3.6.3</span> Helpers that select
variables from a character vector: <code>all_of()</code>,
<code>any_of()</code>.</a></li>
<li><a href="#helper-that-applies-a-function-to-all-variables-where."
id="toc-helper-that-applies-a-function-to-all-variables-where."><span
class="toc-section-number">7.2.3.6.4</span> Helper that applies a
function to all variables: <code>where()</code>.</a></li>
</ul></li>
</ul></li>
<li><a href="#filter-function---row-subsetting."
id="toc-filter-function---row-subsetting."><span
class="toc-section-number">7.2.4</span> <code>filter</code> function -
Row subsetting.</a>
<ul>
<li><a
href="#filtering-based-on-multiple-conditions-and-expressions-also-just-using-commas."
id="toc-filtering-based-on-multiple-conditions-and-expressions-also-just-using-commas."><span
class="toc-section-number">7.2.4.1</span> Filtering based on multiple
conditions (AND expressions also just using commas).</a></li>
<li><a
href="#filtering-rows-without-missing-values-in-a-certain-variable."
id="toc-filtering-rows-without-missing-values-in-a-certain-variable."><span
class="toc-section-number">7.2.4.2</span> Filtering rows without missing
values in a certain variable.</a></li>
<li><a
href="#filtering-complete-cases-rows-without-missing-values-in-all-variables-just-use-generic-functions-na.omit-or-complete.cases.-both-from-stats-package."
id="toc-filtering-complete-cases-rows-without-missing-values-in-all-variables-just-use-generic-functions-na.omit-or-complete.cases.-both-from-stats-package."><span
class="toc-section-number">7.2.4.3</span> Filtering complete cases (rows
without missing values in all variables): just use generic functions
<code>na.omit()</code> or <code>complete.cases(.)</code>, both from
<code>stats</code> package.</a></li>
</ul></li>
<li><a href="#arrange-function---row-ordering."
id="toc-arrange-function---row-ordering."><span
class="toc-section-number">7.2.5</span> <code>arrange()</code> function
- Row ordering.</a>
<ul>
<li><a href="#breaking-ties." id="toc-breaking-ties."><span
class="toc-section-number">7.2.5.1</span> Breaking ties.</a></li>
</ul></li>
<li><a href="#rename-function." id="toc-rename-function."><span
class="toc-section-number">7.2.6</span> <code>rename()</code>
function.</a></li>
<li><a href="#the-mutate-function-and-its-related-transmute-function."
id="toc-the-mutate-function-and-its-related-transmute-function."><span
class="toc-section-number">7.2.7</span> The <code>mutate()</code>
function and it’s related <code>transmute()</code> function.</a>
<ul>
<li><a
href="#using-the-computed-value-of-a-column-to-create-other-columns-all-in-the-same-statment."
id="toc-using-the-computed-value-of-a-column-to-create-other-columns-all-in-the-same-statment."><span
class="toc-section-number">7.2.7.1</span> Using the computed value of a
column to create other columns, all in the same statment.</a></li>
</ul></li>
<li><a href="#group_by-and-summarizesummarise-functions."
id="toc-group_by-and-summarizesummarise-functions."><span
class="toc-section-number">7.2.8</span> <code>group_by()</code> and
<code>summarize()</code>/<code>summarise()</code> functions.</a>
<ul>
<li><a
href="#example-0-summarize-alone-without-group_by-not-so-interesting."
id="toc-example-0-summarize-alone-without-group_by-not-so-interesting."><span
class="toc-section-number">7.2.8.1</span> Example 0:
<code>summarize()</code> alone (without <code>group_by()</code>), not so
interesting.</a></li>
<li><a href="#example-1-grouping-statistics-by-a-factor-variable."
id="toc-example-1-grouping-statistics-by-a-factor-variable."><span
class="toc-section-number">7.2.8.2</span> Example 1: grouping statistics
by a factor variable.</a></li>
<li><a href="#example-2-grouping-statistics-by-non-factor-varaibles."
id="toc-example-2-grouping-statistics-by-non-factor-varaibles."><span
class="toc-section-number">7.2.8.3</span> Example 2: grouping statistics
by non factor varaibles.</a></li>
<li><a
href="#example-3-special-dplyr-commands-for-counting-n-and-unique-values-n_distinct."
id="toc-example-3-special-dplyr-commands-for-counting-n-and-unique-values-n_distinct."><span
class="toc-section-number">7.2.8.4</span> Example 3: special
<code>dplyr</code> commands for counting (<code>n()</code>) and unique
values (<code>n_distinct()</code>).</a></li>
<li><a
href="#example-4-applying-functions-to-a-set-of-columns-with-across."
id="toc-example-4-applying-functions-to-a-set-of-columns-with-across."><span
class="toc-section-number">7.2.8.5</span> Example 4: applying functions
to a set of columns with <code>across()</code>.</a></li>
<li><a
href="#example-5-looking-at-the-top-1-packages-downloded-from-cran."
id="toc-example-5-looking-at-the-top-1-packages-downloded-from-cran."><span
class="toc-section-number">7.2.8.6</span> Example 5: looking at the top
1% packages downloded from CRAN.</a>
<ul>
<li><a
href="#top-1-package-popularity-measured-by-the-quantity-of-downloads."
id="toc-top-1-package-popularity-measured-by-the-quantity-of-downloads."><span
class="toc-section-number">7.2.8.6.1</span> Top 1% package popularity
measured by the quantity of downloads.</a></li>
<li><a
href="#top-1-package-popularity-measured-by-the-unique-downloads."
id="toc-top-1-package-popularity-measured-by-the-unique-downloads."><span
class="toc-section-number">7.2.8.6.2</span> Top 1% package popularity
measured by the unique downloads.</a></li>
</ul></li>
</ul></li>
<li><a href="#chaining-or-piping-operator-."
id="toc-chaining-or-piping-operator-."><span
class="toc-section-number">7.2.9</span> Chaining or Piping operator
<code>%&gt;%</code>.</a>
<ul>
<li><a href="#chicago-pollutats-statistics-example."
id="toc-chicago-pollutats-statistics-example."><span
class="toc-section-number">7.2.9.1</span> Chicago pollutats statistics
example.</a></li>
<li><a
href="#top-1-package-popularity-measured-by-the-downloads-from-distinct-countries."
id="toc-top-1-package-popularity-measured-by-the-downloads-from-distinct-countries."><span
class="toc-section-number">7.2.9.2</span> Top 1% package popularity
measured by the downloads from distinct countries.</a></li>
<li><a
href="#its-possible-to-embed-function-calls-to-avoid-intermediate-results-without-using-the-chain-operator-but-it-could-be-a-real-mess."
id="toc-its-possible-to-embed-function-calls-to-avoid-intermediate-results-without-using-the-chain-operator-but-it-could-be-a-real-mess."><span
class="toc-section-number">7.2.9.3</span> It’s possible to embed
function calls to avoid intermediate results without using the chain
operator, but it could be a real mess.</a></li>
<li><a href="#one-last-example." id="toc-one-last-example."><span
class="toc-section-number">7.2.9.4</span> One last example.</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#tidying-data-with-tidyr-package."
id="toc-tidying-data-with-tidyr-package."><span
class="toc-section-number">8</span> Tidying Data with <code>tidyr</code>
package.</a>
<ul>
<li><a href="#most-common-symptoms-of-messy-data."
id="toc-most-common-symptoms-of-messy-data."><span
class="toc-section-number">8.1</span> Most common symptoms of messy
data.</a>
<ul>
<li><a
href="#column-headers-are-values-not-variable-names.-using-gather-now-replaced-by-pivot_longer-function."
id="toc-column-headers-are-values-not-variable-names.-using-gather-now-replaced-by-pivot_longer-function."><span
class="toc-section-number">8.1.1</span> Column headers are values, not
variable names. Using <code>gather()</code>, now replaced by
<code>pivot_longer()</code> function.</a></li>
<li><a
href="#multiple-variables-are-stored-in-one-column.-using-gather-betterpivot_longer-and-separate-functions."
id="toc-multiple-variables-are-stored-in-one-column.-using-gather-betterpivot_longer-and-separate-functions."><span
class="toc-section-number">8.1.2</span> Multiple variables are stored in
one column. Using <code>gather()</code>
(better<code>pivot_longer()</code>) and <code>separate()</code>
functions.</a></li>
<li><a
href="#variables-stored-in-both-rows-and-columns.-using-gather-betterpivot_longer-and-spread-better-pivot_wider-from-tidyr-package-and-parse_number-from-readr-package-within-mutate-from-dplyr-package."
id="toc-variables-stored-in-both-rows-and-columns.-using-gather-betterpivot_longer-and-spread-better-pivot_wider-from-tidyr-package-and-parse_number-from-readr-package-within-mutate-from-dplyr-package."><span
class="toc-section-number">8.1.3</span> Variables stored in both rows
and columns. Using <code>gather()</code>
(better<code>pivot_longer()</code>) and <code>spread()</code> (better
<code>pivot_wider()</code>) from <code>tidyr</code> package, and
<code>parse_number()</code> from <code>readr</code> package within
<code>mutate()</code> from <code>dplyr</code> package.</a></li>
<li><a
href="#multiple-types-of-observational-units-stored-in-the-same-table.-using-select-and-unique."
id="toc-multiple-types-of-observational-units-stored-in-the-same-table.-using-select-and-unique."><span
class="toc-section-number">8.1.4</span> Multiple types of observational
units stored in the same table. Using <code>select()</code> and
<code>unique()</code>.</a></li>
<li><a
href="#a-single-observational-unit-stored-in-multiple-tables.-using-mutate-and-bind_rows-from-dplyr-package."
id="toc-a-single-observational-unit-stored-in-multiple-tables.-using-mutate-and-bind_rows-from-dplyr-package."><span
class="toc-section-number">8.1.5</span> A single observational unit
stored in multiple tables. Using <code>mutate()</code> and
<code>bind_rows()</code> from <code>dplyr</code> package.</a></li>
</ul></li>
<li><a href="#final-example-tidying-a-real-dataset."
id="toc-final-example-tidying-a-real-dataset."><span
class="toc-section-number">8.2</span> Final example: tidying a real
dataset.</a></li>
</ul></li>
<li><a href="#merging-data." id="toc-merging-data."><span
class="toc-section-number">9</span> Merging data.</a>
<ul>
<li><a href="#getting-peer-review-experiment-data-to-work-with."
id="toc-getting-peer-review-experiment-data-to-work-with."><span
class="toc-section-number">9.1</span> Getting peer review experiment
data to work with.</a></li>
<li><a href="#merging-data-frames-merge-command-from-the-base-package."
id="toc-merging-data-frames-merge-command-from-the-base-package."><span
class="toc-section-number">9.2</span> Merging data frames:
<code>merge()</code> command from the <code>base package</code>.</a>
<ul>
<li><a href="#default-merging-behaviour."
id="toc-default-merging-behaviour."><span
class="toc-section-number">9.2.1</span> Default merging
behaviour.</a></li>
</ul></li>
<li><a href="#merging-using-join-from-the-plyr-package."
id="toc-merging-using-join-from-the-plyr-package."><span
class="toc-section-number">9.3</span> Merging using <code>join()</code>
from the <code>plyr package</code>.</a>
<ul>
<li><a
href="#much-more-straightforward-multiple-data-frames-merging-join_all-command."
id="toc-much-more-straightforward-multiple-data-frames-merging-join_all-command."><span
class="toc-section-number">9.3.1</span> Much more straightforward
<em>multiple</em> data frames merging: <code>join_all()</code>
command.</a></li>
</ul></li>
<li><a href="#further-resources-on-merging-data."
id="toc-further-resources-on-merging-data."><span
class="toc-section-number">9.4</span> Further resources on merging
data.</a></li>
</ul></li>
<li><a href="#session-info." id="toc-session-info."><span
class="toc-section-number">10</span> Session Info.</a></li>
</ul>
</div>

<hr />
<div id="subsetting-sorting-and-ordering." class="section level1"
number="1">
<h1><span class="header-section-number">1</span> Subsetting, Sorting and
Ordering.</h1>
<p>Once we’ve loaded our data into R, then we might want to manipulate
that data and <strong>set it up</strong> to be a <strong>tidy
dataset</strong>:</p>
<ul>
<li><p><em>variables</em> in the <em>columns</em> and
<em>observations</em> in the <em>rows</em>;</p></li>
<li><p><em>only the observations</em> that we want to be able to
<em>analyze</em>;</p></li>
<li><p><em>each table or file</em> to store data about only <em>one
kind</em> of observation.</p></li>
</ul>
<p>At this point, our subsetting, sorting, ordering and reshaping skills
became important.</p>
<ul>
<li>For a review of the fundamentals on this topic, see <strong>Module
1</strong> of <strong>R Programming</strong> course, especially, the
<strong><em>“Subsetting, sorting, ordering and combining data to obtain
a tidy data frame - A first approach</em></strong> section.</li>
</ul>
<hr />
</div>
<div id="summarizing-data---revisited." class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Summarizing data -
Revisited.</h1>
<p>A <strong>key process</strong> of data cleaning is <strong>looking at
the dataset</strong> that we’ve loaded into R, in order to:</p>
<ul>
<li><strong>Identify</strong> any sort of <strong>quirks or weird
issues</strong> or <strong>missing values</strong>, or <strong>other
problems</strong> that we need to address before we can do downstream
analysis.</li>
</ul>
<p>How do we look a the dataset? Well, what we do is to
<strong>summarize the data</strong>.</p>
<ul>
<li><p>In <strong>R Programming</strong> course, particularly in the
<strong>Inspecting a data frame</strong> section, we saw a litte bit
about the tools we can use to summarize data.</p></li>
<li><p>We return to this topic now, adding more details and working
through an example.</p></li>
</ul>
<div id="getting-an-example-dataset." class="section level2"
number="2.1">
<h2><span class="header-section-number">2.1</span> Getting an example
dataset.</h2>
<p>We’ll work with <a
href="https://data.baltimorecity.gov/Culture-Arts/Restaurants/k5ry-ef3g">this
Baltimore’s dataset</a>.</p>
<div class="figure">
<img src="3_data/baltimore_restaurants_dataset.png" alt="" />
<p class="caption">Baltimore’s restaurants dataset</p>
</div>
<p>Going to the <code>Export</code> tab of this website, we’ll be able
to see a list of different versions of this dataset. Let’s copy the URL
that points to the <code>csv</code> version of the dataset, download it
and finally read it from disk.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;./3_data&quot;</span>)) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dir.create</span>(<span class="st">&quot;./3_data&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fileUrl <span class="ot">&lt;-</span> <span class="st">&quot;https://data.baltimorecity.gov/api/views/k5ry-ef3g/rows.csv?accessType=DOWNLOAD&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(fileUrl, <span class="at">destfile =</span> <span class="st">&quot;./3_data/restaurants.csv&quot;</span>, <span class="at">method =</span> <span class="st">&quot;curl&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>restData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/restaurants.csv&quot;</span>)</span></code></pre></div>
</div>
<div
id="looking-at-the-size-of-the-data-object.size-units-parameter-of-print."
class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Looking at the size
of the data: <code>object.size()</code>, <code>units</code> parameter of
<code>print()</code>.</h2>
<p>We can use the <code>object.size()</code> command to see the size of
the dataset.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">object.size</span>(restData)             <span class="co"># Output in bytes.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dv">279248</span> bytes</span></code></pre></div>
<p>To get the size on a <strong>different scale</strong>, we can use the
<code>print()</code> command telling it, through the <code>units</code>
parameter, <strong>what units</strong> we’d like to see the object
measured in.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">object.size</span>(restData), <span class="at">units =</span> <span class="st">&quot;Mb&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3</span> Mb</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">object.size</span>(restData), <span class="at">units =</span> <span class="st">&quot;Gb&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> Gb</span></code></pre></div>
</div>
<div id="looking-at-a-bit-of-the-data-dim-names-head-tail."
class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Looking at a bit of
the data: <code>dim()</code>, <code>names()</code>, <code>head()</code>,
<code>tail()</code>.</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(restData)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1327</span>    <span class="dv">9</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(restData)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;name&quot;</span>                         <span class="st">&quot;zipCode&quot;</span>                     </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>] <span class="st">&quot;neighborhood&quot;</span>                 <span class="st">&quot;councilDistrict&quot;</span>             </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>] <span class="st">&quot;policeDistrict&quot;</span>               <span class="st">&quot;Location.1&quot;</span>                  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">7</span>] <span class="st">&quot;X2010.Census.Neighborhoods&quot;</span>   <span class="st">&quot;X2010.Census.Wards.Precincts&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">9</span>] <span class="st">&quot;Zip.Codes&quot;</span>                   </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(restData, <span class="dv">3</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>   name zipCode neighborhood councilDistrict policeDistrict</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">410</span>   <span class="dv">21206</span>    Frankford               <span class="dv">2</span>   NORTHEASTERN</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1919</span>   <span class="dv">21231</span>  Fells Point               <span class="dv">1</span>   SOUTHEASTERN</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> SAUTE   <span class="dv">21224</span>       Canton               <span class="dv">1</span>   SOUTHEASTERN</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                       Location<span class="fl">.1</span> X2010.Census.Neighborhoods</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">4509</span> BELAIR ROAD\nBaltimore, MD                         <span class="cn">NA</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">1919</span> FLEET ST\nBaltimore, MD                         <span class="cn">NA</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">2844</span> HUDSON ST\nBaltimore, MD                         <span class="cn">NA</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  X2010.Census.Wards.Precincts Zip.Codes</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                           <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                           <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>                           <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(restData, <span class="dv">3</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                 name zipCode  neighborhood councilDistrict policeDistrict</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="dv">1325</span> ZINK<span class="st">&#39;S CAF\u0090   21213 Belair-Edison              13   NORTHEASTERN</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="st">1326     ZISSIMOS BAR   21211       Hampden               7       NORTHERN</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">1327           ZORBAS   21224     Greektown               2   SOUTHEASTERN</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="st">                           Location.1 X2010.Census.Neighborhoods</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="st">1325 3300 LAWNVIEW AVE</span><span class="sc">\n</span><span class="st">Baltimore, MD                         NA</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="st">1326      1023 36TH ST</span><span class="sc">\n</span><span class="st">Baltimore, MD                         NA</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="st">1327  4710 EASTERN Ave</span><span class="sc">\n</span><span class="st">Baltimore, MD                         NA</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="st">     X2010.Census.Wards.Precincts Zip.Codes</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="st">1325                           NA        NA</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="st">1326                           NA        NA</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="st">1327                           NA        NA</span></span></code></pre></div>
</div>
<div
id="summarizing-all-variables-and-getting-a-complete-information-about-the-structure-of-the-dataset-summarize-and-str."
class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Summarizing all
variables and getting a complete information about the structure of the
dataset: <code>summarize()</code> and <code>str()</code>.</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(restData)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                           name         zipCode             neighborhood</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> MCDONALD<span class="st">&#39;S                  :   8   Min.   :-21226   Downtown    :128  </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st"> POPEYES FAMOUS FRIED CHICKEN:   7   1st Qu.: 21202   Fells Point : 91  </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st"> SUBWAY                      :   6   Median : 21218   Inner Harbor: 89  </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st"> KENTUCKY FRIED CHICKEN      :   5   Mean   : 21185   Canton      : 81  </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st"> BURGER KING                 :   4   3rd Qu.: 21226   Federal Hill: 42  </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="st"> DUNKIN DONUTS               :   4   Max.   : 21287   Mount Vernon: 33  </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="st"> (Other)                     :1293                    (Other)     :863  </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st"> councilDistrict       policeDistrict                         Location.1   </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st"> Min.   : 1.000   SOUTHEASTERN:385    1101 RUSSELL ST</span><span class="sc">\n</span><span class="st">Baltimore, MD:   9  </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="st"> 1st Qu.: 2.000   CENTRAL     :288    201 PRATT ST</span><span class="sc">\n</span><span class="st">Baltimore, MD   :   8  </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="st"> Median : 9.000   SOUTHERN    :213    2400 BOSTON ST</span><span class="sc">\n</span><span class="st">Baltimore, MD :   8  </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st"> Mean   : 7.191   NORTHERN    :157    300 LIGHT ST</span><span class="sc">\n</span><span class="st">Baltimore, MD   :   5  </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="st"> 3rd Qu.:11.000   NORTHEASTERN: 72    300 CHARLES ST</span><span class="sc">\n</span><span class="st">Baltimore, MD :   4  </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="st"> Max.   :14.000   EASTERN     : 67    301 LIGHT ST</span><span class="sc">\n</span><span class="st">Baltimore, MD   :   4  </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="st">                  (Other)     :145    (Other)                       :1289  </span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="st"> X2010.Census.Neighborhoods X2010.Census.Wards.Precincts Zip.Codes     </span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st"> Mode:logical               Mode:logical                 Mode:logical  </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="st"> NA&#39;</span>s<span class="sc">:</span><span class="dv">1327</span>                  NA<span class="st">&#39;s:1327                    NA&#39;</span>s<span class="sc">:</span><span class="dv">1327</span>     </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">1327</span> obs. of  <span class="dv">9</span> variables<span class="sc">:</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> name                        <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1277</span> levels <span class="st">&quot;#1 CHINESE KITCHEN&quot;</span>,..<span class="sc">:</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">992</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> ...</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipCode                     <span class="sc">:</span> int  <span class="dv">21206</span> <span class="dv">21231</span> <span class="dv">21224</span> <span class="dv">21211</span> <span class="dv">21223</span> <span class="dv">21218</span> <span class="dv">21205</span> <span class="dv">21211</span> <span class="dv">21205</span> <span class="dv">21231</span> ...</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> neighborhood                <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">173</span> levels <span class="st">&quot;Abell&quot;</span>,<span class="st">&quot;Arlington&quot;</span>,..<span class="sc">:</span> <span class="dv">53</span> <span class="dv">52</span> <span class="dv">18</span> <span class="dv">66</span> <span class="dv">104</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">133</span> <span class="dv">98</span> <span class="dv">157</span> ...</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> councilDistrict             <span class="sc">:</span> int  <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">14</span> <span class="dv">9</span> <span class="dv">14</span> <span class="dv">13</span> <span class="dv">7</span> <span class="dv">13</span> <span class="dv">1</span> ...</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> policeDistrict              <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">9</span> levels <span class="st">&quot;CENTRAL&quot;</span>,<span class="st">&quot;EASTERN&quot;</span>,..<span class="sc">:</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">6</span> ...</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Location<span class="fl">.1</span>                  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1210</span> levels <span class="st">&quot;1 BIDDLE ST</span><span class="sc">\n</span><span class="st">Baltimore, MD&quot;</span>,..<span class="sc">:</span> <span class="dv">835</span> <span class="dv">334</span> <span class="dv">554</span> <span class="dv">755</span> <span class="dv">492</span> <span class="dv">537</span> <span class="dv">505</span> <span class="dv">530</span> <span class="dv">507</span> <span class="dv">569</span> ...</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> X2010.Census.Neighborhoods  <span class="sc">:</span> logi  <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> ...</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> X2010.Census.Wards.Precincts<span class="sc">:</span> logi  <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> ...</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Zip.Codes                   <span class="sc">:</span> logi  <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> ...</span></code></pre></div>
<ul>
<li><p>The <strong><code>summary</code> output</strong>:</p>
<ul>
<li><p>As we know, the summary of a <strong>factor</strong> variable,
like <code>name</code>, tells us the count of each of the values of the
categorical variable: how many “McDonlad’s”, “Popeye’s Famous Fried
Chicken”, etc. there are in the city.</p></li>
<li><p>The summary of the <code>ZipCode</code>
<strong>quantitative</strong> variable tells us, as we already know, the
minimum, the first quartile, the median, and so forth.</p>
<ul>
<li>At a glance we can see for instance an interesting fact: <em>one of
the zip codes</em> is actually <em>coded as</em> a <strong>negative
value</strong>, which obviously probably shouldn’t have happened.</li>
</ul></li>
<li><p>Another thing we can see right away, is how we are doing with
<strong>missing values</strong>.</p>
<ul>
<li><p>There’s a <em>group of variables</em> that <strong>do not have
<code>NA</code>s</strong> at all and <em>another group</em> that has
<strong>only <code>NA</code>s!</strong>.</p></li>
<li><p>So, one of the first things we can do is remove those variables
(<code>X2010.Census.Neighborhoods</code>,
<code>X2010.Census.Wards.Precints</code> and <code>Zip.Codes</code>)
that has only <code>NA</code>s as values, because they don’t give us any
information.</p></li>
</ul></li>
</ul></li>
<li><p>The <strong><code>str</code> output</strong>:</p>
<ul>
<li><p>As we know, it tells us the class of the variable, the dimensions
of the data frame, all the different classes that the different columns
correspond to.</p></li>
<li><p>This information allows us to <strong>know if we need</strong> to
manipulate things and <strong>change quantitative</strong>
<strong>variables to qualitative</strong> and so forth.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>X2010.Census.Neighborhoods <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>X2010.Census.Wards.Precincts <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>Zip.Codes <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">1327</span> obs. of  <span class="dv">6</span> variables<span class="sc">:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> name           <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1277</span> levels <span class="st">&quot;#1 CHINESE KITCHEN&quot;</span>,..<span class="sc">:</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">992</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> ...</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipCode        <span class="sc">:</span> int  <span class="dv">21206</span> <span class="dv">21231</span> <span class="dv">21224</span> <span class="dv">21211</span> <span class="dv">21223</span> <span class="dv">21218</span> <span class="dv">21205</span> <span class="dv">21211</span> <span class="dv">21205</span> <span class="dv">21231</span> ...</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> neighborhood   <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">173</span> levels <span class="st">&quot;Abell&quot;</span>,<span class="st">&quot;Arlington&quot;</span>,..<span class="sc">:</span> <span class="dv">53</span> <span class="dv">52</span> <span class="dv">18</span> <span class="dv">66</span> <span class="dv">104</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">133</span> <span class="dv">98</span> <span class="dv">157</span> ...</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> councilDistrict<span class="sc">:</span> int  <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">14</span> <span class="dv">9</span> <span class="dv">14</span> <span class="dv">13</span> <span class="dv">7</span> <span class="dv">13</span> <span class="dv">1</span> ...</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> policeDistrict <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">9</span> levels <span class="st">&quot;CENTRAL&quot;</span>,<span class="st">&quot;EASTERN&quot;</span>,..<span class="sc">:</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">6</span> ...</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Location<span class="fl">.1</span>     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1210</span> levels <span class="st">&quot;1 BIDDLE ST</span><span class="sc">\n</span><span class="st">Baltimore, MD&quot;</span>,..<span class="sc">:</span> <span class="dv">835</span> <span class="dv">334</span> <span class="dv">554</span> <span class="dv">755</span> <span class="dv">492</span> <span class="dv">537</span> <span class="dv">505</span> <span class="dv">530</span> <span class="dv">507</span> <span class="dv">569</span> ...</span></code></pre></div>
</div>
<div id="quantiles-of-quantitative-variables." class="section level2"
number="2.5">
<h2><span class="header-section-number">2.5</span> Quantiles of
quantitative variables.</h2>
<p>We can use <code>quantile()</code> to look at
<strong>variability</strong> on quantitative variables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(restData<span class="sc">$</span>councilDistrict, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">%  25%</span>  <span class="dv">50</span><span class="sc">%  75%</span> <span class="dv">100</span>% </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">9</span>   <span class="dv">11</span>   <span class="dv">14</span> </span></code></pre></div>
<ul>
<li><p>So the smallest value is 1, the top value is 14 and the median
value is 9.</p></li>
<li><p>Setting the <code>na.rm</code> parameter to <code>TRUE</code> we
ensure to remove the missing values (in this case it wouldn’t be
necessary because we saw with <code>summary</code> that this variable
doesn’t have <code>NA</code>s).</p></li>
</ul>
<p>We can also tell it to look at <strong>different
probabilities</strong>, through the <code>probs</code> parameter.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(restData<span class="sc">$</span>councilDistrict, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span><span class="sc">% 75%</span> <span class="dv">90</span>% </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>  <span class="dv">11</span>  <span class="dv">12</span> </span></code></pre></div>
<ul>
<li>The zeroth quartile is the minimum value; the 0.5 quartile, the
medium; etc.</li>
</ul>
</div>
<div id="check-for-missing-values." class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Check for missing
values.</h2>
<p>We know that a useful function here <code>is.na()</code> function and
we also know how to use it.</p>
<div
id="checking-how-many-missing-values-in-a-single-variable-is.na-sum."
class="section level3" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Checking how many
missing values in a single variable: <code>is.na()</code> +
<code>sum()</code>.</h3>
<p>Let’s apply <code>is.na()</code> to the <code>councilDistrict</code>
variable. It returns a logical vector, so we make the <code>sum()</code>
of it to see how many <code>NA</code>s are there.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(restData<span class="sc">$</span>councilDistrict))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
<ul>
<li>As we saw before, <strong>no missing values</strong> there.</li>
</ul>
</div>
<div
id="globally-checking-existance-of-missing-values-in-a-single-variable-is.na-any."
class="section level3" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Globally checking
existance of missing values in a single variable: <code>is.na()</code> +
<code>any()</code>.</h3>
<p>If we are <strong>not interested</strong> in the
<strong>number</strong> of missing values that the variable might have,
we can use <strong>the <code>any()</code> command</strong> on the
logical vector returned by <code>is.na</code>.</p>
<ul>
<li>It will just look through the entire set of values. In this case
<code>is.na</code> returns true or false, so it checks if any of these
values are equal to <code>TRUE</code>.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(restData<span class="sc">$</span>councilDistrict))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span></code></pre></div>
<ul>
<li><code>any</code> <strong>returns <code>FALSE</code></strong> because
all of the values returned by <code>is.na</code> are <code>FALSE</code>,
because none of the values of the variable are <code>NA</code>.</li>
</ul>
</div>
<div
id="checking-that-all-values-of-a-single-variable-meet-a-logical-condition-all."
class="section level3" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Checking that all
values of a single variable meet a logical condition:
<code>all()</code>.</h3>
<p>Another thing we can do here is use <strong>the <code>all()</code>
command</strong> to perform <strong><em>common sense
checkings</em></strong> through <strong><em>logical
statements</em></strong>, for instance, a condition that <strong>every
value</strong> of the variable <strong>should satisfy</strong>.</p>
<ul>
<li><p>That will depend on the nature of the variable we are looking
at.</p></li>
<li><p>For example, we would hope that all the <strong>zip
codes</strong> are <strong>greater than zero</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(restData<span class="sc">$</span>zipCode <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span></code></pre></div>
<ul>
<li>It turns out that, as we saw before, one of the zip codes isn’t
greater than zero!</li>
</ul>
</div>
<div
id="checking-at-once-how-many-missing-values-in-all-variables-is.na-to-the-entire-data-frame-colsums."
class="section level3" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Checking AT ONCE
how many missing values in ALL variables: <code>is.na()</code> to the
entire data frame + <code>colSums()</code>.</h3>
<p>We’ve got this information before with <code>summary()</code>, but
this commnand gives a lot of other info.</p>
<p>There’s a way to just check the number of <code>NA</code>s in ALL the
variables of the data frame:</p>
<ul>
<li><p>We apply <strong><code>is.na()</code></strong> to the
<strong>entire data frame</strong>. That will give us a <strong>logical
matrix</strong> with the same dimensions of the original data frame,
because <strong>each column</strong> will be <strong>the logical
vector</strong> that comes out after checking for <code>NA</code>s on
each of the variables.</p></li>
<li><p>Then, we just have to <strong>sum across all the
columns</strong>. We know that we could do that with
<code>sapply()</code>, but we also know that there’s an
<strong>optimized function for this specific task</strong>:
<code>colSums()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">is.na</span>(restData))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">1327</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;dimnames&quot;</span>)<span class="ot">=</span>List of <span class="dv">2</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span> <span class="cn">NULL</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="st">&quot;name&quot;</span> <span class="st">&quot;zipCode&quot;</span> <span class="st">&quot;neighborhood&quot;</span> <span class="st">&quot;councilDistrict&quot;</span> ...</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(restData))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>           name         zipCode    neighborhood councilDistrict  policeDistrict </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>               <span class="dv">0</span>               <span class="dv">0</span>               <span class="dv">0</span>               <span class="dv">0</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     Location<span class="fl">.1</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span> </span></code></pre></div>
<ul>
<li>We verify then, once again, that there are no missing values.</li>
</ul>
</div>
<div
id="globally-checking-at-once-existance-of-missing-values-in-the-entire-data-frame-is.na-to-the-entire-data-frame-colsums-all-zero-condition."
class="section level3" number="2.6.5">
<h3><span class="header-section-number">2.6.5</span> Globally checking
AT ONCE existance of missing values in the entire data frame:
<code>is.na()</code> to the entire data frame + <code>colSums()</code> +
<code>all()</code> “zero” condition.</h3>
<p>We can apply <code>all()</code> to the previous column sums checking
if all of them are equal to zero.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(restData)) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<ul>
<li>Again, there are no missing values in this data set.</li>
</ul>
</div>
</div>
<div
id="finding-values-within-a-variable-with-specific-characteristics-operator-in."
class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Finding values within
a variable with specific characteristics: operator
<code>%in%</code>.</h2>
<p>Suppose we want to find all the zip codes that are equal to 21212. We
could just use the equals equals command, but <strong>there’s an
interesting alternative</strong>: <code>operator %in%</code>.</p>
<ul>
<li><p>So, the question that answers operator <code>%in%</code> is:
<em>are there any values of the left variable that fall</em> <em>into
the vector of values at the right?</em></p></li>
<li><p>It <strong>returns a logical vector</strong> that we can of
course use for <em>indexing rows</em>, <em>taking a sum</em>,
<em>making</em> <em>a table of <code>TRUE</code>s and
<code>FALSE</code>es</em>.</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21212&quot;</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span>  <span class="cn">TRUE</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a> <span class="dv">1299</span>    <span class="dv">28</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21212&quot;</span>, <span class="st">&quot;21213&quot;</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span>  <span class="cn">TRUE</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">1268</span>    <span class="dv">59</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(restData[restData<span class="sc">$</span>zipCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;21212&quot;</span>, <span class="st">&quot;21213&quot;</span>), ])</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                           name zipCode      neighborhood councilDistrict</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1304</span>       WHITTEN<span class="st">&#39;S  (4502-04)   21213 Claremont-Freedom              13</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="st">1312                wozi lounge   21212          Guilford               4</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="st">1319 YETI RESTAURANT &amp; CARRYOUT   21212          Rosebank               4</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">1320           YORK CLUB TAVERN   21212          Homeland               4</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="st">1323  ZEN WEST ROADSIDE CANTINA   21212          Rosebank               4</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="st">1325           ZINK&#39;</span>S CAF\u0090   <span class="dv">21213</span>     Belair<span class="sc">-</span>Edison              <span class="dv">13</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>     policeDistrict                       Location<span class="fl">.1</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="dv">1304</span>   NORTHEASTERN   <span class="dv">4502</span> ERDMAN AVE\nBaltimore, MD</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1312</span>       NORTHERN      <span class="dv">4515</span> YORK RD\nBaltimore, MD</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="dv">1319</span>       NORTHERN      <span class="dv">5926</span> YORK RD\nBaltimore, MD</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="dv">1320</span>       NORTHERN      <span class="dv">5407</span> YORK RD\nBaltimore, MD</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="dv">1323</span>       NORTHERN      <span class="dv">5916</span> YORK RD\nBaltimore, MD</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="dv">1325</span>   NORTHEASTERN <span class="dv">3300</span> LAWNVIEW AVE\nBaltimore, MD</span></code></pre></div>
</div>
<div
id="making-tables-contingency-and-complexflat-tables-with-table-function-and-cross-tables-with-xtabs-function."
class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Making tables:
contingency and complex/flat tables with <code>table()</code> function
and cross tables with <code>xtabs()</code> function.</h2>
<p>Another way to look at the data is to <strong>look at specific
variables</strong> and make a <strong>table</strong>.</p>
<p>Generally speaking, in R we can talk about <em>these kinds</em> of
tables:</p>
<ul>
<li><p><strong>Contingency tables</strong>: they are a way to redraw
data and assemble it into a table that shows the layout of the original
data in a manner that allows the reader to gain an overall summary of
the original data.</p>
<ul>
<li>They are particularly useful when a large number of observations
need to be condensed into a smaller format.</li>
</ul></li>
<li><p><strong>Complex/Flat tables</strong>: they are a <strong>type of
contingency table</strong> that is used when creating just one single
table as opposed to multiple ones.</p></li>
<li><p><strong>Cross tables</strong>: cross-tabulation is used to
reassemble data into a tabular format as necessary.</p></li>
</ul>
<p>We can use:</p>
<ul>
<li><p>The <code>table()</code> command to create <strong>contingency
tables</strong>.</p></li>
<li><p>The <code>xtabs()</code> command to create <strong>cross
tables</strong>.</p></li>
<li><p>The <code>ftable()</code> command to create <strong>contingency
complex(flat) tables</strong>.</p></li>
</ul>
<div id="contingency-tables." class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Contingency
tables.</h3>
<p>The <strong><code>table()</code> command</strong>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(table)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> <span class="st">&#39;table&#39;</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="dv">3</span> <span class="dv">29</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">18</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">37</span> <span class="dv">0</span> ...</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;dimnames&quot;</span>)<span class="ot">=</span>List of <span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> ...</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="st">&quot;laying&quot;</span> <span class="st">&quot;sitting&quot;</span> <span class="st">&quot;standing&quot;</span> <span class="st">&quot;walk&quot;</span> ...</span></code></pre></div>
<ul>
<li><p>It can handle samples of data in simple <em>vectors</em>,
<em>lists</em> or more complex <em>matrix</em> or <em>data frame</em>
objects.</p></li>
<li><p>It can produce <strong>contingency tables</strong> (we’ll see
examples of one dimensional and two dimensional contingency tables) and
<strong>complex (flat) contingency tables</strong>.</p></li>
<li><p>A word about the <code>useNA</code> parameter: it controls if the
table includes counts of <code>NA</code> values.</p>
<ul>
<li><code>"no"</code> means <em>never</em> (this is the
<strong>default</strong>).<br />
</li>
<li><code>"ifany"</code> means <em>only if the count is
positive</em>.<br />
</li>
<li><code>"always"</code> means <em>even for zero counts</em>.</li>
</ul></li>
</ul>
<div id="one-dimensional-contingency-tables." class="section level4"
number="2.8.1.1">
<h4><span class="header-section-number">2.8.1.1</span> One dimensional
contingency tables.</h4>
<p>A vector is the simplest data object from which we can create a (one
dimensional) contingency table.</p>
<p>Let’s make a table from the <code>zipCode</code> variable.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipCode, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">21226</span>  <span class="dv">21201</span>  <span class="dv">21202</span>  <span class="dv">21205</span>  <span class="dv">21206</span>  <span class="dv">21207</span>  <span class="dv">21208</span>  <span class="dv">21209</span>  <span class="dv">21210</span>  <span class="dv">21211</span>  <span class="dv">21212</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>    <span class="dv">136</span>    <span class="dv">201</span>     <span class="dv">27</span>     <span class="dv">30</span>      <span class="dv">4</span>      <span class="dv">1</span>      <span class="dv">8</span>     <span class="dv">23</span>     <span class="dv">41</span>     <span class="dv">28</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">21213</span>  <span class="dv">21214</span>  <span class="dv">21215</span>  <span class="dv">21216</span>  <span class="dv">21217</span>  <span class="dv">21218</span>  <span class="dv">21220</span>  <span class="dv">21222</span>  <span class="dv">21223</span>  <span class="dv">21224</span>  <span class="dv">21225</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">31</span>     <span class="dv">17</span>     <span class="dv">54</span>     <span class="dv">10</span>     <span class="dv">32</span>     <span class="dv">69</span>      <span class="dv">1</span>      <span class="dv">7</span>     <span class="dv">56</span>    <span class="dv">199</span>     <span class="dv">19</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">21226</span>  <span class="dv">21227</span>  <span class="dv">21229</span>  <span class="dv">21230</span>  <span class="dv">21231</span>  <span class="dv">21234</span>  <span class="dv">21237</span>  <span class="dv">21239</span>  <span class="dv">21251</span>  <span class="dv">21287</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">18</span>      <span class="dv">4</span>     <span class="dv">13</span>    <span class="dv">156</span>    <span class="dv">127</span>      <span class="dv">7</span>      <span class="dv">1</span>      <span class="dv">3</span>      <span class="dv">2</span>      <span class="dv">1</span> </span></code></pre></div>
<ul>
<li><p>Here we confirm that <strong>only of the zip codes is coded as a
negative value</strong>.</p></li>
<li><p>Also, where the <strong>bulk of the zip code values</strong> are.
For example, <code>21201</code>, <code>21202</code> and
<code>21224</code> have a lot of values.</p></li>
<li><p>Finally, we confirm also that <strong>there are no missing
values</strong>. Infact, <code>useNA = "ifany"</code> means that if
there are any missing values, it’s count is put in an added
<code>NA</code> column, which is not there in our output.</p></li>
</ul>
</div>
<div
id="two-dimensional-contingency-tables-relationship-between-two-variables."
class="section level4" number="2.8.1.2">
<h4><span class="header-section-number">2.8.1.2</span> Two dimensional
contingency tables (relationship between two variables).</h4>
<p>We can also make two dimensional tables, <strong>passing two
variables</strong> to <code>table()</code>.</p>
<p>This is useful to get a <strong>sense of the relationship</strong>
between <strong>two variables</strong>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>councilDistrict, restData<span class="sc">$</span>zipCode)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>     <span class="sc">-</span><span class="dv">21226</span> <span class="dv">21201</span> <span class="dv">21202</span> <span class="dv">21205</span> <span class="dv">21206</span> <span class="dv">21207</span> <span class="dv">21208</span> <span class="dv">21209</span> <span class="dv">21210</span> <span class="dv">21211</span> <span class="dv">21212</span> <span class="dv">21213</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>       <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">37</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">3</span>    <span class="dv">27</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">27</span>     <span class="dv">0</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">6</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>    <span class="dv">19</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>    <span class="dv">27</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8</span>       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>       <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>      <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">11</span>      <span class="dv">0</span>   <span class="dv">115</span>   <span class="dv">139</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">12</span>      <span class="dv">0</span>    <span class="dv">20</span>    <span class="dv">24</span>     <span class="dv">4</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">13</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">20</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">13</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">14</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">4</span>    <span class="dv">14</span>     <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>     <span class="dv">21214</span> <span class="dv">21215</span> <span class="dv">21216</span> <span class="dv">21217</span> <span class="dv">21218</span> <span class="dv">21220</span> <span class="dv">21222</span> <span class="dv">21223</span> <span class="dv">21224</span> <span class="dv">21225</span> <span class="dv">21226</span> <span class="dv">21227</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">7</span>     <span class="dv">0</span>   <span class="dv">140</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">54</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>     <span class="dv">17</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>      <span class="dv">0</span>    <span class="dv">31</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>      <span class="dv">0</span>    <span class="dv">15</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>      <span class="dv">0</span>     <span class="dv">6</span>     <span class="dv">7</span>    <span class="dv">15</span>     <span class="dv">6</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">8</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">53</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">18</span>    <span class="dv">18</span>     <span class="dv">0</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">11</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">9</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">12</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">26</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">5</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">14</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">34</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>     <span class="dv">21229</span> <span class="dv">21230</span> <span class="dv">21231</span> <span class="dv">21234</span> <span class="dv">21237</span> <span class="dv">21239</span> <span class="dv">21251</span> <span class="dv">21287</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>      <span class="dv">0</span>     <span class="dv">1</span>   <span class="dv">124</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">7</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">0</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8</span>     <span class="dv">13</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>      <span class="dv">0</span>    <span class="dv">11</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>     <span class="dv">0</span>   <span class="dv">133</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  <span class="dv">11</span>     <span class="dv">0</span>    <span class="dv">11</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="dv">12</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="dv">14</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span></code></pre></div>
<ul>
<li><p>We can see, for example, that district 2 has 27 restaurants in
the 21206 zip code.</p></li>
<li><p>And that the negative zip code is in district 10.</p></li>
</ul>
<p>Another example with the <code>iris</code> dataset.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">table</span>(iris<span class="sc">$</span>Petal.Length, iris<span class="sc">$</span>Species), <span class="dv">10</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      setosa versicolor virginica</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>        <span class="dv">1</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.1</span>      <span class="dv">1</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.2</span>      <span class="dv">2</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.3</span>      <span class="dv">7</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.4</span>     <span class="dv">13</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.5</span>     <span class="dv">13</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.6</span>      <span class="dv">7</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.7</span>      <span class="dv">4</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.9</span>      <span class="dv">2</span>          <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>        <span class="dv">0</span>          <span class="dv">1</span>         <span class="dv">0</span></span></code></pre></div>
<ul>
<li>So, for instance, there are 13 setosa species that have petals long
1.5, other 13 have petals long 1.4, other 7 have petals long 1.3 and so
forth.</li>
</ul>
</div>
</div>
<div id="cross-tables-xtab-function." class="section level3"
number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Cross tables:
<code>xtab()</code> function.</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(xtabs)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">formula =</span> <span class="sc">~</span>., <span class="at">data =</span> <span class="fu">parent.frame</span>(), subset, <span class="at">sparse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    na.action, <span class="at">addNA =</span> <span class="cn">FALSE</span>, <span class="at">exclude =</span> <span class="cf">if</span> (<span class="sc">!</span>addNA) <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NaN</span>), <span class="at">drop.unused.levels =</span> <span class="cn">FALSE</span>)  </span></code></pre></div>
<ul>
<li><p>The first argument is a <strong><code>formula</code>
object</strong>.</p>
<ul>
<li><p>The <strong>tilde <code>~</code></strong> character is used to
create a formula.</p></li>
<li><p>On the <em>left hand side</em> we give the <strong>variable that
we want to be displayed</strong> as the <strong>body</strong> (the
cells) of the table.</p></li>
<li><p>On the <em>right hand side</em> we give the
<strong>cross-classifying variables</strong>, <em>separated by
<code>+</code></em>, on which we want to break the left variable
down.</p></li>
</ul></li>
</ul>
<p><strong>Example</strong>. Let’s take here one of the classic datasets
in R to work with: the <code>UCBAdmissions</code> dataset, the Berkeley
admissions data.</p>
<ul>
<li>It’s an array of tables (a multidimensional array of 3 dimensions),
so let’s first coerce it to a <code>data.frame</code> and inspect it
with <code>summary</code>.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(UCBAdmissions)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">6</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>UCBAdmissions</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> A</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  Admitted  <span class="dv">512</span>     <span class="dv">89</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">313</span>     <span class="dv">19</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> B</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  Admitted  <span class="dv">353</span>     <span class="dv">17</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">207</span>      <span class="dv">8</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> C</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  Admitted  <span class="dv">120</span>    <span class="dv">202</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">205</span>    <span class="dv">391</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> D</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  Admitted  <span class="dv">138</span>    <span class="dv">131</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">279</span>    <span class="dv">244</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> E</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  Admitted   <span class="dv">53</span>     <span class="dv">94</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">138</span>    <span class="dv">299</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>, , Dept <span class="ot">=</span> F</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>          Gender</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>Admit      Male Female</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  Admitted   <span class="dv">22</span>     <span class="dv">24</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  Rejected  <span class="dv">351</span>    <span class="dv">317</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(UCBAdmissions)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DF)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>      Admit       Gender   Dept       Freq      </span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a> Admitted<span class="sc">:</span><span class="dv">12</span>   Male  <span class="sc">:</span><span class="dv">12</span>   A<span class="sc">:</span><span class="dv">4</span>   Min.   <span class="sc">:</span>  <span class="fl">8.0</span>  </span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a> Rejected<span class="sc">:</span><span class="dv">12</span>   Female<span class="sc">:</span><span class="dv">12</span>   B<span class="sc">:</span><span class="dv">4</span>   1st Qu.<span class="sc">:</span> <span class="fl">80.0</span>  </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>                           C<span class="sc">:</span><span class="dv">4</span>   Median <span class="sc">:</span><span class="fl">170.0</span>  </span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>                           D<span class="sc">:</span><span class="dv">4</span>   Mean   <span class="sc">:</span><span class="fl">188.6</span>  </span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>                           E<span class="sc">:</span><span class="dv">4</span>   3rd Qu.<span class="sc">:</span><span class="fl">302.5</span>  </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>                           F<span class="sc">:</span><span class="dv">4</span>   Max.   <span class="sc">:</span><span class="fl">512.0</span>  </span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(DF)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">24</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> Admit <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">&quot;Admitted&quot;</span>,<span class="st">&quot;Rejected&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> ...</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Gender<span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Dept  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">6</span> levels <span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,..<span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> ...</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Freq  <span class="sc">:</span> num  <span class="dv">512</span> <span class="dv">313</span> <span class="dv">89</span> <span class="dv">19</span> <span class="dv">353</span> <span class="dv">207</span> <span class="dv">17</span> <span class="dv">8</span> <span class="dv">120</span> <span class="dv">205</span> ...</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DF)</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>     Admit Gender Dept Freq</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Admitted   Male    A  <span class="dv">512</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Rejected   Male    A  <span class="dv">313</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Admitted Female    A   <span class="dv">89</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Rejected Female    A   <span class="dv">19</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> Admitted   Male    B  <span class="dv">353</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Rejected   Male    B  <span class="dv">207</span></span></code></pre></div>
<ul>
<li><p>We can see there are <strong>four variables</strong>:
<em>Admit</em>, <em>Gender</em>, <em>Department</em> and
<em>Frequency</em>.</p></li>
<li><p>It tells us how many people, each of the different categories,
are admitted or rejected.</p></li>
</ul>
<p>So let’s make a <strong>cross table</strong> to <strong>identify the
relationships</strong> in this dataset.</p>
<ul>
<li>We are interested in the frequency variable <code>Freq</code> and we
want to break it down by <code>Gender</code> and by <code>Admit</code>
variables.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> Gender <span class="sc">+</span> Admit, <span class="at">data =</span> DF)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(xt); <span class="fu">dim</span>(xt)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;xtabs&quot;</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>xt</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        Admit</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>Gender   Admitted Rejected</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  Male       <span class="dv">1198</span>     <span class="dv">1493</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  Female      <span class="dv">557</span>     <span class="dv">1278</span></span></code></pre></div>
<ul>
<li>So this tells us the frequency, for instance, that males were
rejected (<code>1493</code>), the frequency that females were admitted
(<code>557</code>), etc.</li>
</ul>
</div>
<div
id="cross-tables-with-more-than-two-cross-classifying-variables-often-hard-to-see.-example."
class="section level3" number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> Cross tables with
more than two cross-classifying variables, often hard to see.
Example.</h3>
<p>We can do cross tabs for a larger number of variables, but they are
often kind of hard to see.</p>
<p>Now we’ll take as example, another standard R dataset:
<code>warpbreaks</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(warpbreaks)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">54</span>  <span class="dv">4</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(warpbreaks)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     breaks      wool   tension   replicate</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span><span class="fl">10.00</span>   A<span class="sc">:</span><span class="dv">27</span>   L<span class="sc">:</span><span class="dv">18</span>    Min.   <span class="sc">:</span><span class="dv">1</span>  </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span><span class="fl">18.25</span>   B<span class="sc">:</span><span class="dv">27</span>   M<span class="sc">:</span><span class="dv">18</span>    1st Qu.<span class="sc">:</span><span class="dv">3</span>  </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">26.00</span>          H<span class="sc">:</span><span class="dv">18</span>    Median <span class="sc">:</span><span class="dv">5</span>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">28.15</span>                  Mean   <span class="sc">:</span><span class="dv">5</span>  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">34.00</span>                  3rd Qu.<span class="sc">:</span><span class="dv">7</span>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">70.00</span>                  Max.   <span class="sc">:</span><span class="dv">9</span>  </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">54</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> breaks   <span class="sc">:</span> num  <span class="dv">26</span> <span class="dv">30</span> <span class="dv">54</span> <span class="dv">25</span> <span class="dv">70</span> <span class="dv">52</span> <span class="dv">51</span> <span class="dv">26</span> <span class="dv">67</span> <span class="dv">18</span> ...</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> wool     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tension  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">3</span> levels <span class="st">&quot;L&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> ...</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> replicate<span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">1</span> ...</span></code></pre></div>
<p>To illustrate the point of this paragraph, let’s add the following
<code>repĺicate</code> variable to this dataset.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>warpbreaks<span class="sc">$</span>replicate <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">len =</span> <span class="dv">54</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">54</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> breaks   <span class="sc">:</span> num  <span class="dv">26</span> <span class="dv">30</span> <span class="dv">54</span> <span class="dv">25</span> <span class="dv">70</span> <span class="dv">52</span> <span class="dv">51</span> <span class="dv">26</span> <span class="dv">67</span> <span class="dv">18</span> ...</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> wool     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tension  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">3</span> levels <span class="st">&quot;L&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> ...</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> replicate<span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">1</span> ...</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks, <span class="dv">12</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>   breaks wool tension replicate</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">26</span>    A       L         <span class="dv">1</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">30</span>    A       L         <span class="dv">2</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">54</span>    A       L         <span class="dv">3</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">25</span>    A       L         <span class="dv">4</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      <span class="dv">70</span>    A       L         <span class="dv">5</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      <span class="dv">52</span>    A       L         <span class="dv">6</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      <span class="dv">51</span>    A       L         <span class="dv">7</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      <span class="dv">26</span>    A       L         <span class="dv">8</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      <span class="dv">67</span>    A       L         <span class="dv">9</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     <span class="dv">18</span>    A       M         <span class="dv">1</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>     <span class="dv">21</span>    A       M         <span class="dv">2</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>     <span class="dv">29</span>    A       M         <span class="dv">3</span></span></code></pre></div>
<p>Now, we can create a <strong>cross table</strong> with the values of
<code>breaks</code> variable broken down <strong>by all the
other</strong> <strong>variables in the data set</strong>, that is to
say, by the <strong>three different variables</strong>
<code>replicate</code>, <code>tension</code> and <code>wool</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(breaks <span class="sc">~</span> ., <span class="at">data =</span> warpbreaks)     <span class="co"># dot &quot;.&quot; character stands for &quot;all other&quot; variables.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(xt); <span class="fu">dim</span>(xt)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;xtabs&quot;</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">9</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>xt</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">26</span> <span class="dv">18</span> <span class="dv">36</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">27</span> <span class="dv">42</span> <span class="dv">20</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">30</span> <span class="dv">21</span> <span class="dv">21</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">14</span> <span class="dv">26</span> <span class="dv">21</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">54</span> <span class="dv">29</span> <span class="dv">24</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">29</span> <span class="dv">19</span> <span class="dv">24</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">25</span> <span class="dv">17</span> <span class="dv">18</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">19</span> <span class="dv">16</span> <span class="dv">17</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">70</span> <span class="dv">12</span> <span class="dv">10</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">29</span> <span class="dv">39</span> <span class="dv">13</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">52</span> <span class="dv">18</span> <span class="dv">43</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">31</span> <span class="dv">28</span> <span class="dv">15</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">51</span> <span class="dv">35</span> <span class="dv">28</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">41</span> <span class="dv">21</span> <span class="dv">15</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">26</span> <span class="dv">30</span> <span class="dv">15</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">20</span> <span class="dv">39</span> <span class="dv">16</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>, , replicate <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    tension</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>wool  L  M  H</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>   A <span class="dv">67</span> <span class="dv">36</span> <span class="dv">26</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>   B <span class="dv">44</span> <span class="dv">29</span> <span class="dv">28</span></span></code></pre></div>
<ul>
<li>So we end up creating a <strong>multidimensional array</strong>, an
<em>array of two dimensional tables</em>.</li>
</ul>
</div>
<div id="flat-tables." class="section level3" number="2.8.4">
<h3><span class="header-section-number">2.8.4</span> Flat tables.</h3>
<p>Multidimensional objects can be a little hard to see, because they
will usually be a long list of output.</p>
<p>To improve this issue, we can make a <strong>flat table</strong> by
<strong>just taking the cross table that we made previously</strong> and
<strong>applying the <code>ftable()</code> command</strong>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">ftable</span>(xt)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ft); <span class="fu">dim</span>(ft)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;ftable&quot;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span> <span class="dv">9</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ft</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>             replicate  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>wool tension                                     </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>A    L                 <span class="dv">26</span> <span class="dv">30</span> <span class="dv">54</span> <span class="dv">25</span> <span class="dv">70</span> <span class="dv">52</span> <span class="dv">51</span> <span class="dv">26</span> <span class="dv">67</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>     M                 <span class="dv">18</span> <span class="dv">21</span> <span class="dv">29</span> <span class="dv">17</span> <span class="dv">12</span> <span class="dv">18</span> <span class="dv">35</span> <span class="dv">30</span> <span class="dv">36</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>     H                 <span class="dv">36</span> <span class="dv">21</span> <span class="dv">24</span> <span class="dv">18</span> <span class="dv">10</span> <span class="dv">43</span> <span class="dv">28</span> <span class="dv">15</span> <span class="dv">26</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>B    L                 <span class="dv">27</span> <span class="dv">14</span> <span class="dv">29</span> <span class="dv">19</span> <span class="dv">29</span> <span class="dv">31</span> <span class="dv">41</span> <span class="dv">20</span> <span class="dv">44</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>     M                 <span class="dv">42</span> <span class="dv">26</span> <span class="dv">19</span> <span class="dv">16</span> <span class="dv">39</span> <span class="dv">28</span> <span class="dv">21</span> <span class="dv">39</span> <span class="dv">29</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>     H                 <span class="dv">20</span> <span class="dv">21</span> <span class="dv">24</span> <span class="dv">17</span> <span class="dv">13</span> <span class="dv">15</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">28</span></span></code></pre></div>
<ul>
<li><p>It summarizes the data in a <strong>much smaller, more compact
form</strong>.</p></li>
<li><p>It’s <strong>easier to see</strong> when we have large
tables.</p></li>
</ul>
<hr />
</div>
</div>
</div>
<div id="creating-new-variables.-transforming-the-data."
class="section level1" number="3">
<h1><span class="header-section-number">3</span> Creating new variables.
Transforming the data.</h1>
<p>Once we loaded the dataset into R, sometimes we’ll find that
<strong>some of the variables</strong> that <strong>we’re</strong>
<strong>looking for</strong> <strong><em>are not actually in the loaded
raw data</em></strong>.</p>
<p>So we may need to <strong>transform the data</strong> a little bit to
get the value we’d like.</p>
<p>Usually, we’ll <strong>add those values back into the data
frame</strong>.</p>
<ul>
<li>This is <strong>particularly important</strong> when we’re doing
something like <strong>prediction</strong>, where we want to create
<em>new variables</em> but we might use <em>as predictors</em>.</li>
</ul>
<p><strong>Common variables</strong> that people create are:</p>
<ul>
<li><p><em>Subsetting variables</em> that indicates a subset from other
variables.</p></li>
<li><p><em>Missingness indicators</em> to point out where we might have
missing data.</p></li>
<li><p>Categorical variables for <em>cutting up quantitative
variables</em>, that is, variables that are <strong>factor versions of a
quantitative variable</strong> corresponding to particular values that
may be of interest.</p></li>
<li><p><em>Applying transformations</em> to deal with data that have a
<strong>strange distributions</strong>.</p></li>
</ul>
<div
id="recall-creating-sequences-with-seq-and-its-importance-for-indexing."
class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Recall creating
sequences with <code>seq()</code> and it’s importance for indexing.</h2>
<p>Sequences are often used to index different operations that we’re
interested to do on data.</p>
<p>We already saw this topic in <strong>R Programming</strong> course
(within the section of <strong>Numeric Vectors</strong>), so let’s now
<strong>just remember</strong> that there are <strong>three ways in
which we usually specify how many values to</strong>
<strong>generate</strong>.</p>
<ul>
<li><p>One is to use the <code>by</code> parameter.</p></li>
<li><p>Another is to specify the <code>length.out</code> of the
sequence.</p></li>
<li><p>And a third way is to create a sequence of the <strong>same
lenght</strong> of another vector that we specify throug the
<code>along.with</code> parameter of the <code>seq()</code> function or
using the <code>seq_along()</code> command.</p>
<ul>
<li>This last one is usually done for looping or accessing subsets of
data sets.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>); s1</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">3</span>); s2</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">1.0</span>  <span class="fl">5.5</span> <span class="fl">10.0</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">100</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">along.with =</span> x)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(x)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span></span></code></pre></div>
</div>
<div
id="creating-a-new-logical-variable-indicating-a-subset-of-others-operator-in.-handy-for-subsetting."
class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Creating a new
logical variable indicating a subset of others: operator
<code>%in%</code>. Handy for subsetting.</h2>
<p>One kind of variable that we might want to create is a variable that
<strong>indicates which subset another</strong> <strong>variable comes
from</strong>.</p>
<ul>
<li><p>Taking as example our Baltimore restaurants data,
<code>restData</code>, we know that this dataset has the
<code>neighborhood</code>s variable.</p></li>
<li><p>So, we might want to <strong>find all the restaurants</strong>
that are <strong>in two neighborhoods near us</strong>,
<code>Roland Park</code> and <code>Homeland</code>.</p></li>
</ul>
<p>As we know, <strong>operator <code>%in%</code> comes in
handy</strong> to perform this task.</p>
<ul>
<li><p>It returns a logical vector, so <strong>the new variable</strong>
that indicates a subset of others will be a <strong>logical
variable</strong>.</p></li>
<li><p>Therefore, this new variable will allow us to subset the dataset
only by the restaurants that are near us.</p></li>
<li><p>This is a <strong>nice, clean way of subsetting</strong> the
dataset, as *opposed to** always having to use the longer ampersand
<code>&amp;</code> command.</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>nearMe <span class="ot">&lt;-</span> restData<span class="sc">$</span>neighborhood <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Roland Park&quot;</span>, <span class="st">&quot;Homeland&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>nearMe)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span>  <span class="cn">TRUE</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1314</span>    <span class="dv">13</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>restData[restData<span class="sc">$</span>nearMe, ]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                                       name zipCode neighborhood</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="dv">37</span>               BELVEDERE TOWERS CAF\u0090   <span class="dv">21210</span>  Roland Park</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="dv">108</span>                  BALTIMORE COUNTRY CLUB   <span class="dv">21210</span>  Roland Park</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="dv">202</span>                            CARLYLE CLUB   <span class="dv">21210</span>  Roland Park</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="dv">253</span>       CHOW  MEIN CHARLIES  chinese food   <span class="dv">21210</span>  Roland Park</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="dv">346</span>         DIMIS CAF\u0090 AND GRILL, INC.   <span class="dv">21210</span>  Roland Park</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="dv">373</span>                           DUNKIN DONUTS   <span class="dv">21212</span>     Homeland</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="dv">582</span>                MISS SHIRLEY<span class="st">&#39;S CAF\u0090   21210  Roland Park</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">711                            KAY-CEE CLUB   21212     Homeland</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">827  MARYLAND CASUALTY  COMPANY (CAF\u0090)   21211  Roland Park</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">954                      PETIT LOUIS BISTRO   21210  Roland Park</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">1189                          THE EVERGREEN   21210  Roland Park</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st">1298   WENDY&#39;</span>S OLD FASHIONED HAMBURGERS <span class="co">#96   21212     Homeland</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="dv">1320</span>                       YORK CLUB TAVERN   <span class="dv">21212</span>     Homeland</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>     councilDistrict policeDistrict                         Location<span class="fl">.1</span> nearMe</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="dv">37</span>                 <span class="dv">6</span>       NORTHERN  <span class="dv">1190</span> NORTHERN PKWY\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="dv">108</span>                <span class="dv">6</span>       NORTHERN        <span class="dv">4712</span> CLUB RD\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="dv">202</span>               <span class="dv">14</span>       NORTHERN <span class="dv">500</span> UNIVERSITY PKWY\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="dv">253</span>                <span class="dv">6</span>       NORTHERN  <span class="dv">508</span> COLD SPRING LN\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="dv">346</span>                <span class="dv">6</span>       NORTHERN   <span class="dv">500</span> COLDSPRING LN\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="dv">373</span>                <span class="dv">4</span>       NORTHERN        <span class="dv">5422</span> YORK RD\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="dv">582</span>                <span class="dv">6</span>       NORTHERN   <span class="dv">513</span> COLDSPRING LN\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="dv">711</span>                <span class="dv">4</span>       NORTHERN    <span class="dv">201</span> HOMELAND AVE\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="dv">827</span>               <span class="dv">14</span>       NORTHERN     <span class="dv">3910</span> KESWICK RD\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="dv">954</span>                <span class="dv">6</span>       NORTHERN     <span class="dv">4800</span> ROLAND AVE\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="dv">1189</span>               <span class="dv">6</span>       NORTHERN   <span class="dv">501</span> COLDSPRING LN\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="dv">1298</span>               <span class="dv">4</span>       NORTHERN        <span class="dv">5615</span> YORK RD\nBaltimore, MD   <span class="cn">TRUE</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="dv">1320</span>               <span class="dv">4</span>       NORTHERN        <span class="dv">5407</span> YORK RD\nBaltimore, MD   <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div
id="creating-binary-variables-ifelse-command.-handy-for-filtering-or-subsetting-based-on-specific-values-such-as-wrong-values-values-of-interest-etc."
class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Creating binary
variables: <code>ifelse()</code> command. Handy for filtering or
subsetting based on specific values (such as “wrong” values, values of
interest, etc).</h2>
<p>We might want to create a <strong>binary variable</strong> that
contains the <em>result of checking a certain condition</em> <em>upon a
variable</em>.</p>
<ul>
<li>For example, we might want to <strong>find the cases where we know
the zip code is wrong</strong>.</li>
</ul>
<p>To do this we can use <strong>the <code>ifelse()</code>
command</strong>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ifelse)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (test, yes, no)  </span></code></pre></div>
<ul>
<li><p>It first argument is the <em>condition</em>. In our example,
whether the zip code is less than zero or not.</p></li>
<li><p>It <strong>returns</strong> a <strong>vector</strong> with the
<strong>values specified in the <code>yes</code> and
<code>no</code></strong> parameters.</p>
<ul>
<li><p>For instance, those values can be <code>TRUE</code> and
<code>FALSE</code> (the retured vector will be a <code>logical</code>
vector); <code>1</code> and <code>0</code> (<code>numeric</code>
vector); <code>"yes"</code> and <code>"no"</code>, or
<code>"TRUE"</code> and <code>"FALSE"</code> (<code>character</code>
vector); etc.</p></li>
<li><p>Missing values in the test, give missing values in the
result.</p></li>
<li><p>In our example, if the zip code is less than zero, we’ll think
that it must be wrong so, the first thing that this command will return
is <code>TRUE</code> if the condition holds true. In other words, all
the cases where the zip code is less than zero, we’ll get a
<code>TRUE</code>.</p></li>
<li><p>If the zip code is positive, then we’ll get a
<code>FALSE</code>.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>zipWrong <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(restData<span class="sc">$</span>zipCode <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">TRUE</span>,  <span class="cn">FALSE</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData<span class="sc">$</span>zipWrong)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a> logi [<span class="dv">1</span><span class="sc">:</span><span class="dv">1327</span>] <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipWrong)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span>  <span class="cn">TRUE</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">1326</span>     <span class="dv">1</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipWrong, restData<span class="sc">$</span>zipCode <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="cn">FALSE</span> <span class="cn">TRUE</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="cn">FALSE</span>  <span class="dv">1326</span>    <span class="dv">0</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span>      <span class="dv">0</span>    <span class="dv">1</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>restData[restData<span class="sc">$</span>zipWrong, ]</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                                            name zipCode</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1157</span> TASTE INTERNATIONAL RESTAURANT <span class="sc">&amp;</span> LOUNGE<span class="sc">/</span>BAR  <span class="sc">-</span><span class="dv">21226</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                   neighborhood councilDistrict policeDistrict</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1157</span> Curtis Bay Industrial Area              <span class="dv">10</span>       SOUTHERN</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                            Location<span class="fl">.1</span> nearMe zipWrong</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="dv">1157</span> <span class="dv">4314</span> CURTIS AVENUE\nBaltimore, MD  <span class="cn">FALSE</span>     <span class="cn">TRUE</span></span></code></pre></div>
<ul>
<li><p>The second table shows which zip code is both wrong and less than
zero. Another way of showing that in all the cases where the zip code
are greater than zero, we get <code>FALSE</code> and in the <strong>one
case</strong> where the zip code is less than zero, we get
<code>TRUE</code>.</p></li>
<li><p>So <strong>that might be a value that we want to filter out of
the data set</strong>.</p></li>
<li><p>And this technique makes an <strong>easy way to filter</strong>
those kind of values out.</p></li>
</ul>
</div>
<div
id="nesting-the-ifelse-command-to-create-three-levels-from-a-certian-variable."
class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Nesting the
<code>ifelse()</code> command to create three levels from a certian
variable.</h2>
<p>We can also go <em>beyond a binary scenario</em> and make a variable
with more than two levels.</p>
<p>Infact, if we <strong>nest <code>ifelse()</code> within
itself</strong> we can create 3 levels from a certain variable.</p>
<p>So, going back to our <code>restData</code> data frame, let’s create
a variable with these three levels:</p>
<ul>
<li><code>"low"</code>: restaurants with zip codes smaller than or equal
to 25th percentile.<br />
</li>
<li><code>"med"</code>: restaurants with zip codes greater than 25th and
smaller thant or equal to 75th percentile.<br />
</li>
<li><code>"high"</code>: restaurants with zip codes grater than 75th
percentile.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>rest_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(restData<span class="sc">$</span>zipCode)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>rest_quantiles                                     <span class="co"># a numeric named vector.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="sc">%      25%</span>      <span class="dv">50</span><span class="sc">%      75%</span>     <span class="dv">100</span>% </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">21226.0</span>  <span class="fl">21202.0</span>  <span class="fl">21218.0</span>  <span class="fl">21225.5</span>  <span class="fl">21287.0</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>threeZipLevels <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(restData<span class="sc">$</span>zipCode <span class="sc">&lt;=</span> rest_quantiles[<span class="st">&quot;25%&quot;</span>],</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;low&quot;</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(restData<span class="sc">$</span>zipCode <span class="sc">&gt;</span> rest_quantiles[<span class="st">&quot;75%&quot;</span>], <span class="st">&quot;high&quot;</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;med&quot;</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>threeZipLevels)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>high  low  med </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">332</span>  <span class="dv">338</span>  <span class="dv">657</span> </span></code></pre></div>
<p>But, when we are interested in creating variables with more than two
levels, <strong>it’s much easier</strong> to use <strong>the
<code>cut()</code> command</strong>.</p>
<p>That’s what we see now.</p>
</div>
<div
id="creating-a-categorical-variable-for-cutting-up-quantitative-variables-cut-command."
class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Creating a
categorical variable for “cutting up” quantitative variables:
<code>cut()</code> command.</h2>
<p>So, we also might want to make <strong>categorical variables out of
quantitative variables</strong>.</p>
<ul>
<li>For example, we might want to <strong>break the zip codes up into
consecutive numbers</strong>.</li>
</ul>
<p>There’s a specific function, <strong>the <code>cut()</code>
command</strong>, to <strong>convert <code>numeric</code> into
<code>factor</code></strong>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cut)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, ...)  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cut.default)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, breaks, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">include.lowest =</span> <span class="cn">FALSE</span>, <span class="at">right =</span> <span class="cn">TRUE</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dig.lab =</span> 3L, <span class="at">ordered_result =</span> <span class="cn">FALSE</span>, ...)  </span></code></pre></div>
<ul>
<li><p>It takes as input a <code>numeric</code> vector <code>x</code>
and converts it to a <code>factor</code> <em>by cutting</em>: it
<strong>divides</strong> the range of <code>x</code> into intervals and
<strong>codes</strong> the values in <code>x</code> according to which
interval they fall.</p></li>
<li><p>The <em>leftmost interval</em> corresponds to <em>level one</em>,
the next leftmost to level two and so on.</p></li>
<li><p><code>breaks</code> parameter gives the <strong>number of
intervals</strong> into which <code>x</code> is to be cut, and it can be
either:</p>
<ul>
<li><p>A <strong>numeric vector</strong> of two or more unique cut
points.</p></li>
<li><p>Or a <strong>single number</strong> <em>greater than or equal to
2</em>.</p></li>
</ul></li>
<li><p>With the <code>labels</code> parameter, we can specify the labels
for the levels of the resulting category.</p>
<ul>
<li><p>By <strong>default</strong>, <code>labels</code> are constructed
using <strong>“(a,b]” interval notation</strong>.</p></li>
<li><p>If <code>labels = FALSE</code>, simple <strong>integer codes are
returned</strong> <strong><em>instead of a
factor</em></strong>.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cx)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">&quot;(0,10]&quot;</span>,<span class="st">&quot;(10,25]&quot;</span>,..<span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cx)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>cx</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">0</span>,<span class="dv">10</span>]  (<span class="dv">10</span>,<span class="dv">25</span>]  (<span class="dv">25</span>,<span class="dv">50</span>] (<span class="dv">50</span>,<span class="dv">100</span>] </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>      <span class="dv">10</span>       <span class="dv">15</span>       <span class="dv">25</span>       <span class="dv">50</span> </span></code></pre></div>
<p>Let’s verify that, when we <strong>leave off the labels</strong>, we
don’t get a factor anymore.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cx)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cx)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>cx</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">15</span> <span class="dv">25</span> <span class="dv">50</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If we don&#39;t specify the &quot;endpoints&quot; (zero an 100 in our example), some categories</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># will not be created.</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cx)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>] <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> ...</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cx)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>cx</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">2</span> </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">25</span> </span></code></pre></div>
<p>Going back to our <code>restData</code>example, we’ll apply the
<code>cut()</code> command to <strong><code>zipCode</code> quantitative
variable</strong>, telling it that we want to <strong><code>break</code>
that variable up</strong> according to a list of values, in this case,
break it up <strong>according to the quantiles</strong> to that zip
code.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>zipGroups <span class="ot">&lt;-</span> <span class="fu">cut</span>(restData<span class="sc">$</span>zipCode, <span class="at">breaks =</span> <span class="fu">quantile</span>(restData<span class="sc">$</span>zipCode))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData<span class="sc">$</span>zipGroups)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">&quot;(-2.123e+04,2.12e+04]&quot;</span>,..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> ...</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipGroups, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="fl">2.123e+04</span>,<span class="fl">2.12e+04</span>]  (<span class="fl">2.12e+04</span>,<span class="fl">2.122e+04</span>] (<span class="fl">2.122e+04</span>,<span class="fl">2.123e+04</span>] </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">337</span>                   <span class="dv">375</span>                   <span class="dv">282</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>(<span class="fl">2.123e+04</span>,<span class="fl">2.129e+04</span>]                  <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">332</span>                     <span class="dv">1</span> </span></code></pre></div>
<ul>
<li><p>So <code>zipGroups</code> is a <strong>factor variable</strong>
result of breaking the variable <code>zipCode</code> up into the
quantums from the zero to the 25th percentile; from the 25th to the
50th; from the 50th the 75th; and the 75th to the 100th
percentile.</p></li>
<li><p>And so for example, there are about 375 of the values that land
between the 25th percentile and the 50th percentile.</p></li>
</ul>
<p>We could then <strong>make a table</strong> that shows us
<strong>which of the zip codes fall into which of these
different</strong> <strong>clusters</strong>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipGroups, restData<span class="sc">$</span>zipCode)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="dv">21226</span> <span class="dv">21201</span> <span class="dv">21202</span> <span class="dv">21205</span> <span class="dv">21206</span> <span class="dv">21207</span> <span class="dv">21208</span> <span class="dv">21209</span> <span class="dv">21210</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="fl">2.123e+04</span>,<span class="fl">2.12e+04</span>]      <span class="dv">0</span>   <span class="dv">136</span>   <span class="dv">201</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.12e+04</span>,<span class="fl">2.122e+04</span>]       <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">27</span>    <span class="dv">30</span>     <span class="dv">4</span>     <span class="dv">1</span>     <span class="dv">8</span>    <span class="dv">23</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.122e+04</span>,<span class="fl">2.123e+04</span>]      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.123e+04</span>,<span class="fl">2.129e+04</span>]      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">21211</span> <span class="dv">21212</span> <span class="dv">21213</span> <span class="dv">21214</span> <span class="dv">21215</span> <span class="dv">21216</span> <span class="dv">21217</span> <span class="dv">21218</span> <span class="dv">21220</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="fl">2.123e+04</span>,<span class="fl">2.12e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.12e+04</span>,<span class="fl">2.122e+04</span>]     <span class="dv">41</span>    <span class="dv">28</span>    <span class="dv">31</span>    <span class="dv">17</span>    <span class="dv">54</span>    <span class="dv">10</span>    <span class="dv">32</span>    <span class="dv">69</span>     <span class="dv">0</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.122e+04</span>,<span class="fl">2.123e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.123e+04</span>,<span class="fl">2.129e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">21222</span> <span class="dv">21223</span> <span class="dv">21224</span> <span class="dv">21225</span> <span class="dv">21226</span> <span class="dv">21227</span> <span class="dv">21229</span> <span class="dv">21230</span> <span class="dv">21231</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="fl">2.123e+04</span>,<span class="fl">2.12e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.12e+04</span>,<span class="fl">2.122e+04</span>]      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.122e+04</span>,<span class="fl">2.123e+04</span>]     <span class="dv">7</span>    <span class="dv">56</span>   <span class="dv">199</span>    <span class="dv">19</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.123e+04</span>,<span class="fl">2.129e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>    <span class="dv">18</span>     <span class="dv">4</span>    <span class="dv">13</span>   <span class="dv">156</span>   <span class="dv">127</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">21234</span> <span class="dv">21237</span> <span class="dv">21239</span> <span class="dv">21251</span> <span class="dv">21287</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="fl">2.123e+04</span>,<span class="fl">2.12e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.12e+04</span>,<span class="fl">2.122e+04</span>]      <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.122e+04</span>,<span class="fl">2.123e+04</span>]     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">2.123e+04</span>,<span class="fl">2.129e+04</span>]     <span class="dv">7</span>     <span class="dv">1</span>     <span class="dv">3</span>     <span class="dv">2</span>     <span class="dv">1</span></span></code></pre></div>
<ul>
<li>We can see that the low zip code values fall into the first cluster
and then the medium values fall into the next cluster, and so
forth.</li>
</ul>
</div>
<div id="easier-cutting-cut2-function-of-the-hmisc-package."
class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Easier cutting:
<code>cut2()</code> function of the <code>Hmisc</code> package.</h2>
<p>In the <a
href="https://cran.r-project.org/web/packages/Hmisc/index.html"><code>Hmisc</code>
(Harrell Miscellaneous) CRAN package</a>, we can find <strong>the
<code>cut2()</code> function</strong>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cut2)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, cuts, <span class="at">m =</span> <span class="dv">150</span>, g, <span class="at">levels.mean =</span> <span class="cn">FALSE</span>, digits, <span class="at">minmax =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">oneval =</span> <span class="cn">TRUE</span>, <span class="at">onlycuts =</span> <span class="cn">FALSE</span>, <span class="at">formatfun =</span> format, ...)  </span></code></pre></div>
<ul>
<li><p>We can specify through the <code>g</code> parameter, the number
of different groups in which we want to divide our variable.</p>
<ul>
<li><p>So if we tell to break <code>zipCode</code> up into 4 different
groups, it will <strong>actually find out the</strong> <strong>quantiles
for us</strong> and break the variable up into four groups according to
the quantiles.</p></li>
<li><p>This is a nice way to “cut” if we don’t want to have to set the
breaks in advance.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>zipGroups <span class="ot">&lt;-</span> <span class="fu">cut2</span>(restData<span class="sc">$</span>zipCode, <span class="at">g =</span> <span class="dv">4</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData<span class="sc">$</span>zipGroups, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>[<span class="sc">-</span><span class="dv">21226</span>,<span class="dv">21205</span><span class="er">)</span> [ <span class="dv">21205</span>,<span class="dv">21220</span><span class="er">)</span> [ <span class="dv">21220</span>,<span class="dv">21227</span><span class="er">)</span> [ <span class="dv">21227</span>,<span class="dv">21287</span>]           <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>           <span class="dv">338</span>            <span class="dv">375</span>            <span class="dv">300</span>            <span class="dv">314</span>              <span class="dv">0</span> </span></code></pre></div>
<p><strong>Notice</strong> that we do not get the same result as if
we’ve used <code>cut()</code> function giving the same value to it’s
<code>breaks</code> parameter.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>zip_groups <span class="ot">&lt;-</span> <span class="fu">cut</span>(restData<span class="sc">$</span>zipCode, <span class="at">breaks =</span> <span class="dv">4</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(zip_groups, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>zip_groups</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="fl">2.13e+04</span>,<span class="sc">-</span><span class="fl">1.06e+04</span>]      (<span class="sc">-</span><span class="fl">1.06e+04</span>,<span class="fl">30.5</span>]       (<span class="fl">30.5</span>,<span class="fl">1.07e+04</span>] </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span>                     <span class="dv">0</span>                     <span class="dv">0</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">1.07e+04</span>,<span class="fl">2.13e+04</span>]                  <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">1326</span>                     <span class="dv">0</span> </span></code></pre></div>
</div>
<div
id="transforming-numerical-variables-into-categorical-factor-variables-factor-command.-re-leveling-with-relevel-and-levels-and-going-back-with-as.numeric."
class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Transforming
numerical variables into categorical (factor) variables:
<code>factor()</code> command. Re-leveling with <code>relevel()</code>
and <code>levels()</code>, and going back with
<code>as.numeric()</code>.</h2>
<p>It could happen, like it indeed do happen with <code>zipCode</code>,
that the values of an integer or numerical variable do not follow a
clear pattern in their quantitative changes, so we are not sure, for
instance, if incrementing by one changes quantitatively the
variable.</p>
<p>So, to <strong>certaintly indentify the different values</strong> of
the variable, we could <strong>turn the numeric</strong>
<strong>variable</strong> into a <strong>factor variable</strong>.</p>
<p>As we know, we can create factors with <strong>the
<code>factor()</code> command</strong>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(factor)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">x =</span> <span class="fu">character</span>(), levels, <span class="at">labels =</span> levels, <span class="at">exclude =</span> <span class="cn">NA</span>, <span class="at">ordered =</span> <span class="fu">is.ordered</span>(x), </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">nmax =</span> <span class="cn">NA</span>)  </span></code></pre></div>
<ul>
<li>Remember that, by defalut, it <em>orders levels alphabetically</em>
and that we can <strong>change that order</strong> through the
<strong><code>levels</code> parameter</strong>.</li>
</ul>
<p>Let’s create a <code>factor</code>, then, from the
<code>integer</code> variable <code>zipCode</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>zcf <span class="ot">&lt;-</span> <span class="fu">factor</span>(restData<span class="sc">$</span>zipCode)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">1327</span> obs. of  <span class="dv">11</span> variables<span class="sc">:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> name           <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1277</span> levels <span class="st">&quot;#1 CHINESE KITCHEN&quot;</span>,..<span class="sc">:</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">992</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> ...</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipCode        <span class="sc">:</span> int  <span class="dv">21206</span> <span class="dv">21231</span> <span class="dv">21224</span> <span class="dv">21211</span> <span class="dv">21223</span> <span class="dv">21218</span> <span class="dv">21205</span> <span class="dv">21211</span> <span class="dv">21205</span> <span class="dv">21231</span> ...</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> neighborhood   <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">173</span> levels <span class="st">&quot;Abell&quot;</span>,<span class="st">&quot;Arlington&quot;</span>,..<span class="sc">:</span> <span class="dv">53</span> <span class="dv">52</span> <span class="dv">18</span> <span class="dv">66</span> <span class="dv">104</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">133</span> <span class="dv">98</span> <span class="dv">157</span> ...</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> councilDistrict<span class="sc">:</span> int  <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">14</span> <span class="dv">9</span> <span class="dv">14</span> <span class="dv">13</span> <span class="dv">7</span> <span class="dv">13</span> <span class="dv">1</span> ...</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> policeDistrict <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">9</span> levels <span class="st">&quot;CENTRAL&quot;</span>,<span class="st">&quot;EASTERN&quot;</span>,..<span class="sc">:</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">6</span> ...</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Location<span class="fl">.1</span>     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1210</span> levels <span class="st">&quot;1 BIDDLE ST</span><span class="sc">\n</span><span class="st">Baltimore, MD&quot;</span>,..<span class="sc">:</span> <span class="dv">835</span> <span class="dv">334</span> <span class="dv">554</span> <span class="dv">755</span> <span class="dv">492</span> <span class="dv">537</span> <span class="dv">505</span> <span class="dv">530</span> <span class="dv">507</span> <span class="dv">569</span> ...</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> nearMe         <span class="sc">:</span> logi  <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipWrong       <span class="sc">:</span> logi  <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> threeZipLevels <span class="sc">:</span> chr  <span class="st">&quot;med&quot;</span> <span class="st">&quot;high&quot;</span> <span class="st">&quot;med&quot;</span> <span class="st">&quot;med&quot;</span> ...</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipGroups      <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">&quot;[-21226,21205)&quot;</span>,..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> ...</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zcf            <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">32</span> levels <span class="st">&quot;-21226&quot;</span>,<span class="st">&quot;21201&quot;</span>,..<span class="sc">:</span> <span class="dv">5</span> <span class="dv">27</span> <span class="dv">21</span> <span class="dv">10</span> <span class="dv">20</span> <span class="dv">17</span> <span class="dv">4</span> <span class="dv">10</span> <span class="dv">4</span> <span class="dv">27</span> ...</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData<span class="sc">$</span>zcf)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a> Factor w<span class="sc">/</span> <span class="dv">32</span> levels <span class="st">&quot;-21226&quot;</span>,<span class="st">&quot;21201&quot;</span>,..<span class="sc">:</span> <span class="dv">5</span> <span class="dv">27</span> <span class="dv">21</span> <span class="dv">10</span> <span class="dv">20</span> <span class="dv">17</span> <span class="dv">4</span> <span class="dv">10</span> <span class="dv">4</span> <span class="dv">27</span> ...</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>restData<span class="sc">$</span>zcf[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">21206</span> <span class="dv">21231</span> <span class="dv">21224</span> <span class="dv">21211</span> <span class="dv">21223</span> <span class="dv">21218</span> <span class="dv">21205</span> <span class="dv">21211</span> <span class="dv">21205</span> <span class="dv">21231</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="dv">32</span> Levels<span class="sc">:</span> <span class="sc">-</span><span class="dv">21226</span> <span class="dv">21201</span> <span class="dv">21202</span> <span class="dv">21205</span> <span class="dv">21206</span> <span class="dv">21207</span> <span class="dv">21208</span> <span class="dv">21209</span> <span class="dv">21210</span> ... <span class="dv">21287</span></span></code></pre></div>
<ul>
<li>So we know now <strong>how many different zip code levels there
are</strong>. There are 32 different zip code levels.</li>
</ul>
<p>Now let’s create a <em>dummy character vector</em> and give it to
<code>factor()</code>, so we can remember the following properties:</p>
<ul>
<li><p><strong>How to change the levels’ order</strong> by putting the
<strong>value that we want</strong> as the <strong>lowest
level</strong>. Recall that this can be <em>important in linear
modelling</em>, because the first level is used as the baseline
level.</p></li>
<li><p>The <strong>underlying representation</strong> of a factor is an
<strong>integer vector with labels</strong>, where each of the character
values of the factor is coded with an integer.</p></li>
<li><p>The <code>order</code> parameter is a logical flag to determine
if the <strong>levels should be regarded as ordered</strong> (in <em>the
order given</em>).</p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;yes&quot;</span> <span class="st">&quot;yes&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>xf</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] no  no  yes yes no  no  no  no  no  no </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> yes no</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(xf)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;factor&quot;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(xf)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(,<span class="st">&quot;levels&quot;</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;yes&quot;</span> <span class="st">&quot;no&quot;</span> </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>xfo <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>xfo</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] no  no  yes yes no  no  no  no  no  no </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> yes <span class="sc">&lt;</span> no</span></code></pre></div>
<ul>
<li>The <em>lowest level</em> isn’t the word <code>no</code> that comes
first alphabetically, as it would’ve been by default.</li>
</ul>
<p>We <strong>can also change the level’s order</strong> with another
two functions: <strong>the <code>relevel()</code> or the
<code>levels()</code></strong> commands.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(relevel)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, ref, ...)  </span></code></pre></div>
<ul>
<li><p>The levels of a factor are re-ordered so that the level specified
by <code>ref</code> is first and the others are moved down.</p></li>
<li><p>This is useful for contr.treatment contrasts which take the first
level as the reference.</p></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">relevel</span>(xf, <span class="at">ref =</span> <span class="st">&quot;no&quot;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] no  no  yes yes no  no  no  no  no  no </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> no yes</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(xf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>xf</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] no  no  yes yes no  no  no  no  no  no </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>Levels<span class="sc">:</span> yes no</span></code></pre></div>
<p>Finally, we can use <strong>the <code>as.numeric()</code>
command</strong> to convert very easily the factor variable back into a
numeric variable.</p>
<ul>
<li>This can be <em>useful in certain kinds of models</em>.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(xf)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span></span></code></pre></div>
<p>Also, to a character variable with the
<strong><code>as.character()</code> command</strong>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(xf)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span>  <span class="st">&quot;yes&quot;</span> <span class="st">&quot;yes&quot;</span> <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span>  <span class="st">&quot;no&quot;</span> </span></code></pre></div>
</div>
<div
id="creating-a-new-data-frame-by-mutating-the-old-one-mutate-function-from-plyr-package."
class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Creating a new data
frame by mutating the old one: <code>mutate()</code> function, from
<code>plyr package</code>.</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mutate)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (.data, ...)  </span></code></pre></div>
<ul>
<li><p>This function takes a <code>data.frame</code> as it’s first
argument and <strong>transforms it accordingly</strong> to the
<strong>definitions of new columns</strong> given as named
parameters.</p></li>
<li><p>It’s very similar to <code>transform()</code> but it executes the
transformations iteratively so that later transformations can use the
columns created by earlier transformations. <code>mutate()</code> seems
to be considerably faster than <code>transform()</code> for large data
frames.</p></li>
</ul>
<p>Let’s create new data frame applying <code>mutate()</code> to
<code>restData</code> data frame and <strong>adding a new
variable</strong> <code>zipGroups</code>, which is equal to a function
of one of the variables in the original data frame.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>restData2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(restData, <span class="at">zipGroups =</span> <span class="fu">cut2</span>(zipCode, <span class="at">g =</span> <span class="dv">4</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(restData2)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">1327</span> obs. of  <span class="dv">11</span> variables<span class="sc">:</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> name           <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1277</span> levels <span class="st">&quot;#1 CHINESE KITCHEN&quot;</span>,..<span class="sc">:</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">992</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> ...</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipCode        <span class="sc">:</span> int  <span class="dv">21206</span> <span class="dv">21231</span> <span class="dv">21224</span> <span class="dv">21211</span> <span class="dv">21223</span> <span class="dv">21218</span> <span class="dv">21205</span> <span class="dv">21211</span> <span class="dv">21205</span> <span class="dv">21231</span> ...</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> neighborhood   <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">173</span> levels <span class="st">&quot;Abell&quot;</span>,<span class="st">&quot;Arlington&quot;</span>,..<span class="sc">:</span> <span class="dv">53</span> <span class="dv">52</span> <span class="dv">18</span> <span class="dv">66</span> <span class="dv">104</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">133</span> <span class="dv">98</span> <span class="dv">157</span> ...</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> councilDistrict<span class="sc">:</span> int  <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">14</span> <span class="dv">9</span> <span class="dv">14</span> <span class="dv">13</span> <span class="dv">7</span> <span class="dv">13</span> <span class="dv">1</span> ...</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> policeDistrict <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">9</span> levels <span class="st">&quot;CENTRAL&quot;</span>,<span class="st">&quot;EASTERN&quot;</span>,..<span class="sc">:</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">6</span> ...</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Location<span class="fl">.1</span>     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1210</span> levels <span class="st">&quot;1 BIDDLE ST</span><span class="sc">\n</span><span class="st">Baltimore, MD&quot;</span>,..<span class="sc">:</span> <span class="dv">835</span> <span class="dv">334</span> <span class="dv">554</span> <span class="dv">755</span> <span class="dv">492</span> <span class="dv">537</span> <span class="dv">505</span> <span class="dv">530</span> <span class="dv">507</span> <span class="dv">569</span> ...</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> nearMe         <span class="sc">:</span> logi  <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipWrong       <span class="sc">:</span> logi  <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span> ...</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> threeZipLevels <span class="sc">:</span> chr  <span class="st">&quot;med&quot;</span> <span class="st">&quot;high&quot;</span> <span class="st">&quot;med&quot;</span> <span class="st">&quot;med&quot;</span> ...</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zipGroups      <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">&quot;[-21226,21205)&quot;</span>,..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> ...</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zcf            <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">32</span> levels <span class="st">&quot;-21226&quot;</span>,<span class="st">&quot;21201&quot;</span>,..<span class="sc">:</span> <span class="dv">5</span> <span class="dv">27</span> <span class="dv">21</span> <span class="dv">10</span> <span class="dv">20</span> <span class="dv">17</span> <span class="dv">4</span> <span class="dv">10</span> <span class="dv">4</span> <span class="dv">27</span> ...</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(restData2<span class="sc">$</span>zipGroups)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>[<span class="sc">-</span><span class="dv">21226</span>,<span class="dv">21205</span><span class="er">)</span> [ <span class="dv">21205</span>,<span class="dv">21220</span><span class="er">)</span> [ <span class="dv">21220</span>,<span class="dv">21227</span><span class="er">)</span> [ <span class="dv">21227</span>,<span class="dv">21287</span>] </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>           <span class="dv">338</span>            <span class="dv">375</span>            <span class="dv">300</span>            <span class="dv">314</span> </span></code></pre></div>
</div>
<div id="common-transformations-to-quantitative-data."
class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Common
transformations to quantitative data.</h2>
<p>Here is a list of the most common transformations:</p>
<ul>
<li><code>abs(x)</code>.<br />
</li>
<li><code>sqrt(x)</code>.<br />
</li>
<li><code>ceiling(x)</code>.<br />
</li>
<li><code>floor(x)</code>.<br />
</li>
<li><code>round(x, digits=n)</code>, for example:
<code>round(3.475, digits=2)</code> is <code>3.48</code>.<br />
</li>
<li><code>signif(x, digits=n)</code>, for example:
<code>signif(3.475, digits=2)</code> is <code>3.5</code>.<br />
</li>
<li><code>cos(x)</code>, <code>sin(x)</code>, etc.<br />
</li>
<li><code>log(x)</code>, natural logarithm.<br />
</li>
<li><code>log2(x)</code>, <code>log10(x)</code>, and other common
logs.<br />
</li>
<li><code>exp(x)</code>.</li>
</ul>
<p>So, for example, <strong>logs are commonly used</strong> when you
have <strong>skewed data</strong>, or data with a <strong>lot of
outliers</strong>.</p>
<p>We can read a lot about this, at these two links:</p>
<ul>
<li><p>This <a
href="http://www.biostat.jhsph.edu/~ajaffe/lec_winterR/Lecture%202.pdf">Andrew
Jaffe’s R notes</a>.</p></li>
<li><p>This <a
href="https://www.statmethods.net/management/functions.html">statmethods
page</a>.</p></li>
</ul>
</div>
<div id="further-resources." class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> Further
resources.</h2>
<ul>
<li><p>A <a href="http://plyr.had.co.nz/09-user/">tutorial from the
developer of <code>plyr</code></a>.</p></li>
<li><p>Again, <a
href="http://www.biostat.jhsph.edu/~ajaffe/lec_winterR/Lecture%202.pdf">Andrew
Jaffe’s R notes</a>.</p></li>
</ul>
<hr />
</div>
</div>
<div id="reshaping-data." class="section level1" number="4">
<h1><span class="header-section-number">4</span> Reshaping data.</h1>
<p>When we do <strong>data reshaping</strong>, we focus on two of the
principles of tidy data:</p>
<ul>
<li><p>Each <strong>variable</strong> must be in a single
<strong>column</strong>.</p></li>
<li><p>Each <strong>observation</strong> must be in a single
<strong>row</strong>.</p></li>
</ul>
<p>Hadley Wickham has created a <strong>comprehensive package</strong>,
called <code>reshape</code>, to “massage” data.</p>
<ul>
<li><p>We can install the package from CRAN.</p></li>
<li><p>There’s a Wickham introduction intoduction to
<code>reshape</code> in:</p>
<ul>
<li>This <a
href="http://had.co.nz/reshape/introduction.pdf">paper</a>.<br />
</li>
<li>And this <a
href="http://had.co.nz/reshape/french-fries-demo.html">video</a>.</li>
</ul></li>
</ul>
<p>Basically, the <strong>idea of reshaping data</strong> is to do
<em>two things</em>:</p>
<ul>
<li><p>First, we <strong>melt</strong> data so that <strong>each
row</strong> is a <strong>unique id-variable
combination</strong>.</p></li>
<li><p>Then, we <strong>cast</strong> the melted data into a <strong>any
shape we would like</strong>.</p></li>
</ul>
<p>Those steps is what we are going to see now in detail.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">&#39;reshape2&#39;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:data.table&#39;</span><span class="sc">:</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    dcast, melt</span></code></pre></div>
<div id="melting-data-frames-melt-function-from-reshape2-package."
class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Melting data frames:
<code>melt()</code> function, from <code>reshape2 package</code>.</h2>
<pre><code>melt(data, id.vars, measure.vars, variable.name = &quot;variable&quot;, ..., na.rm = FALSE,
     value.name = &quot;value&quot;, factorsAsStrings = TRUE
)</code></pre>
<ul>
<li><p>So, to <em>melt</em> a data frame means <em>create a new data
frame</em> from another data frame, so that <strong>each</strong>
<strong>row</strong> of the new data frame is a <strong>unique
id-variable combination</strong> of the older data frame.</p></li>
<li><p>As first argument, we must give the <strong>data frame to
melt</strong>.</p></li>
<li><p>We need then to tell <strong>which</strong> of the variables of
that data frame <strong>are the id variables</strong>.</p>
<ul>
<li>It’s a vector of id variables, identified <em>by position</em>
(integer vector) or <em>by name</em> (character vector).</li>
</ul></li>
<li><p>Also, we have to specify <strong>which</strong> of the variables
of the original data frame <strong>are the measured</strong>
<strong>variables</strong>.</p></li>
<li><p>If we <strong>don’t supply neither</strong> <code>id.vars</code>
and <code>measure.vars</code>, <code>melt()</code> will assume
<strong>factor and character</strong> <strong>variables</strong> as
<strong>id variables</strong> and <strong>all others</strong> will be
<strong>mesured</strong>.</p></li>
<li><p>So in summary, <code>melt()</code> produces a new data frame with
the following columns or variables:</p>
<ul>
<li><p>All the varialbes taken as
<strong>id-variables</strong>.</p></li>
<li><p>Another column, called by default <em><code>variable</code></em>,
that is a <strong>factor variable</strong> with as many
<strong>levels</strong> as the <strong>measure variables</strong>. So
<strong><em>each measur variable ends up beeing a level of this new
factor</em></strong> <strong><em>variable</em></strong>.</p>
<ul>
<li><strong>Notice</strong> that the way that this variable is created,
explains <em>why</em> the new data frame can have much more
<strong>rows</strong> than the original one: the <em>twice</em> of rows
(if there are <em>two</em> measure variables or levels), the
<em>triple</em> (if there are <em>three</em> measure variables or
levels), and so on.</li>
</ul></li>
<li><p>And finally a column, called by default
<em><code>value</code></em>, cointaing the corrisponding measure
values.</p></li>
</ul></li>
</ul>
<p>Let’s take <strong>the <code>mtcars</code> dataset as
example</strong>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">32</span> obs. of  <span class="dv">12</span> variables<span class="sc">:</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> mpg    <span class="sc">:</span> num  <span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> ...</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> cyl    <span class="sc">:</span> num  <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">6</span> ...</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> disp   <span class="sc">:</span> num  <span class="dv">160</span> <span class="dv">160</span> <span class="dv">108</span> <span class="dv">258</span> <span class="dv">360</span> ...</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> hp     <span class="sc">:</span> num  <span class="dv">110</span> <span class="dv">110</span> <span class="dv">93</span> <span class="dv">110</span> <span class="dv">175</span> <span class="dv">105</span> <span class="dv">245</span> <span class="dv">62</span> <span class="dv">95</span> <span class="dv">123</span> ...</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> drat   <span class="sc">:</span> num  <span class="fl">3.9</span> <span class="fl">3.9</span> <span class="fl">3.85</span> <span class="fl">3.08</span> <span class="fl">3.15</span> <span class="fl">2.76</span> <span class="fl">3.21</span> <span class="fl">3.69</span> <span class="fl">3.92</span> <span class="fl">3.92</span> ...</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> wt     <span class="sc">:</span> num  <span class="fl">2.62</span> <span class="fl">2.88</span> <span class="fl">2.32</span> <span class="fl">3.21</span> <span class="fl">3.44</span> ...</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qsec   <span class="sc">:</span> num  <span class="fl">16.5</span> <span class="dv">17</span> <span class="fl">18.6</span> <span class="fl">19.4</span> <span class="dv">17</span> ...</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> vs     <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> am     <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> gear   <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> ...</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> carb   <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> ...</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> carname<span class="sc">:</span> chr  <span class="st">&quot;Mazda RX4&quot;</span> <span class="st">&quot;Mazda RX4 Wag&quot;</span> <span class="st">&quot;Datsun 710&quot;</span> <span class="st">&quot;Hornet 4 Drive&quot;</span> ...</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>Mazda RX4         <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.620</span> <span class="fl">16.46</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>Mazda RX4 Wag     <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.875</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>Datsun <span class="dv">710</span>        <span class="fl">22.8</span>   <span class="dv">4</span>  <span class="dv">108</span>  <span class="dv">93</span> <span class="fl">3.85</span> <span class="fl">2.320</span> <span class="fl">18.61</span>  <span class="dv">1</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">1</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>Hornet <span class="dv">4</span> Drive    <span class="fl">21.4</span>   <span class="dv">6</span>  <span class="dv">258</span> <span class="dv">110</span> <span class="fl">3.08</span> <span class="fl">3.215</span> <span class="fl">19.44</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>Hornet Sportabout <span class="fl">18.7</span>   <span class="dv">8</span>  <span class="dv">360</span> <span class="dv">175</span> <span class="fl">3.15</span> <span class="fl">3.440</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">2</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>Valiant           <span class="fl">18.1</span>   <span class="dv">6</span>  <span class="dv">225</span> <span class="dv">105</span> <span class="fl">2.76</span> <span class="fl">3.460</span> <span class="fl">20.22</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                            carname</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>Mazda RX4                 Mazda RX4</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>Mazda RX4 Wag         Mazda RX4 Wag</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>Datsun <span class="dv">710</span>               Datsun <span class="dv">710</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>Hornet <span class="dv">4</span> Drive       Hornet <span class="dv">4</span> Drive</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>Hornet Sportabout Hornet Sportabout</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>Valiant                     Valiant</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(mtcars)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;Mazda RX4&quot;</span>           <span class="st">&quot;Mazda RX4 Wag&quot;</span>       <span class="st">&quot;Datsun 710&quot;</span>         </span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>] <span class="st">&quot;Hornet 4 Drive&quot;</span>      <span class="st">&quot;Hornet Sportabout&quot;</span>   <span class="st">&quot;Valiant&quot;</span>            </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;Duster 360&quot;</span>          <span class="st">&quot;Merc 240D&quot;</span>           <span class="st">&quot;Merc 230&quot;</span>           </span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;Merc 280&quot;</span>            <span class="st">&quot;Merc 280C&quot;</span>           <span class="st">&quot;Merc 450SE&quot;</span>         </span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">&quot;Merc 450SL&quot;</span>          <span class="st">&quot;Merc 450SLC&quot;</span>         <span class="st">&quot;Cadillac Fleetwood&quot;</span> </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] <span class="st">&quot;Lincoln Continental&quot;</span> <span class="st">&quot;Chrysler Imperial&quot;</span>   <span class="st">&quot;Fiat 128&quot;</span>           </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">&quot;Honda Civic&quot;</span>         <span class="st">&quot;Toyota Corolla&quot;</span>      <span class="st">&quot;Toyota Corona&quot;</span>      </span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">22</span>] <span class="st">&quot;Dodge Challenger&quot;</span>    <span class="st">&quot;AMC Javelin&quot;</span>         <span class="st">&quot;Camaro Z28&quot;</span>         </span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] <span class="st">&quot;Pontiac Firebird&quot;</span>    <span class="st">&quot;Fiat X1-9&quot;</span>           <span class="st">&quot;Porsche 914-2&quot;</span>      </span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">28</span>] <span class="st">&quot;Lotus Europa&quot;</span>        <span class="st">&quot;Ford Pantera L&quot;</span>      <span class="st">&quot;Ferrari Dino&quot;</span>       </span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">31</span>] <span class="st">&quot;Maserati Bora&quot;</span>       <span class="st">&quot;Volvo 142E&quot;</span>         </span></code></pre></div>
<ul>
<li><p>We can see that it has <strong>11 variables</strong> and
<strong>all of them numerical</strong>.</p></li>
<li><p>Also, that there are <strong>32 rows or observations</strong> and
that those <strong>rows are named</strong> with the names of the
different kinds of cars.</p></li>
<li><p>So, one thing we can do before going further, is to <strong>add a
new variable</strong> to this dataset with the <strong>names of the
cars</strong>. It will be a new <strong>factor variable</strong> with
<strong>32 levels</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>carname <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">32</span> obs. of  <span class="dv">12</span> variables<span class="sc">:</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> mpg    <span class="sc">:</span> num  <span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> ...</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> cyl    <span class="sc">:</span> num  <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">6</span> ...</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> disp   <span class="sc">:</span> num  <span class="dv">160</span> <span class="dv">160</span> <span class="dv">108</span> <span class="dv">258</span> <span class="dv">360</span> ...</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> hp     <span class="sc">:</span> num  <span class="dv">110</span> <span class="dv">110</span> <span class="dv">93</span> <span class="dv">110</span> <span class="dv">175</span> <span class="dv">105</span> <span class="dv">245</span> <span class="dv">62</span> <span class="dv">95</span> <span class="dv">123</span> ...</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> drat   <span class="sc">:</span> num  <span class="fl">3.9</span> <span class="fl">3.9</span> <span class="fl">3.85</span> <span class="fl">3.08</span> <span class="fl">3.15</span> <span class="fl">2.76</span> <span class="fl">3.21</span> <span class="fl">3.69</span> <span class="fl">3.92</span> <span class="fl">3.92</span> ...</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> wt     <span class="sc">:</span> num  <span class="fl">2.62</span> <span class="fl">2.88</span> <span class="fl">2.32</span> <span class="fl">3.21</span> <span class="fl">3.44</span> ...</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qsec   <span class="sc">:</span> num  <span class="fl">16.5</span> <span class="dv">17</span> <span class="fl">18.6</span> <span class="fl">19.4</span> <span class="dv">17</span> ...</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> vs     <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> am     <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> gear   <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> ...</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> carb   <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> ...</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> carname<span class="sc">:</span> chr  <span class="st">&quot;Mazda RX4&quot;</span> <span class="st">&quot;Mazda RX4 Wag&quot;</span> <span class="st">&quot;Datsun 710&quot;</span> <span class="st">&quot;Hornet 4 Drive&quot;</span> ...</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>Mazda RX4         <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.620</span> <span class="fl">16.46</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>Mazda RX4 Wag     <span class="fl">21.0</span>   <span class="dv">6</span>  <span class="dv">160</span> <span class="dv">110</span> <span class="fl">3.90</span> <span class="fl">2.875</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">4</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>Datsun <span class="dv">710</span>        <span class="fl">22.8</span>   <span class="dv">4</span>  <span class="dv">108</span>  <span class="dv">93</span> <span class="fl">3.85</span> <span class="fl">2.320</span> <span class="fl">18.61</span>  <span class="dv">1</span>  <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">1</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>Hornet <span class="dv">4</span> Drive    <span class="fl">21.4</span>   <span class="dv">6</span>  <span class="dv">258</span> <span class="dv">110</span> <span class="fl">3.08</span> <span class="fl">3.215</span> <span class="fl">19.44</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>Hornet Sportabout <span class="fl">18.7</span>   <span class="dv">8</span>  <span class="dv">360</span> <span class="dv">175</span> <span class="fl">3.15</span> <span class="fl">3.440</span> <span class="fl">17.02</span>  <span class="dv">0</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">2</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>Valiant           <span class="fl">18.1</span>   <span class="dv">6</span>  <span class="dv">225</span> <span class="dv">105</span> <span class="fl">2.76</span> <span class="fl">3.460</span> <span class="fl">20.22</span>  <span class="dv">1</span>  <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                            carname</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>Mazda RX4                 Mazda RX4</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>Mazda RX4 Wag         Mazda RX4 Wag</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>Datsun <span class="dv">710</span>               Datsun <span class="dv">710</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>Hornet <span class="dv">4</span> Drive       Hornet <span class="dv">4</span> Drive</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>Hornet Sportabout Hornet Sportabout</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>Valiant                     Valiant</span></code></pre></div>
<p>So now let’s <strong>melt this <code>mtcars</code> dataset</strong>
into a <strong>new dataset</strong> where:</p>
<ul>
<li><p>The <strong>id variables</strong> are <code>carname</code>,
<code>gear</code> and <code>cyl</code>.</p></li>
<li><p>And <code>mpg</code> and <code>hp</code> as <strong>measure
variables</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>carMelt <span class="ot">&lt;-</span> <span class="fu">melt</span>(mtcars, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;carname&quot;</span>, <span class="st">&quot;gear&quot;</span>, <span class="st">&quot;cyl&quot;</span>), <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;hp&quot;</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(carMelt)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">64</span> obs. of  <span class="dv">5</span> variables<span class="sc">:</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> carname <span class="sc">:</span> chr  <span class="st">&quot;Mazda RX4&quot;</span> <span class="st">&quot;Mazda RX4 Wag&quot;</span> <span class="st">&quot;Datsun 710&quot;</span> <span class="st">&quot;Hornet 4 Drive&quot;</span> ...</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> gear    <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> ...</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> cyl     <span class="sc">:</span> num  <span class="dv">6</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">6</span> ...</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> variable<span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">&quot;mpg&quot;</span>,<span class="st">&quot;hp&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> value   <span class="sc">:</span> num  <span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> ...</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(carMelt)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>            carname gear cyl variable value</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         Mazda RX4    <span class="dv">4</span>   <span class="dv">6</span>      mpg  <span class="fl">21.0</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     Mazda RX4 Wag    <span class="dv">4</span>   <span class="dv">6</span>      mpg  <span class="fl">21.0</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        Datsun <span class="dv">710</span>    <span class="dv">4</span>   <span class="dv">4</span>      mpg  <span class="fl">22.8</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    Hornet <span class="dv">4</span> Drive    <span class="dv">3</span>   <span class="dv">6</span>      mpg  <span class="fl">21.4</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> Hornet Sportabout    <span class="dv">3</span>   <span class="dv">8</span>      mpg  <span class="fl">18.7</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>           Valiant    <span class="dv">3</span>   <span class="dv">6</span>      mpg  <span class="fl">18.1</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(carMelt)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>          carname gear cyl variable value</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="dv">59</span>  Porsche <span class="dv">914-2</span>    <span class="dv">5</span>   <span class="dv">4</span>       hp    <span class="dv">91</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="dv">60</span>   Lotus Europa    <span class="dv">5</span>   <span class="dv">4</span>       hp   <span class="dv">113</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="dv">61</span> Ford Pantera L    <span class="dv">5</span>   <span class="dv">8</span>       hp   <span class="dv">264</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="dv">62</span>   Ferrari Dino    <span class="dv">5</span>   <span class="dv">6</span>       hp   <span class="dv">175</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="dv">63</span>  Maserati Bora    <span class="dv">5</span>   <span class="dv">8</span>       hp   <span class="dv">335</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="dv">64</span>     Volvo 142E    <span class="dv">4</span>   <span class="dv">4</span>       hp   <span class="dv">109</span></span></code></pre></div>
<ul>
<li><p>So now we have a molten data frame with 64 rows and 5 columns.
The doubling of rows number, is due to the two measured variables of the
original data frame, <code>mpg</code> and <code>hp</code>, that are now
two levels of the <code>variable</code> variable of the new data
frame.</p></li>
<li><p>We end up having a <strong>reshaped</strong> <em>tall, skinny
data set</em>.</p></li>
</ul>
</div>
<div id="casting-data-frames-dcast-function-from-reshape2-package."
class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Casting data frames:
<code>dcast()</code> function, from <code>reshape2 package</code>.</h2>
<p>Once we’ve melted the dataset we can <strong>recast</strong> it in a
bunch of different ways, <strong>reformat</strong> it into different
sort of shapes.</p>
<p>In the <code>reshape2</code> package we can find two functions to do
this, <code>acast()</code> and <code>dcast()</code>, depending on
whether we want <em>vector/matrix/array</em> output or <em>data
frame</em> output.</p>
<p>We are going to see <code>dcast()</code> here.</p>
<pre><code>dcast(data, formula, fun.aggregate = NULL, ..., margins = NULL, subset = NULL, fill = NULL,
      drop = TRUE, value.var = guess_value(data)
)</code></pre>
<ul>
<li><p>This funcion takes as <code>data</code> parameter, a
<strong>molten data frame</strong> and <strong>recasts it into</strong>
a particular shape, into a <strong>particular data
frame</strong>.</p></li>
<li><p>The <code>formula</code> parameter is where we specify the
<strong>casting formula</strong>, that has the following format:</p>
<ul>
<li><p><code>x_variable + x_2 ~ y_variable + y_2 ~ z_variable ~ ...</code></p></li>
<li><p>There’s an alternative <em>list format</em>:</p>
<ul>
<li><code>list(.(x_variable, x_2), .(y_variable, y_2), .(z))</code>. The
advantage of this form is that we can cast based on transformations of
the variables, for example:
<code>list(.(a+b), .(c = round(c)))</code></li>
</ul></li>
<li><p>The <strong>order</strong> of the variables <strong>makes a
difference</strong>: the <strong>first</strong> varies <em>slowest</em>,
and the <strong>last</strong> varies <em>fastest</em>.</p></li>
<li><p>There are a couple of special variables:</p>
<ul>
<li><p><code>...</code> represents <strong>all other variables not used
in the formula</strong>.</p></li>
<li><p><code>.</code> represents <strong>no variable</strong>, so we can
do this formula: <code>var1 ~ .</code></p></li>
</ul></li>
</ul></li>
<li><p>The <code>fun.aggregate</code> parameter specifies the
<strong>aggregation function</strong> for <strong>summarizing the
data</strong>.</p>
<ul>
<li><p>This is needed if variables do not identify a single observation
for each output cell.</p></li>
<li><p>Defaults to <code>length</code> (with a message) if needed but
not specified.</p></li>
</ul></li>
<li><p>And so, what this function basically does, is take the dataset
and <strong>resummarize</strong> it <strong>in different</strong>
<strong>ways</strong>, and <strong>reorganizing</strong> it <strong>in
different ways</strong>.</p></li>
</ul>
<p>Going back to our example, let’s give the <code>carMelt</code>
dataset ot <code>dcast()</code> and specify a <code>formula</code> so
that we can see the cylinders (one of the id variables) <strong>broken
down by</strong> the different levels of the measured variables in
<code>variable</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cylData <span class="ot">&lt;-</span> <span class="fu">dcast</span>(carMelt, cyl <span class="sc">~</span> variable)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Aggregation <span class="cf">function</span> missing<span class="sc">:</span> defaulting to length</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>cylData</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  cyl mpg hp</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">4</span>  <span class="dv">11</span> <span class="dv">11</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">6</span>   <span class="dv">7</span>  <span class="dv">7</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">8</span>  <span class="dv">14</span> <span class="dv">14</span></span></code></pre></div>
<ul>
<li><p>So the <strong>values</strong> of the <strong>left hand side
variable</strong> in the formula are put in the rows and the
<strong>values</strong> of the <strong>righ hand side variable</strong>
are put in different columns (one for each level of the right hand side
variable).</p></li>
<li><p>Because we didn’t specify an aggregate functions, the
<strong>summariezed data</strong> that we see in this data frame is the
<strong>default summary by length or by link</strong>.</p>
<ul>
<li>So for 4 cylinders, we have 11 measures of mpg and 11 measures of
horsepower; for 6 cylinders, we have 7 measures of mpg and 7 measures of
horsepower, and so forth.</li>
</ul></li>
</ul>
<p>Let’s now break down other id variable, the <code>gear</code>
variable.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gearData <span class="ot">&lt;-</span> <span class="fu">dcast</span>(carMelt, gear <span class="sc">~</span> variable)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Aggregation <span class="cf">function</span> missing<span class="sc">:</span> defaulting to length</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>gearData</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  gear mpg hp</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">3</span>  <span class="dv">15</span> <span class="dv">15</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">4</span>  <span class="dv">12</span> <span class="dv">12</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">5</span>   <span class="dv">5</span>  <span class="dv">5</span></span></code></pre></div>
<ul>
<li>The same logic.</li>
</ul>
<p>And both <code>cyl</code> and <code>gear</code>?</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cgData <span class="ot">&lt;-</span> <span class="fu">dcast</span>(carMelt, cyl<span class="sc">+</span>gear <span class="sc">~</span> variable)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Aggregation <span class="cf">function</span> missing<span class="sc">:</span> defaulting to length</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>cgData</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  cyl gear mpg hp</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">4</span>    <span class="dv">3</span>   <span class="dv">1</span>  <span class="dv">1</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">4</span>    <span class="dv">4</span>   <span class="dv">8</span>  <span class="dv">8</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">4</span>    <span class="dv">5</span>   <span class="dv">2</span>  <span class="dv">2</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">6</span>    <span class="dv">3</span>   <span class="dv">2</span>  <span class="dv">2</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">6</span>    <span class="dv">4</span>   <span class="dv">4</span>  <span class="dv">4</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">6</span>    <span class="dv">5</span>   <span class="dv">1</span>  <span class="dv">1</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">8</span>    <span class="dv">3</span>  <span class="dv">12</span> <span class="dv">12</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">8</span>    <span class="dv">5</span>   <span class="dv">2</span>  <span class="dv">2</span></span></code></pre></div>
<p>Let’s now <strong>pass a function</strong> to make a
<strong>different summary of the data</strong>: take the
<code>mean</code> for each value.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cylData <span class="ot">&lt;-</span> <span class="fu">dcast</span>(carMelt, cyl <span class="sc">~</span> variable, mean)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>cylData</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  cyl      mpg        hp</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">4</span> <span class="fl">26.66364</span>  <span class="fl">82.63636</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">6</span> <span class="fl">19.74286</span> <span class="fl">122.28571</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">8</span> <span class="fl">15.10000</span> <span class="fl">209.21429</span></span></code></pre></div>
<ul>
<li>Now we can see, for the 4 cylinder cars, the mean miles per gallon
is 26.66 and the mean horsepower is 82.64. Meanwhile, for an eight
cylinder car, there’s a much lower mean miles per gallon and a much
higher mean horsepower.</li>
</ul>
</div>
</div>
<div id="averaging-data-tapply-split-lapply-unlist-sapply."
class="section level1" number="5">
<h1><span class="header-section-number">5</span> Averaging data:
<code>tapply()</code>, <code>split()</code>, <code>lapply()</code>,
<code>unlist()</code>, <code>sapply()</code>.</h1>
<div id="a-split-apply-combine-s-a-c-type-of-problem."
class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> A Split-Apply-Combine
(S-A-C) type of problem.</h2>
<p>A <strong>very common</strong> thing to do is to <strong>average
values within a particular factor</strong>, that is to say,
<strong>calculate some statistic for lots of different
groups</strong>.</p>
<p>These kind of problems are widely <strong>known as</strong>
<em>split-apply-combine</em> problems, because of the <em>three
steps</em> involved in <em>their solution</em>.</p>
</div>
<div id="putting-the-data-into-the-right-format." class="section level2"
number="5.2">
<h2><span class="header-section-number">5.2</span> Putting the data into
the right format.</h2>
<p>To compute this task, first of all, we need to put the data in the
right format, and the <strong>“canonical form”</strong> in R is a
<strong>data frame with</strong>:</p>
<ul>
<li><p>A <strong>column</strong> containing the <strong>values to
calculate a satistic for</strong>.</p></li>
<li><p>Another <strong>column</strong> containing the <strong>group to
which each value belongs</strong>.</p></li>
</ul>
<p>A good example is the <code>InsectSprays</code> dataset
(effectiveness of insect sprays), built in R.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(InsectSprays)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">72</span> obs. of  <span class="dv">2</span> variables<span class="sc">:</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> count<span class="sc">:</span> num  <span class="dv">10</span> <span class="dv">7</span> <span class="dv">20</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">12</span> <span class="dv">10</span> <span class="dv">23</span> <span class="dv">17</span> <span class="dv">20</span> ...</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> spray<span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">6</span> levels <span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,..<span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(InsectSprays)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  count spray</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">10</span>     A</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">7</span>     A</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">20</span>     A</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="dv">14</span>     A</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="dv">14</span>     A</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>    <span class="dv">12</span>     A</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(InsectSprays)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>   count spray</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="dv">67</span>    <span class="dv">13</span>     F</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="dv">68</span>    <span class="dv">10</span>     F</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="dv">69</span>    <span class="dv">26</span>     F</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="dv">70</span>    <span class="dv">26</span>     F</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span>    <span class="dv">24</span>     F</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="dv">72</span>    <span class="dv">13</span>     F</span></code></pre></div>
<ul>
<li><p>Clearly, the <code>spray</code> column is the <strong>grouping
column</strong>: there are A to F types of sprays.</p></li>
<li><p>Then, there’s the <strong><code>count</code> of insects in
agricultural experimental units</strong> <em>treated</em> with
<strong>different</strong> <strong>insecticides</strong>.</p></li>
</ul>
</div>
<div
id="a-one-function-solution-to-these-s-a-c-problems-tapply-by-or-aggregate-functions."
class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> A one-function
solution to these S-A-C problems: <code>tapply()</code>,
<code>by()</code> or <code>aggregate()</code> functions.</h2>
<p>There are different functions that can do, by them selves, all of
<strong>the three steps</strong> of the <em>split-apply-combine</em>
strategy.</p>
<p>One of those functions is <code>tapply()</code>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tapply)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (X, INDEX, <span class="at">FUN =</span> <span class="cn">NULL</span>, ..., <span class="at">default =</span> <span class="cn">NA</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)  </span></code></pre></div>
<p>As we know from <strong>R Programming - Module 3</strong>:</p>
<ul>
<li><p><code>tapply</code> works with <strong>vectors only</strong>
(<em>aka</em> apply along an <em>index</em>), allowing us to:</p>
<ul>
<li><p><em>split</em> the vector into groups determined by the
<strong>levels</strong> of the <strong>factor</strong> variable that has
to be passed to the <code>INDEX</code> parameter;</p></li>
<li><p><em>apply</em> a function over those subsets or groups;</p></li>
<li><p>and get the <em>combined</em> result of that.</p></li>
</ul></li>
<li><p>By defalut, it will try to <code>simplify</code> the result
(unless the applied function returns more than a single value).</p></li>
<li><p>So <code>tapply()</code> can be thought as a combination of
<code>split()</code> and <code>sapply()</code> <strong>for vectors
only</strong>.</p></li>
<li><p><code>X</code> is a <strong>vector</strong>.</p></li>
<li><p><code>INDEX</code> is a <strong>factor</strong> or a <strong>list
of factors</strong> (or else they are <strong>coerced to
factors</strong>).</p>
<ul>
<li>This argument has to be of <em>the same length</em> of
<code>X</code>.</li>
</ul></li>
<li><p><code>FUN</code> is the function to be applied.</p></li>
</ul>
<p>Once we remembered all that, we can go back to our
<code>InsectSprays</code> dataset and take, for example, the
<code>sum</code> or the <code>mean</code> of the count of insects for
each different type of spray.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(InsectSprays<span class="sc">$</span>count, InsectSprays<span class="sc">$</span>spray, sum)        <span class="co"># spray column is a factor with 6 levels.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  A   B   C   D   E   F </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="dv">174</span> <span class="dv">184</span>  <span class="dv">25</span>  <span class="dv">59</span>  <span class="dv">42</span> <span class="dv">200</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(InsectSprays<span class="sc">$</span>count, InsectSprays<span class="sc">$</span>spray, mean)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        A         B         C         D         E         F </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fl">14.500000</span> <span class="fl">15.333333</span>  <span class="fl">2.083333</span>  <span class="fl">4.916667</span>  <span class="fl">3.500000</span> <span class="fl">16.666667</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sprays_means)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;array&quot;</span></span></code></pre></div>
<p>Another function we could use is <strong>the <code>by()</code>
command</strong>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(by)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, INDICES, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>)  </span></code></pre></div>
<ul>
<li>This function is actually an <strong>object-oriented</strong>
<strong><em>wrapper</em></strong> for <code>tapply</code> applied to
<strong>data frames</strong>.</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">by</span>(InsectSprays<span class="sc">$</span>count, InsectSprays<span class="sc">$</span>spray, mean)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> A</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">14.5</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> B</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">15.33333</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> C</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.083333</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------</span> </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> D</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">4.916667</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------</span> </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> E</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.5</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------</span> </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray<span class="sc">:</span> F</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">16.66667</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sprays_means)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;by&quot;</span></span></code></pre></div>
<p>Finally there’s a third function we could use in this scenario:
<strong>the <code>aggregate()</code> command</strong>.</p>
<pre><code>aggregate(formula, data, FUN, ..., subset, na.action = na.omit)</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(count <span class="sc">~</span> spray, InsectSprays, mean)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  spray     count</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A <span class="fl">14.500000</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     B <span class="fl">15.333333</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     C  <span class="fl">2.083333</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     D  <span class="fl">4.916667</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     E  <span class="fl">3.500000</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     F <span class="fl">16.666667</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sprays_means)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span></code></pre></div>
</div>
<div
id="the-s-a-c-strategy-using-separate-functions-split-lapply-unlist-and-sapply."
class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> The S-A-C strategy
using separate functions: <code>split()</code>, <code>lapply()</code>,
<code>unlist()</code> and <code>sapply()</code>.</h2>
<p>The <strong>Split, Apply, Combine</strong> methodology can be also
implemented in separated steps.</p>
<div id="split-step." class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> <em>Split</em>
step.</h3>
<p>So we can make the first splitting step with the <code>split()</code>
command. Let’s recall it quickly.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(split)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, f, <span class="at">drop =</span> <span class="cn">FALSE</span>, ...)  </span></code></pre></div>
<ul>
<li>This function takes a <em>vector</em>, <em>list</em> or <em>data
frame</em> (<code>x</code> argument) and <strong>splits it into</strong>
<strong><em>groups</em></strong> <strong>determined by</strong> the
<strong><em>levels</em></strong> of a <strong>factor or list of
factors</strong> (<code>f</code> argument).<br />
</li>
<li>Regarding the <code>f</code> argument:
<ul>
<li>if <code>f</code> don’t have the same <em>length</em> of
<code>x</code>, it is recycled as necessary (and if the length of
<code>x</code> is not a multiple of the length of <code>f</code> a
warning is printed).<br />
</li>
<li>if <code>f</code> is not a factor, then it <strong>is coerced to
factor</strong>.<br />
</li>
<li>if <code>f</code> is a list of factors, an
<strong><code>interaction</code> occurs</strong> (a new factor with
concatenated levels is created with the <code>interaction()</code>
function -see below-).<br />
</li>
</ul></li>
<li><code>drop</code> indicates whether <em>empty levels</em> of the
factor should be dropped or not.<br />
</li>
<li>This function always <strong>returns a list</strong>.</li>
</ul>
<p>Going back to our example, we must first <em>split</em> the insects
<code>count</code> column by the groups of <code>spray</code>s
column.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>insects_x_sprays <span class="ot">&lt;-</span> <span class="fu">split</span>(InsectSprays<span class="sc">$</span>count, InsectSprays<span class="sc">$</span>spray)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>insects_x_sprays</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>A</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">10</span>  <span class="dv">7</span> <span class="dv">20</span> <span class="dv">14</span> <span class="dv">14</span> <span class="dv">12</span> <span class="dv">10</span> <span class="dv">23</span> <span class="dv">17</span> <span class="dv">20</span> <span class="dv">14</span> <span class="dv">13</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>B</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">11</span> <span class="dv">17</span> <span class="dv">21</span> <span class="dv">11</span> <span class="dv">16</span> <span class="dv">14</span> <span class="dv">17</span> <span class="dv">17</span> <span class="dv">19</span> <span class="dv">21</span>  <span class="dv">7</span> <span class="dv">13</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>C</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">7</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">4</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>D</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="dv">3</span>  <span class="dv">5</span> <span class="dv">12</span>  <span class="dv">6</span>  <span class="dv">4</span>  <span class="dv">3</span>  <span class="dv">5</span>  <span class="dv">5</span>  <span class="dv">5</span>  <span class="dv">5</span>  <span class="dv">2</span>  <span class="dv">4</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>E</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">5</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">4</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>F</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">11</span>  <span class="dv">9</span> <span class="dv">15</span> <span class="dv">22</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">13</span> <span class="dv">10</span> <span class="dv">26</span> <span class="dv">26</span> <span class="dv">24</span> <span class="dv">13</span></span></code></pre></div>
<ul>
<li>So <code>split</code> returns a <strong>list of the
groups</strong>.</li>
</ul>
</div>
<div
id="apply-step-and-a-combine-step-that-gathers-the-results-into-a-list-lapply."
class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> <em>Apply</em> step
and a <em>combine</em> step that gathers the results into a list:
<code>lapply()</code>.</h3>
<p>We can use <strong>the <code>lapply()</code> function</strong> to
apply a function across that list, to each element (group) of that
list.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lapply)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (X, FUN, ...)  </span></code></pre></div>
<ul>
<li>Just remember here that this function:
<ul>
<li><strong>Takes a list</strong> as input.<br />
</li>
<li>Applys a function to each element of the list.<br />
</li>
<li><strong>Always returns a list</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">lapply</span>(insects_x_sprays, mean)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>A</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">14.5</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>B</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">15.33333</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>C</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.083333</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>D</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">4.916667</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>E</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.5</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>F</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">16.66667</span></span></code></pre></div>
<div id="trying-to-recombine-the-list-as-a-vector-unlist."
class="section level4" number="5.4.2.1">
<h4><span class="header-section-number">5.4.2.1</span> Trying to
<em>recombine</em> the list as a vector: <code>unlist()</code>.</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(sprays_means)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>        A         B         C         D         E         F </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fl">14.500000</span> <span class="fl">15.333333</span>  <span class="fl">2.083333</span>  <span class="fl">4.916667</span>  <span class="fl">3.500000</span> <span class="fl">16.666667</span> </span></code></pre></div>
</div>
</div>
<div
id="apply-step-and-a-combine-step-that-tries-to-simplify-the-result-sapply-and-vapply."
class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> <em>Apply</em> step
and a <em>combine</em> step that tries to simplify the result:
<code>sapply()</code> and <code>vapply()</code>.</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sapply)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (X, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(vapply)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (X, FUN, FUN.VALUE, ..., <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>)  </span></code></pre></div>
<p>As a brief recall, let’s say that:</p>
<ol style="list-style-type: decimal">
<li><code>sapply()</code> is the same as <code>lapply()</code>, both
take a <strong>list as input</strong> and <strong>apply</strong> a
function to each element of the list, but:
<ul>
<li>while <code>lapply()</code> always returns a
<strong>list</strong>,<br />
</li>
<li><code>sapply()</code> instead <strong>attempts to simplify the
result</strong>.</li>
</ul></li>
<li><code>vapply()</code> is a <strong>safer alternative</strong> to
<code>sapply()</code> (which is most helpful when writing our own
functions), because:
<ul>
<li>while <code>sapply()</code> tries to <em>guess the correct
format</em> of the result,<br />
</li>
<li><code>vapply()</code> allows us to <em>specify it explicitly</em>
and if the result <em>doesn’t match</em> the specified format, it will
<em>throw an error</em> causing the operation to stop.</li>
</ul></li>
</ol>
<p>So let’s use these functions in our example.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(insects_x_sprays, mean)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>        A         B         C         D         E         F </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fl">14.500000</span> <span class="fl">15.333333</span>  <span class="fl">2.083333</span>  <span class="fl">4.916667</span>  <span class="fl">3.500000</span> <span class="fl">16.666667</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">vapply</span>(insects_x_sprays, mean, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>        A         B         C         D         E         F </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fl">14.500000</span> <span class="fl">15.333333</span>  <span class="fl">2.083333</span>  <span class="fl">4.916667</span>  <span class="fl">3.500000</span> <span class="fl">16.666667</span> </span></code></pre></div>
</div>
</div>
<div
id="another-one-function-solution-to-these-s-a-c-problems-ddply-function-from-plyr-package."
class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Another one-function
solution to these S-A-C problems: <code>ddply()</code> function, from
<code>plyr package</code>.</h2>
<p>The <code>plyr</code> package provides a nice interface for
implementing the <strong>split-apply-combine</strong> strategy in one
step.</p>
<p>In general, there are <strong>four fundamental verbs of data
manipulation</strong> in <code>plyr</code>’s interface:</p>
<ul>
<li><p><em>Filter:</em> subsetting or removing observations based on
some condition.</p></li>
<li><p><em>Transform</em>: adding or modifying variables.</p></li>
<li><p><em>Sort</em>: changing the order of observations.</p>
<ul>
<li><code>plyr</code> provides the <code>arrange()</code> function for
sorting.</li>
</ul></li>
<li><p><em>Aggregate</em>: collapsing multiple values into a single
value (e.g., by summing or taking means).</p>
<ul>
<li><code>plyr</code> provides the <code>summarise()</code> function for
aggregation.</li>
</ul></li>
</ul>
<p>That said, let’s see how <code>ddply()</code> works.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ddply)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (.data, .variables, <span class="at">.fun =</span> <span class="cn">NULL</span>, ..., <span class="at">.progress =</span> <span class="st">&quot;none&quot;</span>, <span class="at">.inform =</span> <span class="cn">FALSE</span>, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">.drop =</span> <span class="cn">TRUE</span>, <span class="at">.parallel =</span> <span class="cn">FALSE</span>, <span class="at">.paropts =</span> <span class="cn">NULL</span>)  </span></code></pre></div>
<ul>
<li><p>This function takes a <strong>data frame</strong> as it’s
<em>first argument</em>, splits it, applies a funcion to each subset of
that data frame and combines results <strong>into a data
frame</strong>.</p></li>
<li><p>So it takes a data frame and returns another data frame (there’s
the <code>dlplyr()</code> alternative that returns a list, wich is
useful when we want to do another processing step before recombining
into a data frame).</p></li>
<li><p>In the <code>.variables</code> parameter we specify the
<strong>variable or variables to split the input data frame by</strong>,
and we can do it:</p>
<ul>
<li><p>As a <em>character vector</em>.</p></li>
<li><p>As a <em>formula</em>.</p></li>
<li><p>Or as <em><code>as.quoted()</code> variables</em>.</p>
<ul>
<li><p>The <code>as.quoted()</code> method is <strong>called by
default</strong> on <strong>all plyr functions</strong> that
<strong>take a</strong> <strong><code>.variables</code>
argument</strong>.</p></li>
<li><p>It converts <em>characters</em>, <em>formulas</em> and
<em>calls</em> to quoted <code>.variables</code> and
<strong>returns</strong> a <strong>list of quoted
<code>.variables</code></strong>.</p></li>
</ul></li>
</ul></li>
<li><p>The <code>.fun</code> parameter is for specifying the function to
apply to each piece.</p>
<ul>
<li><em>Pay attention:</em> we cannot pass the <code>mean</code>
function here, we have to follow the <code>plyr</code> interface. Taking
the mean is an <em>aggragate</em> data manipulation, so in this case we
have to use the <em><code>summarise()</code> function</em> and give it
the <code>mean()</code> of the variable we want as
<code>argument</code>.</li>
</ul></li>
<li><p>The ellipses <code>...</code> is for passing other arguments to
<code>.fun</code>.</p></li>
</ul>
<p>So, let’s take the <code>InsectSprays</code> data frame and use
<code>ddply()</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">ddply</span>(InsectSprays, .(spray), summarise, <span class="at">mean =</span> <span class="fu">mean</span>(count))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sprays_means</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  spray      mean</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A <span class="fl">14.500000</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     B <span class="fl">15.333333</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     C  <span class="fl">2.083333</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     D  <span class="fl">4.916667</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     E  <span class="fl">3.500000</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     F <span class="fl">16.666667</span></span></code></pre></div>
<ul>
<li><p>Put buntly (dicho sin rodeos), we use the <strong>dot
function</strong>, <code>.()</code>, to specify the grouping or
splitting variable, so that <strong>we don’t have to use</strong>
<strong><em>quotation marks</em></strong>.</p></li>
<li><p>We then tell that we want to <code>summarise</code> by the
<code>spray</code> variable and how do we want to summarize: by taking
the mean of <code>count</code>.</p></li>
</ul>
<div
id="making-the-summary-output-to-be-of-the-same-length-as-the-grouping-variable-passing-the-summary-function-through-the-ave-function-as-parameter-of-ddply."
class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Making the summary
output to be of the same length as the grouping variable: passing the
summary function through the <code>ave()</code> function as parameter of
<code>ddply()</code>.</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ave)                        <span class="co"># &quot;ave&quot; stands for average.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, ..., <span class="at">FUN =</span> mean)  </span></code></pre></div>
<ul>
<li><p>This function takes a numeric vector as input.</p></li>
<li><p>Makes an average (by default the <code>mean</code>) of each
subset typically specified by factor levels (if no grouping variable is
provided, it takes the average of the hole vector as the only
group).</p></li>
<li><p>Returns a vector of the <strong>same length</strong> of the
original, where <strong>each observation with the same</strong>
<strong>factor level</strong> has <strong>it’s group
average</strong>.</p></li>
</ul>
<p>Just a couple of examples to see how it works.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>ave_mean1 <span class="ot">&lt;-</span> <span class="fu">ave</span>(InsectSprays<span class="sc">$</span>count)               <span class="co"># No grouping variable provided.</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ave_mean1)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">72</span>] <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> <span class="fl">9.5</span> ...</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ave_mean1)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">9.5</span>     <span class="fl">9.5</span>     <span class="fl">9.5</span>     <span class="fl">9.5</span>     <span class="fl">9.5</span>     <span class="fl">9.5</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>ave_mean2 <span class="ot">&lt;-</span> <span class="fu">ave</span>(InsectSprays<span class="sc">$</span>count, InsectSprays<span class="sc">$</span>spray)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ave_mean2)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">72</span>] <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> ...</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ave_mean2)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">2.083</span>   <span class="fl">3.500</span>   <span class="fl">9.708</span>   <span class="fl">9.500</span>  <span class="fl">15.333</span>  <span class="fl">16.667</span> </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ave_mean2)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span> <span class="fl">14.5</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ave_mean2)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">16.66667</span> <span class="fl">16.66667</span> <span class="fl">16.66667</span> <span class="fl">16.66667</span> <span class="fl">16.66667</span> <span class="fl">16.66667</span></span></code></pre></div>
<p>Now let’s use <code>ave()</code> within <code>ddply()</code>
function.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUN = mean by default within ave()</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>sprays_means <span class="ot">&lt;-</span> <span class="fu">ddply</span>(InsectSprays, .(spray), summarise, <span class="at">mean =</span> <span class="fu">ave</span>(count))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sprays_means)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">72</span>  <span class="dv">2</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sprays_means)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  spray mean</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A <span class="fl">14.5</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     A <span class="fl">14.5</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     A <span class="fl">14.5</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     A <span class="fl">14.5</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     A <span class="fl">14.5</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     A <span class="fl">14.5</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(sprays_means)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>   spray     mean</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="dv">67</span>     F <span class="fl">16.66667</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="dv">68</span>     F <span class="fl">16.66667</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="dv">69</span>     F <span class="fl">16.66667</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="dv">70</span>     F <span class="fl">16.66667</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span>     F <span class="fl">16.66667</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="dv">72</span>     F <span class="fl">16.66667</span></span></code></pre></div>
<ul>
<li><p>We can see that the <strong>output data frame</strong> now has
the same “length” (same number of rows) of the original
<code>spray</code> grouping variable, because how the average (the
<code>mean</code>) was constructed.</p></li>
<li><p>Notice that the <em>grouping</em> <code>spray</code> variable is
not specified within <code>ave()</code>, this last function is not aware
of it. The one how knows how to make the groups is <code>ddplry()</code>
so what most probably is happening is that <code>ddplyr()</code> is
applying <code>ave</code> to each group.</p></li>
</ul>
<p>Just a final example, taken another average: the
<code>sum</code>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>sprays_sums <span class="ot">&lt;-</span> <span class="fu">ddply</span>(InsectSprays, .(spray), summarise, <span class="at">sum =</span> <span class="fu">ave</span>(count, <span class="at">FUN =</span> sum))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sprays_sums)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">72</span>  <span class="dv">2</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sprays_sums)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  spray sum</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A <span class="dv">174</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     A <span class="dv">174</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     A <span class="dv">174</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     A <span class="dv">174</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     A <span class="dv">174</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     A <span class="dv">174</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(sprays_sums)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>   spray sum</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="dv">67</span>     F <span class="dv">200</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="dv">68</span>     F <span class="dv">200</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="dv">69</span>     F <span class="dv">200</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="dv">70</span>     F <span class="dv">200</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span>     F <span class="dv">200</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="dv">72</span>     F <span class="dv">200</span></span></code></pre></div>
</div>
<div id="why-would-we-want-to-do-that" class="section level3"
number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Why would we want
to do that?</h3>
<p>Instead of having a variable where we just see the averages once for
each group, we would want to have those group averages for every value
of each group because that would allow us <strong>to add this variable
to the dataset</strong> and <strong>use it to do different
analysis</strong>.</p>
<p>We could for example use a combination of <code>ddplyr()</code> and
<code>mutate()</code> in order to add new variables that are summaries
of their previous variables.</p>
</div>
</div>
</div>
<div id="further-resourses-about-reshape2-and-plyr."
class="section level1" number="6">
<h1><span class="header-section-number">6</span> Further resourses about
<code>reshape2</code> and <code>plyr</code>.</h1>
<ul>
<li><p>The <a href="http://plyr.had.co.nz/09-user/">tutorial from the
developer of <code>plyr</code></a>.</p></li>
<li><p>And a nice <a
href="https://www.slideshare.net/jeffreybreen/reshaping-data-in-r"><code>reshape2</code>
tutorial</a>.</p></li>
</ul>
<hr />
</div>
<div id="managing-data-frames-with-dplyr-package."
class="section level1" number="7">
<h1><span class="header-section-number">7</span> Managing Data Frames
with <code>dplyr</code> package.</h1>
<div id="introduction." class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction.</h2>
<p>The <code>dplyr</code> package, developed by Hadley Wickham of
RStudio, is specifically designed to help us <strong>work with data
frames</strong>, which are a <em>key data structure</em> in statistics
and in R.</p>
<p>We can install it form CRAN. The latest version at the time of
writing these notes, is <code>v. 1.0.1</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">&#39;dplyr&#39;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:Hmisc&#39;</span><span class="sc">:</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    src, summarize</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:data.table&#39;</span><span class="sc">:</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    between, first, last</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:plyr&#39;</span><span class="sc">:</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    arrange, count, desc, failwith, id, mutate, rename, summarise,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    summarize</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:stats&#39;</span><span class="sc">:</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    filter, lag</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">&#39;package:base&#39;</span><span class="sc">:</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    intersect, setdiff, setequal, union</span></code></pre></div>
<p>Here we’ll just cover the basics to introduce the package.</p>
<ul>
<li><p>We’ll talk about the “verbs” <em>arrange</em>, <em>filter</em>,
<em>select</em>, <em>mutate</em> and <em>rename</em>.</p></li>
<li><p>We’ll see <strong>how to use those functions</strong> to
manipulate data frames and to manage data in a <strong>more</strong>
<strong>efficient and easy-to-use way</strong>.</p></li>
</ul>
<p>But before that, let’s precise some important aspects of this
package.</p>
<div id="an-improoved-version-of-plyr-package." class="section level3"
number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> An improoved
version of <code>plyr</code> package.</h3>
<p>The <code>dplyr</code> package often can be thought of as an
<strong>optimized and distilled version</strong> of the
<strong><code>plyr</code> package</strong>, also writen by Wickham.</p>
<p>Actually it <strong>doesn’t provide any new functionality</strong>,
in the sense that everything dplyr does could already be done with base
R, but:</p>
<ul>
<li><p>It <strong>greatly simplifies</strong> a lot of the
<strong>existing functionality in R</strong>.</p>
<ul>
<li>Operations like filtering, re-ordering and collapsing, can often be
tedious operations in R whose syntax is not very intuitive. The dplyr
package is designed to mitigate a lot of these problems.</li>
</ul></li>
<li><p>It makes it a <strong>lot faster</strong>.</p>
<ul>
<li>One of the reasons it’s a lot faster is because <strong>many key
operations are coded in C++</strong>.</li>
</ul></li>
</ul>
</div>
<div
id="provides-a-grammar-in-particular-verbs-for-data-frame-manipulation."
class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Provides a
<em>grammar</em> (in particular <em>verbs</em>) for data frame
manipulation.</h3>
<p>This package provides a grammar, verbs for tabular data manipulation.
And this is useful for communicating what we are doing because it
provides an abstraction for data manipulation that previously did not
exist.</p>
<p>The <strong>key <code>dplyr</code> verbs</strong> cover the most
fundamental data manipulation tasks:</p>
<ul>
<li><p><code>select</code>: return a subset of the
<strong>columns</strong> of a data frame.</p></li>
<li><p><code>filter</code>: extract a subset of <strong>rows</strong>
from a data frame based on logical conditions.</p></li>
<li><p><code>arrange</code>: reorder <strong>rows</strong> of a data
frame while preserving the order of the columns.</p></li>
<li><p><code>rename</code>: rename <strong>variables/columns</strong> in
a data frame.</p></li>
<li><p><code>mutate</code>: add new (or transform existing)
<strong>variables/columns</strong>.</p></li>
<li><p><code>summarise</code> / <code>summarize</code>: generate summary
statistics of different variables in the data frame, possibly within
strata.</p></li>
<li><p><code>%&gt;%</code>: the <strong>pipe</strong> operator, used to
connect multiple verb actions together in a pipeline.</p></li>
</ul>
</div>
<div id="additional-benefits-of-dplyr-grammar." class="section level3"
number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Additional benefits
of <code>dplyr</code> <em>grammar</em>.</h3>
<p>An important benefit from learning the <code>dplyr</code>
<em>grammar</em>, is that <code>dplyr</code> can work with
<strong>tabular</strong> <strong>data from a variety of
sources</strong>.</p>
<ul>
<li><p>Below, we’ll just use the default R implementation.</p></li>
<li><p>But we can use the <code>data.table</code> package which is for
designed for very large and fast tables.</p></li>
<li><p>Similarly the <code>SQL</code> interface for relational databases
via the DBI package can be used.</p></li>
<li><p>Also, multidimensonal arrays.</p></li>
</ul>
<p>So, if we had data stored in a relational database we can <strong>use
all the same functions</strong> in the <code>dplyr</code> package and
manipulate the data in either a <code>data.table</code> object or a an
<code>SQL</code> database, <strong>without</strong> <strong>having to
relearn a whole new set of tools</strong>.</p>
<p>That’s really handy. Once we’ve gotten fluent in <code>dplyr</code>
package, we can translate those skills to other database backends almost
immediately.</p>
</div>
<div id="the-goal-is-always-tidy-data." class="section level3"
number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> The goal is always
tidy data.</h3>
<p>The <code>dplyr</code> package works with data frames, so it makes
the <strong>following assumptions</strong>:</p>
<ul>
<li><p>Each observation is represented by one row.</p></li>
<li><p>Each column represents a variable or a measure or
characteristic.</p></li>
<li><p>Each type of observational unit forms a table.</p></li>
</ul>
<p>As we know, these are <strong>basic concepts from the notion of tidy
data</strong>.</p>
</div>
<div
id="the-tidyverse-set-of-packages-and-tibbles-data-frames-that-has-the-tbl_df-class-as-its-central-data-structure-tibble-and-as_tibble."
class="section level3" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> The
<em><code>tidyverse</code></em> set of packages and <em>“tibbles”</em>
(data frames that has the <code>tbl_df</code> class) as its central data
structure: <code>tibble()</code> and <code>as_tibble()</code>.</h3>
<p>The <code>dplyr</code> package is a part of a <strong>set of
packages</strong>, known as the <code>tidyverse</code>, including
<code>ggplot2</code>, <code>tidyr</code>, <code>readr</code>,
<code>stringr</code>.</p>
<p>So, <code>tidyverse</code> is an <strong>ecosystem of
packages</strong> designed with <strong>common APIs</strong> and a
<strong>shared philosophy</strong>.</p>
<ul>
<li>There are <strong>four basic principles</strong> to a <strong>tidy
API</strong>.
<ol style="list-style-type: decimal">
<li>Reuse existing data structures.<br />
</li>
<li>Compose simple functions with the pipe (we’ll get to this
later).<br />
</li>
<li>Embrace functional programming.<br />
</li>
<li>Design for humans.<br />
</li>
</ol></li>
<li>The <strong>shared philosophy</strong> is each package to have
<em>small functions</em> that each do <em>one thing well</em>.</li>
</ul>
<p>The article <a
href="https://tidyverse.tidyverse.org/articles/manifesto.html">“The tidy
tools manifesto”</a> written by Hadley Wickham, addresses each of the
points listed above.</p>
<p>As we said, <strong>this ecosystem has</strong>
<strong><em>“tibbles”</em></strong> <strong>as it central data
structure</strong>.</p>
<ul>
<li><p>The colloquial term <em>“tibble”</em> refers to a data frame that
has the <code>tbl_df</code> class.</p></li>
<li><p>The <code>tbl_df</code> class is a
<strong><em>subclass</em></strong> of <code>data.frame</code>,
<strong>created</strong> in order <strong>to have different</strong>
<strong>default behaviour</strong>. Let’s see then <em>how</em> default
behaviour of <em>tibbles</em> differs from that of
<code>data.frames</code>, during creation and access:</p>
<ul>
<li><p>The <strong>general ethos</strong> is that <em>tibbles</em> are
<strong>lazy and surly</strong>: they <em>do less</em> and <em>complain
more</em> than base <code>data.frames</code>. This forces problems to be
tackled earlier and more explicitly, typically leading to code that is
more expressive and robust.</p></li>
<li><p><strong>Column data</strong> is <em>not coerced</em>. A character
vector is not turned into a factor. List-columns are expressly
anticipated and do not require special tricks.</p></li>
<li><p><strong>Columns are built sequentially</strong>. When
<em>defining a column</em>, we can <em>refer to columns created
earlier</em> in the call.</p></li>
<li><p><strong>Recycling</strong> only happens for a length 1 input,
that is, only columns of length one are recycled.</p></li>
<li><p><strong>Column names</strong> are <em>not munged</em> (no se
rellenan), <em>although</em> <strong>missing names</strong> are
<em>auto-populated</em>. Empty and duplicated column names are strongly
discouraged, but the user must indicate how to resolve.</p></li>
<li><p><strong>Row names</strong> are <em>not added</em> and are
<em>strongly discouraged</em>, in favor of storing that info as a
column.</p></li>
<li><p><strong>Subsetting a single column</strong> <em>doesn’t have
dropping behaviour</em>, <code>df[, j, drop=FALSE]</code> is the
default.</p></li>
<li><p><strong>Enhanced printing and inspection</strong>; those topics
are given <em>very high priority</em>.</p>
<ul>
<li>The <strong>goal</strong> is to <strong>convey as much information
as possible</strong>, in a <strong>concise way</strong>, even for large
and complex tibbles, preventing us from printing a lot of data to the
console.</li>
</ul></li>
</ul></li>
</ul>
<blockquote>
<p>So, in summary, a <em>tibble</em> is nothing else than a <em>data
frame</em>, with <em>different default behavior</em> and <em>enhanced
printing</em>.</p>
</blockquote>
<p>But, <strong>how do we create</strong>
<strong><em>tibbles?</em></strong>. Well, here we have to distinguish
which version of <code>dplyr</code> package we are talking about.</p>
<ul>
<li><p>Versions of <code>dplyr &lt; 1.0.0</code>.</p>
<ul>
<li>The function used to create a <em>tibble</em> are
<code>tbl_df()</code> and <code>as.tbl()</code>.</li>
</ul></li>
<li><p>Versions of <code>dplyr &gt;= 1.0.0</code>.</p>
<ul>
<li><p>Those functions were deprecated and replaced by
<code>tibble()</code> and <code>as_tibble()</code>.</p></li>
<li><p>Let’s take a quick look to these new functions.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tibble)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (..., <span class="at">.rows =</span> <span class="cn">NULL</span>, <span class="at">.name_repair =</span> <span class="fu">c</span>(<span class="st">&quot;check_unique&quot;</span>, <span class="st">&quot;unique&quot;</span>, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;universal&quot;</span>, <span class="st">&quot;minimal&quot;</span>))  </span></code></pre></div>
<ul>
<li><p>It constructs a <strong>data frame</strong>. It is used like
<code>base::data.frame()</code>, that is, it builds the object from
individual columns.</p></li>
<li><p><strong>Returns a data frame</strong> with class
<code>tbl_df</code>, in addition to <code>data.frame</code> (a
<em>tibble</em>).</p></li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(as_tibble)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, ..., <span class="at">.rows =</span> <span class="cn">NULL</span>, <span class="at">.name_repair =</span> <span class="fu">c</span>(<span class="st">&quot;check_unique&quot;</span>, <span class="st">&quot;unique&quot;</span>, </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;universal&quot;</span>, <span class="st">&quot;minimal&quot;</span>), <span class="at">rownames =</span> pkgconfig<span class="sc">::</span><span class="fu">get_config</span>(<span class="st">&quot;tibble::rownames&quot;</span>, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>))  </span></code></pre></div>
<ul>
<li><p>It <strong>turns an existing object</strong>, such as a
<strong>data frame</strong> or <strong>matrix</strong>, <strong>into
a</strong> <strong><em>tibble</em></strong> (a data frame with class
<code>tbl_df</code>).</p></li>
<li><p>This is in contrast with <code>tibble()</code>, which builds a
tibble from individual columns.</p></li>
<li><p><code>as_tibble()</code> is to <code>tibble()</code>
<strong>as</strong> <code>base::as.data.frame()</code> is to
<code>base::data.frame()</code>.</p></li>
<li><p>The <code>x</code> parameter can be a data frame, list, matrix,
or other object that could reasonably be coerced to a tibble.</p></li>
</ul>
</div>
<div id="all-dplyr-functions-have-basically-the-same-format."
class="section level3" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> All
<code>dplyr</code> functions have basically the same format.</h3>
<p>So, the <code>dplyr</code> package provides the most important
<code>tidyverse</code> functions for manipulating tables. These
functions <strong>share some common characteristics</strong> that make
it easy to transform tables:</p>
<ul>
<li><p>The <em>first argument</em> is <strong>always a data
frame</strong>.</p>
<ul>
<li><p>That <strong>leads to a major improvement</strong>: that inside a
<code>dplyr</code> function we can <strong>refer to columns</strong> in
the data frame <strong>directly</strong> by their names. There’s no need
for <code>$</code> syntax or quotation marks. It will recognize the
columns in that data frame provided as first argument.</p></li>
<li><p>This only becomes a problem if we’d like to use an object that
has the <strong>same name</strong> as one of the columns in the data
frame. In this case, place <code>!!</code> before the object’s name to
unquote it, <code>dplyr</code> will skip the columns when looking up the
object, for example:<br />
<code>hwy &lt;- 1:10         summarise(mpg, h = mean(!!hwy), c = mean(cty))</code></p></li>
</ul></li>
<li><p>The <em>subsequent arguments</em> describe <strong>what to do
with the data frame</strong>.</p></li>
<li><p>The <strong>result is always a new data frame</strong>, so each
<code>dplyr</code> function takes a table (data frame) in input and
always returns a <em>transformed copy</em> of that table.</p>
<ul>
<li>They won’t change our original table unless we tell them to (by
<em>saving over the name of the original</em> <em>table</em>). That’s
good news, because we should always retain a clean copy of our original
data in case something goes wrong.</li>
</ul></li>
</ul>
</div>
</div>
<div id="basic-tools." class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Basic tools.</h2>
<div id="getting-a-sample-dataset." class="section level3"
number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Getting a sample
dataset.</h3>
<p>We are going to work with the <code>chicago.rds</code> file. It
contains daily observations with air pollution and weather variables in
the city of Chicago for the years 1987 to 2005.</p>
<p>We can download it:</p>
<ul>
<li><p>From <a
href="https://github.com/DataScienceSpecialization/courses/tree/master/03_GettingData/dplyr">Data
Science Specialization Github repo</a>.</p></li>
<li><p>In <a
href="http://www.biostat.jhsph.edu/~rpeng/leanpub/rprog/chicago_data.zip">Dr. Roger
D. Peng web site</a> there’s a compressed version of the same
file.</p></li>
</ul>
<p>I’ve downloaded the <code>.rds</code> file manually, instead of using
<code>download.file()</code> function.</p>
<p>Now we can read it in from disk into the <code>chicago</code>
variable.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;./3_data/chicago.rds&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(chicago)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span></code></pre></div>
<ul>
<li>So we have our data frame to work with.</li>
</ul>
</div>
<div
id="inspecting-the-chicago-data-frame-and-turning-it-into-a-tibble."
class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Inspecting the
<code>chicago</code> data frame and turning it into a
<em>tibble</em>.</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(chicago)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">6940</span> obs. of  <span class="dv">8</span> variables<span class="sc">:</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> city      <span class="sc">:</span> chr  <span class="st">&quot;chic&quot;</span> <span class="st">&quot;chic&quot;</span> <span class="st">&quot;chic&quot;</span> <span class="st">&quot;chic&quot;</span> ...</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tmpd      <span class="sc">:</span> num  <span class="fl">31.5</span> <span class="dv">33</span> <span class="dv">33</span> <span class="dv">29</span> <span class="dv">32</span> <span class="dv">40</span> <span class="fl">34.5</span> <span class="dv">29</span> <span class="fl">26.5</span> <span class="fl">32.5</span> ...</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> dptp      <span class="sc">:</span> num  <span class="fl">31.5</span> <span class="fl">29.9</span> <span class="fl">27.4</span> <span class="fl">28.6</span> <span class="fl">28.9</span> ...</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> date      <span class="sc">:</span> Date, format<span class="sc">:</span> <span class="st">&quot;1987-01-01&quot;</span> <span class="st">&quot;1987-01-02&quot;</span> ...</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> pm25tmean2<span class="sc">:</span> num  <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> <span class="cn">NA</span> ...</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> pm10tmean2<span class="sc">:</span> num  <span class="dv">34</span> <span class="cn">NA</span> <span class="fl">34.2</span> <span class="dv">47</span> <span class="cn">NA</span> ...</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> o3tmean2  <span class="sc">:</span> num  <span class="fl">4.25</span> <span class="fl">3.3</span> <span class="fl">3.33</span> <span class="fl">4.38</span> <span class="fl">4.75</span> ...</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> no2tmean2 <span class="sc">:</span> num  <span class="dv">20</span> <span class="fl">23.2</span> <span class="fl">23.8</span> <span class="fl">30.4</span> <span class="fl">30.3</span> ...</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(chicago)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  city tmpd   dptp       date pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> chic <span class="fl">31.5</span> <span class="fl">31.500</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>   <span class="fl">34.00000</span> <span class="fl">4.250000</span>  <span class="fl">19.98810</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> chic <span class="fl">33.0</span> <span class="fl">29.875</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>         <span class="cn">NA</span> <span class="fl">3.304348</span>  <span class="fl">23.19099</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> chic <span class="fl">33.0</span> <span class="fl">27.375</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>   <span class="fl">34.16667</span> <span class="fl">3.333333</span>  <span class="fl">23.81548</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> chic <span class="fl">29.0</span> <span class="fl">28.625</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>   <span class="fl">47.00000</span> <span class="fl">4.375000</span>  <span class="fl">30.43452</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> chic <span class="fl">32.0</span> <span class="fl">28.875</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>         <span class="cn">NA</span> <span class="fl">4.750000</span>  <span class="fl">30.33333</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> chic <span class="fl">40.0</span> <span class="fl">35.125</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>   <span class="fl">48.00000</span> <span class="fl">5.833333</span>  <span class="fl">25.77233</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(chicago)</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>     city                tmpd             dptp             date           </span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a> Length<span class="sc">:</span><span class="dv">6940</span>        Min.   <span class="sc">:-</span><span class="fl">16.00</span>   Min.   <span class="sc">:-</span><span class="fl">25.62</span>   Min.   <span class="sc">:</span><span class="dv">1987-01-01</span>  </span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a> Class <span class="sc">:</span>character   1st Qu.<span class="sc">:</span> <span class="fl">35.00</span>   1st Qu.<span class="sc">:</span> <span class="fl">27.00</span>   1st Qu.<span class="sc">:</span><span class="dv">1991-10-01</span>  </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a> Mode  <span class="sc">:</span>character   Median <span class="sc">:</span> <span class="fl">51.00</span>   Median <span class="sc">:</span> <span class="fl">39.88</span>   Median <span class="sc">:</span><span class="dv">1996-07-01</span>  </span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>                    Mean   <span class="sc">:</span> <span class="fl">50.31</span>   Mean   <span class="sc">:</span> <span class="fl">40.34</span>   Mean   <span class="sc">:</span><span class="dv">1996-07-01</span>  </span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>                    3rd Qu.<span class="sc">:</span> <span class="fl">67.00</span>   3rd Qu.<span class="sc">:</span> <span class="fl">55.75</span>   3rd Qu.<span class="sc">:</span><span class="dv">2001-04-01</span>  </span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>                    Max.   <span class="sc">:</span> <span class="fl">92.00</span>   Max.   <span class="sc">:</span> <span class="fl">78.25</span>   Max.   <span class="sc">:</span><span class="dv">2005-12-31</span>  </span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>                    NA<span class="st">&#39;s   :1        NA&#39;</span>s   <span class="sc">:</span><span class="dv">2</span>                            </span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>   pm25tmean2      pm10tmean2        o3tmean2         no2tmean2     </span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a> Min.   <span class="sc">:</span> <span class="fl">1.70</span>   Min.   <span class="sc">:</span>  <span class="fl">2.00</span>   Min.   <span class="sc">:</span> <span class="fl">0.1528</span>   Min.   <span class="sc">:</span> <span class="fl">6.158</span>  </span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a> 1st Qu.<span class="sc">:</span> <span class="fl">9.70</span>   1st Qu.<span class="sc">:</span> <span class="fl">21.50</span>   1st Qu.<span class="sc">:</span><span class="fl">10.0729</span>   1st Qu.<span class="sc">:</span><span class="fl">19.654</span>  </span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a> Median <span class="sc">:</span><span class="fl">14.66</span>   Median <span class="sc">:</span> <span class="fl">30.28</span>   Median <span class="sc">:</span><span class="fl">18.5218</span>   Median <span class="sc">:</span><span class="fl">24.556</span>  </span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a> Mean   <span class="sc">:</span><span class="fl">16.23</span>   Mean   <span class="sc">:</span> <span class="fl">33.90</span>   Mean   <span class="sc">:</span><span class="fl">19.4355</span>   Mean   <span class="sc">:</span><span class="fl">25.232</span>  </span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a> 3rd Qu.<span class="sc">:</span><span class="fl">20.60</span>   3rd Qu.<span class="sc">:</span> <span class="fl">42.00</span>   3rd Qu.<span class="sc">:</span><span class="fl">27.0010</span>   3rd Qu.<span class="sc">:</span><span class="fl">30.139</span>  </span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a> Max.   <span class="sc">:</span><span class="fl">61.50</span>   Max.   <span class="sc">:</span><span class="fl">365.00</span>   Max.   <span class="sc">:</span><span class="fl">66.5875</span>   Max.   <span class="sc">:</span><span class="fl">62.480</span>  </span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a> NA<span class="st">&#39;s   :4447    NA&#39;</span>s   <span class="sc">:</span><span class="dv">242</span>                                        </span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(chicago)</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(chicago)</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;tbl_df&quot;</span>     <span class="st">&quot;tbl&quot;</span>        <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>chicago                                 <span class="co"># no more &quot;head()&quot; needed.</span></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div id="select-function---column-subsetting." class="section level3"
number="7.2.3">
<h3><span class="header-section-number">7.2.3</span>
<code>select()</code> function - Column subsetting.</h3>
<p>Let’s see how we can refer columns by name, without <code>$</code>
syntax or quotation marks.</p>
<div
id="using-the-colon-notation-with-variable-names-to-select-a-range-of-columns."
class="section level4" number="7.2.3.1">
<h4><span class="header-section-number">7.2.3.1</span> Using the colon
notation with variable names to select a range of columns.</h4>
<p>One of the nice things we can do with the <code>select()</code>
function in <code>dplyr</code>, is to <strong>access a set of
columns</strong> using the <strong>colon operator</strong> with <em>just
the names</em> of the variables.</p>
<ul>
<li>Let’s say that we want to get the first 3 columns, that is to say,
<strong>starting with <code>city</code></strong> and <strong>ending with
<code>dptp</code></strong> (the dew point -punto de rocío- column),
including all the columns in between.</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(chicago)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;city&quot;</span> <span class="st">&quot;tmpd&quot;</span> <span class="st">&quot;dptp&quot;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, city<span class="sc">:</span>dptp)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>  </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>  </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<ul>
<li><p>Notice how it <strong>greatly improves and easy</strong> the
writing of statements by allowing to use only the <strong>variables
names</strong>.</p></li>
<li><p>This colon notation is <strong>not a notation that we would
normally be able to use in other functions</strong> (normally, the
<code>:</code> notation is reserved for numbers).</p></li>
</ul>
<p>So it’s a <strong>nice and handy way</strong> to look at subsets of
columns of a data frame using the <strong>colon notation</strong> with
<strong>just names</strong>, as an <strong>interesting and useful
alternative</strong> to <strong><em>subsetting with numbers
representing</em></strong> <strong><em>variables’
position</em></strong>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>chicago[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]                              <span class="co"># Again, no &quot;head()&quot; needed.</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>  </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>  </span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div id="the-output-is-in-the-order-user-specifies."
class="section level4" number="7.2.3.2">
<h4><span class="header-section-number">7.2.3.2</span> The output is in
the order user specifies.</h4>
<p>The columns are returned in the order that user specifies those
columns.</p>
<p>For example, if we are using <em>the colon notation</em>, we can
<strong>invert the order</strong> like this:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, dptp<span class="sc">:</span>city)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    dptp  tmpd city </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span> chic </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="fl">29.9</span>  <span class="dv">33</span>   chic </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">27.4</span>  <span class="dv">33</span>   chic </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="fl">28.6</span>  <span class="dv">29</span>   chic </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="fl">28.9</span>  <span class="dv">32</span>   chic </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="fl">35.1</span>  <span class="dv">40</span>   chic </span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">26.8</span>  <span class="fl">34.5</span> chic </span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">22</span>    <span class="dv">29</span>   chic </span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">29</span>    <span class="fl">26.5</span> chic </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">27.8</span>  <span class="fl">32.5</span> chic </span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<p>Actually, we can do the <strong>same thing</strong> using <em>square
braquets operator with numbers</em>:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>chicago[, <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    dptp  tmpd city </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span> chic </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="fl">29.9</span>  <span class="dv">33</span>   chic </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">27.4</span>  <span class="dv">33</span>   chic </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="fl">28.6</span>  <span class="dv">29</span>   chic </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="fl">28.9</span>  <span class="dv">32</span>   chic </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="fl">35.1</span>  <span class="dv">40</span>   chic </span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">26.8</span>  <span class="fl">34.5</span> chic </span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">22</span>    <span class="dv">29</span>   chic </span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">29</span>    <span class="fl">26.5</span> chic </span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">27.8</span>  <span class="fl">32.5</span> chic </span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<p>But, as we’ll see right away, <strong>things get interesting</strong>
when <strong>using commas of names’ vectors</strong>.</p>
<blockquote>
<p>In conclusion, inherent in <code>select()</code> is the ability to
arrange our selected <em>columns</em> in any order we please.<br />
As we’ll see, the same does not happen when extracting <em>rows</em>
with <code>filter()</code>, this last function does not perform any
ordering action and, therefore, we’ll need another function,
<code>arrange()</code>, to order rows.</p>
</blockquote>
</div>
<div id="selecting-columns-using-comma-or-a-vector-of-names."
class="section level4" number="7.2.3.3">
<h4><span class="header-section-number">7.2.3.3</span> Selecting columns
using comma or a vector of names.</h4>
<p>We can specify columns <strong>separating their names with
commas</strong> or <strong>specifying the names in a vector</strong>
(naturally, without quotes!!).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, city<span class="sc">:</span>dptp, pm25tmean2)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 4</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp pm25tmean2</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span>         <span class="cn">NA</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span>         <span class="cn">NA</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span>         <span class="cn">NA</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span>         <span class="cn">NA</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span>         <span class="cn">NA</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span>         <span class="cn">NA</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span>         <span class="cn">NA</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>           <span class="cn">NA</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>           <span class="cn">NA</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span>         <span class="cn">NA</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, pm25tmean2, dptp<span class="sc">:</span>city)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 4</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>   pm25tmean2  dptp  tmpd city </span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>        <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>         <span class="cn">NA</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span> chic </span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>         <span class="cn">NA</span>  <span class="fl">29.9</span>  <span class="dv">33</span>   chic </span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>         <span class="cn">NA</span>  <span class="fl">27.4</span>  <span class="dv">33</span>   chic </span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>         <span class="cn">NA</span>  <span class="fl">28.6</span>  <span class="dv">29</span>   chic </span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>         <span class="cn">NA</span>  <span class="fl">28.9</span>  <span class="dv">32</span>   chic </span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>         <span class="cn">NA</span>  <span class="fl">35.1</span>  <span class="dv">40</span>   chic </span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>         <span class="cn">NA</span>  <span class="fl">26.8</span>  <span class="fl">34.5</span> chic </span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>         <span class="cn">NA</span>  <span class="dv">22</span>    <span class="dv">29</span>   chic </span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>         <span class="cn">NA</span>  <span class="dv">29</span>    <span class="fl">26.5</span> chic </span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>         <span class="cn">NA</span>  <span class="fl">27.8</span>  <span class="fl">32.5</span> chic </span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">c</span>(dptp, pm25tmean2, tmpd))</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>    dptp pm25tmean2  tmpd</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>  <span class="fl">31.5</span></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="fl">29.9</span>         <span class="cn">NA</span>  <span class="dv">33</span>  </span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">27.4</span>         <span class="cn">NA</span>  <span class="dv">33</span>  </span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="fl">28.6</span>         <span class="cn">NA</span>  <span class="dv">29</span>  </span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="fl">28.9</span>         <span class="cn">NA</span>  <span class="dv">32</span>  </span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="fl">35.1</span>         <span class="cn">NA</span>  <span class="dv">40</span>  </span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">26.8</span>         <span class="cn">NA</span>  <span class="fl">34.5</span></span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">22</span>           <span class="cn">NA</span>  <span class="dv">29</span>  </span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">29</span>           <span class="cn">NA</span>  <span class="fl">26.5</span></span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">27.8</span>         <span class="cn">NA</span>  <span class="fl">32.5</span></span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div id="and-the-minus-sing-to-specify-columns-to-throw-away."
class="section level4" number="7.2.3.4">
<h4><span class="header-section-number">7.2.3.4</span> And the minus
sing to specify columns to “throw away”.</h4>
<p>We can <strong>also use the minus sign</strong> to select all the
columns except for the columns indicated by <em>name</em>, by a
<em>vector of names</em> or by a <em>range</em>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="sc">-</span>city, <span class="sc">-</span>pm25tmean2)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 6</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    tmpd  dptp date       pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="sc">-</span><span class="fu">c</span>(city, pm25tmean2))</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 6</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    tmpd  dptp date       pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="sc">-</span>(city<span class="sc">:</span>dptp))</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>   date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>chicago[, <span class="sc">-</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>)]</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>   date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div
id="the-equivalent-tricky-way-in-regular-r-if-we-dont-know-column-positions."
class="section level4" number="7.2.3.5">
<h4><span class="header-section-number">7.2.3.5</span> The equivalent
<em>tricky</em> way in regular R, if we don’t know column
positions.</h4>
<p>Suppose we don’t know the positions that<code>city</code> and
<code>dptp</code> columns have in our dataset.</p>
<p>There’s a <strong>equivalent code to use column notation</strong> in
<strong>regular R</strong> (without <code>dplyr</code>), that is a
<strong>little bit tricky</strong> because:</p>
<ul>
<li><p>We have to find the index for where the <code>city</code> column
is and the index for where the <code>dptp</code> column is (we can do
that with the <code>match()</code> function).</p></li>
<li><p>Then we take the negative of those indices.</p></li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="st">&quot;city&quot;</span>, <span class="fu">names</span>(chicago))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="st">&quot;dptp&quot;</span>, <span class="fu">names</span>(chicago))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>chicago[, <span class="sc">-</span>(i<span class="sc">:</span>j)]</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>   date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<ul>
<li>It’s <strong>not particularly complicated</strong>
<strong><em>but</em></strong> it’s an <em>extra two lines</em> of code
and perhaps <em>not as</em> <em>readable</em>.</li>
</ul>
</div>
<div id="therere-also-very-useful-selection-helpers-a-special-syntax."
class="section level4" number="7.2.3.6">
<h4><span class="header-section-number">7.2.3.6</span> There’re also
very useful <em>selection helpers</em> (a special syntax).</h4>
<div
id="selection-helpers-for-selecting-specific-columns-everything-last_col."
class="section level5" number="7.2.3.6.1">
<h5><span class="header-section-number">7.2.3.6.1</span> Selection
helpers for selecting <em>specific columns</em>:
<code>everything()</code>, <code>last_col()</code>.</h5>
<p>For example:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">everything</span>())</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">last_col</span>())</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 1</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>   no2tmean2</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>       <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>      <span class="fl">20.0</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>      <span class="fl">23.2</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>      <span class="fl">23.8</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>      <span class="fl">30.4</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>      <span class="fl">30.3</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>      <span class="fl">25.8</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>      <span class="fl">20.6</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>      <span class="fl">17.0</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>      <span class="fl">23.4</span></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>      <span class="fl">19.5</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div
id="selection-helpers-for-selecting-variables-by-matching-patterns-in-their-names-ends_with-starts_with-contains-matches."
class="section level5" number="7.2.3.6.2">
<h5><span class="header-section-number">7.2.3.6.2</span> Selection
helpers for selecting variables by matching <em>patterns</em> in their
names: <code>ends_with()</code>, <code>starts_with()</code>,
<code>contains()</code>, <code>matches()</code>.</h5>
<p>For example, if we wanted to <em>keep every variable that ends with a
“2”</em>, we could do:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">ends_with</span>(<span class="st">&quot;2&quot;</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 4</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>   pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<p>Or if we wanted to <em>keep every variable that starts with a
“d”</em>, we could do:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">starts_with</span>(<span class="st">&quot;d&quot;</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 2</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    dptp date      </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>    </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="fl">29.9</span> <span class="dv">1987-01-02</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">27.4</span> <span class="dv">1987-01-03</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="fl">28.6</span> <span class="dv">1987-01-04</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="fl">28.9</span> <span class="dv">1987-01-05</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="fl">35.1</span> <span class="dv">1987-01-06</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">22</span>   <span class="dv">1987-01-08</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<p>The <code>contains()</code> selection helper uses a <strong>literal
string</strong> to see if there’s a match. For example, if we wanted
only those <em>variables containing “mean” in their names</em>, we could
do:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">contains</span>(<span class="st">&quot;mean&quot;</span>))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 4</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>   pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<p>Finally, <code>matches()</code> matches a <strong>regular
expression</strong>. For example:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">matches</span>(<span class="st">&quot;^[to]&quot;</span>))  <span class="do">## names that begin with either &quot;t&quot; or &quot;o&quot;.</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 2</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    tmpd o3tmean2</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>     <span class="fl">4.25</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>       <span class="fl">3.30</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>       <span class="fl">3.33</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>       <span class="fl">4.38</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>       <span class="fl">4.75</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>       <span class="fl">5.83</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>     <span class="fl">9.29</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>      <span class="fl">11.3</span> </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>     <span class="fl">4.5</span> </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>     <span class="fl">4.96</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div
id="helpers-that-select-variables-from-a-character-vector-all_of-any_of."
class="section level5" number="7.2.3.6.3">
<h5><span class="header-section-number">7.2.3.6.3</span> Helpers that
select variables from a character vector: <code>all_of()</code>,
<code>any_of()</code>.</h5>
<p>Examples.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All names must be present, otherwise an out-of-bounds error is thrown.</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;o3tmean2&quot;</span>, <span class="st">&quot;tmpd&quot;</span>)))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>   date       o3tmean2  tmpd</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>        <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1987-01-01</span>     <span class="fl">4.25</span>  <span class="fl">31.5</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1987-01-02</span>     <span class="fl">3.30</span>  <span class="dv">33</span>  </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1987-01-03</span>     <span class="fl">3.33</span>  <span class="dv">33</span>  </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1987-01-04</span>     <span class="fl">4.38</span>  <span class="dv">29</span>  </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1987-01-05</span>     <span class="fl">4.75</span>  <span class="dv">32</span>  </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1987-01-06</span>     <span class="fl">5.83</span>  <span class="dv">40</span>  </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1987-01-07</span>     <span class="fl">9.29</span>  <span class="fl">34.5</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1987-01-08</span>    <span class="fl">11.3</span>   <span class="dv">29</span>  </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1987-01-09</span>     <span class="fl">4.5</span>   <span class="fl">26.5</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1987-01-10</span>     <span class="fl">4.96</span>  <span class="fl">32.5</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;o3tmean2&quot;</span>, <span class="st">&quot;tmpd&quot;</span>, <span class="st">&quot;lalala&quot;</span>)))</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="st">`</span><span class="at">select()</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> Problem <span class="cf">while</span> evaluating <span class="st">`</span><span class="at">all_of(c(&quot;date&quot;, &quot;o3tmean2&quot;, &quot;tmpd&quot;, &quot;lalala&quot;))</span><span class="st">`</span>.</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="co"># The same as &quot;all_of()&quot;, except that no error is thrown for names that</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a><span class="co"># not exist.</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;o3tmean2&quot;</span>, <span class="st">&quot;tmpd&quot;</span>, <span class="st">&quot;lalala&quot;</span>)))</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 3</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>   date       o3tmean2  tmpd</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>        <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1987-01-01</span>     <span class="fl">4.25</span>  <span class="fl">31.5</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1987-01-02</span>     <span class="fl">3.30</span>  <span class="dv">33</span>  </span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1987-01-03</span>     <span class="fl">3.33</span>  <span class="dv">33</span>  </span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1987-01-04</span>     <span class="fl">4.38</span>  <span class="dv">29</span>  </span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1987-01-05</span>     <span class="fl">4.75</span>  <span class="dv">32</span>  </span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1987-01-06</span>     <span class="fl">5.83</span>  <span class="dv">40</span>  </span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1987-01-07</span>     <span class="fl">9.29</span>  <span class="fl">34.5</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1987-01-08</span>    <span class="fl">11.3</span>   <span class="dv">29</span>  </span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1987-01-09</span>     <span class="fl">4.5</span>   <span class="fl">26.5</span></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1987-01-10</span>     <span class="fl">4.96</span>  <span class="fl">32.5</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
<div id="helper-that-applies-a-function-to-all-variables-where."
class="section level5" number="7.2.3.6.4">
<h5><span class="header-section-number">7.2.3.6.4</span> Helper that
applies a function to all variables: <code>where()</code>.</h5>
<p>This helper applies a function <strong><em>to all
variables</em></strong> and selects those for which the function returns
<code>TRUE</code>.</p>
<p>For example, let’s first select only the <code>numeric</code>
variables and then only those whose class is <code>character</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">where</span>(is.numeric))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 6</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    tmpd  dptp pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>    <span class="fl">29.9</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>    <span class="fl">27.4</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>    <span class="fl">28.6</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>    <span class="fl">28.9</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>    <span class="fl">35.1</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>  <span class="fl">26.8</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>    <span class="dv">22</span>           <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>  <span class="dv">29</span>           <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>  <span class="fl">27.8</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">where</span>(is.character))</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 1</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>   city </span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic </span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic </span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic </span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic </span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic </span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic </span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic </span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic </span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic </span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic </span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
</div>
</div>
<div id="filter-function---row-subsetting." class="section level3"
number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> <code>filter</code>
function - Row subsetting.</h3>
<p>The <code>filter()</code> function is used to <strong>subset rows
based on conditions</strong>.</p>
<ul>
<li><p>The conditions goes as second parameter (it can be an arbitrarily
complex logical expression).</p></li>
<li><p>The logical expression returns a logical vector that
<code>filter()</code> uses to <strong>return only the</strong>
<strong>rows corrisponding to the <code>TRUE</code>s</strong>.</p></li>
<li><p>Unlike base subsetting with <code>[</code>, when a condition
evaluates to <code>NA</code> the <strong>row will be
dropped</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>chic.filt <span class="ot">&lt;-</span> <span class="fu">filter</span>(chicago, pm25tmean2 <span class="sc">&gt;</span> <span class="dv">30</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>chic.filt</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 194 × 8</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">23</span>  <span class="fl">21.9</span> <span class="dv">1998-01-17</span>       <span class="fl">38.1</span>       <span class="fl">32.5</span>     <span class="fl">3.18</span>      <span class="fl">25.3</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">28</span>  <span class="fl">25.8</span> <span class="dv">1998-01-23</span>       <span class="fl">34.0</span>       <span class="fl">38.7</span>     <span class="fl">1.75</span>      <span class="fl">29.4</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">55</span>  <span class="fl">51.3</span> <span class="dv">1998-04-30</span>       <span class="fl">39.4</span>       <span class="dv">34</span>      <span class="fl">10.8</span>       <span class="fl">25.3</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">59</span>  <span class="fl">53.7</span> <span class="dv">1998-05-01</span>       <span class="fl">35.4</span>       <span class="fl">28.5</span>    <span class="fl">14.3</span>       <span class="fl">31.4</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">57</span>  <span class="dv">52</span>   <span class="dv">1998-05-02</span>       <span class="fl">33.3</span>       <span class="dv">35</span>      <span class="fl">20.7</span>       <span class="fl">26.8</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">57</span>  <span class="dv">56</span>   <span class="dv">1998-05-07</span>       <span class="fl">32.1</span>       <span class="fl">34.5</span>    <span class="fl">24.3</span>       <span class="fl">34.0</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">75</span>  <span class="fl">65.8</span> <span class="dv">1998-05-15</span>       <span class="fl">56.5</span>       <span class="dv">91</span>      <span class="fl">38.6</span>       <span class="fl">29.0</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">61</span>  <span class="dv">59</span>   <span class="dv">1998-06-09</span>       <span class="fl">33.8</span>       <span class="dv">26</span>      <span class="fl">17.9</span>       <span class="fl">25.5</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">73</span>  <span class="fl">60.3</span> <span class="dv">1998-07-13</span>       <span class="fl">30.3</span>       <span class="fl">64.5</span>    <span class="fl">37.0</span>       <span class="fl">37.9</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">78</span>  <span class="fl">67.1</span> <span class="dv">1998-07-14</span>       <span class="fl">41.4</span>       <span class="dv">75</span>      <span class="fl">40.1</span>       <span class="fl">32.6</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 184 more rows</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chic.filt, city<span class="sc">:</span>dptp, pm25tmean2)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 194 × 4</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp pm25tmean2</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">23</span>  <span class="fl">21.9</span>       <span class="fl">38.1</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">28</span>  <span class="fl">25.8</span>       <span class="fl">34.0</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">55</span>  <span class="fl">51.3</span>       <span class="fl">39.4</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">59</span>  <span class="fl">53.7</span>       <span class="fl">35.4</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">57</span>  <span class="dv">52</span>         <span class="fl">33.3</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">57</span>  <span class="dv">56</span>         <span class="fl">32.1</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">75</span>  <span class="fl">65.8</span>       <span class="fl">56.5</span></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">61</span>  <span class="dv">59</span>         <span class="fl">33.8</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">73</span>  <span class="fl">60.3</span>       <span class="fl">30.3</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">78</span>  <span class="fl">67.1</span>       <span class="fl">41.4</span></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 184 more rows</span></span></code></pre></div>
<p>This function is <strong>similar to the existing
<code>subset()</code> function in R</strong>.</p>
<div
id="filtering-based-on-multiple-conditions-and-expressions-also-just-using-commas."
class="section level4" number="7.2.4.1">
<h4><span class="header-section-number">7.2.4.1</span> Filtering based
on multiple conditions (AND expressions also just using commas).</h4>
<p>Of course we can subset rows based on <em>conditions</em> over values
in <em>multiple columns</em>.</p>
<p>If we want to <strong>relate the various conditions</strong> with an
<strong>AND operation</strong>, we can do this using <strong>two
equivalent ways</strong>:</p>
<ul>
<li><p>Using <em>commas</em>.</p></li>
<li><p>Using <code>&amp;</code> operator.</p></li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>chic.filt <span class="ot">&lt;-</span> <span class="fu">filter</span>(chicago, pm25tmean2 <span class="sc">&gt;</span> <span class="dv">30</span>, tmpd <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>chic.filt</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 17 × 8</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">81</span>  <span class="fl">71.2</span> <span class="dv">1998-08-23</span>       <span class="fl">39.6</span>       <span class="dv">59</span>       <span class="fl">45.9</span>      <span class="fl">14.3</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span> <span class="dv">1998-09-06</span>       <span class="fl">31.5</span>       <span class="fl">50.5</span>     <span class="fl">50.7</span>      <span class="fl">20.3</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">82</span>  <span class="fl">72.2</span> <span class="dv">2001-07-20</span>       <span class="fl">32.3</span>       <span class="fl">58.5</span>     <span class="fl">33.0</span>      <span class="fl">33.7</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">84</span>  <span class="fl">72.9</span> <span class="dv">2001-08-01</span>       <span class="fl">43.7</span>       <span class="fl">81.5</span>     <span class="fl">45.2</span>      <span class="fl">27.4</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">85</span>  <span class="fl">72.6</span> <span class="dv">2001-08-08</span>       <span class="fl">38.8</span>       <span class="dv">70</span>       <span class="fl">38.0</span>      <span class="fl">27.6</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">84</span>  <span class="fl">72.6</span> <span class="dv">2001-08-09</span>       <span class="fl">38.2</span>       <span class="dv">66</span>       <span class="fl">36.7</span>      <span class="fl">26.5</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">82</span>  <span class="fl">67.4</span> <span class="dv">2002-06-20</span>       <span class="dv">33</span>         <span class="fl">80.5</span>     <span class="fl">47.4</span>      <span class="fl">30.8</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">82</span>  <span class="fl">63.5</span> <span class="dv">2002-06-23</span>       <span class="fl">42.5</span>       <span class="dv">65</span>       <span class="fl">54.9</span>      <span class="fl">30.0</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span> <span class="dv">2002-07-08</span>       <span class="fl">33.1</span>       <span class="dv">64</span>       <span class="fl">45.3</span>      <span class="fl">27.7</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">82</span>  <span class="fl">66.2</span> <span class="dv">2002-07-18</span>       <span class="fl">38.8</span>       <span class="fl">72.5</span>     <span class="fl">45.0</span>      <span class="fl">26.1</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> chic     <span class="dv">82</span>  <span class="fl">65.1</span> <span class="dv">2003-06-25</span>       <span class="fl">33.9</span>       <span class="dv">66</span>       <span class="fl">56.1</span>      <span class="fl">22.9</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> chic     <span class="dv">84</span>  <span class="fl">68.4</span> <span class="dv">2003-07-04</span>       <span class="fl">32.9</span>       <span class="fl">47.5</span>     <span class="fl">45.7</span>      <span class="fl">21.3</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> chic     <span class="dv">86</span>  <span class="fl">63.4</span> <span class="dv">2005-06-24</span>       <span class="fl">31.9</span>       <span class="dv">74</span>       <span class="fl">51.0</span>      <span class="fl">23.8</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> chic     <span class="dv">82</span>  <span class="fl">64.6</span> <span class="dv">2005-06-27</span>       <span class="fl">51.5</span>       <span class="dv">79</span>       <span class="fl">55.2</span>      <span class="fl">28.5</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> chic     <span class="dv">85</span>  <span class="fl">64.1</span> <span class="dv">2005-06-28</span>       <span class="fl">31.2</span>       <span class="fl">57.5</span>     <span class="fl">50.3</span>      <span class="fl">26.6</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> chic     <span class="dv">84</span>  <span class="dv">67</span>   <span class="dv">2005-07-17</span>       <span class="fl">32.7</span>       <span class="fl">42.5</span>     <span class="fl">44.6</span>      <span class="fl">16.3</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> chic     <span class="dv">84</span>  <span class="dv">69</span>   <span class="dv">2005-08-03</span>       <span class="fl">37.9</span>       <span class="dv">64</span>       <span class="fl">39.3</span>      <span class="fl">23.6</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>chic.filt2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(chicago, pm25tmean2 <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> tmpd <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>chic.filt2</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 17 × 8</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">81</span>  <span class="fl">71.2</span> <span class="dv">1998-08-23</span>       <span class="fl">39.6</span>       <span class="dv">59</span>       <span class="fl">45.9</span>      <span class="fl">14.3</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span> <span class="dv">1998-09-06</span>       <span class="fl">31.5</span>       <span class="fl">50.5</span>     <span class="fl">50.7</span>      <span class="fl">20.3</span></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">82</span>  <span class="fl">72.2</span> <span class="dv">2001-07-20</span>       <span class="fl">32.3</span>       <span class="fl">58.5</span>     <span class="fl">33.0</span>      <span class="fl">33.7</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">84</span>  <span class="fl">72.9</span> <span class="dv">2001-08-01</span>       <span class="fl">43.7</span>       <span class="fl">81.5</span>     <span class="fl">45.2</span>      <span class="fl">27.4</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">85</span>  <span class="fl">72.6</span> <span class="dv">2001-08-08</span>       <span class="fl">38.8</span>       <span class="dv">70</span>       <span class="fl">38.0</span>      <span class="fl">27.6</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">84</span>  <span class="fl">72.6</span> <span class="dv">2001-08-09</span>       <span class="fl">38.2</span>       <span class="dv">66</span>       <span class="fl">36.7</span>      <span class="fl">26.5</span></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">82</span>  <span class="fl">67.4</span> <span class="dv">2002-06-20</span>       <span class="dv">33</span>         <span class="fl">80.5</span>     <span class="fl">47.4</span>      <span class="fl">30.8</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">82</span>  <span class="fl">63.5</span> <span class="dv">2002-06-23</span>       <span class="fl">42.5</span>       <span class="dv">65</span>       <span class="fl">54.9</span>      <span class="fl">30.0</span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span> <span class="dv">2002-07-08</span>       <span class="fl">33.1</span>       <span class="dv">64</span>       <span class="fl">45.3</span>      <span class="fl">27.7</span></span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">82</span>  <span class="fl">66.2</span> <span class="dv">2002-07-18</span>       <span class="fl">38.8</span>       <span class="fl">72.5</span>     <span class="fl">45.0</span>      <span class="fl">26.1</span></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> chic     <span class="dv">82</span>  <span class="fl">65.1</span> <span class="dv">2003-06-25</span>       <span class="fl">33.9</span>       <span class="dv">66</span>       <span class="fl">56.1</span>      <span class="fl">22.9</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> chic     <span class="dv">84</span>  <span class="fl">68.4</span> <span class="dv">2003-07-04</span>       <span class="fl">32.9</span>       <span class="fl">47.5</span>     <span class="fl">45.7</span>      <span class="fl">21.3</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> chic     <span class="dv">86</span>  <span class="fl">63.4</span> <span class="dv">2005-06-24</span>       <span class="fl">31.9</span>       <span class="dv">74</span>       <span class="fl">51.0</span>      <span class="fl">23.8</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> chic     <span class="dv">82</span>  <span class="fl">64.6</span> <span class="dv">2005-06-27</span>       <span class="fl">51.5</span>       <span class="dv">79</span>       <span class="fl">55.2</span>      <span class="fl">28.5</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> chic     <span class="dv">85</span>  <span class="fl">64.1</span> <span class="dv">2005-06-28</span>       <span class="fl">31.2</span>       <span class="fl">57.5</span>     <span class="fl">50.3</span>      <span class="fl">26.6</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> chic     <span class="dv">84</span>  <span class="dv">67</span>   <span class="dv">2005-07-17</span>       <span class="fl">32.7</span>       <span class="fl">42.5</span>     <span class="fl">44.6</span>      <span class="fl">16.3</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> chic     <span class="dv">84</span>  <span class="dv">69</span>   <span class="dv">2005-08-03</span>       <span class="fl">37.9</span>       <span class="dv">64</span>       <span class="fl">39.3</span>      <span class="fl">23.6</span></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(chic.filt, chic.filt2)</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chic.filt, city<span class="sc">:</span>dptp, pm25tmean2, tmpd)</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 17 × 4</span></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp pm25tmean2</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">81</span>  <span class="fl">71.2</span>       <span class="fl">39.6</span></span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span>       <span class="fl">31.5</span></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">82</span>  <span class="fl">72.2</span>       <span class="fl">32.3</span></span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">84</span>  <span class="fl">72.9</span>       <span class="fl">43.7</span></span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">85</span>  <span class="fl">72.6</span>       <span class="fl">38.8</span></span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">84</span>  <span class="fl">72.6</span>       <span class="fl">38.2</span></span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">82</span>  <span class="fl">67.4</span>       <span class="dv">33</span>  </span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">82</span>  <span class="fl">63.5</span>       <span class="fl">42.5</span></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">81</span>  <span class="fl">70.4</span>       <span class="fl">33.1</span></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">82</span>  <span class="fl">66.2</span>       <span class="fl">38.8</span></span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> chic     <span class="dv">82</span>  <span class="fl">65.1</span>       <span class="fl">33.9</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> chic     <span class="dv">84</span>  <span class="fl">68.4</span>       <span class="fl">32.9</span></span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> chic     <span class="dv">86</span>  <span class="fl">63.4</span>       <span class="fl">31.9</span></span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> chic     <span class="dv">82</span>  <span class="fl">64.6</span>       <span class="fl">51.5</span></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> chic     <span class="dv">85</span>  <span class="fl">64.1</span>       <span class="fl">31.2</span></span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> chic     <span class="dv">84</span>  <span class="dv">67</span>         <span class="fl">32.7</span></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> chic     <span class="dv">84</span>  <span class="dv">69</span>         <span class="fl">37.9</span></span></code></pre></div>
<p>If we want to <strong>relate the various conditions</strong> with an
<strong>OR operation</strong>, we have to do that using the
<code>|</code> operator.</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>chic.filt3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(chicago, pm25tmean2 <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">|</span> tmpd <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>chic.filt3</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 379 × 8</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="dv">83</span>    <span class="fl">68.5</span> <span class="dv">1987-06-14</span>         <span class="cn">NA</span>       <span class="fl">43.7</span>     <span class="fl">45.4</span>      <span class="fl">26.0</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="fl">80.5</span>  <span class="fl">62.8</span> <span class="dv">1987-06-18</span>         <span class="cn">NA</span>       <span class="dv">90</span>       <span class="fl">63.0</span>      <span class="fl">43.8</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="fl">80.5</span>  <span class="fl">69.2</span> <span class="dv">1987-07-08</span>         <span class="cn">NA</span>       <span class="dv">38</span>       <span class="fl">30.9</span>      <span class="fl">23.0</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="fl">80.5</span>  <span class="fl">67.6</span> <span class="dv">1987-07-09</span>         <span class="cn">NA</span>       <span class="dv">31</span>       <span class="fl">24.9</span>      <span class="fl">20.2</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="fl">84.5</span>  <span class="fl">73.6</span> <span class="dv">1987-07-19</span>         <span class="cn">NA</span>       <span class="dv">72</span>       <span class="fl">47.1</span>      <span class="fl">13.4</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="fl">81.5</span>  <span class="fl">67.6</span> <span class="dv">1987-07-20</span>         <span class="cn">NA</span>       <span class="fl">65.4</span>     <span class="fl">40.5</span>      <span class="fl">18.5</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="dv">81</span>    <span class="fl">71.2</span> <span class="dv">1987-07-21</span>         <span class="cn">NA</span>       <span class="dv">58</span>       <span class="fl">58.2</span>      <span class="fl">36.6</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="fl">80.5</span>  <span class="fl">69.6</span> <span class="dv">1987-07-22</span>         <span class="cn">NA</span>       <span class="dv">98</span>       <span class="fl">45.3</span>      <span class="fl">36.4</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="dv">82</span>    <span class="dv">70</span>   <span class="dv">1987-07-23</span>         <span class="cn">NA</span>      <span class="dv">117</span>       <span class="fl">59.2</span>      <span class="fl">26.0</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="dv">83</span>    <span class="fl">71.2</span> <span class="dv">1987-07-24</span>         <span class="cn">NA</span>       <span class="dv">79</span>       <span class="fl">35.7</span>      <span class="fl">23.2</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 369 more rows</span></span></code></pre></div>
</div>
<div id="filtering-rows-without-missing-values-in-a-certain-variable."
class="section level4" number="7.2.4.2">
<h4><span class="header-section-number">7.2.4.2</span> Filtering rows
without missing values in a certain variable.</h4>
<p>Finally, we can get only the rows for which the values of a certain
variable are not missing.</p>
<p>We saw early that <code>pm25tmean2</code> variable has a lot of
<code>NA</code>s, so let’s take only the rows of our dataset for which
the values of that variable are not missing.</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(chicago<span class="sc">$</span>pm25tmean2)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">&#39;s </span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="st">   1.70    9.70   14.66   16.23   20.60   61.50    4447 </span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="st">filter(chicago, !is.na(pm25tmean2))</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="st"># A tibble: 2,493 × 8</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="st">   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="st">   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;          &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="st"> 1 chic     48  46.7 1998-01-05       11.5       20.6     2.80      20.9</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="st"> 2 chic     18   7.1 1998-01-11       10.2       30.8     5.71      28.5</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="st"> 3 chic     23  21.9 1998-01-17       38.1       32.5     3.18      25.3</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="st"> 4 chic     28  25.8 1998-01-23       34.0       38.7     1.75      29.4</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="st"> 5 chic     37  30.6 1998-01-29       21.4       30.2     3.10      30.3</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="st"> 6 chic     32  25.6 1998-02-04       13.9       12.8    24.7       14.1</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="st"> 7 chic     39  33.9 1998-02-10       29.5       62.8     4.98      36.2</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="st"> 8 chic     42  35.3 1998-02-16       22.6       33.7    11.4       22.2</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="st"> 9 chic     44  35   1998-02-22       27.8       39.1    11.8       23.3</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="st">10 chic     41  33.2 1998-02-28       16.5       21.2    12.7       28.1</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="st"># … with 2,483 more rows</span></span></code></pre></div>
</div>
<div
id="filtering-complete-cases-rows-without-missing-values-in-all-variables-just-use-generic-functions-na.omit-or-complete.cases.-both-from-stats-package."
class="section level4" number="7.2.4.3">
<h4><span class="header-section-number">7.2.4.3</span> Filtering
complete cases (rows without missing values in all variables): just use
generic functions <code>na.omit()</code> or
<code>complete.cases(.)</code>, both from <code>stats</code>
package.</h4>
<p>Remember that, if we want only the complete observations (rows with
no missing values in neither of the columns), we can just use these
generic functions:</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">na.omit</span>(chicago)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 2,488 × 8</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">48</span>  <span class="fl">46.7</span> <span class="dv">1998-01-05</span>       <span class="fl">11.5</span>       <span class="fl">20.6</span>     <span class="fl">2.80</span>      <span class="fl">20.9</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">18</span>   <span class="fl">7.1</span> <span class="dv">1998-01-11</span>       <span class="fl">10.2</span>       <span class="fl">30.8</span>     <span class="fl">5.71</span>      <span class="fl">28.5</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">23</span>  <span class="fl">21.9</span> <span class="dv">1998-01-17</span>       <span class="fl">38.1</span>       <span class="fl">32.5</span>     <span class="fl">3.18</span>      <span class="fl">25.3</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">28</span>  <span class="fl">25.8</span> <span class="dv">1998-01-23</span>       <span class="fl">34.0</span>       <span class="fl">38.7</span>     <span class="fl">1.75</span>      <span class="fl">29.4</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">37</span>  <span class="fl">30.6</span> <span class="dv">1998-01-29</span>       <span class="fl">21.4</span>       <span class="fl">30.2</span>     <span class="fl">3.10</span>      <span class="fl">30.3</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">32</span>  <span class="fl">25.6</span> <span class="dv">1998-02-04</span>       <span class="fl">13.9</span>       <span class="fl">12.8</span>    <span class="fl">24.7</span>       <span class="fl">14.1</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">39</span>  <span class="fl">33.9</span> <span class="dv">1998-02-10</span>       <span class="fl">29.5</span>       <span class="fl">62.8</span>     <span class="fl">4.98</span>      <span class="fl">36.2</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">42</span>  <span class="fl">35.3</span> <span class="dv">1998-02-16</span>       <span class="fl">22.6</span>       <span class="fl">33.7</span>    <span class="fl">11.4</span>       <span class="fl">22.2</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">44</span>  <span class="dv">35</span>   <span class="dv">1998-02-22</span>       <span class="fl">27.8</span>       <span class="fl">39.1</span>    <span class="fl">11.8</span>       <span class="fl">23.3</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">41</span>  <span class="fl">33.2</span> <span class="dv">1998-02-28</span>       <span class="fl">16.5</span>       <span class="fl">21.2</span>    <span class="fl">12.7</span>       <span class="fl">28.1</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 2,478 more rows</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalently</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>chicago <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 2,488 × 8</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">48</span>  <span class="fl">46.7</span> <span class="dv">1998-01-05</span>       <span class="fl">11.5</span>       <span class="fl">20.6</span>     <span class="fl">2.80</span>      <span class="fl">20.9</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">18</span>   <span class="fl">7.1</span> <span class="dv">1998-01-11</span>       <span class="fl">10.2</span>       <span class="fl">30.8</span>     <span class="fl">5.71</span>      <span class="fl">28.5</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">23</span>  <span class="fl">21.9</span> <span class="dv">1998-01-17</span>       <span class="fl">38.1</span>       <span class="fl">32.5</span>     <span class="fl">3.18</span>      <span class="fl">25.3</span></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">28</span>  <span class="fl">25.8</span> <span class="dv">1998-01-23</span>       <span class="fl">34.0</span>       <span class="fl">38.7</span>     <span class="fl">1.75</span>      <span class="fl">29.4</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">37</span>  <span class="fl">30.6</span> <span class="dv">1998-01-29</span>       <span class="fl">21.4</span>       <span class="fl">30.2</span>     <span class="fl">3.10</span>      <span class="fl">30.3</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">32</span>  <span class="fl">25.6</span> <span class="dv">1998-02-04</span>       <span class="fl">13.9</span>       <span class="fl">12.8</span>    <span class="fl">24.7</span>       <span class="fl">14.1</span></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">39</span>  <span class="fl">33.9</span> <span class="dv">1998-02-10</span>       <span class="fl">29.5</span>       <span class="fl">62.8</span>     <span class="fl">4.98</span>      <span class="fl">36.2</span></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">42</span>  <span class="fl">35.3</span> <span class="dv">1998-02-16</span>       <span class="fl">22.6</span>       <span class="fl">33.7</span>    <span class="fl">11.4</span>       <span class="fl">22.2</span></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">44</span>  <span class="dv">35</span>   <span class="dv">1998-02-22</span>       <span class="fl">27.8</span>       <span class="fl">39.1</span>    <span class="fl">11.8</span>       <span class="fl">23.3</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">41</span>  <span class="fl">33.2</span> <span class="dv">1998-02-28</span>       <span class="fl">16.5</span>       <span class="fl">21.2</span>    <span class="fl">12.7</span>       <span class="fl">28.1</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 2,478 more rows</span></span></code></pre></div>
</div>
</div>
<div id="arrange-function---row-ordering." class="section level3"
number="7.2.5">
<h3><span class="header-section-number">7.2.5</span>
<code>arrange()</code> function - Row ordering.</h3>
<p>The purpose of this function is <strong>reorder the rows of a data
frame based on the values of a column</strong>, while preserving the
order of the columns.</p>
<ul>
<li><p>As we said, we need this function for <em>rows</em> because,
unlike <code>select()</code>, <code>filter()</code> does not order
rows.</p></li>
<li><p>This is something that is <strong>normally a pain to do in
R</strong>. But with <code>arrange()</code> it’s smooth and
straightforward.</p></li>
</ul>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chicago, date)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">arrange</span>(chicago, date))</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 × 8</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>  city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> chic     <span class="dv">35</span>  <span class="fl">29.6</span> <span class="dv">2005-12-26</span>       <span class="fl">8.4</span>         <span class="fl">8.5</span>    <span class="fl">14.0</span>       <span class="fl">16.8</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> chic     <span class="dv">40</span>  <span class="fl">33.6</span> <span class="dv">2005-12-27</span>      <span class="fl">23.6</span>        <span class="dv">27</span>       <span class="fl">4.47</span>      <span class="fl">23.5</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> chic     <span class="dv">37</span>  <span class="fl">34.5</span> <span class="dv">2005-12-28</span>      <span class="fl">17.8</span>        <span class="fl">27.5</span>     <span class="fl">3.26</span>      <span class="fl">19.3</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> chic     <span class="dv">35</span>  <span class="fl">29.4</span> <span class="dv">2005-12-29</span>       <span class="fl">7.45</span>       <span class="fl">23.5</span>     <span class="fl">6.79</span>      <span class="fl">20.0</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> chic     <span class="dv">36</span>  <span class="dv">31</span>   <span class="dv">2005-12-30</span>      <span class="fl">15.1</span>        <span class="fl">19.2</span>     <span class="fl">3.03</span>      <span class="fl">22.8</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> chic     <span class="dv">35</span>  <span class="fl">30.1</span> <span class="dv">2005-12-31</span>      <span class="dv">15</span>          <span class="fl">23.5</span>     <span class="fl">2.53</span>      <span class="fl">13.2</span></span></code></pre></div>
<p>So, <strong>by default</strong>, the ordering is
<strong>ascending</strong>. If we want to change that, we simply use the
<code>disc()</code> command on the ordering variable.</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chicago, <span class="fu">desc</span>(date))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic     <span class="dv">35</span>  <span class="fl">30.1</span> <span class="dv">2005-12-31</span>      <span class="dv">15</span>          <span class="fl">23.5</span>     <span class="fl">2.53</span>      <span class="fl">13.2</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic     <span class="dv">36</span>  <span class="dv">31</span>   <span class="dv">2005-12-30</span>      <span class="fl">15.1</span>        <span class="fl">19.2</span>     <span class="fl">3.03</span>      <span class="fl">22.8</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic     <span class="dv">35</span>  <span class="fl">29.4</span> <span class="dv">2005-12-29</span>       <span class="fl">7.45</span>       <span class="fl">23.5</span>     <span class="fl">6.79</span>      <span class="fl">20.0</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic     <span class="dv">37</span>  <span class="fl">34.5</span> <span class="dv">2005-12-28</span>      <span class="fl">17.8</span>        <span class="fl">27.5</span>     <span class="fl">3.26</span>      <span class="fl">19.3</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic     <span class="dv">40</span>  <span class="fl">33.6</span> <span class="dv">2005-12-27</span>      <span class="fl">23.6</span>        <span class="dv">27</span>       <span class="fl">4.47</span>      <span class="fl">23.5</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic     <span class="dv">35</span>  <span class="fl">29.6</span> <span class="dv">2005-12-26</span>       <span class="fl">8.4</span>         <span class="fl">8.5</span>    <span class="fl">14.0</span>       <span class="fl">16.8</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic     <span class="dv">35</span>  <span class="fl">32.1</span> <span class="dv">2005-12-25</span>       <span class="fl">6.7</span>         <span class="dv">8</span>      <span class="fl">14.4</span>       <span class="fl">13.8</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic     <span class="dv">37</span>  <span class="fl">35.2</span> <span class="dv">2005-12-24</span>      <span class="fl">30.8</span>        <span class="fl">25.2</span>     <span class="fl">1.77</span>      <span class="fl">32.0</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic     <span class="dv">41</span>  <span class="fl">32.6</span> <span class="dv">2005-12-23</span>      <span class="fl">32.9</span>        <span class="fl">34.5</span>     <span class="fl">6.91</span>      <span class="fl">29.1</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic     <span class="dv">22</span>  <span class="fl">23.3</span> <span class="dv">2005-12-22</span>      <span class="fl">36.6</span>        <span class="fl">42.5</span>     <span class="fl">5.39</span>      <span class="fl">33.7</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">arrange</span>(chicago, <span class="fu">desc</span>(date)))</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 × 8</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span></code></pre></div>
<div id="breaking-ties." class="section level4" number="7.2.5.1">
<h4><span class="header-section-number">7.2.5.1</span> Breaking
ties.</h4>
<p>We can also arrange the data according to the values of
<strong>multiple variables</strong>, indicating them <strong>separated
by commas</strong>.</p>
<p>This means that if there are <em>multiple rows</em> with the
<strong>same value for the first variable</strong>, they will be
<strong>sorted by the second variable</strong>, and so forth.</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>chicago</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>  <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>    <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>    <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>    <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>    <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>    <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>  <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>    <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>  <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>  <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(chicago, <span class="fu">desc</span>(tmpd), dptp)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 8</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>   city   tmpd  dptp date       pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="dv">92</span>    <span class="fl">76.4</span> <span class="dv">1995-07-13</span>       <span class="cn">NA</span>         <span class="fl">92.5</span>     <span class="fl">58.5</span>      <span class="fl">27.3</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="fl">91.5</span>  <span class="fl">75.6</span> <span class="dv">1995-07-14</span>       <span class="cn">NA</span>         <span class="fl">54.5</span>     <span class="fl">52.0</span>      <span class="fl">24.8</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">90</span>    <span class="fl">70.9</span> <span class="dv">2005-07-24</span>       <span class="fl">22.0</span>       <span class="dv">44</span>       <span class="fl">47.6</span>      <span class="fl">12.0</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">90</span>    <span class="fl">77.1</span> <span class="dv">1999-07-30</span>       <span class="cn">NA</span>         <span class="dv">54</span>       <span class="fl">34.2</span>      <span class="fl">27.5</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="fl">89.5</span>  <span class="fl">70.4</span> <span class="dv">1988-08-02</span>       <span class="cn">NA</span>         <span class="dv">67</span>       <span class="fl">49.8</span>      <span class="fl">25.9</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">89</span>    <span class="fl">71.1</span> <span class="dv">1988-08-01</span>       <span class="cn">NA</span>         <span class="fl">67.2</span>     <span class="fl">44.1</span>      <span class="fl">26.0</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">88.5</span>  <span class="fl">70.2</span> <span class="dv">1988-06-20</span>       <span class="cn">NA</span>         <span class="dv">88</span>       <span class="fl">61.7</span>      <span class="fl">25.6</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">88</span>    <span class="fl">66.4</span> <span class="dv">1988-08-17</span>       <span class="cn">NA</span>         <span class="dv">71</span>       <span class="fl">39.3</span>      <span class="fl">23.5</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="dv">88</span>    <span class="fl">67.4</span> <span class="dv">1988-08-03</span>       <span class="cn">NA</span>         <span class="dv">65</span>       <span class="fl">40.6</span>      <span class="fl">27.7</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="dv">88</span>    <span class="fl">71.2</span> <span class="dv">1991-07-22</span>       <span class="cn">NA</span>         <span class="dv">70</span>       <span class="fl">34.9</span>      <span class="fl">24.6</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
</div>
</div>
<div id="rename-function." class="section level3" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span>
<code>rename()</code> function.</h3>
<p>This is a very simple function. It <strong>just renames
variables</strong> of a data frame in R.</p>
<ul>
<li>But, <em>actually</em>, this is a <strong>surprisingly hard and
annoying</strong> thing to do in R if we don’t have a function like
<code>rename</code>.</li>
</ul>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>chicago2 <span class="ot">&lt;-</span> chicago[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ]</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(chicago2)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;city&quot;</span>       <span class="st">&quot;tmpd&quot;</span>       <span class="st">&quot;dptp&quot;</span>       <span class="st">&quot;date&quot;</span>       <span class="st">&quot;pm25tmean2&quot;</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>] <span class="st">&quot;pm10tmean2&quot;</span> <span class="st">&quot;o3tmean2&quot;</span>   <span class="st">&quot;no2tmean2&quot;</span> </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>chicago2 <span class="ot">&lt;-</span> <span class="fu">rename</span>(chicago2,  <span class="at">dewpoint =</span> dptp,  <span class="at">pm10 =</span> pm10tmean2)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>chicago2</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 8</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>   city   tmpd dewpoint date       pm25tmean2  pm10 o3tmean2 no2tmean2</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>     <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>  <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>       <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>       <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>  <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>       <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>  <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>       <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>       <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>  <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>     <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>  <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>       <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>  <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>     <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>  <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>     <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows</span></span></code></pre></div>
</div>
<div id="the-mutate-function-and-its-related-transmute-function."
class="section level3" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> The
<code>mutate()</code> function and it’s related <code>transmute()</code>
function.</h3>
<p><code>mutate()</code> function is used to <strong>transform existing
variables</strong> or to <strong>create new variables</strong>.</p>
<ul>
<li>For instance, it’s very common to create a new variable
<strong>based on the value of one or more</strong> <strong>variables
already in a dataset</strong>.</li>
</ul>
<p>Let’s <em>create a new variable</em> <code>pm10detrend</code> in our
data frame that represents “the deviation from the center” of another
existing varialbe <code>pm10</code> (we do that by substructing it’s
<code>mean</code>).</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>chicago2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chicago2, <span class="at">pm10detrend =</span> pm10 <span class="sc">-</span> <span class="fu">mean</span>(pm10, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>chicago2</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 9</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>   city   tmpd dewpoint date       pm25tmean2  pm10 o3tmean2 no2tmean2</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>     <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>  <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>       <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>       <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>  <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>       <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>  <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>       <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>       <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>  <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>     <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>  <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>       <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>  <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>     <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>  <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>     <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows, and 1 more variable: pm10detrend &lt;dbl&gt;</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago2, pm10, pm10detrend)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 2</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>    pm10 pm10detrend</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">34</span>        <span class="sc">-</span><span class="fl">7.34</span> </span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="cn">NA</span>        <span class="cn">NA</span>    </span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">34.2</span>      <span class="sc">-</span><span class="fl">7.17</span> </span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">47</span>         <span class="fl">5.66</span> </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="cn">NA</span>        <span class="cn">NA</span>    </span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">48</span>         <span class="fl">6.66</span> </span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">41</span>        <span class="sc">-</span><span class="fl">0.341</span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">36</span>        <span class="sc">-</span><span class="fl">5.34</span> </span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">33.3</span>      <span class="sc">-</span><span class="fl">8.05</span> </span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="cn">NA</span>        <span class="cn">NA</span>    </span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows</span></span></code></pre></div>
<ul>
<li>That way we can see at whether a given day’s air pollution level is
higher than or less than average (as opposed to looking at its absolute
level).</li>
</ul>
<p>The related <code>transmute()</code> function <strong>does the same
thing</strong> as <code>mutate()</code> but then <strong>drops</strong>
<strong>all non-transformed variables</strong>.</p>
<p>Here we <em>detrend</em> the <code>pm10</code> and <code>ozone</code>
(O3) variables:</p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(chicago2,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">pm10detrend =</span> pm10 <span class="sc">-</span> <span class="fu">mean</span>(pm10, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">o3detrend =</span> o3tmean2 <span class="sc">-</span> <span class="fu">mean</span>(o3tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 2</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>   pm10detrend o3detrend</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>         <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>      <span class="sc">-</span><span class="fl">7.34</span>     <span class="sc">-</span><span class="fl">11.4</span> </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>      <span class="cn">NA</span>        <span class="sc">-</span><span class="fl">12.3</span> </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>      <span class="sc">-</span><span class="fl">7.17</span>     <span class="sc">-</span><span class="fl">12.3</span> </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>       <span class="fl">5.66</span>     <span class="sc">-</span><span class="fl">11.3</span> </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>      <span class="cn">NA</span>        <span class="sc">-</span><span class="fl">10.9</span> </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>       <span class="fl">6.66</span>      <span class="sc">-</span><span class="fl">9.79</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>      <span class="sc">-</span><span class="fl">0.341</span>     <span class="sc">-</span><span class="fl">6.34</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>      <span class="sc">-</span><span class="fl">5.34</span>      <span class="sc">-</span><span class="fl">4.34</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>      <span class="sc">-</span><span class="fl">8.05</span>     <span class="sc">-</span><span class="fl">11.1</span> </span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>      <span class="cn">NA</span>        <span class="sc">-</span><span class="fl">10.7</span> </span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows</span></span></code></pre></div>
<div
id="using-the-computed-value-of-a-column-to-create-other-columns-all-in-the-same-statment."
class="section level4" number="7.2.7.1">
<h4><span class="header-section-number">7.2.7.1</span> Using the
computed value of a column to create other columns, all in the same
statment.</h4>
<p>One very nice feature of <code>mutate()</code> is that you can use
the value computed for a column to create another column, all <strong>in
the same line of code</strong>.</p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>chicago2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chicago2, <span class="at">pm10detrend2 =</span> pm10 <span class="sc">-</span> <span class="fu">median</span>(pm10, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pm10detrend3 =</span> <span class="fu">abs</span>(pm10detrend <span class="sc">-</span> pm10detrend2))</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>chicago2</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 11</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>   city   tmpd dewpoint date       pm25tmean2  pm10 o3tmean2 no2tmean2</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> chic   <span class="fl">31.5</span>     <span class="fl">31.5</span> <span class="dv">1987-01-01</span>         <span class="cn">NA</span>  <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> chic   <span class="dv">33</span>       <span class="fl">29.9</span> <span class="dv">1987-01-02</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> chic   <span class="dv">33</span>       <span class="fl">27.4</span> <span class="dv">1987-01-03</span>         <span class="cn">NA</span>  <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> chic   <span class="dv">29</span>       <span class="fl">28.6</span> <span class="dv">1987-01-04</span>         <span class="cn">NA</span>  <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> chic   <span class="dv">32</span>       <span class="fl">28.9</span> <span class="dv">1987-01-05</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> chic   <span class="dv">40</span>       <span class="fl">35.1</span> <span class="dv">1987-01-06</span>         <span class="cn">NA</span>  <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> chic   <span class="fl">34.5</span>     <span class="fl">26.8</span> <span class="dv">1987-01-07</span>         <span class="cn">NA</span>  <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> chic   <span class="dv">29</span>       <span class="dv">22</span>   <span class="dv">1987-01-08</span>         <span class="cn">NA</span>  <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> chic   <span class="fl">26.5</span>     <span class="dv">29</span>   <span class="dv">1987-01-09</span>         <span class="cn">NA</span>  <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> chic   <span class="fl">32.5</span>     <span class="fl">27.8</span> <span class="dv">1987-01-10</span>         <span class="cn">NA</span>  <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows, and 3 more variables: pm10detrend &lt;dbl&gt;,</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   pm10detrend2 &lt;dbl&gt;, pm10detrend3 &lt;dbl&gt;</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago2, pm10, pm10detrend, pm10detrend2, pm10detrend3)</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 100 × 4</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>    pm10 pm10detrend pm10detrend2 pm10detrend3</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>        <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>        <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">34</span>        <span class="sc">-</span><span class="fl">7.34</span>         <span class="sc">-</span><span class="dv">5</span>            <span class="fl">2.34</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="cn">NA</span>        <span class="cn">NA</span>            <span class="cn">NA</span>           <span class="cn">NA</span>   </span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="fl">34.2</span>      <span class="sc">-</span><span class="fl">7.17</span>         <span class="sc">-</span><span class="fl">4.83</span>         <span class="fl">2.34</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">47</span>         <span class="fl">5.66</span>          <span class="dv">8</span>            <span class="fl">2.34</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="cn">NA</span>        <span class="cn">NA</span>            <span class="cn">NA</span>           <span class="cn">NA</span>   </span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">48</span>         <span class="fl">6.66</span>          <span class="dv">9</span>            <span class="fl">2.34</span></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">41</span>        <span class="sc">-</span><span class="fl">0.341</span>         <span class="dv">2</span>            <span class="fl">2.34</span></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">36</span>        <span class="sc">-</span><span class="fl">5.34</span>         <span class="sc">-</span><span class="dv">3</span>            <span class="fl">2.34</span></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">33.3</span>      <span class="sc">-</span><span class="fl">8.05</span>         <span class="sc">-</span><span class="fl">5.71</span>         <span class="fl">2.34</span></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="cn">NA</span>        <span class="cn">NA</span>            <span class="cn">NA</span>           <span class="cn">NA</span>   </span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 90 more rows</span></span></code></pre></div>
</div>
</div>
<div id="group_by-and-summarizesummarise-functions."
class="section level3" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span>
<code>group_by()</code> and
<code>summarize()</code>/<code>summarise()</code> functions.</h3>
<p>With these functions we can <strong>generate summary statistics by
stratum or groups</strong>.</p>
<ul>
<li><p>The <code>group_by()</code> function allows us to,
<strong><em>essentially behind the scenes</em></strong>, <strong>split a
data frame</strong> according to certain <strong>categorical
variables</strong>.</p>
<ul>
<li><p>In other words, <code>group_by()</code> <strong>breaks
up</strong> a given dataset into <strong>groups of rows</strong> based
on the <strong>values of one or more variables</strong>.</p></li>
<li><p>It <strong>returns</strong> a data frame with class
<code>grouped_df</code>.</p></li>
<li><p>The description of the help file, states as follows: most data
operations are done on groups defined by variables.
<code>group_by()</code> takes an existing table and converts it into a
grouped table where operations are performed “by group”.</p></li>
<li><p><code>ungroup()</code> <strong>removes
grouping</strong>.</p></li>
</ul></li>
<li><p>Once we have our <strong>data frame organized or splitted by
stratums or gropus</strong>, we can give it to the
<code>summarize()</code> function where we can specify the statisctics
by groups we want to perform.</p>
<ul>
<li>We can also use the <strong><code>s</code> spelling</strong>
version: <code>summarise()</code>, it’s the same.</li>
</ul></li>
</ul>
<div id="example-0-summarize-alone-without-group_by-not-so-interesting."
class="section level4" number="7.2.8.1">
<h4><span class="header-section-number">7.2.8.1</span> Example 0:
<code>summarize()</code> alone (without <code>group_by()</code>), not so
interesting.</h4>
<p>If we pass to <code>summarize()</code> function a plain (not grouped)
dataset, it will <strong>collapse the dataset</strong> <strong>to a
single row</strong>.</p>
<p>For example, let’s say we’re interested in knowing some statistics
about the point of dew (dptp). We could proceed as follows:</p>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(chicago,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean_dptp =</span> <span class="fu">mean</span>(dptp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">max_dptp =</span> <span class="fu">max</span>(dptp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">median_dptp =</span> <span class="fu">median</span>(dptp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1 × 3</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  mean_dptp max_dptp median_dptp</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>      <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="fl">40.3</span>     <span class="fl">78.2</span>        <span class="fl">39.9</span></span></code></pre></div>
<p>That’s <em>not particularly interesting</em>.
<code>summarize()</code> is <strong>most useful when working with
data</strong> that has been <strong>grouped by the values of a
particular variable</strong>.</p>
</div>
<div id="example-1-grouping-statistics-by-a-factor-variable."
class="section level4" number="7.2.8.2">
<h4><span class="header-section-number">7.2.8.2</span> Example 1:
grouping statistics by a factor variable.</h4>
<p>So let’s start creating a <strong>factor variable</strong> (a
<em>temperature</em> <strong><em>category</em></strong>
<em>variable</em> called <code>tempcat</code>) which will indicate
whether a given day was <code>"hot"</code> or <code>"cold"</code>,
depending on whether the temperature was over 80 degrees or not.</p>
<p>Then use the <code>group_by()</code> command to create a new data
frame, called <code>hotcold</code>, based on the original one and in the
previous factor variable as grouping variable.</p>
<p>Finally, use the <code>summarize()</code> function to make some
statistics by the two groups, <code>cold</code> and <code>hot</code>,
within the <code>hotcold</code> data frame.</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(chicago)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;city&quot;</span>       <span class="st">&quot;tmpd&quot;</span>       <span class="st">&quot;dptp&quot;</span>       <span class="st">&quot;date&quot;</span>       <span class="st">&quot;pm25tmean2&quot;</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>] <span class="st">&quot;pm10tmean2&quot;</span> <span class="st">&quot;o3tmean2&quot;</span>   <span class="st">&quot;no2tmean2&quot;</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chicago,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tempcat =</span> <span class="fu">factor</span>(<span class="dv">1</span> <span class="sc">*</span> (tmpd <span class="sc">&gt;</span> <span class="dv">80</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;cold&quot;</span>, <span class="st">&quot;hot&quot;</span>)) )<span class="co"># 1*TRUE==1; 1*FALSE==0; </span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, tmpd, pm25tmean2, o3tmean2, no2tmean2, tempcat)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    tmpd pm25tmean2 o3tmean2 no2tmean2 tempcat</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>  </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>     <span class="fl">4.25</span>      <span class="fl">20.0</span> cold   </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.30</span>      <span class="fl">23.2</span> cold   </span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span> cold   </span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>           <span class="cn">NA</span>     <span class="fl">4.38</span>      <span class="fl">30.4</span> cold   </span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>           <span class="cn">NA</span>     <span class="fl">4.75</span>      <span class="fl">30.3</span> cold   </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>           <span class="cn">NA</span>     <span class="fl">5.83</span>      <span class="fl">25.8</span> cold   </span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>         <span class="cn">NA</span>     <span class="fl">9.29</span>      <span class="fl">20.6</span> cold   </span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>           <span class="cn">NA</span>    <span class="fl">11.3</span>       <span class="fl">17.0</span> cold   </span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>         <span class="cn">NA</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span> cold   </span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>         <span class="cn">NA</span>     <span class="fl">4.96</span>      <span class="fl">19.5</span> cold   </span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>hotcold <span class="ot">&lt;-</span> <span class="fu">group_by</span>(chicago, tempcat)</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hotcold)                                                       <span class="co"># a &quot;grouped_df&quot;</span></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;grouped_df&quot;</span> <span class="st">&quot;tbl_df&quot;</span>     <span class="st">&quot;tbl&quot;</span>        <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(hotcold, tmpd, pm25tmean2, o3tmean2, no2tmean2, tempcat)      <span class="co"># grouped &quot;behind the scenes&quot;</span></span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   tempcat [3]</span></span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>    tmpd pm25tmean2 o3tmean2 no2tmean2 tempcat</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>  </span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>     <span class="fl">4.25</span>      <span class="fl">20.0</span> cold   </span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.30</span>      <span class="fl">23.2</span> cold   </span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span> cold   </span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>           <span class="cn">NA</span>     <span class="fl">4.38</span>      <span class="fl">30.4</span> cold   </span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>           <span class="cn">NA</span>     <span class="fl">4.75</span>      <span class="fl">30.3</span> cold   </span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>           <span class="cn">NA</span>     <span class="fl">5.83</span>      <span class="fl">25.8</span> cold   </span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>         <span class="cn">NA</span>     <span class="fl">9.29</span>      <span class="fl">20.6</span> cold   </span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>           <span class="cn">NA</span>    <span class="fl">11.3</span>       <span class="fl">17.0</span> cold   </span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>         <span class="cn">NA</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span> cold   </span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>         <span class="cn">NA</span>     <span class="fl">4.96</span>      <span class="fl">19.5</span> cold   </span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean pm25, max ozone and median nitrogen dioxide in &quot;cold&quot; and &quot;hot&quot; days.</span></span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(hotcold,</span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">pm25 =</span> <span class="fu">mean</span>(pm25tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">o3 =</span> <span class="fu">max</span>(o3tmean2),</span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">no2 =</span> <span class="fu">median</span>(no2tmean2))</span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 × 4</span></span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true" tabindex="-1"></a>  tempcat  pm25    o3   no2</span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> cold     <span class="fl">16.0</span> <span class="fl">66.6</span>   <span class="fl">24.5</span></span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> hot      <span class="fl">26.5</span> <span class="fl">63.0</span>   <span class="fl">24.9</span></span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="fl">47.7</span>  <span class="fl">9.42</span>  <span class="fl">37.4</span></span></code></pre></div>
<ul>
<li><p><em>Notice 1:</em> we can see at the top of the console output
for <code>hotcold</code> tibble, that this table has been grouped by the
<code>tempcat</code> variable. <strong>Everything else looks the
same</strong>, but now <em>any operation</em> we apply to the grouped
data will take plase <em>on a per <code>tempcat</code>
basis</em>.</p></li>
<li><p><em>Notice 2:</em> There’re missing value in the
<code>pm25tmean2</code> variable:</p></li>
</ul>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(hotcold<span class="sc">$</span>pm25tmean2))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">4447</span></span></code></pre></div>
<ul>
<li><p>So we need to set <code>na.rm = TRUE</code> in order to get the
mean of the groups but ignoring the missing values.</p></li>
<li><p>We can see then, for instance, that <code>pm25</code> <em>tends
to be lower</em> when it’s <em>cold</em> and <em>higher</em> when it’s
<em>hot</em>.</p></li>
</ul>
</div>
<div id="example-2-grouping-statistics-by-non-factor-varaibles."
class="section level4" number="7.2.8.3">
<h4><span class="header-section-number">7.2.8.3</span> Example 2:
grouping statistics by non factor varaibles.</h4>
<p>We could also categorize the dataset on other variables that are not
originally <em>factors</em>, for example we might want to do a
<strong>summary for each year</strong> in the dataset.</p>
<p>So we can use <code>mutate()</code> to create a <strong>new
<code>year</code> variable</strong>. We can extract the
<code>year</code> information from the <code>date</code> variable by
using the <code>as.POSIXlt()</code> function. This is going to be our
<strong>grouping variable</strong> and it is a <strong>numeric
variable</strong>, not a factor.</p>
<p>We group the <code>chicago</code> data set by that <code>year</code>
variable, creating a new <code>years</code> data frame.</p>
<p>Finally, we’ll use the <code>summarize()</code> function in the same
way to get a summary for each of the three different pollutant variables
(pm, ozone and nitrogen dioxide) <strong>for each of the years</strong>
in the data set.</p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chicago,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">year =</span> <span class="fu">as.POSIXlt</span>(date)<span class="sc">$</span>year <span class="sc">+</span> <span class="dv">1900</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, tmpd, pm25tmean2, o3tmean2, no2tmean2, year)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    tmpd pm25tmean2 o3tmean2 no2tmean2  year</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>     <span class="fl">4.25</span>      <span class="fl">20.0</span>  <span class="dv">1987</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.30</span>      <span class="fl">23.2</span>  <span class="dv">1987</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span>  <span class="dv">1987</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>           <span class="cn">NA</span>     <span class="fl">4.38</span>      <span class="fl">30.4</span>  <span class="dv">1987</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>           <span class="cn">NA</span>     <span class="fl">4.75</span>      <span class="fl">30.3</span>  <span class="dv">1987</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>           <span class="cn">NA</span>     <span class="fl">5.83</span>      <span class="fl">25.8</span>  <span class="dv">1987</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>         <span class="cn">NA</span>     <span class="fl">9.29</span>      <span class="fl">20.6</span>  <span class="dv">1987</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>           <span class="cn">NA</span>    <span class="fl">11.3</span>       <span class="fl">17.0</span>  <span class="dv">1987</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>         <span class="cn">NA</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span>  <span class="dv">1987</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>         <span class="cn">NA</span>     <span class="fl">4.96</span>      <span class="fl">19.5</span>  <span class="dv">1987</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">group_by</span>(chicago, year)</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(years, tmpd, pm25tmean2, o3tmean2, no2tmean2, year)         <span class="co"># grouped &quot;behind the scenes&quot;</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   year [19]</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>    tmpd pm25tmean2 o3tmean2 no2tmean2  year</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="fl">31.5</span>         <span class="cn">NA</span>     <span class="fl">4.25</span>      <span class="fl">20.0</span>  <span class="dv">1987</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.30</span>      <span class="fl">23.2</span>  <span class="dv">1987</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">33</span>           <span class="cn">NA</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span>  <span class="dv">1987</span></span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">29</span>           <span class="cn">NA</span>     <span class="fl">4.38</span>      <span class="fl">30.4</span>  <span class="dv">1987</span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">32</span>           <span class="cn">NA</span>     <span class="fl">4.75</span>      <span class="fl">30.3</span>  <span class="dv">1987</span></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">40</span>           <span class="cn">NA</span>     <span class="fl">5.83</span>      <span class="fl">25.8</span>  <span class="dv">1987</span></span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="fl">34.5</span>         <span class="cn">NA</span>     <span class="fl">9.29</span>      <span class="fl">20.6</span>  <span class="dv">1987</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">29</span>           <span class="cn">NA</span>    <span class="fl">11.3</span>       <span class="fl">17.0</span>  <span class="dv">1987</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="fl">26.5</span>         <span class="cn">NA</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span>  <span class="dv">1987</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">32.5</span>         <span class="cn">NA</span>     <span class="fl">4.96</span>      <span class="fl">19.5</span>  <span class="dv">1987</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean pm25, max ozone and median nitrogen dioxide for each year.</span></span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(years,</span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">pm25 =</span> <span class="fu">mean</span>(pm25tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">o3 =</span> <span class="fu">max</span>(o3tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">no2 =</span> <span class="fu">median</span>(no2tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 19 × 4</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a>    year  pm25    o3   no2</span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">1987</span> <span class="cn">NaN</span>    <span class="fl">63.0</span>  <span class="fl">23.5</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">1988</span> <span class="cn">NaN</span>    <span class="fl">61.7</span>  <span class="fl">24.5</span></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1989</span> <span class="cn">NaN</span>    <span class="fl">59.7</span>  <span class="fl">26.1</span></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">1990</span> <span class="cn">NaN</span>    <span class="fl">52.2</span>  <span class="fl">22.6</span></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">1991</span> <span class="cn">NaN</span>    <span class="fl">63.1</span>  <span class="fl">21.4</span></span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">1992</span> <span class="cn">NaN</span>    <span class="fl">50.8</span>  <span class="fl">24.8</span></span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1993</span> <span class="cn">NaN</span>    <span class="fl">44.3</span>  <span class="fl">25.8</span></span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">1994</span> <span class="cn">NaN</span>    <span class="fl">52.2</span>  <span class="fl">28.5</span></span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">1995</span> <span class="cn">NaN</span>    <span class="fl">66.6</span>  <span class="fl">27.3</span></span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1996</span> <span class="cn">NaN</span>    <span class="fl">58.4</span>  <span class="fl">26.4</span></span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">1997</span> <span class="cn">NaN</span>    <span class="fl">56.5</span>  <span class="fl">25.5</span></span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">1998</span>  <span class="fl">18.3</span>  <span class="fl">50.7</span>  <span class="fl">24.6</span></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">1999</span>  <span class="fl">18.5</span>  <span class="fl">57.5</span>  <span class="fl">24.7</span></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">2000</span>  <span class="fl">16.9</span>  <span class="fl">55.8</span>  <span class="fl">23.5</span></span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="dv">2001</span>  <span class="fl">16.9</span>  <span class="fl">51.8</span>  <span class="fl">25.1</span></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>  <span class="dv">2002</span>  <span class="fl">15.3</span>  <span class="fl">54.9</span>  <span class="fl">22.7</span></span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">2003</span>  <span class="fl">15.2</span>  <span class="fl">56.2</span>  <span class="fl">24.6</span></span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  <span class="dv">2004</span>  <span class="fl">14.6</span>  <span class="fl">44.5</span>  <span class="fl">23.4</span></span>
<span id="cb113-65"><a href="#cb113-65" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  <span class="dv">2005</span>  <span class="fl">16.2</span>  <span class="fl">58.8</span>  <span class="fl">22.6</span></span></code></pre></div>
<ul>
<li>We can see that, in general, there’s a kind of a downward trend over
time.</li>
</ul>
<p>Let’s make a <strong>slightly more complicated example</strong>.</p>
<p>Suppose we want to know what are the <em>average levels</em> of ozone
(o3) and nitrogen dioxide (no2) <em>within quantiles</em> of pm25.</p>
<ul>
<li><p>A slicker way to do this would be through a regression model, but
we can actually do this <em>quickly</em> with <code>group_by()</code>
and <code>summarize()</code>.</p></li>
<li><p>First, let’s <strong>create a variable of pm25 divided into
quantiles</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>qq <span class="ot">&lt;-</span> <span class="fu">quantile</span>(chicago<span class="sc">$</span>pm25tmean2, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>qq</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="sc">%    20%</span>    <span class="dv">40</span><span class="sc">%    60%</span>    <span class="dv">80</span><span class="sc">%   100%</span> </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a> <span class="fl">1.700</span>  <span class="fl">8.700</span> <span class="fl">12.375</span> <span class="fl">16.700</span> <span class="fl">22.610</span> <span class="fl">61.500</span> </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>chicago <span class="ot">&lt;-</span> <span class="fu">mutate</span>(chicago, <span class="at">pm25.quint =</span> <span class="fu">cut</span>(pm25tmean2, qq))</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(chicago, <span class="fu">matches</span>(<span class="st">&quot;^[pon]&quot;</span>))</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,940 × 5</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>   pm25tmean2 pm10tmean2 o3tmean2 no2tmean2 pm25.quint</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>     </span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>         <span class="cn">NA</span>       <span class="dv">34</span>       <span class="fl">4.25</span>      <span class="fl">20.0</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">3.30</span>      <span class="fl">23.2</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>         <span class="cn">NA</span>       <span class="fl">34.2</span>     <span class="fl">3.33</span>      <span class="fl">23.8</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>         <span class="cn">NA</span>       <span class="dv">47</span>       <span class="fl">4.38</span>      <span class="fl">30.4</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.75</span>      <span class="fl">30.3</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>         <span class="cn">NA</span>       <span class="dv">48</span>       <span class="fl">5.83</span>      <span class="fl">25.8</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>         <span class="cn">NA</span>       <span class="dv">41</span>       <span class="fl">9.29</span>      <span class="fl">20.6</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>         <span class="cn">NA</span>       <span class="dv">36</span>      <span class="fl">11.3</span>       <span class="fl">17.0</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>         <span class="cn">NA</span>       <span class="fl">33.3</span>     <span class="fl">4.5</span>       <span class="fl">23.4</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>         <span class="cn">NA</span>       <span class="cn">NA</span>       <span class="fl">4.96</span>      <span class="fl">19.5</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      </span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,930 more rows</span></span></code></pre></div>
<ul>
<li>Now we can <strong>group the data frame</strong> by the
<code>pm25.quint</code> variable and then <strong>compute</strong> the
<strong>mean of o3 and no2 within quintiles of pm25</strong>.</li>
</ul>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>quint <span class="ot">&lt;-</span> <span class="fu">group_by</span>(chicago, pm25.quint)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(quint,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">o3 =</span> <span class="fu">mean</span>(o3tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">no2 =</span> <span class="fu">mean</span>(no2tmean2, <span class="at">ra.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 × 3</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  pm25.quint     o3   no2</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> (<span class="fl">1.7</span>,<span class="fl">8.7</span>]    <span class="fl">21.7</span>  <span class="fl">18.0</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> (<span class="fl">8.7</span>,<span class="fl">12.4</span>]   <span class="fl">20.4</span>  <span class="fl">22.1</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> (<span class="fl">12.4</span>,<span class="fl">16.7</span>]  <span class="fl">20.7</span>  <span class="fl">24.4</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> (<span class="fl">16.7</span>,<span class="fl">22.6</span>]  <span class="fl">19.9</span>  <span class="fl">27.3</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> (<span class="fl">22.6</span>,<span class="fl">61.5</span>]  <span class="fl">20.3</span>  <span class="fl">29.6</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>         <span class="fl">18.8</span>  <span class="fl">25.8</span></span></code></pre></div>
<ul>
<li><p>It <strong>seems</strong> there <em>isn’t a strong
relationship</em> between <code>pm25</code> and
<code>o3</code>.</p></li>
<li><p>But there <strong>appears</strong> to be a <em>positive
correlation</em> between <code>pm25</code> and
<code>no2</code>.</p></li>
<li><p>More sophisticated statistical modeling can help to provide
precise answers to these questions, but <strong>a simple application of
<code>dplyr</code> functions</strong> can often <em>get us most</em>
<em>of the way there</em>.</p></li>
</ul>
</div>
<div
id="example-3-special-dplyr-commands-for-counting-n-and-unique-values-n_distinct."
class="section level4" number="7.2.8.4">
<h4><span class="header-section-number">7.2.8.4</span> Example 3:
special <code>dplyr</code> commands for counting (<code>n()</code>) and
unique values (<code>n_distinct()</code>).</h4>
<p>The <code>n()</code> command computes the <strong>number of
observations</strong> in the <strong>current group</strong>.</p>
<ul>
<li>This function is implemented specifically for each data source and
<strong>can only be used</strong> <strong>from within
<code>summarize()</code>, <code>mutate()</code> and
<code>filter()</code></strong>.</li>
</ul>
<p>The <code>n_distinct()</code> command <strong>efficiently
counts</strong> the <strong>number of unique values</strong> in a
<strong>set of vector</strong>.</p>
<ul>
<li>This is a <strong>faster and more concise</strong> equivalent of
<code>length(unique(x))</code>.</li>
</ul>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(years,</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_city =</span> <span class="fu">n_distinct</span>(city),</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_pm25 =</span> <span class="fu">n_distinct</span>(pm25tmean2))</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 19 × 4</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    year count unique_city unique_pm25</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span>       <span class="er">&lt;</span>int<span class="sc">&gt;</span>       <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">1987</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">1988</span>   <span class="dv">366</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1989</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">1990</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">1991</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">1992</span>   <span class="dv">366</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1993</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">1994</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">1995</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1996</span>   <span class="dv">366</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">1997</span>   <span class="dv">365</span>           <span class="dv">1</span>           <span class="dv">1</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">1998</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">188</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">1999</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">100</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">2000</span>   <span class="dv">366</span>           <span class="dv">1</span>         <span class="dv">293</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="dv">2001</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">296</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>  <span class="dv">2002</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">279</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">2003</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">264</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  <span class="dv">2004</span>   <span class="dv">366</span>           <span class="dv">1</span>         <span class="dv">277</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  <span class="dv">2005</span>   <span class="dv">365</span>           <span class="dv">1</span>         <span class="dv">265</span></span></code></pre></div>
</div>
<div id="example-4-applying-functions-to-a-set-of-columns-with-across."
class="section level4" number="7.2.8.5">
<h4><span class="header-section-number">7.2.8.5</span> Example 4:
applying functions to a set of columns with <code>across()</code>.</h4>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(across)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">.cols =</span> <span class="fu">everything</span>(), <span class="at">.fns =</span> <span class="cn">NULL</span>, ..., <span class="at">.names =</span> <span class="cn">NULL</span>)  </span></code></pre></div>
<ul>
<li><p>This function makes it easy to <strong>apply the same
transformation</strong> to <strong>multiple columns</strong>, allowing
us to use <em><code>select</code> semantics</em> <strong>inside
<code>summarise()</code> and <code>mutate()</code></strong> and avoid
copying and pasting (which is both tedious and error prone):<br />
<code>df &lt;- some data frame with four numeric columns a, b, c, d.       gdf &lt;- group_by(df, g1, g2)       summarise(gdf, a = mean(a), b = mean(b), c = mean(c), d = mean(d))</code></p></li>
<li><p>The first argument, <code>.cols</code>, selects the columns we
want to operate on. It uses tidy selection so we can pick variables by
position, name, and type.</p></li>
<li><p>The second argument, <code>.fns</code>, is a function or list of
functions to apply to each column. This argument is optional, and we can
omit it if we just want to get the underlying data.</p></li>
<li><p><code>across()</code> <strong><em>supersedes</em></strong> the
<strong>family of “scoped variants”</strong> like
<code>summarise_at()</code>, <code>summarise_if()</code>, and
<code>summarise_all()</code>.</p></li>
<li><p>See <code>vignette("colwise")</code> for more details.</p></li>
</ul>
<p>So, let’s see some examples about how we can use
<code>across()</code> with <code>summarize()</code> <em>all numeric
columns</em> of the <code>chigago</code> dataset.</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize a set of columns of a not grouped dataset, applying only one summary function.</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(chicago, <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1 × 7</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>   tmpd  dptp pm25tmean2 pm10tmean2 o3tmean2 no2tmean2  year</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="fl">50.3</span>  <span class="fl">40.3</span>       <span class="fl">16.2</span>       <span class="fl">33.9</span>     <span class="fl">19.4</span>      <span class="fl">25.2</span>  <span class="dv">1996</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(chicago, <span class="fu">across</span>(<span class="fu">where</span>(is.factor), n_distinct))</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1 × 2</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  tempcat pm25.quint</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">3</span>          <span class="dv">6</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(chicago, <span class="fu">across</span>(<span class="fu">everything</span>(), n_distinct))</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 1 × 11</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>   city  tmpd  dptp  date pm25tmean2 pm10tmean2 o3tmean2 no2tmean2 tempcat  year</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">1</span>   <span class="dv">197</span>  <span class="dv">1246</span>  <span class="dv">6940</span>       <span class="dv">1097</span>        <span class="dv">863</span>     <span class="dv">6048</span>      <span class="dv">6198</span>       <span class="dv">3</span>    <span class="dv">19</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 1 more variable: pm25.quint &lt;int&gt;</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize set of columns of grouped dataset, applying only one summary function.</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(years, <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 19 × 7</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>    year  tmpd  dptp pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">1987</span>  <span class="fl">52.1</span>  <span class="fl">41.7</span>      <span class="cn">NaN</span>         <span class="fl">40.3</span>     <span class="fl">20.5</span>      <span class="fl">25.3</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">1988</span>  <span class="fl">49.9</span>  <span class="fl">37.3</span>      <span class="cn">NaN</span>         <span class="fl">43.2</span>     <span class="fl">22.2</span>      <span class="fl">25.3</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1989</span>  <span class="fl">48.4</span>  <span class="fl">38.2</span>      <span class="cn">NaN</span>         <span class="fl">40.3</span>     <span class="fl">20.8</span>      <span class="fl">27.4</span></span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">1990</span>  <span class="fl">51.7</span>  <span class="fl">42.1</span>      <span class="cn">NaN</span>         <span class="fl">35.5</span>     <span class="fl">19.7</span>      <span class="fl">23.1</span></span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">1991</span>  <span class="fl">51.4</span>  <span class="fl">41.1</span>      <span class="cn">NaN</span>         <span class="fl">36.9</span>     <span class="fl">20.0</span>      <span class="fl">21.9</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">1992</span>  <span class="fl">48.8</span>  <span class="fl">40.1</span>      <span class="cn">NaN</span>         <span class="fl">38.8</span>     <span class="fl">16.1</span>      <span class="fl">25.9</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1993</span>  <span class="fl">48.7</span>  <span class="fl">40.9</span>      <span class="cn">NaN</span>         <span class="fl">36.5</span>     <span class="fl">15.8</span>      <span class="fl">26.1</span></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">1994</span>  <span class="fl">50.1</span>  <span class="fl">39.4</span>      <span class="cn">NaN</span>         <span class="fl">40.1</span>     <span class="fl">17.3</span>      <span class="fl">29.1</span></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">1995</span>  <span class="fl">50.2</span>  <span class="fl">39.5</span>      <span class="cn">NaN</span>         <span class="fl">35.6</span>     <span class="fl">18.1</span>      <span class="fl">27.9</span></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1996</span>  <span class="fl">47.4</span>  <span class="fl">39.9</span>      <span class="cn">NaN</span>         <span class="fl">31.7</span>     <span class="fl">16.7</span>      <span class="fl">27.0</span></span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">1997</span>  <span class="fl">48.7</span>  <span class="fl">39.9</span>      <span class="cn">NaN</span>         <span class="fl">30.8</span>     <span class="fl">18.6</span>      <span class="fl">25.8</span></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">1998</span>  <span class="fl">53.8</span>  <span class="fl">44.3</span>       <span class="fl">18.3</span>       <span class="fl">30.9</span>     <span class="fl">19.3</span>      <span class="fl">24.7</span></span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">1999</span>  <span class="fl">51.5</span>  <span class="fl">41.0</span>       <span class="fl">18.5</span>       <span class="fl">31.3</span>     <span class="fl">20.5</span>      <span class="fl">24.9</span></span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">2000</span>  <span class="fl">50.0</span>  <span class="fl">40.3</span>       <span class="fl">16.9</span>       <span class="fl">30.5</span>     <span class="fl">18.5</span>      <span class="fl">24.1</span></span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="dv">2001</span>  <span class="fl">51.0</span>  <span class="fl">41.3</span>       <span class="fl">16.9</span>       <span class="fl">32.4</span>     <span class="fl">19.4</span>      <span class="fl">25.4</span></span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>  <span class="dv">2002</span>  <span class="fl">51.2</span>  <span class="fl">41.4</span>       <span class="fl">15.3</span>       <span class="fl">29.4</span>     <span class="fl">21.0</span>      <span class="fl">23.7</span></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">2003</span>  <span class="fl">49.3</span>  <span class="fl">38.3</span>       <span class="fl">15.2</span>       <span class="fl">27.5</span>     <span class="fl">21.0</span>      <span class="fl">25.2</span></span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  <span class="dv">2004</span>  <span class="fl">50.1</span>  <span class="fl">40.0</span>       <span class="fl">14.6</span>       <span class="fl">27.9</span>     <span class="fl">20.5</span>      <span class="fl">23.4</span></span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  <span class="dv">2005</span>  <span class="fl">51.5</span>  <span class="fl">39.7</span>       <span class="fl">16.2</span>       <span class="fl">28.6</span>     <span class="fl">23.2</span>      <span class="fl">23.2</span></span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(years, <span class="fu">across</span>(<span class="fu">everything</span>(), n_distinct))</span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 19 × 10</span></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>    year  city  tmpd  dptp  date pm25tmean2 pm10tmean2 o3tmean2 no2tmean2</span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">1987</span>     <span class="dv">1</span>   <span class="dv">126</span>   <span class="dv">258</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">128</span>      <span class="dv">349</span>       <span class="dv">364</span></span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">1988</span>     <span class="dv">1</span>   <span class="dv">146</span>   <span class="dv">274</span>   <span class="dv">366</span>          <span class="dv">1</span>        <span class="dv">120</span>      <span class="dv">350</span>       <span class="dv">365</span></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1989</span>     <span class="dv">1</span>   <span class="dv">143</span>   <span class="dv">271</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">136</span>      <span class="dv">345</span>       <span class="dv">363</span></span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">1990</span>     <span class="dv">1</span>   <span class="dv">127</span>   <span class="dv">252</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">160</span>      <span class="dv">348</span>       <span class="dv">365</span></span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">1991</span>     <span class="dv">1</span>   <span class="dv">141</span>   <span class="dv">265</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">149</span>      <span class="dv">356</span>       <span class="dv">363</span></span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">1992</span>     <span class="dv">1</span>   <span class="dv">118</span>   <span class="dv">255</span>   <span class="dv">366</span>          <span class="dv">1</span>        <span class="dv">163</span>      <span class="dv">353</span>       <span class="dv">362</span></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1993</span>     <span class="dv">1</span>   <span class="dv">131</span>   <span class="dv">261</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">165</span>      <span class="dv">363</span>       <span class="dv">361</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">1994</span>     <span class="dv">1</span>   <span class="dv">144</span>   <span class="dv">259</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">178</span>      <span class="dv">363</span>       <span class="dv">363</span></span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">1995</span>     <span class="dv">1</span>   <span class="dv">144</span>   <span class="dv">272</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">175</span>      <span class="dv">361</span>       <span class="dv">362</span></span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1996</span>     <span class="dv">1</span>   <span class="dv">135</span>   <span class="dv">268</span>   <span class="dv">366</span>          <span class="dv">1</span>        <span class="dv">140</span>      <span class="dv">361</span>       <span class="dv">357</span></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">1997</span>     <span class="dv">1</span>   <span class="dv">135</span>   <span class="dv">270</span>   <span class="dv">365</span>          <span class="dv">1</span>        <span class="dv">156</span>      <span class="dv">365</span>       <span class="dv">363</span></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">1998</span>     <span class="dv">1</span>    <span class="dv">71</span>   <span class="dv">268</span>   <span class="dv">365</span>        <span class="dv">188</span>        <span class="dv">152</span>      <span class="dv">364</span>       <span class="dv">361</span></span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">1999</span>     <span class="dv">1</span>    <span class="dv">82</span>   <span class="dv">295</span>   <span class="dv">365</span>        <span class="dv">100</span>        <span class="dv">166</span>      <span class="dv">363</span>       <span class="dv">360</span></span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">2000</span>     <span class="dv">1</span>    <span class="dv">78</span>   <span class="dv">280</span>   <span class="dv">366</span>        <span class="dv">293</span>        <span class="dv">157</span>      <span class="dv">363</span>       <span class="dv">363</span></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="dv">2001</span>     <span class="dv">1</span>    <span class="dv">75</span>   <span class="dv">278</span>   <span class="dv">365</span>        <span class="dv">296</span>        <span class="dv">154</span>      <span class="dv">362</span>       <span class="dv">363</span></span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>  <span class="dv">2002</span>     <span class="dv">1</span>    <span class="dv">72</span>   <span class="dv">290</span>   <span class="dv">365</span>        <span class="dv">279</span>        <span class="dv">148</span>      <span class="dv">363</span>       <span class="dv">362</span></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">2003</span>     <span class="dv">1</span>    <span class="dv">78</span>   <span class="dv">282</span>   <span class="dv">365</span>        <span class="dv">264</span>        <span class="dv">141</span>      <span class="dv">363</span>       <span class="dv">363</span></span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  <span class="dv">2004</span>     <span class="dv">1</span>    <span class="dv">77</span>   <span class="dv">276</span>   <span class="dv">366</span>        <span class="dv">277</span>        <span class="dv">140</span>      <span class="dv">364</span>       <span class="dv">357</span></span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  <span class="dv">2005</span>     <span class="dv">1</span>    <span class="dv">81</span>   <span class="dv">279</span>   <span class="dv">365</span>        <span class="dv">265</span>        <span class="dv">143</span>      <span class="dv">363</span>       <span class="dv">358</span></span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 1 more variable: tempcat &lt;int&gt;</span></span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize a set of columns of grouped dataset, applying more than one summary function.</span></span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(years, <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">stat1 =</span> mean, <span class="at">stat2 =</span> sum), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 19 × 13</span></span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a>    year tmpd_stat1 tmpd_stat2 dptp_stat1 dptp_stat2 pm25tmean2_stat1</span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>            <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>  <span class="dv">1987</span>       <span class="fl">52.1</span>     <span class="dv">19026</span>        <span class="fl">41.7</span>     <span class="fl">15233.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">1988</span>       <span class="fl">49.9</span>     <span class="fl">18276.</span>       <span class="fl">37.3</span>     <span class="fl">13658.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1989</span>       <span class="fl">48.4</span>     <span class="dv">17654</span>        <span class="fl">38.2</span>     <span class="fl">13942.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-79"><a href="#cb118-79" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>  <span class="dv">1990</span>       <span class="fl">51.7</span>     <span class="fl">18860.</span>       <span class="fl">42.1</span>     <span class="fl">15366.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-80"><a href="#cb118-80" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>  <span class="dv">1991</span>       <span class="fl">51.4</span>     <span class="dv">18762</span>        <span class="fl">41.1</span>     <span class="fl">15014.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-81"><a href="#cb118-81" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">1992</span>       <span class="fl">48.8</span>     <span class="dv">17865</span>        <span class="fl">40.1</span>     <span class="fl">14682.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-82"><a href="#cb118-82" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1993</span>       <span class="fl">48.7</span>     <span class="fl">17782.</span>       <span class="fl">40.9</span>     <span class="fl">14914.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-83"><a href="#cb118-83" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">1994</span>       <span class="fl">50.1</span>     <span class="dv">18280</span>        <span class="fl">39.4</span>     <span class="fl">14372.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-84"><a href="#cb118-84" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">1995</span>       <span class="fl">50.2</span>     <span class="fl">18326.</span>       <span class="fl">39.5</span>     <span class="fl">14418.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-85"><a href="#cb118-85" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1996</span>       <span class="fl">47.4</span>     <span class="fl">17346.</span>       <span class="fl">39.9</span>     <span class="fl">14612.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-86"><a href="#cb118-86" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">1997</span>       <span class="fl">48.7</span>     <span class="dv">17779</span>        <span class="fl">39.9</span>     <span class="fl">14574.</span>            <span class="cn">NaN</span>  </span>
<span id="cb118-87"><a href="#cb118-87" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">1998</span>       <span class="fl">53.8</span>     <span class="dv">19631</span>        <span class="fl">44.3</span>     <span class="fl">16157.</span>             <span class="fl">18.3</span></span>
<span id="cb118-88"><a href="#cb118-88" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">1999</span>       <span class="fl">51.5</span>     <span class="dv">18784</span>        <span class="fl">41.0</span>     <span class="dv">14960</span>              <span class="fl">18.5</span></span>
<span id="cb118-89"><a href="#cb118-89" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">2000</span>       <span class="fl">50.0</span>     <span class="dv">18315</span>        <span class="fl">40.3</span>     <span class="fl">14732.</span>             <span class="fl">16.9</span></span>
<span id="cb118-90"><a href="#cb118-90" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="dv">2001</span>       <span class="fl">51.0</span>     <span class="dv">18631</span>        <span class="fl">41.3</span>     <span class="dv">15079</span>              <span class="fl">16.9</span></span>
<span id="cb118-91"><a href="#cb118-91" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>  <span class="dv">2002</span>       <span class="fl">51.2</span>     <span class="dv">18677</span>        <span class="fl">41.4</span>     <span class="fl">15088.</span>             <span class="fl">15.3</span></span>
<span id="cb118-92"><a href="#cb118-92" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">2003</span>       <span class="fl">49.3</span>     <span class="dv">17947</span>        <span class="fl">38.3</span>     <span class="fl">13994.</span>             <span class="fl">15.2</span></span>
<span id="cb118-93"><a href="#cb118-93" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  <span class="dv">2004</span>       <span class="fl">50.1</span>     <span class="dv">18346</span>        <span class="fl">40.0</span>     <span class="fl">14596.</span>             <span class="fl">14.6</span></span>
<span id="cb118-94"><a href="#cb118-94" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  <span class="dv">2005</span>       <span class="fl">51.5</span>     <span class="dv">18807</span>        <span class="fl">39.7</span>     <span class="fl">14500.</span>             <span class="fl">16.2</span></span>
<span id="cb118-95"><a href="#cb118-95" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 7 more variables: pm25tmean2_stat2 &lt;dbl&gt;, pm10tmean2_stat1 &lt;dbl&gt;,</span></span>
<span id="cb118-96"><a href="#cb118-96" aria-hidden="true" tabindex="-1"></a><span class="co">#   pm10tmean2_stat2 &lt;dbl&gt;, o3tmean2_stat1 &lt;dbl&gt;, o3tmean2_stat2 &lt;dbl&gt;,</span></span>
<span id="cb118-97"><a href="#cb118-97" aria-hidden="true" tabindex="-1"></a><span class="co">#   no2tmean2_stat1 &lt;dbl&gt;, no2tmean2_stat2 &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="example-5-looking-at-the-top-1-packages-downloded-from-cran."
class="section level4" number="7.2.8.6">
<h4><span class="header-section-number">7.2.8.6</span> Example 5:
looking at the top 1% packages downloded from CRAN.</h4>
<p>Let’s develop a more complete example, where we’ll use all the
<code>dplyr</code> functions that we saw so far.</p>
<p>As we know, “<strong>CRAN</strong> is a <strong>network of ftp and
web servers</strong> around the world that store
<strong>identical</strong>, <strong>up-to-date</strong>,
<strong><em>versions of code and documentation for R”</em></strong> <a
href="http://cran.rstudio.com/"
class="uri">http://cran.rstudio.com/</a>.</p>
<p>RStudio maintains one of these so-called ‘CRAN mirrors’ and they make
their <strong>download logs</strong> publicly available <a
href="http://cran-logs.rstudio.com/"
class="uri">http://cran-logs.rstudio.com/</a>.</p>
<p>We’ll be working with a file which contains <strong>log information
from July 8, 2014, about roughly 225,000</strong> <strong>package
downloads</strong>.</p>
<p>Let’s read from disk that file and create a tibble.</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>cran_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/cran.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(cran_df)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>cran <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(cran_df)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>cran</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 225,468 × 11</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>       X date  time    size r_version r_arch r_os  package version country ip_id</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>     <span class="dv">1</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">8.06e4</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 ming… htmlto… <span class="dv">0</span>.<span class="fl">2.4</span>   US          <span class="dv">1</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>     <span class="dv">2</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">3.22e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 ming… tseries <span class="fl">0.10</span><span class="dv">-32</span> US          <span class="dv">2</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>     <span class="dv">3</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.48e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… party   <span class="fl">1.0</span><span class="dv">-15</span>  US          <span class="dv">3</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>     <span class="dv">4</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">6.06e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… Hmisc   <span class="fl">3.14</span><span class="dv">-4</span>  US          <span class="dv">3</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>     <span class="dv">5</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.98e4</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… digest  <span class="dv">0</span>.<span class="fl">6.4</span>   CA          <span class="dv">4</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>     <span class="dv">6</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.77e4</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… random… <span class="fl">4.6</span><span class="dv">-7</span>   US          <span class="dv">3</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>     <span class="dv">7</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">3.94e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… plyr    <span class="dv">1</span>.<span class="fl">8.1</span>   US          <span class="dv">3</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>     <span class="dv">8</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">2.82e4</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… whisker <span class="fl">0.3</span><span class="dv">-2</span>   US          <span class="dv">5</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>     <span class="dv">9</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">5.93e3</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>  Rcpp    <span class="dv">0</span>.<span class="fl">10.4</span>  CN          <span class="dv">6</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">10</span> 2014… <span class="dv">00</span><span class="sc">:</span>1… <span class="fl">2.21e6</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… hfligh… <span class="fl">0.1</span>     US          <span class="dv">7</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 225,458 more rows</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cran)</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;X&quot;</span>         <span class="st">&quot;date&quot;</span>      <span class="st">&quot;time&quot;</span>      <span class="st">&quot;size&quot;</span>      <span class="st">&quot;r_version&quot;</span> <span class="st">&quot;r_arch&quot;</span>   </span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;r_os&quot;</span>      <span class="st">&quot;package&quot;</span>   <span class="st">&quot;version&quot;</span>   <span class="st">&quot;country&quot;</span>   <span class="st">&quot;ip_id&quot;</span>    </span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">object.size</span>(cran), <span class="at">units =</span> <span class="st">&quot;Mb&quot;</span>)</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="fl">21.2</span> Mb</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cran_df)</span></code></pre></div>
<p>Our <strong>first goal</strong> is to <strong>group the data by
<code>package</code> name</strong>.</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>by_package <span class="ot">&lt;-</span> <span class="fu">group_by</span>(cran, package)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>by_package</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 225,468 × 11</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   package [6,023]</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>       X date  time    size r_version r_arch r_os  package version country ip_id</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>     <span class="dv">1</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">8.06e4</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 ming… htmlto… <span class="dv">0</span>.<span class="fl">2.4</span>   US          <span class="dv">1</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>     <span class="dv">2</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">3.22e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 ming… tseries <span class="fl">0.10</span><span class="dv">-32</span> US          <span class="dv">2</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>     <span class="dv">3</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.48e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… party   <span class="fl">1.0</span><span class="dv">-15</span>  US          <span class="dv">3</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>     <span class="dv">4</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">6.06e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… Hmisc   <span class="fl">3.14</span><span class="dv">-4</span>  US          <span class="dv">3</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>     <span class="dv">5</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.98e4</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… digest  <span class="dv">0</span>.<span class="fl">6.4</span>   CA          <span class="dv">4</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>     <span class="dv">6</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">7.77e4</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… random… <span class="fl">4.6</span><span class="dv">-7</span>   US          <span class="dv">3</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>     <span class="dv">7</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">3.94e5</span> <span class="dv">3</span>.<span class="fl">1.0</span>     x86_64 linu… plyr    <span class="dv">1</span>.<span class="fl">8.1</span>   US          <span class="dv">3</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>     <span class="dv">8</span> 2014… <span class="dv">00</span><span class="sc">:</span>4… <span class="fl">2.82e4</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… whisker <span class="fl">0.3</span><span class="dv">-2</span>   US          <span class="dv">5</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>     <span class="dv">9</span> 2014… <span class="dv">00</span><span class="sc">:</span>5… <span class="fl">5.93e3</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>  Rcpp    <span class="dv">0</span>.<span class="fl">10.4</span>  CN          <span class="dv">6</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">10</span> 2014… <span class="dv">00</span><span class="sc">:</span>1… <span class="fl">2.21e6</span> <span class="dv">3</span>.<span class="fl">0.2</span>     x86_64 linu… hfligh… <span class="fl">0.1</span>     US          <span class="dv">7</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 225,458 more rows</span></span></code></pre></div>
<p>Let’s compute now some statistics <em>by package</em>.</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>pack_stats <span class="ot">&lt;-</span> <span class="fu">summarize</span>(by_package,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">unique =</span> <span class="fu">n_distinct</span>(ip_id),</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">countries =</span> <span class="fu">n_distinct</span>(country),</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">avg_bytes =</span> <span class="fu">mean</span>(size))</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>pack_stats</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6,023 × 5</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>   package     count unique countries avg_bytes</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A3             <span class="dv">25</span>     <span class="dv">24</span>        <span class="dv">10</span>    <span class="fl">62195.</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> abc            <span class="dv">29</span>     <span class="dv">25</span>        <span class="dv">16</span>  <span class="dv">4826665</span> </span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> abcdeFBA       <span class="dv">15</span>     <span class="dv">15</span>         <span class="dv">9</span>   <span class="fl">455980.</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> ABCExtremes    <span class="dv">18</span>     <span class="dv">17</span>         <span class="dv">9</span>    <span class="fl">22904.</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> ABCoptim       <span class="dv">16</span>     <span class="dv">15</span>         <span class="dv">9</span>    <span class="fl">17807.</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> ABCp2          <span class="dv">18</span>     <span class="dv">17</span>        <span class="dv">10</span>    <span class="fl">30473.</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> abctools       <span class="dv">19</span>     <span class="dv">19</span>        <span class="dv">11</span>  <span class="dv">2589394</span> </span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> abd            <span class="dv">17</span>     <span class="dv">16</span>        <span class="dv">10</span>   <span class="fl">453631.</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> abf2           <span class="dv">13</span>     <span class="dv">13</span>         <span class="dv">9</span>    <span class="fl">35693.</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> abind         <span class="dv">396</span>    <span class="dv">365</span>        <span class="dv">50</span>    <span class="fl">32939.</span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 6,013 more rows</span></span></code></pre></div>
<ul>
<li><p>The <code>count</code> column contains the <strong>total number
of rows (i.e. downloads)</strong> for <em>each package</em>.</p></li>
<li><p>The <code>unique</code> column gives the <strong>total number of
unique downloads</strong> for <em>each package</em>, as measured by the
number of distinct <code>ip_id</code>’s.</p></li>
<li><p>The <code>countries</code> column provides the <strong>number of
countries in which</strong> <em>each package</em> was
<strong>downloaded</strong>.</p></li>
<li><p>The <code>avg_bytes</code> column contains the <strong>mean
download size</strong> (in bytes) for <em>each package</em>.</p></li>
</ul>
<div
id="top-1-package-popularity-measured-by-the-quantity-of-downloads."
class="section level5" number="7.2.8.6.1">
<h5><span class="header-section-number">7.2.8.6.1</span> Top 1% package
popularity measured by the quantity of downloads.</h5>
<p>So, we’d like to know <strong>which packages were most
popular</strong> on the day these data were collected (July 8, 2014),
intended as <strong>the most downloaded</strong> packages.</p>
<p>In order to <strong>isolate the top 1% of packages</strong> based on
the <em>total number of downloads</em> as measured by the
<code>count</code> column, we first <strong>need to know</strong> the
<strong><em>value of <code>count</code></em></strong> that
<strong>splits</strong> the data into the <strong>top 1%</strong> and
<strong>bottom 99%</strong> of packages.</p>
<ul>
<li>In statistics, this is called <strong>the 0.99, or 99%, sample
quantile</strong>.</li>
</ul>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(pack_stats<span class="sc">$</span>count, <span class="at">probs =</span> <span class="fl">0.99</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>   <span class="dv">99</span>% </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fl">679.56</span> </span></code></pre></div>
<p>Now we can <strong>isolate</strong> only those packages which had
<strong>more than 679 total downloads</strong>.</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>top_counts <span class="ot">&lt;-</span> <span class="fu">filter</span>(pack_stats, count <span class="sc">&gt;</span> <span class="dv">679</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>top_counts</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 61 × 5</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>   package    count unique countries avg_bytes</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> bitops      <span class="dv">1549</span>   <span class="dv">1408</span>        <span class="dv">76</span>    <span class="fl">28715.</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> car         <span class="dv">1008</span>    <span class="dv">837</span>        <span class="dv">64</span>  <span class="fl">1229122.</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> caTools      <span class="dv">812</span>    <span class="dv">699</span>        <span class="dv">64</span>   <span class="fl">176589.</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> colorspace  <span class="dv">1683</span>   <span class="dv">1433</span>        <span class="dv">80</span>   <span class="fl">357411.</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> data.table   <span class="dv">680</span>    <span class="dv">564</span>        <span class="dv">59</span>  <span class="fl">1252721.</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> DBI         <span class="dv">2599</span>    <span class="dv">492</span>        <span class="dv">48</span>   <span class="fl">206933.</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> devtools     <span class="dv">769</span>    <span class="dv">560</span>        <span class="dv">55</span>   <span class="fl">212933.</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> dichromat   <span class="dv">1486</span>   <span class="dv">1257</span>        <span class="dv">74</span>   <span class="fl">134732.</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> digest      <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> doSNOW       <span class="dv">740</span>     <span class="dv">75</span>        <span class="dv">24</span>     <span class="fl">8364.</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 51 more rows</span></span></code></pre></div>
<ul>
<li>There are <strong>61 packages</strong> in the top 1% most
downloaded.</li>
</ul>
<p>Let’s <strong>sort the packages</strong> in descending order.</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>top_counts_sorted <span class="ot">&lt;-</span> <span class="fu">arrange</span>(top_counts, <span class="fu">desc</span>(count))</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>top_counts_sorted</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 61 × 5</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>   package  count unique countries avg_bytes</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>    <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> ggplot2   <span class="dv">4602</span>   <span class="dv">1680</span>        <span class="dv">81</span>  <span class="fl">2427716.</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Rcpp      <span class="dv">3195</span>   <span class="dv">2044</span>        <span class="dv">84</span>  <span class="fl">2512100.</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> plyr      <span class="dv">2908</span>   <span class="dv">1754</span>        <span class="dv">81</span>   <span class="fl">799123.</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> rJava     <span class="dv">2773</span>    <span class="dv">963</span>        <span class="dv">70</span>   <span class="fl">633522.</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> DBI       <span class="dv">2599</span>    <span class="dv">492</span>        <span class="dv">48</span>   <span class="fl">206933.</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> LPCM      <span class="dv">2335</span>     <span class="dv">17</span>        <span class="dv">10</span>   <span class="fl">526814.</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> stringr   <span class="dv">2267</span>   <span class="dv">1948</span>        <span class="dv">82</span>    <span class="fl">65277.</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> digest    <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> reshape2  <span class="dv">2032</span>   <span class="dv">1652</span>        <span class="dv">76</span>   <span class="fl">330128.</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> foreach   <span class="dv">1984</span>    <span class="dv">485</span>        <span class="dv">53</span>   <span class="fl">358070.</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 51 more rows</span></span></code></pre></div>
<ul>
<li><p>If we use total number of downloads as our metric for popularity,
then the above output shows us the most popular packages downloaded from
the RStudio CRAN mirror on July 8, 2014.</p></li>
<li><p>Not surprisingly, <code>ggplot2</code> leads the pack with 4602
downloads, followed by <code>Rcpp</code>, <code>plyr</code>, … and if we
keep on going, we’ll see <code>swirl</code> at number 43, with 820 total
downloads.</p></li>
</ul>
</div>
<div id="top-1-package-popularity-measured-by-the-unique-downloads."
class="section level5" number="7.2.8.6.2">
<h5><span class="header-section-number">7.2.8.6.2</span> Top 1% package
popularity measured by the unique downloads.</h5>
<p>Perhaps we’re more interested in the <strong>number of unique
downloads</strong> on that particular day.</p>
<ul>
<li>In other words, if a package is downloaded ten times in one day from
the same computer, we may wish to count that as only one download.
That’s what the <code>unique</code> column will tell us.</li>
</ul>
<p>Therefore:</p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>q99 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(pack_stats<span class="sc">$</span>unique, <span class="at">probs =</span> <span class="fl">0.99</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>q99</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="dv">99</span>% </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="dv">465</span> </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>top_unique <span class="ot">&lt;-</span> <span class="fu">filter</span>(pack_stats, unique <span class="sc">&gt;</span> q99)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>top_unique</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 60 × 5</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>   package    count unique countries avg_bytes</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>      <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> bitops      <span class="dv">1549</span>   <span class="dv">1408</span>        <span class="dv">76</span>    <span class="fl">28715.</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> car         <span class="dv">1008</span>    <span class="dv">837</span>        <span class="dv">64</span>  <span class="fl">1229122.</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> caTools      <span class="dv">812</span>    <span class="dv">699</span>        <span class="dv">64</span>   <span class="fl">176589.</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> colorspace  <span class="dv">1683</span>   <span class="dv">1433</span>        <span class="dv">80</span>   <span class="fl">357411.</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> data.table   <span class="dv">680</span>    <span class="dv">564</span>        <span class="dv">59</span>  <span class="fl">1252721.</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> DBI         <span class="dv">2599</span>    <span class="dv">492</span>        <span class="dv">48</span>   <span class="fl">206933.</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> devtools     <span class="dv">769</span>    <span class="dv">560</span>        <span class="dv">55</span>   <span class="fl">212933.</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> dichromat   <span class="dv">1486</span>   <span class="dv">1257</span>        <span class="dv">74</span>   <span class="fl">134732.</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> digest      <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> e1071        <span class="dv">562</span>    <span class="dv">482</span>        <span class="dv">61</span>   <span class="fl">743154.</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 50 more rows</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>top_unique_sorted <span class="ot">&lt;-</span> <span class="fu">arrange</span>(top_unique, <span class="fu">desc</span>(unique))</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>top_unique_sorted</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 60 × 5</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>   package      count unique countries avg_bytes</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>        <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Rcpp          <span class="dv">3195</span>   <span class="dv">2044</span>        <span class="dv">84</span>  <span class="fl">2512100.</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> stringr       <span class="dv">2267</span>   <span class="dv">1948</span>        <span class="dv">82</span>    <span class="fl">65277.</span></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> digest        <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> plyr          <span class="dv">2908</span>   <span class="dv">1754</span>        <span class="dv">81</span>   <span class="fl">799123.</span></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> ggplot2       <span class="dv">4602</span>   <span class="dv">1680</span>        <span class="dv">81</span>  <span class="fl">2427716.</span></span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> reshape2      <span class="dv">2032</span>   <span class="dv">1652</span>        <span class="dv">76</span>   <span class="fl">330128.</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> RColorBrewer  <span class="dv">1890</span>   <span class="dv">1584</span>        <span class="dv">79</span>    <span class="fl">22764.</span></span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> colorspace    <span class="dv">1683</span>   <span class="dv">1433</span>        <span class="dv">80</span>   <span class="fl">357411.</span></span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> bitops        <span class="dv">1549</span>   <span class="dv">1408</span>        <span class="dv">76</span>    <span class="fl">28715.</span></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> scales        <span class="dv">1726</span>   <span class="dv">1408</span>        <span class="dv">77</span>   <span class="fl">126819.</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 50 more rows</span></span></code></pre></div>
<ul>
<li>Now <code>Rcpp</code> is in the lead, followed by
<code>stringr</code>, <code>digest</code>, <code>plyr</code>, and
<code>ggplot2</code>. <code>swirl</code> moved up a few spaces to number
40, with 698 unique downloads.</li>
</ul>
</div>
</div>
</div>
<div id="chaining-or-piping-operator-." class="section level3"
number="7.2.9">
<h3><span class="header-section-number">7.2.9</span> Chaining or Piping
operator <code>%&gt;%</code>.</h3>
<p>The <code>dplyr</code> package implements a <strong>special
operator</strong>, <code>%&gt;%</code>, that allows us to <strong>chain
different</strong> <strong>operations together</strong> in a way that
shows better what operations are happening.</p>
<ul>
<li><p>The idea it that we <strong>take a data set</strong> and
<strong>feed it through a pipeline of operations</strong> to
<strong>create a new data set</strong>.</p></li>
<li><p>The chain oparator allows us to <strong>chain the function
calls</strong> in a <strong>linear fashion</strong>. The code to the
right of <code>%&gt;%</code> <em>operates on the result</em> from the
code to the left of <code>%&gt;%</code>.</p></li>
<li><p>As a result of this, <strong>if there are not addictional
arguments</strong> to pass, we can call the function <strong>leaving off
the parentheses</strong>.</p></li>
<li><p>Besides improving code readability, it also avoids creating
useless intermidate variables that stores temporary results.</p></li>
<li><p>We can pull up the related documentation with
<code>?chain</code>.</p></li>
</ul>
<div id="chicago-pollutats-statistics-example." class="section level4"
number="7.2.9.1">
<h4><span class="header-section-number">7.2.9.1</span> Chicago pollutats
statistics example.</h4>
<p>Let’s go back to our previous example regarding the pollutants
statistics, this time <strong>summarizing</strong> <strong>by
month</strong>.</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>chicago <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.POSIXlt</span>(date)<span class="sc">$</span>mon <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">pm25 =</span> <span class="fu">mean</span>(pm25tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">o3 =</span> <span class="fu">max</span>(o3tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">no2 =</span> <span class="fu">median</span>(no2tmean2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 12 × 4</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>   month  pm25    o3   no2</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>     <span class="dv">1</span>  <span class="fl">17.8</span>  <span class="fl">28.2</span>  <span class="fl">25.4</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>     <span class="dv">2</span>  <span class="fl">20.4</span>  <span class="fl">37.4</span>  <span class="fl">26.8</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>     <span class="dv">3</span>  <span class="fl">17.4</span>  <span class="fl">39.0</span>  <span class="fl">26.8</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>     <span class="dv">4</span>  <span class="fl">13.9</span>  <span class="fl">47.9</span>  <span class="fl">25.0</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>     <span class="dv">5</span>  <span class="fl">14.1</span>  <span class="fl">52.8</span>  <span class="fl">24.2</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>     <span class="dv">6</span>  <span class="fl">15.9</span>  <span class="fl">66.6</span>  <span class="fl">25.0</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>     <span class="dv">7</span>  <span class="fl">16.6</span>  <span class="fl">59.5</span>  <span class="fl">22.4</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>     <span class="dv">8</span>  <span class="fl">16.9</span>  <span class="fl">54.0</span>  <span class="fl">23.0</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>     <span class="dv">9</span>  <span class="fl">15.9</span>  <span class="fl">57.5</span>  <span class="fl">24.5</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">10</span>  <span class="fl">14.2</span>  <span class="fl">47.1</span>  <span class="fl">24.2</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>    <span class="dv">11</span>  <span class="fl">15.2</span>  <span class="fl">29.5</span>  <span class="fl">23.6</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>    <span class="dv">12</span>  <span class="fl">17.5</span>  <span class="fl">27.7</span>  <span class="fl">24.5</span></span></code></pre></div>
<ul>
<li><p>The <em>output</em> of each of the stages or steps in the
pipeline, is given as input of the following step.</p>
<ul>
<li><code>df -&gt; mutate it -&gt; group it -&gt; summarize it</code>.</li>
</ul></li>
<li><p>Therefore, when we call <code>mutate</code>,
<code>group_by</code> and <code>summarize</code>, we <strong>don’t have
the specify</strong> the data frame as the first argument. It’s implied
by the use of the pipeline operator. We can go directly to the operation
that we are trying to do.</p></li>
<li><p>As said, the pipeline operator is a <strong>really handy
tool</strong> because it prevents us from having to assign a number of
temporary variables that we subsequently feed into another function, and
it allows us to chain a bunch of operations in one sequence that’s both
readable and and powerful.</p></li>
<li><p>By the way, it seems that <code>o3</code> tends to be low in the
winter months and high in the summer while <code>no2</code> is higher in
the winter and lower in the summer.</p></li>
</ul>
</div>
<div
id="top-1-package-popularity-measured-by-the-downloads-from-distinct-countries."
class="section level4" number="7.2.9.2">
<h4><span class="header-section-number">7.2.9.2</span> Top 1% package
popularity measured by the downloads from distinct countries.</h4>
<p>Let’s carry out the <em>chaining method</em> taking our
<code>cran</code> packages’ downloads dataset and compute <strong>from
scratch</strong> another metric of popularity: the <strong>number of
distinct countries from which each</strong> <strong>package was
downloaded</strong>.</p>
<ul>
<li>We’ll consider as the top 1% packages those downloaded from
<strong>more than 60 countries</strong>.</li>
</ul>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> cran <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(package) <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">unique =</span> <span class="fu">n_distinct</span>(ip_id),</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">countries =</span> <span class="fu">n_distinct</span>(country),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">avg_bytes =</span> <span class="fu">mean</span>(size)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(countries <span class="sc">&gt;</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(countries), avg_bytes) <span class="sc">%&gt;%</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>            print</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 46 × 5</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>   package      count unique countries avg_bytes</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>        <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Rcpp          <span class="dv">3195</span>   <span class="dv">2044</span>        <span class="dv">84</span>  <span class="fl">2512100.</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> digest        <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> stringr       <span class="dv">2267</span>   <span class="dv">1948</span>        <span class="dv">82</span>    <span class="fl">65277.</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> plyr          <span class="dv">2908</span>   <span class="dv">1754</span>        <span class="dv">81</span>   <span class="fl">799123.</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> ggplot2       <span class="dv">4602</span>   <span class="dv">1680</span>        <span class="dv">81</span>  <span class="fl">2427716.</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> colorspace    <span class="dv">1683</span>   <span class="dv">1433</span>        <span class="dv">80</span>   <span class="fl">357411.</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> RColorBrewer  <span class="dv">1890</span>   <span class="dv">1584</span>        <span class="dv">79</span>    <span class="fl">22764.</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> scales        <span class="dv">1726</span>   <span class="dv">1408</span>        <span class="dv">77</span>   <span class="fl">126819.</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> bitops        <span class="dv">1549</span>   <span class="dv">1408</span>        <span class="dv">76</span>    <span class="fl">28715.</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> reshape2      <span class="dv">2032</span>   <span class="dv">1652</span>        <span class="dv">76</span>   <span class="fl">330128.</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 36 more rows</span></span></code></pre></div>
<ul>
<li><p><strong>Notice</strong> the call to <code>print</code> function
<strong>without parentheses</strong>, because no additional arguments
were needed.</p></li>
<li><p>It looks like <code>Rcpp</code> is on top with downloads from 84
different countries, followed by <code>digest</code>,
<code>stringr</code>, <code>plyr</code>, and <code>ggplot2</code>.
<code>swirl</code> jumped up the rankings again, this time to
27th.</p></li>
</ul>
</div>
<div
id="its-possible-to-embed-function-calls-to-avoid-intermediate-results-without-using-the-chain-operator-but-it-could-be-a-real-mess."
class="section level4" number="7.2.9.3">
<h4><span class="header-section-number">7.2.9.3</span> It’s possible to
embed function calls to avoid intermediate results without using the
chain operator, but it could be a real mess.</h4>
<p>Just for fun, let’s see this equivalent piece of code.</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(cran,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>                 package</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">unique =</span> <span class="fu">n_distinct</span>(ip_id),</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">countries =</span> <span class="fu">n_distinct</span>(country),</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">avg_bytes =</span> <span class="fu">mean</span>(size)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>      countries <span class="sc">&gt;</span> <span class="dv">60</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">desc</span>(countries),</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    avg_bytes</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>result2</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 46 × 5</span></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>   package      count unique countries avg_bytes</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>        <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Rcpp          <span class="dv">3195</span>   <span class="dv">2044</span>        <span class="dv">84</span>  <span class="fl">2512100.</span></span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> digest        <span class="dv">2210</span>   <span class="dv">1894</span>        <span class="dv">83</span>   <span class="fl">120549.</span></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> stringr       <span class="dv">2267</span>   <span class="dv">1948</span>        <span class="dv">82</span>    <span class="fl">65277.</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> plyr          <span class="dv">2908</span>   <span class="dv">1754</span>        <span class="dv">81</span>   <span class="fl">799123.</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> ggplot2       <span class="dv">4602</span>   <span class="dv">1680</span>        <span class="dv">81</span>  <span class="fl">2427716.</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> colorspace    <span class="dv">1683</span>   <span class="dv">1433</span>        <span class="dv">80</span>   <span class="fl">357411.</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> RColorBrewer  <span class="dv">1890</span>   <span class="dv">1584</span>        <span class="dv">79</span>    <span class="fl">22764.</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> scales        <span class="dv">1726</span>   <span class="dv">1408</span>        <span class="dv">77</span>   <span class="fl">126819.</span></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> bitops        <span class="dv">1549</span>   <span class="dv">1408</span>        <span class="dv">76</span>    <span class="fl">28715.</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> reshape2      <span class="dv">2032</span>   <span class="dv">1652</span>        <span class="dv">76</span>   <span class="fl">330128.</span></span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 36 more rows</span></span></code></pre></div>
<ul>
<li>Eso es un atentado contra el buen gusto (I don’t know how to
translate that into english).</li>
</ul>
</div>
<div id="one-last-example." class="section level4" number="7.2.9.4">
<h4><span class="header-section-number">7.2.9.4</span> One last
example.</h4>
<p>Let’s apply the following chain of operations on <code>cran</code>
dataset.</p>
<ul>
<li>Select four columns of interest: <code>ip_id</code>,
<code>country</code>, <code>package</code> and <code>size</code>, in
that order.<br />
</li>
<li>Add a column <code>size_mb</code> that contains the size of each
download in megabytes.<br />
</li>
<li>Subset all downloads which size in megabytes is not greater than
0.5<br />
</li>
<li>Order the result by the size in megabytes, in descending order.</li>
</ul>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>cran <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ip_id, country, package, size) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">size_mb =</span> size <span class="sc">/</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size_mb <span class="sc">&lt;=</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(size_mb)) <span class="sc">%&gt;%</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 142,021 × 5</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>   ip_id country package                 size size_mb</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>                  <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">11034</span> DE      phia                  <span class="dv">524232</span>   <span class="fl">0.500</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">9643</span> US      tis                   <span class="dv">524152</span>   <span class="fl">0.500</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>  <span class="dv">1542</span> IN      RcppSMC               <span class="dv">524060</span>   <span class="fl">0.500</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">12354</span> US      lessR                 <span class="dv">523916</span>   <span class="fl">0.500</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">12072</span> US      colorspace            <span class="dv">523880</span>   <span class="fl">0.500</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>  <span class="dv">2514</span> KR      depmixS4              <span class="dv">523863</span>   <span class="fl">0.500</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>  <span class="dv">1111</span> US      depmixS4              <span class="dv">523858</span>   <span class="fl">0.500</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>  <span class="dv">8865</span> CR      depmixS4              <span class="dv">523858</span>   <span class="fl">0.500</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>  <span class="dv">5908</span> CN      RcmdrPlugin.KMggplot2 <span class="dv">523852</span>   <span class="fl">0.500</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">12354</span> US      RcmdrPlugin.KMggplot2 <span class="dv">523852</span>   <span class="fl">0.500</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 142,011 more rows</span></span></code></pre></div>
<hr />
</div>
</div>
</div>
</div>
<div id="tidying-data-with-tidyr-package." class="section level1"
number="8">
<h1><span class="header-section-number">8</span> Tidying Data with
<code>tidyr</code> package.</h1>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">&#39;tidyr&#39;</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>The following object is masked _by_ <span class="st">&#39;.GlobalEnv&#39;</span><span class="sc">:</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    complete</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>The following object is masked from <span class="st">&#39;package:reshape2&#39;</span><span class="sc">:</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    smiths</span></code></pre></div>
<p>The author of tidyr, Hadley Wickham, discusses his philosophy of tidy
data in his <a href="http://vita.had.co.nz/papers/tidy-data.pdf">‘Tidy
Data’ paper</a></p>
<p>Tidy data is formatted in a standard way that facilitates exploration
and analysis and works seamlessly with other tidy data tools.</p>
<p>Let’s remember the three conditions that tidy data satisfies:</p>
<ol style="list-style-type: decimal">
<li><p>Each variable forms a <em>column</em>.</p></li>
<li><p>Each observation forms a <em>row</em>.</p></li>
<li><p>Each type of observational unit forms a <em>table</em>.</p></li>
</ol>
<div id="most-common-symptoms-of-messy-data." class="section level2"
number="8.1">
<h2><span class="header-section-number">8.1</span> Most common symptoms
of messy data.</h2>
<p>We can enumerate the following cases that are common symptoms of
messy data.</p>
<ul>
<li><p>Column headers are values, not variable names.</p></li>
<li><p>Multiple variables are stored in one column.</p></li>
<li><p>Variables are stored in both rows and columns.</p></li>
<li><p>Multiple types of observational units are stored in the same
table.</p></li>
<li><p>A single observational unit is stored in multiple
tables.</p></li>
</ul>
<p>Let’s work through a simple example of each of these five cases, then
tidy some real data.</p>
<div
id="column-headers-are-values-not-variable-names.-using-gather-now-replaced-by-pivot_longer-function."
class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Column headers are
values, not variable names. Using <code>gather()</code>, now replaced by
<code>pivot_longer()</code> function.</h3>
<p>The first problem is when we have column headers that are values, not
variable names.</p>
<p>The following simple dataset called <code>students</code>
demonstrates this scenario.</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/students.csv&quot;</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>students</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  grade male female</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A    <span class="dv">1</span>      <span class="dv">5</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     B    <span class="dv">5</span>      <span class="dv">0</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     C    <span class="dv">5</span>      <span class="dv">2</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     D    <span class="dv">5</span>      <span class="dv">5</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     E    <span class="dv">7</span>      <span class="dv">4</span></span></code></pre></div>
<ul>
<li><p>The <em>first column</em> represents each of five possible grades
that students could receive for a particular class.</p></li>
<li><p>The <em>second and third columns</em> give the <strong>number of
male and female students</strong>, respectively, that <strong>received
each grade</strong>.</p></li>
<li><p>This dataset <em>actually has</em> *<strong>three
variables</strong>: <code>grade</code>, <code>sex</code>, and
<code>count</code>.</p>
<ul>
<li><p><code>grade</code> is already a column, so that should remain as
it is.</p></li>
<li><p><code>sex</code> is <strong>captured by the second and third
column headings</strong>.</p></li>
<li><p><code>count</code> is the <strong>number of students</strong> for
<strong>each combination of <code>grade</code> and
<code>sex</code></strong>.</p></li>
</ul></li>
</ul>
<p>To tidy the students data, <strong>we need</strong> to have
<strong>one column</strong> for <strong>each of these three
variables</strong>.</p>
<ul>
<li><p>We can use <strong>the <code>gather()</code> function</strong>
from <code>tidyr</code> to accomplish this.</p></li>
<li><p>But nowadays, the development on <code>gather()</code> is
complete, and for new code <strong>it’s recommended</strong>
<strong>switching to <code>pivot_longer()</code></strong>, which is
<em>easier</em> to use, more <em>featureful</em>, and still under
<em>active development</em>.</p></li>
</ul>
<div class="sourceCode" id="cb132"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gather)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, <span class="at">key =</span> <span class="st">&quot;key&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>, ..., <span class="at">na.rm =</span> <span class="cn">FALSE</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor_key =</span> <span class="cn">FALSE</span>)  </span></code></pre></div>
<ul>
<li><p>It <strong>takes multiple columns</strong> and <strong>collapses
into key-value pairs</strong>, <em>duplicating all other</em> columns
<em>as needed</em>.</p></li>
<li><p>We use <code>gather()</code> when you <strong>notice</strong>
that we have <strong>columns that are not variables</strong>.</p></li>
<li><p>The elipsys <code>...</code> argument, is for <strong>selection
of columns</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pivot_longer)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, cols, <span class="at">names_to =</span> <span class="st">&quot;name&quot;</span>, <span class="at">names_prefix =</span> <span class="cn">NULL</span>, <span class="at">names_sep =</span> <span class="cn">NULL</span>, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="cn">NULL</span>, <span class="at">names_ptypes =</span> <span class="cn">NULL</span>, <span class="at">names_transform =</span> <span class="cn">NULL</span>, </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_repair =</span> <span class="st">&quot;check_unique&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>, <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>, </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_ptypes =</span> <span class="cn">NULL</span>, <span class="at">values_transform =</span> <span class="cn">NULL</span>, ...)  </span></code></pre></div>
<ul>
<li><p>In short, <code>gather(df, "key", "value", x, y, z)</code><br />
<em>is equivalent to</em>
<code>pivot_longer(df, c(x, y, z), names_to = "key", values_to = "value")</code></p></li>
<li><p>More details in <code>vignette("pivot")</code>.</p></li>
</ul>
<p>So, going back to our example, we want to “gather” all columns except
the <code>grade</code> column (since it is already a proper column
variable). And we can proceed as follows:</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gather</span>(students, <span class="at">key =</span> sex, <span class="at">value =</span> count, <span class="sc">-</span>grade)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>   grade    sex count</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      A   male     <span class="dv">1</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      B   male     <span class="dv">5</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      C   male     <span class="dv">5</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      D   male     <span class="dv">5</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      E   male     <span class="dv">7</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      A female     <span class="dv">5</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      B female     <span class="dv">0</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      C female     <span class="dv">2</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      D female     <span class="dv">5</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     E female     <span class="dv">4</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="fu">gather</span>(students, <span class="at">key =</span> sex, <span class="at">value =</span> count, <span class="fu">c</span>(male, female))</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>   grade    sex count</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      A   male     <span class="dv">1</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      B   male     <span class="dv">5</span></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      C   male     <span class="dv">5</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      D   male     <span class="dv">5</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      E   male     <span class="dv">7</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      A female     <span class="dv">5</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      B female     <span class="dv">0</span></span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      C female     <span class="dv">2</span></span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      D female     <span class="dv">5</span></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     E female     <span class="dv">4</span></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(students, <span class="at">cols =</span> <span class="sc">-</span>grade, <span class="at">names_to =</span> <span class="st">&quot;sex&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 3</span></span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>   grade sex    count</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A     male       <span class="dv">1</span></span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> A     female     <span class="dv">5</span></span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> B     male       <span class="dv">5</span></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> B     female     <span class="dv">0</span></span>
<span id="cb134-35"><a href="#cb134-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> C     male       <span class="dv">5</span></span>
<span id="cb134-36"><a href="#cb134-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> C     female     <span class="dv">2</span></span>
<span id="cb134-37"><a href="#cb134-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> D     male       <span class="dv">5</span></span>
<span id="cb134-38"><a href="#cb134-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> D     female     <span class="dv">5</span></span>
<span id="cb134-39"><a href="#cb134-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> E     male       <span class="dv">7</span></span>
<span id="cb134-40"><a href="#cb134-40" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> E     female     <span class="dv">4</span></span>
<span id="cb134-41"><a href="#cb134-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-42"><a href="#cb134-42" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(students, <span class="at">cols =</span> <span class="fu">c</span>(male, female), <span class="at">names_to =</span> <span class="st">&quot;sex&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb134-43"><a href="#cb134-43" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 3</span></span>
<span id="cb134-44"><a href="#cb134-44" aria-hidden="true" tabindex="-1"></a>   grade sex    count</span>
<span id="cb134-45"><a href="#cb134-45" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb134-46"><a href="#cb134-46" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A     male       <span class="dv">1</span></span>
<span id="cb134-47"><a href="#cb134-47" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> A     female     <span class="dv">5</span></span>
<span id="cb134-48"><a href="#cb134-48" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> B     male       <span class="dv">5</span></span>
<span id="cb134-49"><a href="#cb134-49" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> B     female     <span class="dv">0</span></span>
<span id="cb134-50"><a href="#cb134-50" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> C     male       <span class="dv">5</span></span>
<span id="cb134-51"><a href="#cb134-51" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> C     female     <span class="dv">2</span></span>
<span id="cb134-52"><a href="#cb134-52" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> D     male       <span class="dv">5</span></span>
<span id="cb134-53"><a href="#cb134-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> D     female     <span class="dv">5</span></span>
<span id="cb134-54"><a href="#cb134-54" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> E     male       <span class="dv">7</span></span>
<span id="cb134-55"><a href="#cb134-55" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> E     female     <span class="dv">4</span></span></code></pre></div>
<ul>
<li><p><strong>Each row</strong> of the data <em>now represents</em>
<strong>exactly one observation</strong>, characterized by a
<strong>unique combination</strong> of the <code>grade</code> and
<code>sex</code> variables.</p></li>
<li><p><strong>Each variable</strong> (<code>grade</code>,
<code>sex</code>, and <code>count</code>) occupies <strong>exactly one
column</strong>.</p></li>
<li><p>That’s tidy data.</p></li>
</ul>
</div>
<div
id="multiple-variables-are-stored-in-one-column.-using-gather-betterpivot_longer-and-separate-functions."
class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Multiple variables
are stored in one column. Using <code>gather()</code>
(better<code>pivot_longer()</code>) and <code>separate()</code>
functions.</h3>
<p>The second messy data case we’ll look at is when <strong>multiple
variables</strong> are stored in <strong>one column</strong>.</p>
<p>The <code>students2</code> dataset is an example of this.</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>students2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/students2.csv&quot;</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>students2</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  grade male_1 female_1 male_2 female_2</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     A      <span class="dv">3</span>        <span class="dv">4</span>      <span class="dv">3</span>        <span class="dv">4</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     B      <span class="dv">6</span>        <span class="dv">4</span>      <span class="dv">3</span>        <span class="dv">5</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     C      <span class="dv">7</span>        <span class="dv">4</span>      <span class="dv">3</span>        <span class="dv">8</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     D      <span class="dv">4</span>        <span class="dv">0</span>      <span class="dv">8</span>        <span class="dv">1</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     E      <span class="dv">1</span>        <span class="dv">1</span>      <span class="dv">2</span>        <span class="dv">7</span></span></code></pre></div>
<ul>
<li><p>This dataset is similar to the first, except now there are
<strong>two separate classes</strong>, <strong>1</strong> and
<strong>2</strong>, and we have <em>total counts</em> <strong><em>for
each</em></strong> <strong>sex</strong> <strong><em>within
each</em></strong> <strong>class</strong>.</p></li>
<li><p>This dataset suffers from the <strong>same messy data
problem</strong> of having <em>column headers that are values</em>
(male_1, female_1, etc.) and <em>not variable names</em> (sex, class,
and count).</p></li>
<li><p>However, it <strong>also</strong> has <strong>multiple variables
stored in each column (sex and class)</strong>, which is another common
symptom of messy data.</p></li>
</ul>
<p>Tidying this dataset will be a <strong>two step process</strong>.</p>
<ul>
<li><p><strong>First step</strong>.<br />
We’ll start by using <code>gather()</code> (and the improved
<code>pivot_longer()</code>) to <strong>stack the columns</strong> of
students2, like we just did with <code>students</code>.</p>
<ul>
<li>This time, we’ll name the ‘key’ column <code>sex_class</code> and
the ‘value’ column <code>count</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>res_g <span class="ot">&lt;-</span> <span class="fu">gather</span>(students2, sex_class, count, <span class="sc">-</span>grade)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>res_g</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>   grade sex_class count</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      A    male_1     <span class="dv">3</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      B    male_1     <span class="dv">6</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      C    male_1     <span class="dv">7</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      D    male_1     <span class="dv">4</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      E    male_1     <span class="dv">1</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      A  female_1     <span class="dv">4</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      B  female_1     <span class="dv">4</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      C  female_1     <span class="dv">4</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      D  female_1     <span class="dv">0</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     E  female_1     <span class="dv">1</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>     A    male_2     <span class="dv">3</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>     B    male_2     <span class="dv">3</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>     C    male_2     <span class="dv">3</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>     D    male_2     <span class="dv">8</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>     E    male_2     <span class="dv">2</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>     A  female_2     <span class="dv">4</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>     B  female_2     <span class="dv">5</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>     C  female_2     <span class="dv">8</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>     D  female_2     <span class="dv">1</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>     E  female_2     <span class="dv">7</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>res_pl <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(students2, <span class="sc">-</span>grade, <span class="at">names_to =</span> <span class="st">&quot;sex_class&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>res_pl</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 3</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>   grade sex_class count</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A     male_1        <span class="dv">3</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> A     female_1      <span class="dv">4</span></span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> A     male_2        <span class="dv">3</span></span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> A     female_2      <span class="dv">4</span></span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> B     male_1        <span class="dv">6</span></span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> B     female_1      <span class="dv">4</span></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B     male_2        <span class="dv">3</span></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> B     female_2      <span class="dv">5</span></span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> C     male_1        <span class="dv">7</span></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> C     female_1      <span class="dv">4</span></span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> C     male_2        <span class="dv">3</span></span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> C     female_2      <span class="dv">8</span></span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> D     male_1        <span class="dv">4</span></span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> D     female_1      <span class="dv">0</span></span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> D     male_2        <span class="dv">8</span></span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> D     female_2      <span class="dv">1</span></span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> E     male_1        <span class="dv">1</span></span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> E     female_1      <span class="dv">1</span></span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> E     male_2        <span class="dv">2</span></span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> E     female_2      <span class="dv">7</span></span></code></pre></div>
<ul>
<li><p><strong>Second step</strong>.<br />
We <em>still have</em> <strong>two different variables</strong>,
<code>sex</code> and <code>class</code>, <strong>stored
together</strong> in the <code>sex_class</code> column.</p></li>
<li><p><code>tidyr</code> offers a convenient
<strong><code>separate()</code> function</strong> for the purpose of
<strong>separating one column</strong> <strong>into multiple
columns</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(separate)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, col, into, <span class="at">sep =</span> <span class="st">&quot;[^[:alnum:]]+&quot;</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra =</span> <span class="st">&quot;warn&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;warn&quot;</span>, ...)  </span></code></pre></div>
<ul>
<li><p>Given either <strong>regular expression</strong> or a
<strong>vector of character positions</strong>, this function
<strong>turns</strong> a <strong>single</strong>
<strong><em>character</em></strong> <strong>column</strong> into
<strong>multiple columns</strong>.</p></li>
<li><p>By <strong>default</strong>, it splits on <em>non-alphanumeric
values</em> (something else than a letter or number).</p></li>
</ul>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(res_g, <span class="at">col =</span> sex_class, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;class&quot;</span>))</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>   grade    sex class count</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      A   male     <span class="dv">1</span>     <span class="dv">3</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      B   male     <span class="dv">1</span>     <span class="dv">6</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      C   male     <span class="dv">1</span>     <span class="dv">7</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      D   male     <span class="dv">1</span>     <span class="dv">4</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      E   male     <span class="dv">1</span>     <span class="dv">1</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      A female     <span class="dv">1</span>     <span class="dv">4</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      B female     <span class="dv">1</span>     <span class="dv">4</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      C female     <span class="dv">1</span>     <span class="dv">4</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      D female     <span class="dv">1</span>     <span class="dv">0</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     E female     <span class="dv">1</span>     <span class="dv">1</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>     A   male     <span class="dv">2</span>     <span class="dv">3</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>     B   male     <span class="dv">2</span>     <span class="dv">3</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>     C   male     <span class="dv">2</span>     <span class="dv">3</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>     D   male     <span class="dv">2</span>     <span class="dv">8</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>     E   male     <span class="dv">2</span>     <span class="dv">2</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>     A female     <span class="dv">2</span>     <span class="dv">4</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>     B female     <span class="dv">2</span>     <span class="dv">5</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>     C female     <span class="dv">2</span>     <span class="dv">8</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>     D female     <span class="dv">2</span>     <span class="dv">1</span></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>     E female     <span class="dv">2</span>     <span class="dv">7</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(res_pl, <span class="at">col =</span> sex_class, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;class&quot;</span>))</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 4</span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>   grade sex    class count</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A     male   <span class="dv">1</span>         <span class="dv">3</span></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> A     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> A     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> A     female <span class="dv">2</span>         <span class="dv">4</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> B     male   <span class="dv">1</span>         <span class="dv">6</span></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> B     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> B     female <span class="dv">2</span>         <span class="dv">5</span></span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> C     male   <span class="dv">1</span>         <span class="dv">7</span></span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> C     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> C     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> C     female <span class="dv">2</span>         <span class="dv">8</span></span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> D     male   <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> D     female <span class="dv">1</span>         <span class="dv">0</span></span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> D     male   <span class="dv">2</span>         <span class="dv">8</span></span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> D     female <span class="dv">2</span>         <span class="dv">1</span></span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> E     male   <span class="dv">1</span>         <span class="dv">1</span></span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> E     female <span class="dv">1</span>         <span class="dv">1</span></span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> E     male   <span class="dv">2</span>         <span class="dv">2</span></span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> E     female <span class="dv">2</span>         <span class="dv">7</span></span></code></pre></div>
<ul>
<li>Conveniently, <code>separate()</code> was able to figure out on its
own <strong>how to separate</strong> the <code>sex_class</code> column.
As we said, unless we request otherwise with the <code>sep</code>
argument, it splits on non-alphanumeric values. In other words, it
assumes that the values are separated by something other than a letter
or number (in this case, an underscore).</li>
</ul>
<p>Finally, let’s do the <strong>same tidying procedure without causing
intermediate results</strong>.</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>students2 <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>grade, <span class="at">names_to =</span> <span class="st">&quot;sex_class&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> sex_class, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;class&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 4</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>   grade sex    class count</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> A     male   <span class="dv">1</span>         <span class="dv">3</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> A     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> A     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> A     female <span class="dv">2</span>         <span class="dv">4</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> B     male   <span class="dv">1</span>         <span class="dv">6</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> B     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> B     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> B     female <span class="dv">2</span>         <span class="dv">5</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> C     male   <span class="dv">1</span>         <span class="dv">7</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> C     female <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> C     male   <span class="dv">2</span>         <span class="dv">3</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> C     female <span class="dv">2</span>         <span class="dv">8</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> D     male   <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> D     female <span class="dv">1</span>         <span class="dv">0</span></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> D     male   <span class="dv">2</span>         <span class="dv">8</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> D     female <span class="dv">2</span>         <span class="dv">1</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> E     male   <span class="dv">1</span>         <span class="dv">1</span></span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> E     female <span class="dv">1</span>         <span class="dv">1</span></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> E     male   <span class="dv">2</span>         <span class="dv">2</span></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> E     female <span class="dv">2</span>         <span class="dv">7</span></span></code></pre></div>
</div>
<div
id="variables-stored-in-both-rows-and-columns.-using-gather-betterpivot_longer-and-spread-better-pivot_wider-from-tidyr-package-and-parse_number-from-readr-package-within-mutate-from-dplyr-package."
class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Variables stored in
both rows and columns. Using <code>gather()</code>
(better<code>pivot_longer()</code>) and <code>spread()</code> (better
<code>pivot_wider()</code>) from <code>tidyr</code> package, and
<code>parse_number()</code> from <code>readr</code> package within
<code>mutate()</code> from <code>dplyr</code> package.</h3>
<p>A third symptom of messy data is when <strong>variables are stored in
both rows and columns</strong>.</p>
<p>The <code>students3</code> dataset provides an example of this.</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>students3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/students3.csv&quot;</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>students3</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    name    test class1 class2 class3 class4 class5</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Sally midterm      A   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      B   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Sally   final      C   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   Jeff midterm   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      D   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      A   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   Jeff   final   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      E   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  Roger midterm   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      B</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  Roger   final   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      A   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      A</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  Karen midterm   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C      A   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  Karen   final   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C      A   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  Brian midterm      B   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      A</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Brian   final      B   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>   <span class="er">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>      C</span></code></pre></div>
<ul>
<li><p>This dataset contains <strong>midterm and final exam grades for
five students</strong>, each of whom were <strong>enrolled in exactly
two of five</strong> possible <strong>classes</strong>.</p></li>
<li><p>The first variable, <code>name</code>, is already a column and
should remain as it is.</p></li>
<li><p>The headers of the last five columns, <code>class1</code> through
<code>class5</code>, are <strong>all different values</strong> of what
should be a <code>class</code> variable.</p></li>
<li><p>The <strong>values</strong> in the <code>test</code> column,
<code>midterm</code> and <code>final</code>, <strong>should each
be</strong> its own <strong>variable</strong> containing the respective
grades for each student.</p></li>
</ul>
<p>This will require <strong>multiple steps</strong>, which we will
build up gradually using <code>%&gt;%</code>.</p>
<ul>
<li><strong>First step</strong>.<br />
Let’s <em>gather</em> the columns <code>class1</code> through
<code>class5</code> into a new variable <code>class</code>, and
<em>remove</em> the missing values.</li>
</ul>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>students3 <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> class1<span class="sc">:</span>class5,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;grade&quot;</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>            <span class="co"># gather() has the &quot;na.rm&quot; parameter</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 4</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>   name  test    class  grade</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>   <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>fct<span class="sc">&gt;</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Sally midterm class1 A    </span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Sally midterm class3 B    </span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Sally final   class1 C    </span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Sally final   class3 C    </span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Jeff  midterm class2 D    </span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Jeff  midterm class4 A    </span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Jeff  final   class2 E    </span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Jeff  final   class4 C    </span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Roger midterm class2 C    </span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Roger midterm class5 B    </span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> Roger final   class2 A    </span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> Roger final   class5 A    </span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> Karen midterm class3 C    </span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> Karen midterm class4 A    </span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> Karen final   class3 C    </span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> Karen final   class4 A    </span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> Brian midterm class1 B    </span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> Brian midterm class5 A    </span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> Brian final   class1 B    </span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> Brian final   class5 C    </span></code></pre></div>
<ul>
<li><p><strong>Second step</strong>.<br />
Now we need to <strong>turn the values</strong> of the <code>test</code>
column, <code>midterm</code> and <code>final</code>,
<strong>into</strong> <strong>columns (variables)</strong>.</p></li>
<li><p>We can use for this task <strong>the <code>spread()</code>
function</strong>.</p></li>
<li><p>But nowadays, the development on <code>spread()</code> is
complete, and for new code <strong>it’s recommended</strong>
<strong>switching to <code>pivot_wider()</code></strong>, which is
<em>easier</em> to use, more <em>featureful</em>, and still under
<em>active development</em>.</p></li>
</ul>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(spread)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, key, value, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>, <span class="at">drop =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="cn">NULL</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pivot_wider)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (data, <span class="at">id_cols =</span> <span class="cn">NULL</span>, <span class="at">id_expand =</span> <span class="cn">FALSE</span>, <span class="at">names_from =</span> name, <span class="at">names_prefix =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">names_glue =</span> <span class="cn">NULL</span>, <span class="at">names_sort =</span> <span class="cn">FALSE</span>, <span class="at">names_vary =</span> <span class="st">&quot;fastest&quot;</span>, </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_expand =</span> <span class="cn">FALSE</span>, <span class="at">names_repair =</span> <span class="st">&quot;check_unique&quot;</span>, <span class="at">values_from =</span> value, </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_fill =</span> <span class="cn">NULL</span>, <span class="at">values_fn =</span> <span class="cn">NULL</span>, <span class="at">unused_fn =</span> <span class="cn">NULL</span>, ...)  </span></code></pre></div>
<ul>
<li><p>In short, <code>spread(data, key, value)</code><br />
<em>is equivalent to</em>
<code>pivot_wider(data, names_from = key, values_from = value)</code></p></li>
<li><p>More details in <code>vignette("pivot")</code>.</p></li>
</ul>
<p>Let’s apply both to our example.</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>students3 <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> class1<span class="sc">:</span>class5,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;grade&quot;</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(test, grade) <span class="sc">%&gt;%</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 4</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>   name  class  final midterm</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>  </span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Brian class1 B     B      </span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Brian class5 C     A      </span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Jeff  class2 E     D      </span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Jeff  class4 C     A      </span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Karen class3 C     C      </span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Karen class4 A     A      </span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Roger class2 A     C      </span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Roger class5 A     B      </span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Sally class1 C     A      </span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Sally class3 C     B      </span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>students3 <span class="sc">%&gt;%</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> class1<span class="sc">:</span>class5,</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;grade&quot;</span>,</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> test, <span class="at">values_from =</span> grade) <span class="sc">%&gt;%</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 4</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>   name  class  midterm final</span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>fct<span class="sc">&gt;</span>   <span class="er">&lt;</span>fct<span class="sc">&gt;</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Brian class1 B       B    </span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Brian class5 A       C    </span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Jeff  class2 D       E    </span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Jeff  class4 A       C    </span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Karen class3 C       C    </span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Karen class4 A       A    </span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Roger class2 C       A    </span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Roger class5 B       A    </span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Sally class1 A       C    </span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Sally class3 B       C    </span></code></pre></div>
<ul>
<li><p><strong>Third step</strong>.<br />
Lastly, we want the <strong>values</strong> in the <code>class</code>
column to simply be <strong>1, 2, …, 5</strong> and <em>not</em>
<strong>class1, class2, …, class5</strong>.</p></li>
<li><p>We can use the <code>parse_number()</code> function from
<code>readr</code> package to accomplish this.</p></li>
</ul>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>Registered S3 method overwritten by <span class="st">&#39;readr&#39;</span><span class="sc">:</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  method                    from       </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  as.data.frame.spec_tbl_df R_GlobalEnv</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(parse_number)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;NA&quot;</span>), <span class="at">locale =</span> <span class="fu">default_locale</span>(), <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="st">&quot;class5&quot;</span>)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">5</span></span></code></pre></div>
<ul>
<li><p>It <strong>drops</strong> <em>any non-numeric</em> characters
<strong>before or after</strong> the <em>first number</em>.</p></li>
<li><p>So we can use <code>parse_number()</code> <strong>within</strong>
<code>mutate()</code> to <strong>overwrite</strong> the
<code>class</code> column.</p></li>
</ul>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>students3 <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> class1<span class="sc">:</span>class5,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;grade&quot;</span>,</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> test, <span class="at">values_from =</span> grade) <span class="sc">%&gt;%</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">class =</span> <span class="fu">parse_number</span>(class)) <span class="sc">%&gt;%</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 4</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>   name  class midterm final</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span>   <span class="er">&lt;</span>fct<span class="sc">&gt;</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> Brian     <span class="dv">1</span> B       B    </span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> Brian     <span class="dv">5</span> A       C    </span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> Jeff      <span class="dv">2</span> D       E    </span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> Jeff      <span class="dv">4</span> A       C    </span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> Karen     <span class="dv">3</span> C       C    </span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> Karen     <span class="dv">4</span> A       A    </span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> Roger     <span class="dv">2</span> C       A    </span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> Roger     <span class="dv">5</span> B       A    </span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> Sally     <span class="dv">1</span> A       C    </span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Sally     <span class="dv">3</span> B       C    </span></code></pre></div>
</div>
<div
id="multiple-types-of-observational-units-stored-in-the-same-table.-using-select-and-unique."
class="section level3" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Multiple types of
observational units stored in the same table. Using
<code>select()</code> and <code>unique()</code>.</h3>
<p>The fourth messy data problem we’ll look at occurs when
<strong>multiple observational units</strong> are stored in the
<strong>same table</strong>.</p>
<p>The <code>students4</code> dataset presents an example of this.</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>students4 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/students4.csv&quot;</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>students4</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    id  name sex class midterm final</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">168</span> Brian   F     <span class="dv">1</span>       B     B</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">168</span> Brian   F     <span class="dv">5</span>       A     C</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">588</span> Sally   M     <span class="dv">1</span>       A     C</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">588</span> Sally   M     <span class="dv">3</span>       B     C</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">710</span>  Jeff   M     <span class="dv">2</span>       D     E</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">710</span>  Jeff   M     <span class="dv">4</span>       A     C</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">731</span> Roger   F     <span class="dv">2</span>       C     A</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">731</span> Roger   F     <span class="dv">5</span>       B     A</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">908</span> Karen   M     <span class="dv">3</span>       C     C</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">908</span> Karen   M     <span class="dv">4</span>       A     A</span></code></pre></div>
<ul>
<li><p>This data frame is almost the same as our tidy version of
<code>students3</code>. The only difference is that
<code>students4</code> <strong>provides a unique
<code>id</code></strong> for each student, <strong>as well as</strong>
his or her <strong><code>sex</code></strong>.</p></li>
<li><p>At first glance, there doesn’t seem to be much of a problem with
<code>students4</code>. <strong>All columns</strong> are
<strong>variables</strong> and <strong>all rows</strong> are
<strong>observations</strong>.</p></li>
<li><p><strong>However</strong>, notice that <strong>each
<code>id</code>, <code>name</code>, and <code>sex</code></strong> is
<strong>repeated twice</strong>, which seems quite redundant. This is a
<em>hint</em> that our data contains <em>multiple observational
units</em> in a <em>single table</em>.</p></li>
</ul>
<p>Our <strong>solution</strong> will be to <strong>break
<code>students4</code> into two separate tables</strong>.</p>
<ul>
<li><p>One table, <code>student_info</code>, containing <strong>basic
student information</strong>: <code>id</code>, <code>name</code> and
<code>sex</code>.</p></li>
<li><p>The other, <code>gradebook</code>, containing
<strong>grades</strong>: <code>id</code>, <code>class</code>,
<code>midterm</code>, <code>final</code>.</p></li>
<li><p><strong>Important notice</strong>: we’ll include
<strong><code>id</code> column in both tables</strong>.</p>
<ul>
<li><p>In the world of relational databases, <code>id</code> is called
our <em>primary key</em> since it allows us to connect each student
listed in <code>student_info</code> with their grades listed in
<code>gradebook</code>.</p></li>
<li><p>Without a unique identifier, we might not know how the tables are
related.</p></li>
<li><p>In this case, we could have also used the <code>name</code>
variable, since each student happens to have a unique name.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New table with basic student info from students4, removing duplicates.</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>student_info <span class="ot">&lt;-</span> students4 <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">select</span>(id, name, sex) <span class="sc">%&gt;%</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>                    unique <span class="sc">%&gt;%</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>                    print</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>   id  name sex</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">168</span> Brian   F</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">588</span> Sally   M</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">710</span>  Jeff   M</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="dv">731</span> Roger   F</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="dv">908</span> Karen   M</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co"># New table with grades.</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>gradebook <span class="ot">&lt;-</span> students4 <span class="sc">%&gt;%</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">select</span>(id, class, midterm, final) <span class="sc">%&gt;%</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>                 print</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>    id class midterm final</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">168</span>     <span class="dv">1</span>       B     B</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">168</span>     <span class="dv">5</span>       A     C</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">588</span>     <span class="dv">1</span>       A     C</span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">588</span>     <span class="dv">3</span>       B     C</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">710</span>     <span class="dv">2</span>       D     E</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">710</span>     <span class="dv">4</span>       A     C</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">731</span>     <span class="dv">2</span>       C     A</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">731</span>     <span class="dv">5</span>       B     A</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">908</span>     <span class="dv">3</span>       C     C</span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">908</span>     <span class="dv">4</span>       A     A</span></code></pre></div>
</div>
<div
id="a-single-observational-unit-stored-in-multiple-tables.-using-mutate-and-bind_rows-from-dplyr-package."
class="section level3" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> A single
observational unit stored in multiple tables. Using
<code>mutate()</code> and <code>bind_rows()</code> from
<code>dplyr</code> package.</h3>
<p>The fifth and final messy data scenario that we’ll address is when a
<strong>single observational unit</strong> is stored in <strong>multiple
tables</strong>.</p>
<p>To illustrate this, we’ve created two datasets, <code>passed</code>
and <code>failed</code>.</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>passed <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/passed.csv&quot;</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>passed</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>   name class final</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Brian     <span class="dv">1</span>     B</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Roger     <span class="dv">2</span>     A</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Roger     <span class="dv">5</span>     A</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Karen     <span class="dv">4</span>     A</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>failed <span class="ot">&lt;-</span> <span class="fu">read.csv</span> (<span class="st">&quot;./3_data/failed.csv&quot;</span>)</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>failed</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>   name class final</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Brian     <span class="dv">5</span>     C</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Sally     <span class="dv">1</span>     C</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Sally     <span class="dv">3</span>     C</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Jeff     <span class="dv">2</span>     E</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  Jeff     <span class="dv">4</span>     C</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Karen     <span class="dv">3</span>     C</span></code></pre></div>
<ul>
<li><p>Teachers decided to only take into consideration final exam
grades in determining whether students passed or failed each class. As
you may have inferred from the data, students passed a class if they
received a final exam grade of A or B and failed otherwise.</p></li>
<li><p>The <strong>name of each dataset</strong> actually represents the
<strong>value</strong> of a new <strong>variable</strong> that we can
call <code>status</code>.</p></li>
</ul>
<p>So the <strong>solution</strong> is to <strong>join the two tables
together</strong>, as follows:</p>
<ul>
<li><em>First</em>, we’ll add the new <code>status</code> column to each
table containing the <code>"passed"</code> and <code>"failed"</code>
information, respectively, so that it’s not lost when we put everything
together.</li>
</ul>
<div class="sourceCode" id="cb150"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>passed <span class="ot">&lt;-</span> passed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">status =</span> <span class="st">&quot;passed&quot;</span>) <span class="sc">%&gt;%</span> print</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>   name class final status</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Brian     <span class="dv">1</span>     B passed</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Roger     <span class="dv">2</span>     A passed</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Roger     <span class="dv">5</span>     A passed</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Karen     <span class="dv">4</span>     A passed</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>failed <span class="ot">&lt;-</span> failed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">status =</span> <span class="st">&quot;failed&quot;</span>) <span class="sc">%&gt;%</span> print</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>   name class final status</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Brian     <span class="dv">5</span>     C failed</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Sally     <span class="dv">1</span>     C failed</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Sally     <span class="dv">3</span>     C failed</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Jeff     <span class="dv">2</span>     E failed</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  Jeff     <span class="dv">4</span>     C failed</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Karen     <span class="dv">3</span>     C failed</span></code></pre></div>
<ul>
<li>Then we’ll use **the <code>bind_rows()</code> function from the
<code>dplyr</code> package to join the those tables.</li>
</ul>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bind_rows)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (..., <span class="at">.id =</span> <span class="cn">NULL</span>)  </span></code></pre></div>
<ul>
<li><p>This is an <strong>efficient implementation</strong> of the
<strong>common pattern</strong> of <code>do.call(rbind, dfs)</code> for
binding many data frames into one by rows.</p></li>
<li><p>There’s also the <code>bind_cols()</code> function, that
implements <code>do.call(cbind, dfs)</code> common pater for binding
many data frames into one by columns.</p></li>
</ul>
<div class="sourceCode" id="cb152"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(passed, failed)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    name class final status</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Brian     <span class="dv">1</span>     B passed</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Roger     <span class="dv">2</span>     A passed</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  Roger     <span class="dv">5</span>     A passed</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Karen     <span class="dv">4</span>     A passed</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  Brian     <span class="dv">5</span>     C failed</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  Sally     <span class="dv">1</span>     C failed</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  Sally     <span class="dv">3</span>     C failed</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   Jeff     <span class="dv">2</span>     E failed</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   Jeff     <span class="dv">4</span>     C failed</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> Karen     <span class="dv">3</span>     C failed</span></code></pre></div>
<ul>
<li>So, each row is an observation, each column is a variable, and the
table contains a single observational unit. Thus, the data are
tidy.</li>
</ul>
</div>
</div>
<div id="final-example-tidying-a-real-dataset." class="section level2"
number="8.2">
<h2><span class="header-section-number">8.2</span> Final example:
tidying a real dataset.</h2>
<p>The <strong>SAT</strong> is a popular <strong>college-readiness
exam</strong> in the United States that consists of <em>three</em>
<em>sections</em>: critical reading, mathematics, and writing. Students
can earn up to 800 points on each section.</p>
<p>The SAT dataset presents the <strong>total number of
students</strong>, for <strong>each combination</strong> of <strong>exam
section</strong> <strong>and sex</strong>, within <em>each of six score
ranges</em>.</p>
<p>It comes from the <a
href="http://research.collegeboard.org/programs/sat/data/cb-seniors-2013">Total
Group Report 2013</a>, which I’ve already downloaded.</p>
<p>The <strong>following <code>sat</code> variable</strong> contains
data on <strong>all college-bound seniors</strong> who <strong>took the
SAT exam</strong> <strong>in 2013</strong>.</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>sat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/sat.csv&quot;</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>sat</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  score_range read_male read_fem read_total math_male math_fem math_total</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">700-800</span>     <span class="dv">40151</span>    <span class="dv">38898</span>      <span class="dv">79049</span>     <span class="dv">74461</span>    <span class="dv">46040</span>     <span class="dv">120501</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">600-690</span>    <span class="dv">121950</span>   <span class="dv">126084</span>     <span class="dv">248034</span>    <span class="dv">162564</span>   <span class="dv">133954</span>     <span class="dv">296518</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">500-590</span>    <span class="dv">227141</span>   <span class="dv">259553</span>     <span class="dv">486694</span>    <span class="dv">233141</span>   <span class="dv">257678</span>     <span class="dv">490819</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">400-490</span>    <span class="dv">242554</span>   <span class="dv">296793</span>     <span class="dv">539347</span>    <span class="dv">204670</span>   <span class="dv">288696</span>     <span class="dv">493366</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">300-390</span>    <span class="dv">113568</span>   <span class="dv">133473</span>     <span class="dv">247041</span>     <span class="dv">82468</span>   <span class="dv">131025</span>     <span class="dv">213493</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     <span class="dv">200-290</span>     <span class="dv">30728</span>    <span class="dv">29154</span>      <span class="dv">59882</span>     <span class="dv">18788</span>    <span class="dv">26562</span>      <span class="dv">45350</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  write_male write_fem write_total</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">31574</span>     <span class="dv">39101</span>       <span class="dv">70675</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">100963</span>    <span class="dv">125368</span>      <span class="dv">226331</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">202326</span>    <span class="dv">247239</span>      <span class="dv">449565</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">262623</span>    <span class="dv">302933</span>      <span class="dv">565556</span></span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">146106</span>    <span class="dv">144381</span>      <span class="dv">290487</span></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>      <span class="dv">32500</span>     <span class="dv">24933</span>       <span class="dv">57433</span></span></code></pre></div>
<p>We’ll build up a <strong>series of chained commands</strong>, using
functions from both <code>tidyr</code> and <code>dplyr</code>. We’ll
accomplish the following three goals:</p>
<ol style="list-style-type: decimal">
<li>Select all columns that do NOT contain the word “total”, since if we
have the male and female data, we can always recreate the total count in
a separate column, if we want it.
<ul>
<li>Here we can use the <code>contains()</code> function, which we’ll
find detailed in <em>Special functions</em> section of
<code>?select</code>.<br />
</li>
</ul></li>
<li>Gather all columns EXCEPT <code>score_range</code>, using
<code>part_sex</code> as key and <code>count</code> as value.<br />
</li>
<li>Separate <code>part_sex</code> into two separate variables, called
<code>part</code> and <code>sex</code>, respectively.
<ul>
<li>We may need to check the <em>Examples</em> section of
<code>?separate</code> to remember how the <code>into</code> argument
should be phrased.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb154"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>sat <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;total&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>score_range, <span class="at">names_to =</span> <span class="st">&quot;part_sex&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(part_sex, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;sex&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 36 × 4</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>   score_range part  sex    count</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">700-800</span>     read  male   <span class="dv">40151</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">700-800</span>     read  fem    <span class="dv">38898</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">700-800</span>     math  male   <span class="dv">74461</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">700-800</span>     math  fem    <span class="dv">46040</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">700-800</span>     write male   <span class="dv">31574</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">700-800</span>     write fem    <span class="dv">39101</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">600-690</span>     read  male  <span class="dv">121950</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">600-690</span>     read  fem   <span class="dv">126084</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">600-690</span>     math  male  <span class="dv">162564</span></span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">600-690</span>     math  fem   <span class="dv">133954</span></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 26 more rows</span></span></code></pre></div>
<p>Finally, we’ll append two more function calls to <strong>accomplish
the following</strong>:</p>
<ol style="list-style-type: decimal">
<li>Group the data by <code>part</code> and <code>sex</code>, in that
order.<br />
</li>
<li>Add two new columns, whose values will be automatically computed
group-by-group:
<ul>
<li>total = sum(count)<br />
</li>
<li>prop = count / total</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>sat <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;total&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>score_range, <span class="at">names_to =</span> <span class="st">&quot;part_sex&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(part_sex, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;sex&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(part, sex) <span class="sc">%&gt;%</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop =</span> count <span class="sc">/</span> total) <span class="sc">%&gt;%</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  print</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 36 × 6</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   part, sex [6]</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>   score_range part  sex    count  total   prop</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>       <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">700-800</span>     read  male   <span class="dv">40151</span> <span class="dv">776092</span> <span class="fl">0.0517</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">700-800</span>     read  fem    <span class="dv">38898</span> <span class="dv">883955</span> <span class="fl">0.0440</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">700-800</span>     math  male   <span class="dv">74461</span> <span class="dv">776092</span> <span class="fl">0.0959</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">700-800</span>     math  fem    <span class="dv">46040</span> <span class="dv">883955</span> <span class="fl">0.0521</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">700-800</span>     write male   <span class="dv">31574</span> <span class="dv">776092</span> <span class="fl">0.0407</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">700-800</span>     write fem    <span class="dv">39101</span> <span class="dv">883955</span> <span class="fl">0.0442</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">600-690</span>     read  male  <span class="dv">121950</span> <span class="dv">776092</span> <span class="fl">0.157</span> </span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">600-690</span>     read  fem   <span class="dv">126084</span> <span class="dv">883955</span> <span class="fl">0.143</span> </span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">600-690</span>     math  male  <span class="dv">162564</span> <span class="dv">776092</span> <span class="fl">0.209</span> </span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">600-690</span>     math  fem   <span class="dv">133954</span> <span class="dv">883955</span> <span class="fl">0.152</span> </span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a><span class="co"># … with 26 more rows</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="merging-data." class="section level1" number="9">
<h1><span class="header-section-number">9</span> Merging data.</h1>
<p>Sometimes we’ll want to be able to <strong>merge two or more
datasets</strong> together.</p>
<ul>
<li><p>Usually we’ll want to <strong>match</strong> those datasets
<strong>based on an ID</strong>.</p></li>
<li><p>This is <em>very similar</em> to the idea of having a <em>linked
set of tables</em> in a database like <code>MySQL</code>.</p></li>
</ul>
<div id="getting-peer-review-experiment-data-to-work-with."
class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Getting peer review
experiment data to work with.</h2>
<p>We are going to take data from <a
href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0026895">this
peer review experiment</a>.</p>
<ul>
<li><p>This is an experiment that collected data on people who submitted
answers to questions like SAT questions. And then people who reviewed
those answers and tried to decide whether they were right or
not.</p></li>
<li><p>This was a model system for how the peer review system works in
scientific studies.</p></li>
</ul>
<p>There are two files from the peer review dataset that we are going to
download:</p>
<ul>
<li><code>reviews.csv</code> and <code>solutions.csv</code>.</li>
</ul>
<p>We can <strong>download</strong> them from <a
href="http://www.sharecsv.com/dl/0863fd2414355555be0260f46dbe937b/">this
link</a>.<br />
They are also in the <a
href="https://github.com/DataScienceSpecialization/courses/tree/master/03_GettingData/03_05_mergingData/data">Data
Science Specialization github page</a>.</p>
<div class="sourceCode" id="cb156"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;./3_data&quot;</span>)) {<span class="fu">dir.create</span>(<span class="st">&quot;./3_data&quot;</span>)}</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>fileUrl1 <span class="ot">=</span> <span class="st">&quot;http://www.sharecsv.com/dl/e70e9c289adc4b87c900fdf69093f996/reviews.csv&quot;</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>fileUrl2 <span class="ot">=</span> <span class="st">&quot;http://www.sharecsv.com/dl/0863fd2414355555be0260f46dbe937b/solutions.csv&quot;</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(fileUrl1, <span class="at">destfile =</span> <span class="st">&quot;./3_data/reviews.csv&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(fileUrl2, <span class="at">destfile =</span> <span class="st">&quot;./3_data/solutions.csv&quot;</span>, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span></code></pre></div>
<ul>
<li><strong>Notice</strong> the <code>wb</code> (write binary)
<code>mode</code>.</li>
</ul>
<p>Once downloded, we can read those files from disk and load them into
R as data frames with <code>read.csv()</code>.</p>
<div class="sourceCode" id="cb157"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>reviews <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./3_data/reviews.csv&quot;</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(reviews)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">199</span> obs. of  <span class="dv">7</span> variables<span class="sc">:</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> id         <span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span> ...</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> solution_id<span class="sc">:</span> int  <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">10</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">11</span> ...</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> reviewer_id<span class="sc">:</span> int  <span class="dv">27</span> <span class="dv">22</span> <span class="dv">28</span> <span class="dv">26</span> <span class="dv">29</span> <span class="dv">29</span> <span class="dv">25</span> <span class="dv">23</span> <span class="dv">29</span> <span class="dv">26</span> ...</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> start      <span class="sc">:</span> int  <span class="dv">1304095698</span> <span class="dv">1304095188</span> <span class="dv">1304095276</span> <span class="dv">1304095267</span> <span class="dv">1304095456</span> <span class="dv">1304095471</span> <span class="dv">1304095343</span> <span class="cn">NA</span> <span class="dv">1304095520</span> <span class="dv">1304095428</span> ...</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> stop       <span class="sc">:</span> int  <span class="dv">1304095758</span> <span class="dv">1304095206</span> <span class="dv">1304095320</span> <span class="dv">1304095423</span> <span class="dv">1304095469</span> <span class="dv">1304095513</span> <span class="dv">1304095382</span> <span class="cn">NA</span> <span class="dv">1304095613</span> <span class="dv">1304095488</span> ...</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> time_left  <span class="sc">:</span> int  <span class="dv">1754</span> <span class="dv">2306</span> <span class="dv">2192</span> <span class="dv">2089</span> <span class="dv">2043</span> <span class="dv">1999</span> <span class="dv">2130</span> <span class="cn">NA</span> <span class="dv">1899</span> <span class="dv">2024</span> ...</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> accept     <span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="cn">NA</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(reviews)</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>  id solution_id reviewer_id      start       stop time_left accept</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span>           <span class="dv">3</span>          <span class="dv">27</span> <span class="dv">1304095698</span> <span class="dv">1304095758</span>      <span class="dv">1754</span>      <span class="dv">1</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span>           <span class="dv">4</span>          <span class="dv">22</span> <span class="dv">1304095188</span> <span class="dv">1304095206</span>      <span class="dv">2306</span>      <span class="dv">1</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span>           <span class="dv">5</span>          <span class="dv">28</span> <span class="dv">1304095276</span> <span class="dv">1304095320</span>      <span class="dv">2192</span>      <span class="dv">1</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">4</span>           <span class="dv">1</span>          <span class="dv">26</span> <span class="dv">1304095267</span> <span class="dv">1304095423</span>      <span class="dv">2089</span>      <span class="dv">1</span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">5</span>          <span class="dv">10</span>          <span class="dv">29</span> <span class="dv">1304095456</span> <span class="dv">1304095469</span>      <span class="dv">2043</span>      <span class="dv">1</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">6</span>           <span class="dv">2</span>          <span class="dv">29</span> <span class="dv">1304095471</span> <span class="dv">1304095513</span>      <span class="dv">1999</span>      <span class="dv">1</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>solutions <span class="ot">&lt;-</span> <span class="fu">read.csv</span>((<span class="st">&quot;./3_data/solutions.csv&quot;</span>))</span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(solutions)</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">205</span> obs. of  <span class="dv">7</span> variables<span class="sc">:</span></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> id        <span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span> ...</span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> problem_id<span class="sc">:</span> int  <span class="dv">156</span> <span class="dv">269</span> <span class="dv">34</span> <span class="dv">19</span> <span class="dv">605</span> <span class="dv">384</span> <span class="dv">538</span> <span class="dv">312</span> <span class="dv">327</span> <span class="dv">194</span> ...</span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> subject_id<span class="sc">:</span> int  <span class="dv">29</span> <span class="dv">25</span> <span class="dv">22</span> <span class="dv">23</span> <span class="dv">26</span> <span class="dv">27</span> <span class="dv">28</span> <span class="dv">24</span> <span class="dv">22</span> <span class="dv">23</span> ...</span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> start     <span class="sc">:</span> int  <span class="dv">1304095119</span> <span class="dv">1304095119</span> <span class="dv">1304095127</span> <span class="dv">1304095127</span> <span class="dv">1304095127</span> <span class="dv">1304095131</span> <span class="dv">1304095133</span> <span class="dv">1304095134</span> <span class="dv">1304095151</span> <span class="dv">1304095152</span> ...</span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> stop      <span class="sc">:</span> int  <span class="dv">1304095169</span> <span class="dv">1304095183</span> <span class="dv">1304095146</span> <span class="dv">1304095150</span> <span class="dv">1304095167</span> <span class="dv">1304095270</span> <span class="dv">1304095201</span> <span class="dv">1304095198</span> <span class="dv">1304095184</span> <span class="dv">1304095175</span> ...</span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> time_left <span class="sc">:</span> int  <span class="dv">2343</span> <span class="dv">2329</span> <span class="dv">2366</span> <span class="dv">2362</span> <span class="dv">2345</span> <span class="dv">2242</span> <span class="dv">2311</span> <span class="dv">2314</span> <span class="dv">2328</span> <span class="dv">2337</span> ...</span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> answer    <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">6</span> levels <span class="st">&quot;&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,..<span class="sc">:</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">2</span> ...</span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(solutions)</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a>  id problem_id subject_id      start       stop time_left answer</span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span>        <span class="dv">156</span>         <span class="dv">29</span> <span class="dv">1304095119</span> <span class="dv">1304095169</span>      <span class="dv">2343</span>      B</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span>        <span class="dv">269</span>         <span class="dv">25</span> <span class="dv">1304095119</span> <span class="dv">1304095183</span>      <span class="dv">2329</span>      C</span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span>         <span class="dv">34</span>         <span class="dv">22</span> <span class="dv">1304095127</span> <span class="dv">1304095146</span>      <span class="dv">2366</span>      C</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">4</span>         <span class="dv">19</span>         <span class="dv">23</span> <span class="dv">1304095127</span> <span class="dv">1304095150</span>      <span class="dv">2362</span>      D</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">5</span>        <span class="dv">605</span>         <span class="dv">26</span> <span class="dv">1304095127</span> <span class="dv">1304095167</span>      <span class="dv">2345</span>      A</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">6</span>        <span class="dv">384</span>         <span class="dv">27</span> <span class="dv">1304095131</span> <span class="dv">1304095270</span>      <span class="dv">2242</span>      C</span></code></pre></div>
<ul>
<li><p>The <code>reviews</code> data frame has one variable called
<code>solution_id</code>, that corresponds to the <code>id</code> that
appears in the <code>solutions</code> dataset.</p></li>
<li><p>Similarly, the <code>solutions</code> dataset also has a
<code>problem_id</code> and a <code>subject_id</code>, that match to
other datasets that we’re not going to be talking about in this
particular example.</p></li>
</ul>
</div>
<div id="merging-data-frames-merge-command-from-the-base-package."
class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Merging data frames:
<code>merge()</code> command from the <code>base package</code>.</h2>
<p>This function is used to <strong>merge two data frames
together</strong> by <em>common</em> <strong>column</strong> or
<strong>row</strong> <em>names</em>.</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merge)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, y, ...)  </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merge.data.frame)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, y, <span class="at">by =</span> <span class="fu">intersect</span>(<span class="fu">names</span>(x), <span class="fu">names</span>(y)), <span class="at">by.x =</span> by, <span class="at">by.y =</span> by, </span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">all =</span> <span class="cn">FALSE</span>, <span class="at">all.x =</span> all, <span class="at">all.y =</span> all, <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">suffixes =</span> <span class="fu">c</span>(<span class="st">&quot;.x&quot;</span>, </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;.y&quot;</span>), <span class="at">no.dups =</span> <span class="cn">TRUE</span>, <span class="at">incomparables =</span> <span class="cn">NULL</span>, ...)  </span></code></pre></div>
<ul>
<li><p><code>x</code> and <code>y</code> are <strong>the two data
frames</strong> to be merged.</p></li>
<li><p>Then, we can use either <code>by</code> or <code>by.x</code> or
<code>by.y</code> to tell <code>merge()</code> <strong>which of the
columns</strong> it should merge by:</p>
<ul>
<li><p>The rows in the two data frames that match on the specified
columns are extracted, and joined together.</p></li>
<li><p>By <strong>default</strong> the data frames are merged on
<em>common columns</em> (the <em>columns with names they both</em>
<em>have</em>). In our example, it would try to merge by
<code>id</code>, <code>start</code>, <code>stop</code>,
<code>time_left</code>, although that might not have any sense.</p></li>
<li><p>In the <code>by</code> parameter we can specify the
<em>common</em> columns we want to base the merging on.</p></li>
<li><p>And we can also merge based on <em>different columns</em> (column
that have <em>different names</em>). This <em>separate
specification</em> of the columns can be given by <code>by.x</code> and
<code>by.y</code>.</p></li>
<li><p>If <code>by</code> or both <code>by.x</code> and
<code>by.y</code> are of <strong>length 0</strong> (a length zero vector
or <code>NULL</code>), the result, r, is the <strong>Cartesian
product</strong> of <code>x</code> and <code>y</code>, that is to say, r
will be a data frame whose rows will be the <em>product of the rows</em>
and whose columns will be the <em>sum of the columns</em>:</p>
<ul>
<li>dim(r) = c(nrow(x)*nrow(y), ncol(x) + ncol(y)).</li>
</ul></li>
<li><p>If <code>all.x</code> is <code>TRUE</code>, all the non matching
cases of <code>x</code> are appended to the result as well, with
<code>NA</code> filled in the corresponding columns of <code>y</code>;
analogously for <code>all.y</code>.</p></li>
<li><p>In <strong>SQL database terminology</strong>:</p>
<ul>
<li><p>The default value of <code>all = FALSE</code> gives a
<strong>natural join</strong>, a special case of an <strong>inner
join</strong>.</p></li>
<li><p>Specifying <code>all.x = TRUE</code> gives a <strong>left (outer)
join</strong>.</p></li>
<li><p>Specifying <code>all.y = TRUE</code> a
<code>right (outer) join</code>.</p></li>
<li><p>And both (<code>all = TRUE</code>), a <strong>(full) outer
join</strong>.</p></li>
<li><p>DBMSes do not match NULL records, equivalent to
<code>incomparables = NA</code> in R.</p></li>
</ul></li>
</ul></li>
</ul>
<p>So, looking again at the names of our data frames, we can use the
<code>solution_id</code> in the <code>reviews</code> data frame and the
<code>id</code> variable in the <code>solutions</code> dataset to
<code>merge()</code> these datasets together.</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(reviews)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">199</span>   <span class="dv">7</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reviews)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;id&quot;</span>          <span class="st">&quot;solution_id&quot;</span> <span class="st">&quot;reviewer_id&quot;</span> <span class="st">&quot;start&quot;</span>       <span class="st">&quot;stop&quot;</span>       </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>] <span class="st">&quot;time_left&quot;</span>   <span class="st">&quot;accept&quot;</span>     </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(solutions)</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">205</span>   <span class="dv">7</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(solutions)</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;id&quot;</span>         <span class="st">&quot;problem_id&quot;</span> <span class="st">&quot;subject_id&quot;</span> <span class="st">&quot;start&quot;</span>      <span class="st">&quot;stop&quot;</span>      </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>] <span class="st">&quot;time_left&quot;</span>  <span class="st">&quot;answer&quot;</span>    </span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>mergedData <span class="ot">&lt;-</span> <span class="fu">merge</span>(reviews, solutions, <span class="at">by.x =</span> <span class="st">&quot;solution_id&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;id&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mergedData)</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">205</span>  <span class="dv">13</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mergedData)</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;solution_id&quot;</span> <span class="st">&quot;id&quot;</span>          <span class="st">&quot;reviewer_id&quot;</span> <span class="st">&quot;start.x&quot;</span>     <span class="st">&quot;stop.x&quot;</span>     </span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;time_left.x&quot;</span> <span class="st">&quot;accept&quot;</span>      <span class="st">&quot;problem_id&quot;</span>  <span class="st">&quot;subject_id&quot;</span>  <span class="st">&quot;start.y&quot;</span>    </span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">&quot;stop.y&quot;</span>      <span class="st">&quot;time_left.y&quot;</span> <span class="st">&quot;answer&quot;</span>     </span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mergedData)</span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>  solution_id id reviewer_id    start.x     stop.x time_left.x accept</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="dv">1</span>  <span class="dv">4</span>          <span class="dv">26</span> <span class="dv">1304095267</span> <span class="dv">1304095423</span>        <span class="dv">2089</span>      <span class="dv">1</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>           <span class="dv">2</span>  <span class="dv">6</span>          <span class="dv">29</span> <span class="dv">1304095471</span> <span class="dv">1304095513</span>        <span class="dv">1999</span>      <span class="dv">1</span></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>           <span class="dv">3</span>  <span class="dv">1</span>          <span class="dv">27</span> <span class="dv">1304095698</span> <span class="dv">1304095758</span>        <span class="dv">1754</span>      <span class="dv">1</span></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>           <span class="dv">4</span>  <span class="dv">2</span>          <span class="dv">22</span> <span class="dv">1304095188</span> <span class="dv">1304095206</span>        <span class="dv">2306</span>      <span class="dv">1</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>           <span class="dv">5</span>  <span class="dv">3</span>          <span class="dv">28</span> <span class="dv">1304095276</span> <span class="dv">1304095320</span>        <span class="dv">2192</span>      <span class="dv">1</span></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>           <span class="dv">6</span> <span class="dv">16</span>          <span class="dv">22</span> <span class="dv">1304095303</span> <span class="dv">1304095471</span>        <span class="dv">2041</span>      <span class="dv">1</span></span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>  problem_id subject_id    start.y     stop.y time_left.y answer</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        <span class="dv">156</span>         <span class="dv">29</span> <span class="dv">1304095119</span> <span class="dv">1304095169</span>        <span class="dv">2343</span>      B</span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        <span class="dv">269</span>         <span class="dv">25</span> <span class="dv">1304095119</span> <span class="dv">1304095183</span>        <span class="dv">2329</span>      C</span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">34</span>         <span class="dv">22</span> <span class="dv">1304095127</span> <span class="dv">1304095146</span>        <span class="dv">2366</span>      C</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">19</span>         <span class="dv">23</span> <span class="dv">1304095127</span> <span class="dv">1304095150</span>        <span class="dv">2362</span>      D</span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>        <span class="dv">605</span>         <span class="dv">26</span> <span class="dv">1304095127</span> <span class="dv">1304095167</span>        <span class="dv">2345</span>      A</span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>        <span class="dv">384</span>         <span class="dv">27</span> <span class="dv">1304095131</span> <span class="dv">1304095270</span>        <span class="dv">2242</span>      C</span></code></pre></div>
<ul>
<li><p>We “read” the <code>merge</code> statement we made, like this: we
<code>merge</code> the <code>reviews</code> data frame <em>based on</em>
or <em>by the</em> <code>solution_id</code>* variable and the
<code>solutions</code> data frame <em>based on the</em> <code>id</code>
variable.</p></li>
<li><p>Also, as we said, <code>all = TRUE</code> means that, if there’s
a value that appears in one data frame but not in the other, it should
include another row but with <code>NA</code> values for the missing
values that don’t appear in the other data frame.</p></li>
<li><p>So, we can see that the <code>solution_id</code> <em>fulfills the
ID role</em> for the new merged data frame, which is ordered by that
variable. Also, the <code>id</code> variable in the new data frame is
the <code>reviews</code>’ main <code>id</code> variable. So we can see
that the two datasets has been merged together, based on their common
id, so that, then we can analyze it as one dataset.</p></li>
</ul>
<div id="default-merging-behaviour." class="section level3"
number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Default merging
behaviour.</h3>
<p>As we said, the default of <code>merge()</code> is to merge
<strong>based on all common column names</strong>.</p>
<p>If we do an <strong>intersection of the names</strong> of both data
frames, we get the common variables.</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(<span class="fu">names</span>(reviews), <span class="fu">names</span>(solutions))</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;id&quot;</span>        <span class="st">&quot;start&quot;</span>     <span class="st">&quot;stop&quot;</span>      <span class="st">&quot;time_left&quot;</span></span></code></pre></div>
<p>So, <strong>if we try to merge without telling</strong> what to merge
on the basis of, the <code>merge()</code> command <strong>will
try</strong> to merge <strong>on the basis of all those four common
variables</strong>.</p>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>mergedData2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(reviews, solutions, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mergedData2)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">404</span>  <span class="dv">10</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mergedData2)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;id&quot;</span>          <span class="st">&quot;start&quot;</span>       <span class="st">&quot;stop&quot;</span>        <span class="st">&quot;time_left&quot;</span>   <span class="st">&quot;solution_id&quot;</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;reviewer_id&quot;</span> <span class="st">&quot;accept&quot;</span>      <span class="st">&quot;problem_id&quot;</span>  <span class="st">&quot;subject_id&quot;</span>  <span class="st">&quot;answer&quot;</span>     </span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mergedData2)</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  id      start       stop time_left solution_id reviewer_id accept problem_id</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span> <span class="dv">1304095119</span> <span class="dv">1304095169</span>      <span class="dv">2343</span>          <span class="cn">NA</span>          <span class="cn">NA</span>     <span class="cn">NA</span>        <span class="dv">156</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1</span> <span class="dv">1304095698</span> <span class="dv">1304095758</span>      <span class="dv">1754</span>           <span class="dv">3</span>          <span class="dv">27</span>      <span class="dv">1</span>         <span class="cn">NA</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">2</span> <span class="dv">1304095119</span> <span class="dv">1304095183</span>      <span class="dv">2329</span>          <span class="cn">NA</span>          <span class="cn">NA</span>     <span class="cn">NA</span>        <span class="dv">269</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">2</span> <span class="dv">1304095188</span> <span class="dv">1304095206</span>      <span class="dv">2306</span>           <span class="dv">4</span>          <span class="dv">22</span>      <span class="dv">1</span>         <span class="cn">NA</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">3</span> <span class="dv">1304095127</span> <span class="dv">1304095146</span>      <span class="dv">2366</span>          <span class="cn">NA</span>          <span class="cn">NA</span>     <span class="cn">NA</span>         <span class="dv">34</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">3</span> <span class="dv">1304095276</span> <span class="dv">1304095320</span>      <span class="dv">2192</span>           <span class="dv">5</span>          <span class="dv">28</span>      <span class="dv">1</span>         <span class="cn">NA</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>  subject_id answer</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">29</span>      B</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         <span class="cn">NA</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">25</span>      C</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="cn">NA</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>         <span class="dv">22</span>      C</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>         <span class="cn">NA</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span></span></code></pre></div>
<ul>
<li>What ends up happening is that the <code>id</code> variable will
match up sometimes between the two datasets. But <code>start</code>,
<code>stop</code> and <code>time_left</code> won’t necessarily match up.
So, what it ends up doing is it just creates a data frame that’s larger
that applies multiple rows, one for each row of <code>reviews</code> and
each row of <code>solutions</code>.</li>
</ul>
</div>
</div>
<div id="merging-using-join-from-the-plyr-package."
class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Merging using
<code>join()</code> from the <code>plyr package</code>.</h2>
<p>It’s a <strong>bit faster</strong> than <code>merge()</code> but, is
a <strong>bit less full featured</strong>.</p>
<ul>
<li>In other words, it <strong>only can merge</strong> on the basis of
<strong>common names</strong> between the two datasets. For example, we
couldn’t merge the two datasets we talked about before because we needed
to merge by <em>different names</em>: <code>solution_id</code> and
<code>id</code>; and <code>join()</code> <strong>only merges on the
basis of <code>id</code></strong>, even though it’s faster.</li>
</ul>
<div class="sourceCode" id="cb162"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(join)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, y, <span class="at">by =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;left&quot;</span>, <span class="at">match =</span> <span class="st">&quot;all&quot;</span>)  </span></code></pre></div>
<p>Here’s an example.</p>
<div class="sourceCode" id="cb163"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>df1</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>   id          x</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">7</span>  <span class="fl">0.1610699</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">3</span>  <span class="fl">1.2375574</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">4</span>  <span class="fl">0.1540239</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">10</span> <span class="sc">-</span><span class="fl">0.1311806</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">9</span> <span class="sc">-</span><span class="fl">0.3182240</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">2</span> <span class="sc">-</span><span class="fl">1.4902388</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">1</span> <span class="sc">-</span><span class="fl">0.1012916</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">6</span> <span class="sc">-</span><span class="fl">0.2337345</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="dv">8</span> <span class="sc">-</span><span class="fl">0.5128291</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">5</span>  <span class="fl">2.1090629</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>df2</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>   id          y</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">8</span> <span class="sc">-</span><span class="fl">1.1916544</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.9271405</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">3</span> <span class="sc">-</span><span class="fl">0.7876307</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">9</span> <span class="sc">-</span><span class="fl">0.5865832</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">4</span> <span class="sc">-</span><span class="fl">1.0998614</span></span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">2</span>  <span class="fl">0.4176784</span></span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">10</span>  <span class="fl">0.7287547</span></span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">6</span> <span class="sc">-</span><span class="fl">0.2494684</span></span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="dv">7</span>  <span class="fl">0.6758001</span></span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">1</span> <span class="sc">-</span><span class="fl">0.9349282</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">join</span>(df1, df2)</span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>Joining by<span class="sc">:</span> id</span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a>df12</span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>   id          x          y</span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">7</span>  <span class="fl">0.1610699</span>  <span class="fl">0.6758001</span></span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">3</span>  <span class="fl">1.2375574</span> <span class="sc">-</span><span class="fl">0.7876307</span></span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">4</span>  <span class="fl">0.1540239</span> <span class="sc">-</span><span class="fl">1.0998614</span></span>
<span id="cb163-36"><a href="#cb163-36" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">10</span> <span class="sc">-</span><span class="fl">0.1311806</span>  <span class="fl">0.7287547</span></span>
<span id="cb163-37"><a href="#cb163-37" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">9</span> <span class="sc">-</span><span class="fl">0.3182240</span> <span class="sc">-</span><span class="fl">0.5865832</span></span>
<span id="cb163-38"><a href="#cb163-38" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">2</span> <span class="sc">-</span><span class="fl">1.4902388</span>  <span class="fl">0.4176784</span></span>
<span id="cb163-39"><a href="#cb163-39" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">1</span> <span class="sc">-</span><span class="fl">0.1012916</span> <span class="sc">-</span><span class="fl">0.9349282</span></span>
<span id="cb163-40"><a href="#cb163-40" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">6</span> <span class="sc">-</span><span class="fl">0.2337345</span> <span class="sc">-</span><span class="fl">0.2494684</span></span>
<span id="cb163-41"><a href="#cb163-41" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="dv">8</span> <span class="sc">-</span><span class="fl">0.5128291</span> <span class="sc">-</span><span class="fl">1.1916544</span></span>
<span id="cb163-42"><a href="#cb163-42" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">5</span>  <span class="fl">2.1090629</span> <span class="sc">-</span><span class="fl">0.9271405</span></span>
<span id="cb163-43"><a href="#cb163-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-44"><a href="#cb163-44" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(df12, id)</span>
<span id="cb163-45"><a href="#cb163-45" aria-hidden="true" tabindex="-1"></a>   id          x          y</span>
<span id="cb163-46"><a href="#cb163-46" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">1</span> <span class="sc">-</span><span class="fl">0.1012916</span> <span class="sc">-</span><span class="fl">0.9349282</span></span>
<span id="cb163-47"><a href="#cb163-47" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">2</span> <span class="sc">-</span><span class="fl">1.4902388</span>  <span class="fl">0.4176784</span></span>
<span id="cb163-48"><a href="#cb163-48" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">3</span>  <span class="fl">1.2375574</span> <span class="sc">-</span><span class="fl">0.7876307</span></span>
<span id="cb163-49"><a href="#cb163-49" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">4</span>  <span class="fl">0.1540239</span> <span class="sc">-</span><span class="fl">1.0998614</span></span>
<span id="cb163-50"><a href="#cb163-50" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">5</span>  <span class="fl">2.1090629</span> <span class="sc">-</span><span class="fl">0.9271405</span></span>
<span id="cb163-51"><a href="#cb163-51" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">6</span> <span class="sc">-</span><span class="fl">0.2337345</span> <span class="sc">-</span><span class="fl">0.2494684</span></span>
<span id="cb163-52"><a href="#cb163-52" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">7</span>  <span class="fl">0.1610699</span>  <span class="fl">0.6758001</span></span>
<span id="cb163-53"><a href="#cb163-53" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">8</span> <span class="sc">-</span><span class="fl">0.5128291</span> <span class="sc">-</span><span class="fl">1.1916544</span></span>
<span id="cb163-54"><a href="#cb163-54" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="dv">9</span> <span class="sc">-</span><span class="fl">0.3182240</span> <span class="sc">-</span><span class="fl">0.5865832</span></span>
<span id="cb163-55"><a href="#cb163-55" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">10</span> <span class="sc">-</span><span class="fl">0.1311806</span>  <span class="fl">0.7287547</span></span></code></pre></div>
<ul>
<li><p>We created two data frames with a common <code>id</code>
identifier, but we’ve sampled them, so they’re in different
orders.</p></li>
<li><p>When we use the <code>join()</code> command on them, it merges
them by <code>id</code>.</p></li>
</ul>
<div
id="much-more-straightforward-multiple-data-frames-merging-join_all-command."
class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Much more
straightforward <em>multiple</em> data frames merging:
<code>join_all()</code> command.</h3>
<p>The main reason why we bring the <code>plyr</code> package up, is
that:</p>
<ul>
<li><p>if we have <strong>multiple data frames</strong> it’s relatively
<strong>challenging to do it with the <code>merge()</code>
command</strong>;</p></li>
<li><p>but <strong><em>if they have a common
<code>id</code></em></strong>, it’s <strong>very straightforward to do
it with the <code>join_all()</code> command</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(join_all)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (dfs, <span class="at">by =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;left&quot;</span>, <span class="at">match =</span> <span class="st">&quot;all&quot;</span>)  </span></code></pre></div>
<p>Let’s make an example.</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>dfList <span class="ot">&lt;-</span> <span class="fu">list</span>(df1, df2, df3)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="fu">join_all</span>(dfList)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>Joining by<span class="sc">:</span> id</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>Joining by<span class="sc">:</span> id</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>   id          x          y           z</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">6</span>  <span class="fl">1.3261691</span> <span class="sc">-</span><span class="fl">1.2629353</span>  <span class="fl">0.91189372</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">1</span> <span class="sc">-</span><span class="fl">1.0328261</span>  <span class="fl">0.3679021</span>  <span class="fl">0.90205376</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">9</span>  <span class="fl">1.1571767</span> <span class="sc">-</span><span class="fl">0.2540780</span>  <span class="fl">0.01291006</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">4</span>  <span class="fl">0.5845119</span>  <span class="fl">0.4418666</span> <span class="sc">-</span><span class="fl">1.13651642</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">2</span>  <span class="fl">0.8214731</span> <span class="sc">-</span><span class="fl">0.6376050</span>  <span class="fl">0.68869442</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">5</span>  <span class="fl">0.2267674</span>  <span class="fl">1.1353610</span> <span class="sc">-</span><span class="fl">0.55259420</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">8</span>  <span class="fl">0.5423893</span> <span class="sc">-</span><span class="fl">2.4745547</span> <span class="sc">-</span><span class="fl">0.22226980</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">7</span>  <span class="fl">2.5528799</span> <span class="sc">-</span><span class="fl">0.9517573</span> <span class="sc">-</span><span class="fl">1.00901433</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">10</span>  <span class="fl">0.6252108</span>  <span class="fl">0.8939156</span> <span class="sc">-</span><span class="fl">0.27488885</span></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">3</span>  <span class="fl">0.1040526</span>  <span class="fl">2.2334574</span>  <span class="fl">0.15253549</span></span></code></pre></div>
<ul>
<li>The first argument of <code>join_all()</code> must be a list.</li>
</ul>
</div>
</div>
<div id="further-resources-on-merging-data." class="section level2"
number="9.4">
<h2><span class="header-section-number">9.4</span> Further resources on
merging data.</h2>
<p>The <a href="https://www.statmethods.net/management/merging.html">R
data merging page</a> is very good.</p>
<p>Also <a href="http://plyr.had.co.nz/">the <code>plyr</code> page</a>
for merging datasets together.</p>
<p>Before we start doing this intensively, it’s <strong>worth paying
attention to</strong> whether we’re performing <strong>different kinds
of joins</strong>, whether we’re doing a sort of <strong>left
joins</strong>, or <strong>right joins</strong>.</p>
<ul>
<li><p>The best way to learn more about that is to go read about joins
in databases.</p></li>
<li><p>For example, the <a
href="https://en.wikipedia.org/wiki/Join_(SQL)">wikipedia entry about
SQL database joins</a>.</p></li>
</ul>
<hr />
</div>
</div>
<div id="session-info." class="section level1" number="10">
<h1><span class="header-section-number">10</span> Session Info.</h1>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>R version <span class="dv">3</span>.<span class="fl">6.3</span> (<span class="dv">2020-02-29</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>pc<span class="sc">-</span>linux<span class="sc">-</span><span class="fu">gnu</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>Running under<span class="sc">:</span> Ubuntu <span class="dv">18</span>.<span class="fl">04.6</span> LTS</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>blas<span class="sc">/</span>libblas.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>lapack<span class="sc">/</span>liblapack.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] LC_CTYPE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          LC_NUMERIC<span class="ot">=</span>C                 </span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>] LC_TIME<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>           LC_COLLATE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       </span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] LC_MONETARY<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       LC_MESSAGES<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>      </span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] LC_PAPER<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          LC_NAME<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          </span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] LC_ADDRESS<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>        LC_TELEPHONE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>     </span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] LC_MEASUREMENT<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>    LC_IDENTIFICATION<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] readr_2.<span class="fl">0.1</span>       tidyr_1.<span class="fl">2.0</span>       dplyr_1.<span class="fl">0.8</span>       reshape2_1.<span class="fl">4.4</span>   </span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] Hmisc_4<span class="fl">.4</span><span class="dv">-0</span>       ggplot2_3.<span class="fl">3.5</span>     Formula_1<span class="fl">.2</span><span class="dv">-3</span>     survival_3<span class="fl">.4</span><span class="dv">-0</span>   </span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] lattice_0<span class="fl">.20</span><span class="dv">-45</span>   jpeg_0<span class="fl">.1-8.1</span>      gitignore_0.<span class="fl">1.3</span>   rhdf5_2.<span class="fl">30.1</span>     </span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] httr_1.<span class="fl">4.2</span>        httpuv_1.<span class="fl">6.3</span>      sqldf_0<span class="fl">.4</span><span class="dv">-11</span>      RSQLite_2.<span class="fl">2.0</span>    </span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] gsubfn_0<span class="fl">.7</span>        proto_1.<span class="fl">0.0</span>       DBI_1.<span class="fl">1.1</span>         data.table_1.<span class="fl">14.0</span></span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] jsonlite_1.<span class="fl">7.2</span>    XML_3<span class="fl">.99-0.3</span>      xlsx_0.<span class="fl">6.3</span>        plyr_1.<span class="fl">8.6</span>       </span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] bit64_4.<span class="fl">0.5</span>         RColorBrewer_1<span class="fl">.1</span><span class="dv">-2</span>  tools_3.<span class="fl">6.3</span>        </span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>] backports_1.<span class="fl">4.1</span>     bslib_0.<span class="fl">3.0</span>         utf8_1.<span class="fl">2.2</span>         </span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] R6_2.<span class="fl">5.1</span>            rpart_4.<span class="fl">1.19</span>        colorspace_2<span class="fl">.0</span><span class="dv">-3</span>   </span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] nnet_7<span class="fl">.3</span><span class="dv">-18</span>         withr_2.<span class="fl">5.0</span>         tidyselect_1.<span class="fl">2.0</span>   </span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] gridExtra_2<span class="fl">.3</span>       bit_4.<span class="fl">0.4</span>           curl_4.<span class="fl">3.2</span>         </span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] compiler_3.<span class="fl">6.3</span>      chron_2<span class="fl">.3</span><span class="dv">-55</span>        cli_3.<span class="fl">6.0</span>          </span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] formatR_1<span class="fl">.14</span>        htmlTable_2.<span class="fl">0.1</span>     sass_0.<span class="fl">4.0</span>         </span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">22</span>] scales_1.<span class="fl">1.1</span>        checkmate_2.<span class="fl">0.0</span>     askpass_1<span class="fl">.1</span>        </span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] stringr_1.<span class="fl">4.0</span>       digest_0.<span class="fl">6.29</span>       foreign_0<span class="fl">.8</span><span class="dv">-76</span>     </span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">28</span>] rmarkdown_2<span class="fl">.11</span>      base64enc_0<span class="fl">.1</span><span class="dv">-3</span>     pkgconfig_2.<span class="fl">0.3</span>    </span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">31</span>] htmltools_0.<span class="fl">5.2</span>     fastmap_1.<span class="fl">1.0</span>       highr_0<span class="fl">.9</span>          </span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">34</span>] htmlwidgets_1.<span class="fl">5.4</span>   rlang_1.<span class="fl">0.6</span>         rstudioapi_0<span class="fl">.13</span>    </span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] jquerylib_0.<span class="fl">1.4</span>     generics_0.<span class="fl">1.2</span>      acepack_1.<span class="fl">4.1</span>      </span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">40</span>] magrittr_2.<span class="fl">0.2</span>      Matrix_1<span class="fl">.5</span><span class="dv">-1</span>        Rcpp_1.<span class="fl">0.7</span>         </span>
<span id="cb166-44"><a href="#cb166-44" aria-hidden="true" tabindex="-1"></a>[<span class="dv">43</span>] munsell_0.<span class="fl">5.0</span>       Rhdf5lib_1.<span class="fl">8.0</span>      fansi_1.<span class="fl">0.2</span>        </span>
<span id="cb166-45"><a href="#cb166-45" aria-hidden="true" tabindex="-1"></a>[<span class="dv">46</span>] clipr_0.<span class="fl">7.1</span>         lifecycle_1.<span class="fl">0.3</span>     stringi_1.<span class="fl">7.6</span>      </span>
<span id="cb166-46"><a href="#cb166-46" aria-hidden="true" tabindex="-1"></a>[<span class="dv">49</span>] yaml_2.<span class="fl">2.1</span>          grid_3.<span class="fl">6.3</span>          blob_1.<span class="fl">2.2</span>         </span>
<span id="cb166-47"><a href="#cb166-47" aria-hidden="true" tabindex="-1"></a>[<span class="dv">52</span>] promises_1.<span class="dv">2</span>.<span class="fl">0.1</span>    crayon_1.<span class="fl">5.0</span>        splines_3.<span class="fl">6.3</span>      </span>
<span id="cb166-48"><a href="#cb166-48" aria-hidden="true" tabindex="-1"></a>[<span class="dv">55</span>] xlsxjars_0.<span class="fl">6.1</span>      hms_1.<span class="fl">1.0</span>           knitr_1<span class="fl">.41</span>         </span>
<span id="cb166-49"><a href="#cb166-49" aria-hidden="true" tabindex="-1"></a>[<span class="dv">58</span>] pillar_1.<span class="fl">7.0</span>        tcltk_3.<span class="fl">6.3</span>         glue_1.<span class="fl">6.2</span>         </span>
<span id="cb166-50"><a href="#cb166-50" aria-hidden="true" tabindex="-1"></a>[<span class="dv">61</span>] evaluate_0<span class="fl">.19</span>       latticeExtra_0<span class="fl">.6</span><span class="dv">-29</span> vctrs_0.<span class="fl">5.2</span>        </span>
<span id="cb166-51"><a href="#cb166-51" aria-hidden="true" tabindex="-1"></a>[<span class="dv">64</span>] png_0<span class="fl">.1</span><span class="dv">-7</span>           tzdb_0.<span class="fl">3.0</span>          gtable_0.<span class="fl">3.0</span>       </span>
<span id="cb166-52"><a href="#cb166-52" aria-hidden="true" tabindex="-1"></a>[<span class="dv">67</span>] openssl_2.<span class="fl">0.5</span>       purrr_0.<span class="fl">3.4</span>         assertthat_0.<span class="fl">2.1</span>   </span>
<span id="cb166-53"><a href="#cb166-53" aria-hidden="true" tabindex="-1"></a>[<span class="dv">70</span>] xfun_0<span class="fl">.36</span>           later_1.<span class="fl">3.0</span>         tibble_3.<span class="fl">1.8</span>       </span>
<span id="cb166-54"><a href="#cb166-54" aria-hidden="true" tabindex="-1"></a>[<span class="dv">73</span>] rJava_0<span class="fl">.9</span><span class="dv">-13</span>        memoise_1.<span class="fl">1.0</span>       cluster_2.<span class="fl">1.4</span>      </span>
<span id="cb166-55"><a href="#cb166-55" aria-hidden="true" tabindex="-1"></a>[<span class="dv">76</span>] ellipsis_0.<span class="fl">3.2</span>     </span></code></pre></div>
<hr />
</div>

<div style="width: 100%; padding: 10px; box-sizing: border-box; text-align: justify; border: 1px solid gray;">
  <p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
</div>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>


<!--
<p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>
-->


<!--
<p style="font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
-->




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
