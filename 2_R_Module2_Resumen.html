<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>R Programming - Module 2</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Aprendiendo ciencia de datos con R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-hand-spock"></span>
     
    Resumen del contenido
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bars"></span>
     
    Contenido
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Data Science Toolbox</li>
    <li class="divider"></li>
    <li>
      <a href="1_DataScienceToolBox_Resumen.html">Módulo único</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">R</li>
    <li class="divider"></li>
    <li>
      <a href="2_R_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="2_R_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt_PrevPract.html">_práctica</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="2_R_Module3_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module4_Resumen.html">Módulo 4</a>
    </li>
    <li>
      <a href="2_R_Module4_ProgAssmt.html">Ejercicio final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Getting &amp; Cleaning Data</li>
    <li class="divider"></li>
    <li>
      <a href="3_GettingAndCleaningData_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Exploratory Data Analysis</li>
    <li class="divider"></li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Reproducible Research</li>
    <li class="divider"></li>
    <li>
      <a href="5_ReproducibleResearch_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_FinalProj.html">Proyectos finales</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html">
    <span class="fa fa-gears"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">R Programming - Module 2</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#control-strutures." id="toc-control-strutures."><span
class="toc-section-number">1</span> Control Strutures.</a>
<ul>
<li><a href="#a-very-quick-summary-of-the-logical-operators-in-r."
id="toc-a-very-quick-summary-of-the-logical-operators-in-r."><span
class="toc-section-number">1.1</span> A very quick summary of the
logical operators in R.</a>
<ul>
<li><a href="#operator-and." id="toc-operator-and."><span
class="toc-section-number">1.1.1</span> Operator AND.</a></li>
<li><a href="#operator-or." id="toc-operator-or."><span
class="toc-section-number">1.1.2</span> Operator OR.</a></li>
<li><a href="#rules-of-precedence." id="toc-rules-of-precedence."><span
class="toc-section-number">1.1.3</span> Rules of precedence.</a></li>
<li><a href="#exclusive-or." id="toc-exclusive-or."><span
class="toc-section-number">1.1.4</span> Exclusive OR.</a></li>
<li><a href="#useful-logical-functions."
id="toc-useful-logical-functions."><span
class="toc-section-number">1.1.5</span> Useful logical functions.</a>
<ul>
<li><a href="#istrue-and-identical."
id="toc-istrue-and-identical."><span
class="toc-section-number">1.1.5.1</span> isTRUE() and
identical().</a></li>
<li><a href="#which." id="toc-which."><span
class="toc-section-number">1.1.5.2</span> which().</a></li>
<li><a href="#any-all." id="toc-any-all."><span
class="toc-section-number">1.1.5.3</span> any(), all().</a></li>
</ul></li>
</ul></li>
<li><a href="#if-else." id="toc-if-else."><span
class="toc-section-number">1.2</span> if-else.</a>
<ul>
<li><a href="#syntax." id="toc-syntax."><span
class="toc-section-number">1.2.1</span> Syntax.</a></li>
<li><a href="#example." id="toc-example."><span
class="toc-section-number">1.2.2</span> Example.</a></li>
</ul></li>
<li><a href="#for-loops." id="toc-for-loops."><span
class="toc-section-number">1.3</span> for loops.</a>
<ul>
<li><a href="#syntax.-1" id="toc-syntax.-1"><span
class="toc-section-number">1.3.1</span> Syntax.</a></li>
<li><a href="#examples.-the-seq_along-and-the-seq_len-functions."
id="toc-examples.-the-seq_along-and-the-seq_len-functions."><span
class="toc-section-number">1.3.2</span> Examples. The
<em>seq_along()</em> and the <em>seq_len()</em> functions.</a></li>
</ul></li>
<li><a href="#while-loops." id="toc-while-loops."><span
class="toc-section-number">1.4</span> while loops.</a>
<ul>
<li><a href="#syntax.-2" id="toc-syntax.-2"><span
class="toc-section-number">1.4.1</span> Syntax.</a></li>
<li><a href="#example.-1" id="toc-example.-1"><span
class="toc-section-number">1.4.2</span> Example.</a></li>
</ul></li>
<li><a href="#repeat-loops." id="toc-repeat-loops."><span
class="toc-section-number">1.5</span> repeat loops.</a>
<ul>
<li><a href="#example.-2" id="toc-example.-2"><span
class="toc-section-number">1.5.1</span> Example.</a></li>
</ul></li>
<li><a href="#next-and-break." id="toc-next-and-break."><span
class="toc-section-number">1.6</span> next and break.</a></li>
</ul></li>
<li><a href="#functions." id="toc-functions."><span
class="toc-section-number">2</span> Functions.</a>
<ul>
<li><a href="#how-we-define-functions-in-r-and-what-they-are."
id="toc-how-we-define-functions-in-r-and-what-they-are."><span
class="toc-section-number">2.1</span> How we define functions in R and
what they are.</a></li>
<li><a href="#passing-arguments-to-a-function."
id="toc-passing-arguments-to-a-function."><span
class="toc-section-number">2.2</span> Passing arguments to a
function.</a></li>
<li><a href="#returning-an-r-object-from-a-function."
id="toc-returning-an-r-object-from-a-function."><span
class="toc-section-number">2.3</span> Returning an R object from a
function.</a></li>
<li><a href="#basic-examples." id="toc-basic-examples."><span
class="toc-section-number">2.4</span> Basic examples.</a>
<ul>
<li><a href="#greetings-example." id="toc-greetings-example."><span
class="toc-section-number">2.4.1</span> Greetings example.</a></li>
<li><a href="#above-example." id="toc-above-example."><span
class="toc-section-number">2.4.2</span> Above example.</a></li>
<li><a href="#mean-of-each-variable-in-a-data-frame."
id="toc-mean-of-each-variable-in-a-data-frame."><span
class="toc-section-number">2.4.3</span> Mean of each variable in a data
frame.</a></li>
<li><a
href="#mean-of-the-same-variable-present-in-different-data-frames."
id="toc-mean-of-the-same-variable-present-in-different-data-frames."><span
class="toc-section-number">2.4.4</span> Mean of the same variable
present in different data frames.</a></li>
<li><a
href="#median-of-a-single-observation-of-the-same-variable-present-in-different-data-frames."
id="toc-median-of-a-single-observation-of-the-same-variable-present-in-different-data-frames."><span
class="toc-section-number">2.4.5</span> Median of a single observation
of the same variable present in different data frames.</a></li>
<li><a href="#a-preview-of-lapply-function-as-a-better-approach."
id="toc-a-preview-of-lapply-function-as-a-better-approach."><span
class="toc-section-number">2.4.6</span> A preview of
<code>lapply()</code> function as a better approach.</a></li>
</ul></li>
<li><a href="#special-features-of-functions-in-r."
id="toc-special-features-of-functions-in-r."><span
class="toc-section-number">2.5</span> Special features of functions in
R.</a>
<ul>
<li><a
href="#example-that-shows-how-powerful-theses-special-features-of-functions-are."
id="toc-example-that-shows-how-powerful-theses-special-features-of-functions-are."><span
class="toc-section-number">2.5.1</span> Example that shows <strong>how
powerful</strong> theses special features of functions are.</a></li>
<li><a href="#anonymous-functions." id="toc-anonymous-functions."><span
class="toc-section-number">2.5.2</span> Anonymous functions.</a></li>
</ul></li>
<li><a href="#argument-matching." id="toc-argument-matching."><span
class="toc-section-number">2.6</span> Argument matching.</a></li>
<li><a href="#lazy-evaluation-of-arguments."
id="toc-lazy-evaluation-of-arguments."><span
class="toc-section-number">2.7</span> Lazy evaluation of
arguments.</a></li>
<li><a href="#the-ellipsis-or-dot-dot-dot-argument."
id="toc-the-ellipsis-or-dot-dot-dot-argument."><span
class="toc-section-number">2.8</span> The “…” (ellipsis or dot-dot-dot)
argument.</a>
<ul>
<li><a href="#use-cases." id="toc-use-cases."><span
class="toc-section-number">2.8.1</span> Use cases.</a>
<ul>
<li><a href="#extending-another-function."
id="toc-extending-another-function."><span
class="toc-section-number">2.8.1.1</span> Extending another
function.</a></li>
<li><a href="#generic-functions." id="toc-generic-functions."><span
class="toc-section-number">2.8.1.2</span> Generic functions.</a></li>
<li><a href="#unknown-number-of-arguments."
id="toc-unknown-number-of-arguments."><span
class="toc-section-number">2.8.1.3</span> Unknown number of
arguments.</a></li>
</ul></li>
<li><a href="#arguments-coming-after-the-argument."
id="toc-arguments-coming-after-the-argument."><span
class="toc-section-number">2.8.2</span> Arguments coming after the “…”
argument.</a></li>
<li><a href="#unpacking-the-ellipses-argument."
id="toc-unpacking-the-ellipses-argument."><span
class="toc-section-number">2.8.3</span> Unpacking the ellipses
argument.</a></li>
</ul></li>
<li><a href="#user-defined-binary-operators."
id="toc-user-defined-binary-operators."><span
class="toc-section-number">2.9</span> User-defined binary
operators.</a></li>
</ul></li>
<li><a href="#scoping-rules-of-r." id="toc-scoping-rules-of-r."><span
class="toc-section-number">3</span> Scoping Rules of R.</a>
<ul>
<li><a href="#how-r-binds-values-objectsfunctions-to-symbols-names."
id="toc-how-r-binds-values-objectsfunctions-to-symbols-names."><span
class="toc-section-number">3.1</span> How R binds values
(objects/functions) to symbols (names).</a></li>
<li><a href="#scoping-rules-in-r.-lexical-aka-static-scoping."
id="toc-scoping-rules-in-r.-lexical-aka-static-scoping."><span
class="toc-section-number">3.2</span> Scoping rules in R. Lexical (aka
static) scoping.</a></li>
<li><a href="#lexical-scoping-why-does-it-matter"
id="toc-lexical-scoping-why-does-it-matter"><span
class="toc-section-number">3.3</span> Lexical scoping: why does it
matter?</a></li>
<li><a href="#exploring-a-function-closure-the-functions-environment."
id="toc-exploring-a-function-closure-the-functions-environment."><span
class="toc-section-number">3.4</span> Exploring a function closure (the
function’s environment).</a></li>
<li><a href="#lexical-vs.-dynamic-scoping."
id="toc-lexical-vs.-dynamic-scoping."><span
class="toc-section-number">3.5</span> Lexical vs. dynamic
scoping.</a></li>
<li><a
href="#lexical-scoping-consecuences-beyond-binding-free-variables."
id="toc-lexical-scoping-consecuences-beyond-binding-free-variables."><span
class="toc-section-number">3.6</span> Lexical scoping consecuences
beyond binding free variables.</a></li>
<li><a href="#application-of-lexical-scoping-optimization."
id="toc-application-of-lexical-scoping-optimization."><span
class="toc-section-number">3.7</span> Application of lexical scoping:
Optimization.</a>
<ul>
<li><a href="#example-maximizing-a-normal-likelihood."
id="toc-example-maximizing-a-normal-likelihood."><span
class="toc-section-number">3.7.1</span> Example: maximizing a normal
likelihood.</a></li>
<li><a href="#plotting-the-likelihood."
id="toc-plotting-the-likelihood."><span
class="toc-section-number">3.7.2</span> Plotting the
likelihood.</a></li>
</ul></li>
<li><a
href="#another-application-of-lexical-scoping-preserve-state-inside-an-r-object--caching-time-consuming-computations-."
id="toc-another-application-of-lexical-scoping-preserve-state-inside-an-r-object--caching-time-consuming-computations-."><span
class="toc-section-number">3.8</span> Another application of Lexical
Scoping: Preserve state inside an R object -caching time consuming
computations-.</a>
<ul>
<li><a href="#caching-the-mean-of-a-vector.-the---assign-operator."
id="toc-caching-the-mean-of-a-vector.-the---assign-operator."><span
class="toc-section-number">3.8.1</span> Caching the <code>mean</code> of
a vector. The <code>&lt;&lt;-</code> assign operator.</a></li>
</ul></li>
</ul></li>
<li><a href="#coding-standards-for-r."
id="toc-coding-standards-for-r."><span
class="toc-section-number">4</span> Coding Standards for R.</a>
<ul>
<li><a href="#always-use-text-files-text-editor."
id="toc-always-use-text-files-text-editor."><span
class="toc-section-number">4.1</span> Always use text files / text
editor.</a></li>
<li><a
href="#indent-your-code-8-spaces-and-limit-the-witdth-of-your-code-80-columns"
id="toc-indent-your-code-8-spaces-and-limit-the-witdth-of-your-code-80-columns"><span
class="toc-section-number">4.2</span> Indent your code (8 spaces) and
limit the witdth of your code (80 columns)</a>
<ul>
<li><a href="#an-example." id="toc-an-example."><span
class="toc-section-number">4.2.1</span> An example.</a></li>
</ul></li>
<li><a href="#limit-the-length-of-individual-functions."
id="toc-limit-the-length-of-individual-functions."><span
class="toc-section-number">4.3</span> Limit the length of individual
functions.</a></li>
<li><a href="#conclusion." id="toc-conclusion."><span
class="toc-section-number">4.4</span> Conclusion.</a></li>
</ul></li>
<li><a href="#dates-and-times." id="toc-dates-and-times."><span
class="toc-section-number">5</span> Dates and Times.</a>
<ul>
<li><a href="#dates-in-r." id="toc-dates-in-r."><span
class="toc-section-number">5.1</span> Dates in R.</a></li>
<li><a href="#times-in-r." id="toc-times-in-r."><span
class="toc-section-number">5.2</span> Times in R.</a></li>
<li><a
href="#dates-and-times-in-a-format-that-r-does-not-recongnize.-the-strptime-function."
id="toc-dates-and-times-in-a-format-that-r-does-not-recongnize.-the-strptime-function."><span
class="toc-section-number">5.3</span> Dates and times in a format that R
does not recongnize. The strptime() function.</a></li>
<li><a href="#generic-functions-that-work-with-dates-and-times."
id="toc-generic-functions-that-work-with-dates-and-times."><span
class="toc-section-number">5.4</span> Generic functions that work with
Dates and Times.</a></li>
<li><a href="#operations-on-dates-and-times."
id="toc-operations-on-dates-and-times."><span
class="toc-section-number">5.5</span> Operations on Dates and
Times.</a></li>
<li><a href="#the-lubridate-package."
id="toc-the-lubridate-package."><span
class="toc-section-number">5.6</span> The lubridate package.</a></li>
</ul></li>
<li><a href="#session-info." id="toc-session-info."><span
class="toc-section-number">6</span> Session Info.</a></li>
</ul>
</div>

<hr />
<div id="control-strutures." class="section level1" number="1">
<h1><span class="header-section-number">1</span> Control Strutures.</h1>
<p>Control structures allows us to:</p>
<ul>
<li>Control the flow of an R program.<br />
</li>
<li>Respond to inputs or to features of the data and execute different R
expressions accordingly.</li>
</ul>
<p>Commonly used control structures:</p>
<ul>
<li>if and else.<br />
</li>
<li>for.<br />
</li>
<li>while.<br />
</li>
<li>repeat: execute an infinite loop, must break out of it to
stop.<br />
</li>
<li>break.</li>
<li>next: skip an iteration of a loop.<br />
</li>
<li>return: exit a function.</li>
</ul>
<p>Comparison with the <strong><em>apply</em></strong> functions:</p>
<ul>
<li>Control structures are primarily useful for writing programs.<br />
</li>
<li>The <em>apply</em> functions are more useful for command line
interactive work.</li>
</ul>
<div id="a-very-quick-summary-of-the-logical-operators-in-r."
class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> A very quick summary
of the logical operators in R.</h2>
<p>We use logical operators to examine the relationship between
<em>multiple logical expressions</em>.</p>
<ul>
<li>Comparison operators (==, !=, &lt;, &lt;=, &gt;, &gt;=), instead,
examine the relationship between two <em>boolean values</em> or <em>two
numbers</em>.</li>
</ul>
<div id="operator-and." class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Operator AND.</h3>
<ul>
<li>There are <strong>two AND operators</strong> in R:
<strong>&amp;</strong> and <strong>&amp;&amp;</strong>.<br />
</li>
<li>Both work similarly:
<ul>
<li>if the right and left operands are both TRUE the entire expression
is TRUE;<br />
</li>
<li>otherwise it is FALSE.<br />
</li>
</ul></li>
<li>We use the <strong>&amp;</strong> operator to evaluate AND
<strong>across an entire vector</strong>. The
<strong>&amp;&amp;</strong> version of AND only evaluates the
<strong>first member of a vector</strong>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)   <span class="co"># equivalent to c(TRUE, TRUE, TRUE) &amp; c(TRUE, FALSE, FALSE)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="cn">TRUE</span> <span class="cn">FALSE</span> <span class="cn">FALSE</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;&amp;</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="operator-or." class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Operator OR.</h3>
<ul>
<li>Similarly, there are <strong>two OR operators</strong> in R:
<strong>|</strong> and <strong>||</strong>.<br />
</li>
<li>Both work similarly:
<ul>
<li>if the left operand or the right operand is TRUE, the entire
expression is TRUE;</li>
<li>if both operands are TRUE, the entire expresion is TRUE;</li>
<li>if both operands are FALSE, then the entire expression is
FALSE.<br />
</li>
</ul></li>
<li>We use the <strong>|</strong> operator to evaluate OR <strong>across
an entire vector</strong>. The <strong>||</strong> version of OR only
evaluates the <strong>first member of a vector</strong>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)   <span class="co"># equivalent to c(TRUE, TRUE, TRUE) | c(TRUE, FALSE, FALSE)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span> <span class="cn">TRUE</span> <span class="cn">TRUE</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">||</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="rules-of-precedence." class="section level3" number="1.1.3">
<h3><span class="header-section-number">1.1.3</span> Rules of
precedence.</h3>
<p>All AND operators are evaluated <em>before</em> OR operators.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">8</span> <span class="sc">||</span> <span class="dv">6</span> <span class="sc">!=</span> <span class="dv">8</span> <span class="sc">&amp;&amp;</span> <span class="dv">4</span> <span class="sc">&gt;</span> <span class="fl">3.9</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<ul>
<li>First the left and right operands of the AND operator are evaluated.
<ul>
<li>6 is not equal 8, 4 is greater than 3.9, therefore both operands are
TRUE so the resulting expression TRUE &amp;&amp; TRUE evaluates to
TRUE.<br />
</li>
</ul></li>
<li>Then the left operand of the OR operator is evaluated.
<ul>
<li>5 is not greater than 8 so the entire expression is reduced to FALSE
|| TRUE.<br />
</li>
</ul></li>
<li>Since the right operand of this expression is TRUE the entire
expression evaluates to TRUE.</li>
</ul>
</div>
<div id="exclusive-or." class="section level3" number="1.1.4">
<h3><span class="header-section-number">1.1.4</span> Exclusive OR.</h3>
<p>There’s also the <strong>xor()</strong> function.</p>
<ul>
<li>if one argument evaluates to TRUE and the other evaluates to FALSE,
then returns TRUE;<br />
</li>
<li>otherwise it will return FALSE.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xor</span>(<span class="dv">5</span> <span class="sc">==</span> <span class="dv">6</span>, <span class="sc">!</span><span class="cn">FALSE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="useful-logical-functions." class="section level3"
number="1.1.5">
<h3><span class="header-section-number">1.1.5</span> Useful logical
functions.</h3>
<div id="istrue-and-identical." class="section level4" number="1.1.5.1">
<h4><span class="header-section-number">1.1.5.1</span> isTRUE() and
identical().</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isTRUE</span>(<span class="dv">6</span> <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">isTRUE</span>(<span class="cn">NA</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">isTRUE</span>(<span class="dv">3</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="st">&#39;twins&#39;</span>, <span class="st">&#39;twins&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="st">&#39;hello&#39;</span>, <span class="st">&#39;Hello&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">4</span>, <span class="dv">3</span> <span class="sc">&lt;</span> <span class="fl">3.1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="which." class="section level4" number="1.1.5.2">
<h4><span class="header-section-number">1.1.5.2</span> which().</h4>
<p>The <strong>which()</strong> function takes a logical vector as an
argument and <strong><em>returns the indices</em></strong> of the vector
that are TRUE.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">3</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ints <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">10</span>)      <span class="co"># random sampling of integers from 1 to 10 without replacement.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ints</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="dv">4</span>  <span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">8</span>  <span class="dv">1</span>  <span class="dv">7</span>  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">5</span> <span class="dv">10</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(ints <span class="sc">&gt;</span> <span class="dv">7</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">3</span>  <span class="dv">4</span> <span class="dv">10</span></span></code></pre></div>
<p>So we could use <em>which()</em> to <strong>give the indexes we want
to selection operators</strong>, in order to extract elements from a
vector or data frame.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  Ozone Solar.R Wind Temp Month Day</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">41</span>     <span class="dv">190</span>  <span class="fl">7.4</span>   <span class="dv">67</span>     <span class="dv">5</span>   <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">36</span>     <span class="dv">118</span>  <span class="fl">8.0</span>   <span class="dv">72</span>     <span class="dv">5</span>   <span class="dv">2</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">12</span>     <span class="dv">149</span> <span class="fl">12.6</span>   <span class="dv">74</span>     <span class="dv">5</span>   <span class="dv">3</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="dv">18</span>     <span class="dv">313</span> <span class="fl">11.5</span>   <span class="dv">62</span>     <span class="dv">5</span>   <span class="dv">4</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="cn">NA</span>      <span class="cn">NA</span> <span class="fl">14.3</span>   <span class="dv">56</span>     <span class="dv">5</span>   <span class="dv">5</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>    <span class="dv">28</span>      <span class="cn">NA</span> <span class="fl">14.9</span>   <span class="dv">66</span>     <span class="dv">5</span>   <span class="dv">6</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>airquality[<span class="fu">which</span>(airquality<span class="sc">$</span>Ozone <span class="sc">==</span> <span class="dv">36</span>), <span class="st">&quot;Wind&quot;</span>]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">8.0</span> <span class="fl">10.3</span></span></code></pre></div>
<p>But the <strong>subset()</strong> function does the same thing.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(airquality<span class="sc">$</span>Wind, airquality<span class="sc">$</span>Ozone <span class="sc">==</span> <span class="dv">36</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">8.0</span> <span class="fl">10.3</span></span></code></pre></div>
</div>
<div id="any-all." class="section level4" number="1.1.5.3">
<h4><span class="header-section-number">1.1.5.3</span> any(),
all().</h4>
<p>Also the functions <strong>any()</strong> and <strong>all()</strong>
take logical vectors as their argument.</p>
<ul>
<li><strong>any()</strong> will return TRUE if one or more of the
elements in the logical vector is TRUE.<br />
</li>
<li><strong>all()</strong> will return TRUE if every element in the
logical vector is TRUE.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(ints <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">FALSE</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(ints <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
</div>
</div>
<div id="if-else." class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> if-else.</h2>
<div id="syntax." class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Syntax.</h3>
<pre><code>if(&lt;condition&gt;) {  
      # do something  
} else {  
      # do something else  
}  </code></pre>
<p>Series of tests:</p>
<pre><code>if(&lt;condition&gt;) {  
    # do something  
} else if {  
    # do something else  
} else {  
    # do something else  
}  </code></pre>
</div>
<div id="example." class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Example.</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a uniform random number.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">10</span>); x</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">5.404275</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">3</span>) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">10</span></span></code></pre></div>
<blockquote>
<p>In R we can write the following equivalent statements:</p>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="cf">if</span>(x <span class="sc">&gt;</span> <span class="dv">3</span>) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>      <span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">10</span></span></code></pre></div>
</div>
</div>
<div id="for-loops." class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> for loops.</h2>
<ul>
<li>Doing data analysis, there are very few situations where we need for
other types of loops than a <em>for</em> loop.<br />
</li>
<li>They are most commonly used for iterating over the elements of an
object (list, vector, etc.).</li>
</ul>
<div id="syntax.-1" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Syntax.</h3>
<pre><code>for(&lt;iterator_variable&gt; in &lt;sequence_or_vector&gt;) {  
      # do something with each sequence&#39;s value or vector&#39;s element.  
}</code></pre>
<blockquote>
<p>The curly braces are not necessary for <em>one-line loops</em>.
However, not using culry braces <em>will burn you</em> if you decide to
expand the loop to multiple lines.</p>
</blockquote>
</div>
<div id="examples.-the-seq_along-and-the-seq_len-functions."
class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Examples. The
<em>seq_along()</em> and the <em>seq_len()</em> functions.</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing elements by index.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(v[i])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;a&quot;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;b&quot;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;c&quot;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;d&quot;</span></span></code></pre></div>
<p><strong>seq_along()</strong> function.</p>
<ul>
<li>Given a vector as input, returns another vector that is thesequence
from 1 up to the count of elements -length- of that vector.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing elements by a sequence of integer indexes generated</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># by the seq_along() function based on the length of an object.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(v)){</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(v[i])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;a&quot;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;b&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;c&quot;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;d&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing by elements.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(letter <span class="cf">in</span> v) {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(letter)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;a&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;b&quot;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;c&quot;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;d&quot;</span></span></code></pre></div>
<p><strong>seq_len()</strong> function.</p>
<ul>
<li>This function expects a single number (a number vector of length 1)
and returns a vector that is the sequence from 1 up to the value of that
number.<br />
</li>
<li>It’s useful to access by index the elements of multidimensional or
hierarchical data structures (matrices, lists).</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested loops for multidimensional or hierarchical data structures</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (matrices, lists)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">4</span>    <span class="dv">6</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(m))) {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">ncol</span>(m)))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(m[i, j])</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">3</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">5</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">4</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span></code></pre></div>
</div>
</div>
<div id="while-loops." class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> while loops.</h2>
<div id="syntax.-2" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Syntax.</h3>
<pre><code>while(&lt;condition&gt;) {  
    # do something  
    # adjust counter or ensure an exit condition
}  </code></pre>
</div>
<div id="example.-1" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Example.</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(z <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;&amp;</span> z <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(z)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    coin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(coin <span class="sc">==</span> <span class="dv">1</span>) {  <span class="co"># random walk</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> z <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> z <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
<blockquote>
<p><strong>Warning</strong>: while loop execution could take a long
time, as z oscillates back and forth without going out the boundary 3
&lt; z &lt; 10.</p>
</blockquote>
</div>
</div>
<div id="repeat-loops." class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> repeat loops.</h2>
<ul>
<li>Not commonly used in statistical or data analysis
applications.<br />
</li>
<li>It initiates an <strong><em>infinite loop</em></strong>.<br />
</li>
<li>The only way to exit is to call <em>break</em>.</li>
</ul>
<div id="example.-2" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Example.</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tollerance <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">SomeEstimateComputation</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tollerance) {       <span class="co"># Close enough?</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>This approach is used in many types of optimization algorithms, for
example.<br />
</li>
<li>If we’re trying to find the solution to some set of equations, or
trying to maximize or minimize a function, often we’ll iterate over and
over again.<br />
</li>
<li>And and we’ll stop when the estimates are getting closer and closer
together, because that’s usually a sign that we’re converging to
whatever the minimum or maximum of the objective function is.</li>
</ul>
<blockquote>
<p><strong>Warning</strong>: the infinite loop could never stop if x0
and x1 oscillate back and forth and never converge.<br />
<strong>Better</strong> to set a <strong>hard limit</strong> on the
number of iterations by using a <strong><em>for loop</em></strong> and
then report whether convergence was achieved or not.</p>
</blockquote>
</div>
</div>
<div id="next-and-break." class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> next and break.</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">&lt;=</span> <span class="dv">20</span>) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Skip the first 20 iterations.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># do something here.</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&gt;</span> <span class="dv">20</span>) {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Stop loop after 20 iterations.</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
</div>
</div>
<div id="functions." class="section level1" number="2">
<h1><span class="header-section-number">2</span> Functions.</h1>
<div id="how-we-define-functions-in-r-and-what-they-are."
class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> How we define
functions in R and what they are.</h2>
<p>Functions are defined using the <em>function()</em> directive.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is an empty function.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>()                                 <span class="co"># Excecute function f.</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
<p>They are <strong>assigned and stored as R objects</strong> of class
<em>function</em>.</p>
<ul>
<li>The “variable name” assigned will become the name of the
function.<br />
</li>
<li>John Chambers, the creator of R, said: <em>To understand
computations in R, two slogans are</em> <em>helpful:</em>
<ol style="list-style-type: decimal">
<li><em>Everything that exists is an object.</em><br />
</li>
<li><em>Everything that happens is a function call.</em></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(f)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;function&quot;</span></span></code></pre></div>
<blockquote>
<p>So functions are small pieces of reusable code that can be treated
like any other R object.</p>
</blockquote>
</div>
<div id="passing-arguments-to-a-function." class="section level2"
number="2.2">
<h2><span class="header-section-number">2.2</span> Passing arguments to
a function.</h2>
<ul>
<li>Arguments specified in the signature or definition of a function are
called <em>formal arguments</em>.
<ul>
<li>The <strong>formals()</strong> function returns a <em>list</em> of
all the formal arguments of a function.<br />
</li>
<li>Remember that we can see the signature of a function using
<strong>str()</strong>.<br />
</li>
<li>There is also <strong>args()</strong> function: same as str(), but
also specifies what the function returns.<br />
</li>
<li>Finally, just by typing the <strong>name</strong> of the function,
we can see it’s entire definition (the arguments and the body).</li>
</ul></li>
<li>When calling the function, we can:
<ul>
<li>Pass the actual value of the argument.<br />
</li>
<li>Pass the actual value of the argument indicating it’s name
(<em>named arguments</em>).
<ul>
<li>This last alternative is useful, as we’ll see, when a function has
many arguments and it is not clear which argument is being passed.</li>
</ul></li>
</ul></li>
<li>In general it is convenient to assign a <em>default value</em> to a
formal argument, in order to:
<ul>
<li>Avoid <em>missing argument</em> error when calling the
function.<br />
</li>
<li>Relieve users from having to specify the values of all arguments of
a function, every single time they call it.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>greetings <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">num =</span> <span class="dv">1</span>) {              <span class="co"># formal argument with a default value.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    my_message <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World!&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(num)) {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(my_message, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)            <span class="co"># cat() not only concatenates but also outputs</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    }                                         <span class="co"># the concatenated object.</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">greetings</span>(<span class="dv">3</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">greetings</span>()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span></code></pre></div>
</div>
<div id="returning-an-r-object-from-a-function." class="section level2"
number="2.3">
<h2><span class="header-section-number">2.3</span> Returning an R object
from a function.</h2>
<ul>
<li>In R, the return value of a function is <strong>always the very last
expression that is evaluated</strong>.<br />
</li>
<li>There’s no keyword or anything else.<br />
</li>
<li>However, there is a <strong>return()</strong> function that can be
used to return an explicit value.
<ul>
<li>As we’ll see, it is rarely used in R.<br />
</li>
</ul></li>
<li>Finally, we can use the <strong>invisible()</strong> function to
return a value: it does not get auto-printed when the function is
called.
<ul>
<li>It is a common practice with “print” functions (functions that
already send messages to the console).</li>
</ul></li>
</ul>
</div>
<div id="basic-examples." class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Basic examples.</h2>
<div id="greetings-example." class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Greetings
example.</h3>
<p>Function that construct a message by concatenating chararcters
strings, prints out in the console the message a number of times and
returns the number of characters printed in console.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>greetings <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">num =</span> <span class="dv">1</span>) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    my_message <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World!&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(num)) {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(my_message, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    chars <span class="ot">&lt;-</span> <span class="fu">nchar</span>(my_message) <span class="sc">*</span> num             <span class="co"># number of characters printed in the console.</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    chars</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>charsInMessage <span class="ot">&lt;-</span> <span class="fu">greetings</span>(<span class="dv">3</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>Hello World<span class="sc">!</span> </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>charsInMessage</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">15</span> <span class="dv">18</span>  <span class="dv">3</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(charsInMessage)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">36</span></span></code></pre></div>
</div>
<div id="above-example." class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Above example.</h3>
<p>Function that takes a numeric vector and returns all the elements
that are bigger than certain value specified by the user (if not, bigger
than 10).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>above <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10</span>) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    use <span class="ot">&lt;-</span> x <span class="sc">&gt;</span> n</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    x[use]                  <span class="co"># returns a subset of x: all elements bigger than n.</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">above</span>(x, <span class="dv">12</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">13</span> <span class="dv">14</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">17</span> <span class="dv">18</span> <span class="dv">19</span> <span class="dv">20</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">above</span>(x)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">11</span> <span class="dv">12</span> <span class="dv">13</span> <span class="dv">14</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">17</span> <span class="dv">18</span> <span class="dv">19</span> <span class="dv">20</span></span></code></pre></div>
</div>
<div id="mean-of-each-variable-in-a-data-frame." class="section level3"
number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Mean of each
variable in a data frame.</h3>
<p>This function calculates and returns the mean of each numeric
variable (column) in a given data frame or matrix. If not otherwise
specified, removes NA values.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>col_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">removeNA =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    nc <span class="ot">&lt;-</span> <span class="fu">ncol</span>(df)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nc)              <span class="co"># create an empty numeric vector of length nc.</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc) {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[, i], <span class="at">na.rm =</span> removeNA)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    means</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">col_means</span>(airquality)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">42.129310</span> <span class="fl">185.931507</span>   <span class="fl">9.957516</span>  <span class="fl">77.882353</span>   <span class="fl">6.993464</span>  <span class="fl">15.803922</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">col_means</span>(airquality, <span class="cn">FALSE</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]        <span class="cn">NA</span>        <span class="cn">NA</span>  <span class="fl">9.957516</span> <span class="fl">77.882353</span>  <span class="fl">6.993464</span> <span class="fl">15.803922</span></span></code></pre></div>
</div>
<div id="mean-of-the-same-variable-present-in-different-data-frames."
class="section level3" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Mean of the same
variable present in different data frames.</h3>
<p>This function computes and returns the mean of the same variable
(column) present in different data frames.</p>
<ul>
<li><em>Example:</em> we have five data frames in our directory, each of
one with information about a single patient’s age and weight taken or
mesaured on a daily bases over a period of 30 days. The structure of all
these files is the same, lets see one of them:</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">read.csv</span>(<span class="st">&quot;2_TestingFolder/Andy.csv&quot;</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">30</span> obs. of  <span class="dv">4</span> variables<span class="sc">:</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> Patient.Name<span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">1</span> level <span class="st">&quot;Andy&quot;</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Age         <span class="sc">:</span> int  <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> <span class="dv">30</span> ...</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Weight      <span class="sc">:</span> int  <span class="dv">140</span> <span class="dv">140</span> <span class="dv">140</span> <span class="dv">139</span> <span class="dv">138</span> <span class="dv">138</span> <span class="dv">138</span> <span class="dv">138</span> <span class="dv">138</span> <span class="dv">138</span> ...</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> Day         <span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span> ...</span></code></pre></div>
<p>So, let’s suppose that we want to know the mean of the
<em>Weight</em> of all five patients.</p>
<p>A <strong>basic strategy</strong> for our task, is as follows:</p>
<ul>
<li>The idea is basically the same: construct a new vector or data frame
and put there the <em>mean</em> of the variable of each data frame that
is <em>readed at each step of a loop</em>.<br />
</li>
<li>If we <em>know in advanced the size</em> of the vector or data frame
that we want to create (for example, when we have to read all the
files/data frames in a directory and we know how many of them there
are), then:
<ul>
<li>we just create a fixed size vector or data frame;<br />
</li>
<li>and fill it at each step of the loop using indexes.<br />
</li>
</ul></li>
<li>But <em>if we don’t know in advanced the size</em> of the vector or
data frame we need to create, then:
<ul>
<li>we create an empty vector or data frame, in order to<br />
</li>
<li>use the <strong>rbind()</strong> function to add the <em>mean</em>
of the variable of each data frame that is <em>readed at each step of
the loop</em>.</li>
</ul></li>
</ul>
<p>Let’s put first in a fixed vector, the mean of the variable
<em>Weight</em> present in the <em>five data frames</em> that we have in
our directory.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>v_across_means <span class="ot">&lt;-</span> <span class="cf">function</span>(directory, <span class="at">removeNA =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    file_paths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(directory, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(file_paths))                <span class="co"># create an empty fixed vector.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(file_paths)) {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        tmp_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_paths[i])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp_df<span class="sc">$</span>Weight, <span class="at">na.rm =</span> removeNA)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    means</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">v_across_means</span>(<span class="st">&quot;2_TestingFolder&quot;</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">137.3333</span> <span class="fl">206.0667</span> <span class="fl">175.1176</span> <span class="fl">189.8667</span> <span class="fl">220.0333</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="fu">v_across_means</span>(<span class="st">&quot;2_TestingFolder&quot;</span>, <span class="cn">FALSE</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">137.3333</span> <span class="fl">206.0667</span>       <span class="cn">NA</span> <span class="fl">189.8667</span> <span class="fl">220.0333</span></span></code></pre></div>
<p>Now let’s suppose we don’t know how many files there are in the
directory and that we’ve been requested a data frame specifying the
names whose belong each “Weight” mean, as output.<br />
What we do then is create an empty data frame and use
<strong>rbind()</strong> to add at each step of the loop a row with an
<em>id</em> of the person and it’s <em>mean_weight</em>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_across_means <span class="ot">&lt;-</span> <span class="cf">function</span>(directory, <span class="at">removeNA =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    file_paths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(directory, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    id <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    means_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()                            <span class="co"># create an empty data frame.</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(path <span class="cf">in</span> file_paths) {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        id <span class="ot">&lt;-</span> id <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        tmp_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        means_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(means_df, <span class="fu">c</span>(id, <span class="fu">mean</span>(tmp_df<span class="sc">$</span>Weight, <span class="at">na.rm =</span> removeNA)))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(means_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;mean_weight&quot;</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    means_df</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">df_across_means</span>(<span class="st">&quot;2_TestingFolder&quot;</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  id mean_weight</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span>    <span class="fl">137.3333</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span>    <span class="fl">206.0667</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span>    <span class="fl">175.1176</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">4</span>    <span class="fl">189.8667</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">5</span>    <span class="fl">220.0333</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">df_across_means</span>(<span class="st">&quot;2_TestingFolder&quot;</span>, <span class="cn">FALSE</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  id mean_weight</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span>    <span class="fl">137.3333</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span>    <span class="fl">206.0667</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span>          <span class="cn">NA</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">4</span>    <span class="fl">189.8667</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">5</span>    <span class="fl">220.0333</span></span></code></pre></div>
</div>
<div
id="median-of-a-single-observation-of-the-same-variable-present-in-different-data-frames."
class="section level3" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Median of a single
observation of the same variable present in different data frames.</h3>
<p>Now suppose that we want to compute the <em>median</em> of the
<em>Weight</em>:</p>
<ul>
<li>of <em>all</em> of our <em>five patients</em> (not of <em>each</em>
one),<br />
</li>
<li>and <em>only over a single day</em> (not over the hole period of 30
days).</li>
</ul>
<p>A <strong>common strategy</strong> here is basically as follows:</p>
<ul>
<li>Construct with <strong>rbind()</strong> a <em>new raw data
frame</em> that simply puts toghether all of our data frames while
reading each data frame in a loop.<br />
</li>
<li>Then extract from that data the subset we are interested on (in our
example, the five raws which “Day” equals a certain day) and calculate
the median.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>daily_median <span class="ot">&lt;-</span> <span class="cf">function</span>(directory, <span class="at">day =</span> <span class="dv">1</span>, <span class="at">removeNA =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    file_paths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(directory, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read all data frames and row-bind all together.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    raw_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(path <span class="cf">in</span> file_paths) {</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        raw_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(raw_df, <span class="fu">read.csv</span>(path))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subsetting our raw data frame using indexes returned by the which() function.</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    daily_df <span class="ot">&lt;-</span> raw_df[<span class="fu">which</span>(raw_df<span class="sc">$</span>Day <span class="sc">==</span> day), ]</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we can do the same row subsetting with the subset() function.</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    daily_df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(raw_df, raw_df<span class="sc">$</span>Day <span class="sc">==</span> day)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return the median of the &quot;Weight&quot; of all patients.</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(daily_df<span class="sc">$</span>Weight, <span class="at">na.rm =</span> removeNA)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">daily_median</span>(<span class="st">&quot;2_TestingFolder&quot;</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">188</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">daily_median</span>(<span class="st">&quot;2_TestingFolder&quot;</span>, <span class="dv">20</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">197.5</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">daily_median</span>(<span class="st">&quot;2_TestingFolder&quot;</span>, <span class="dv">25</span>, <span class="cn">FALSE</span>)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">NA</span></span></code></pre></div>
</div>
<div id="a-preview-of-lapply-function-as-a-better-approach."
class="section level3" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> A preview of
<code>lapply()</code> function as a better approach.</h3>
<p>The approaches we’ve seen so far for building data frames or vectors
by copying and re-copying them inside of a loop, are
<em>suboptimal</em>: if we have a lot of data it can become very, very
slow.</p>
<p>See <strong>“R_Module2_Resumen_Aside.Rmd”</strong> to learn a better
approach (essentially a preview of lapply() function).</p>
<p>Check out Hadley Wickam’s excellent material on functionals within R:
<a href="http://adv-r.had.co.nz/Functionals.html"
class="uri">http://adv-r.had.co.nz/Functionals.html</a></p>
</div>
</div>
<div id="special-features-of-functions-in-r." class="section level2"
number="2.5">
<h2><span class="header-section-number">2.5</span> Special features of
functions in R.</h2>
<p>Functions in R are <strong><em>first class objects</em></strong>,
meaning that they <strong>can be treated much like</strong> <strong>any
other R object</strong>. Consecuently:</p>
<ul>
<li>Functions can be <strong><em>passed as arguments</em></strong> to
other functions.
<ul>
<li><em>args()</em> function, for instance, takes a function as
argument!<br />
</li>
<li>We’ll see that this feature is very handy for apply functions like
<em>lapply()</em> and <em>sapply()</em>.<br />
</li>
</ul></li>
<li>Functions can be <strong><em>nested</em></strong>.
<ul>
<li>So that we can <em>define a function inside of another
function</em>.<br />
</li>
</ul></li>
<li>These strange features are really usefull for data analysis.</li>
</ul>
<div
id="example-that-shows-how-powerful-theses-special-features-of-functions-are."
class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Example that shows
<strong>how powerful</strong> theses special features of functions
are.</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## One function to evaluate any other function.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="cf">function</span>(func, data) {</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">func</span>(data)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate</span>(mean, <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">33</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">9.4</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate</span>(sd, <span class="fu">c</span>(<span class="fl">1.4</span>, <span class="fl">3.6</span>, <span class="fl">7.9</span>, <span class="fl">8.8</span>))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">3.514138</span></span></code></pre></div>
</div>
<div id="anonymous-functions." class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Anonymous
functions.</h3>
<p>We can pass a function as an argument <em>without a previous
definition</em> of it, that is, we can pass a <em>function without a
name</em>, aka an <strong>anonymous function</strong>.</p>
<ul>
<li>Anonymous functions are <em>generated on the fly</em> as we use them
as an argument of another “main” function, typically of an apply()
family function.
<ul>
<li>Once the call to the “main” function is finished, the anonymous
function <em>desappears</em> and does not appear in the workspace.<br />
</li>
<li>In other words, anonymous functions exist for the life of the “main”
function but are not stored anywhere.<br />
</li>
</ul></li>
<li>As we can guess, anonymous functions should always be tiny
functions.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate</span>(<span class="cf">function</span>(x){x<span class="sc">+</span><span class="dv">1</span>}, <span class="dv">6</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">7</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate</span>(<span class="cf">function</span>(x){x[<span class="dv">1</span>]}, <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">0</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">8</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate</span>(<span class="cf">function</span>(x){x[<span class="fu">length</span>(x)]}, <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">0</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
</div>
</div>
<div id="argument-matching." class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Argument
matching.</h2>
<p>R functions arguments can be matched:</p>
<ul>
<li><em>Positionally</em> or by <em>name</em> (named arguments).<br />
</li>
<li>Named arguments are useful:
<ul>
<li>On the command line, when we want to use the defaults for everything
except for an argument near the end of the list.<br />
</li>
<li>Also help if we remember the name of the argument and not its
position on the argument list.</li>
</ul></li>
<li>The <strong>order of actions</strong> when given an argument, is as
follows:
<ol style="list-style-type: decimal">
<li>Check for exact match for a named argument.<br />
</li>
<li>Check for a partial match.<br />
</li>
<li>Check for a positional match.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(rnorm)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sd)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, <span class="at">na.rm =</span> <span class="cn">FALSE</span>)  </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Positional matching of all arguments.</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Positional matching of first argument, default for second one.</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(my_data)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.873495</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify first argument by name, default for second one.</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="at">x =</span> my_data)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.873495</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify both arguments by name, order doesn&#39;t matter.</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">x =</span> my_data)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.873495</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co"># When mixing both kind of argument matching, as we saw, these actions are taken:</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co"># - named arguments are &quot;taken out&quot; of the argument list.</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co"># - the remaining unnamed arguments are matched in the order that they are</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   listed in the function definition.</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, my_data)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.873495</span></span></code></pre></div>
<p>A more interesting example: the <strong>lm() function</strong>, which
fits linear models to a dataset.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(lm)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two equivalent calls.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, my_data, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">model =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data =</span> my_data, y <span class="sc">~</span> x, <span class="at">model =</span> <span class="cn">FALSE</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span></code></pre></div>
</div>
<div id="lazy-evaluation-of-arguments." class="section level2"
number="2.7">
<h2><span class="header-section-number">2.7</span> Lazy evaluation of
arguments.</h2>
<p>Arguments are evaluated <strong><em>only as needed in the
body</em></strong> of the function.</p>
<p>That is the reason why R may not throw an exception in cases such as
of a function that doesn’t use all of its formal arguments in its body
(nor does it give them default values) and is called with only those
arguments that do uses.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">2</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">4</span></span></code></pre></div>
<blockquote>
<p>It’s common to write a function that doesn’t use an argument. And we
probably wont notice this mistake, because of this “lazy” behaviour of
R.</p>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(a)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(b)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">45</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">45</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">print</span>(b)<span class="sc">:</span> el argumento <span class="st">&quot;b&quot;</span> está ausente, sin valor por omisión</span></code></pre></div>
<blockquote>
<p>“45” was printed first before the error was triggered, because “b”
did not have to be evaluated until after print(a). Once the function
tried to evaluate print(b), it had to throw an error.</p>
</blockquote>
</div>
<div id="the-ellipsis-or-dot-dot-dot-argument." class="section level2"
number="2.8">
<h2><span class="header-section-number">2.8</span> The “…” (ellipsis or
dot-dot-dot) argument.</h2>
<p>Indicates a <em>variable number of arguments</em> that are
<em>usually</em> passed on <em>to other functions</em>.</p>
<div id="use-cases." class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Use cases.</h3>
<div id="extending-another-function." class="section level4"
number="2.8.1.1">
<h4><span class="header-section-number">2.8.1.1</span> Extending another
function.</h4>
<p>“…” argument is often used when <em>extending another function</em>
and we don’t want to copy the entire argument list of the original
function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A custom plotting function that makes use of the default plot() function along</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with its entire argument list.</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, ...) {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(x, y, type, ...)                     <span class="co"># Pass &#39;...&#39; to plot() function.</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>In this example we want to extend the plot() function, just to have
a little bit of a tweak or to change some of the defaults, for
example.<br />
</li>
<li>So my_plot() will replicate some of the arguments of the original
plot() function like x and y. But it’s going to change a default type
argument so that instead of creating circles for points, we want it to
create lines (type == l).<br />
</li>
<li>But of course the default plot() function has many, many other
arguments. And we want to leave them all ultimately the same. And so,
what we can do is use <strong><em>dot dot dot</em></strong> to kind of
absorb all the other arguments in the plot() function.<br />
</li>
<li>We do that by <strong><em>taking in my_plot() the dot dot
dot</em></strong> and then <strong><em>pass it down to the</em></strong>
<strong><em>original plot() function</em></strong>.<br />
</li>
<li>In that manner, all those original arguments can be preserved, then
we don’t have to retype or reconstruct all of those arguments in our
extended function.</li>
</ul>
</div>
<div id="generic-functions." class="section level4" number="2.8.1.2">
<h4><span class="header-section-number">2.8.1.2</span> Generic
functions.</h4>
<p>Generic functions use “…” argument so that <em>extra arguments can be
passed</em> to methods.</p>
<ul>
<li>We’ll see this later when we’ll talk about object oriented
programming.<br />
</li>
<li>However the basic idea is that in R there can be <em>generic
functions</em> that <em>don’t do anything</em> but <em>dispatch methods
for different types of data</em>, and the “…” is used heavily in this
type of setup.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mean</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (x, ...) </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">UseMethod</span>(<span class="st">&quot;mean&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x55ab5bab1800</span><span class="sc">&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> namespace<span class="sc">:</span>base<span class="sc">&gt;</span></span></code></pre></div>
</div>
<div id="unknown-number-of-arguments." class="section level4"
number="2.8.1.3">
<h4><span class="header-section-number">2.8.1.3</span> Unknown number of
arguments.</h4>
<p>The “…” argument is necessary when the <em>number of arguments</em>
passed to a function <em>cannot</em> <em>be known in advanced</em>.</p>
<ul>
<li>For example, both <strong>paste()</strong> and
<strong>cat()</strong> print out text to the console by combining
multiple character vectors together. It is impossible for them to know
in advance how many character vectors will be passed by the user.<br />
</li>
<li>In these cases, the “…” argument comes first in the list of
arguments of the function.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(paste)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (..., <span class="at">sep =</span> <span class="st">&quot; &quot;</span>, <span class="at">collapse =</span> <span class="cn">NULL</span>) </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(cat)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (..., <span class="at">file =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>, <span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">labels =</span> <span class="cn">NULL</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">append =</span> <span class="cn">FALSE</span>) </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
<p>To make <em>some interesting examples</em>, other than just passing
some strings to paste(), lets write a couple of functions that takes the
ellipsis argument and pass it to paste() in order to produce a custom
concatenation.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>symon_says <span class="ot">&lt;-</span> <span class="cf">function</span> (...) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="st">&quot;Symon says:&quot;</span>, ...)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">symon_says</span>(<span class="st">&quot;Ole&quot;</span>, <span class="st">&quot;Ole&quot;</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Symon says: Ole Ole&quot;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>telegram <span class="ot">&lt;-</span> <span class="cf">function</span> (...) {</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="st">&quot;START&quot;</span>, ..., <span class="st">&quot;STOP&quot;</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">telegram</span>(<span class="st">&quot;Ole&quot;</span>, <span class="st">&quot;Ole&quot;</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;START Ole Ole STOP&quot;</span></span></code></pre></div>
</div>
</div>
<div id="arguments-coming-after-the-argument." class="section level3"
number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Arguments coming
after the “…” argument.</h3>
<ul>
<li>All arguments after an ellipses <strong>must have default
values</strong>.<br />
</li>
<li>They must be <strong>named explicitly</strong> (if the default
values are not going to be used).
<ul>
<li>This is reasonable, because there’s no way for R to know whether we
are passing something to the “…” argument or whether we are passing
something to a different argument.<br />
</li>
</ul></li>
<li>They <strong>cannot be partially matched</strong>, i.e., named in
full.<br />
</li>
<li>They <strong>cannot be positionally matched</strong>.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="at">se =</span> <span class="st">&quot;:&quot;</span>)               <span class="co"># Unexpected result if we don&#39;t specify &#39;sep&#39; in full.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;a b :&quot;</span></span></code></pre></div>
</div>
<div id="unpacking-the-ellipses-argument." class="section level3"
number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> Unpacking the
ellipses argument.</h3>
<p>There will be situations in which will need to extract all arguments
involved in an ellipsis, in order to do somthing wiht some of them.</p>
<p>A <em>basic strategy</em> to do this, is as follows:</p>
<ul>
<li>Capture the ellipsis inside of a list.<br />
</li>
<li>Extract the named arguments we are interested in.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>add_alpha_and_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>        args <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We assume there are two named arguments in the list: alpha and beta.</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> args[[<span class="st">&quot;alpha&quot;</span>]]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> args[[<span class="st">&quot;beta&quot;</span>]]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        alpha <span class="sc">+</span> beta</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">add_alpha_and_beta</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">5</span>, <span class="dv">8</span>, <span class="at">beta =</span> <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">7</span></span></code></pre></div>
</div>
</div>
<div id="user-defined-binary-operators." class="section level2"
number="2.9">
<h2><span class="header-section-number">2.9</span> User-defined binary
operators.</h2>
<p>We should make our own binary operators if we plan on using them
often!</p>
<p>User-defined binary operators have the <em>following syntax</em>:</p>
<pre><code>&quot;%&lt;whatever&gt;%&quot; &lt;- function(left, right) {     # Notice the quotation marks!
                                              # &lt;whatever&gt; represents any valid variable name.  
        # some left and right manipulation.
}</code></pre>
<p>For example:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our own paste binary operator, called %p%.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;%p%&quot;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(left, right) {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(left, right)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Que&quot;</span> <span class="sc">%p%</span> <span class="st">&quot;tul&quot;</span> <span class="sc">%p%</span> <span class="st">&quot;eh?&quot;</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Que tul eh?&quot;</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="scoping-rules-of-r." class="section level1" number="3">
<h1><span class="header-section-number">3</span> Scoping Rules of
R.</h1>
<div id="how-r-binds-values-objectsfunctions-to-symbols-names."
class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> How R binds values
(objects/functions) to symbols (names).</h2>
<p>R binds a value to a symbol by searching through a series of
<em>environments</em>.</p>
<ul>
<li>An <strong>environment</strong> is a collection of (symbol, value)
pairs.</li>
</ul>
<p>R resolves symbols following roughly these rules:</p>
<ol style="list-style-type: decimal">
<li>Search the <strong><em>global environment</em></strong> (just our
workspace) for a symbol name matching the one requested.
<ul>
<li>So first of all R seraches among all the things (pairs symbol/value)
that we’ve defined or loaded in our workspase while working on the
command line.<br />
</li>
<li>If there’s a symbol that matches the name that we are requesting,
then R will take that symbol and retrieve it’s associated value.</li>
</ul></li>
<li>Search the namespaces of each of the packages on the
<strong><em>search list</em></strong>.</li>
</ol>
<p>We can see the search list using the <strong>search()</strong>
function.</p>
<ul>
<li><em>global environment</em> of user’s workspace is always the
<em>first</em> element of this list.<br />
</li>
<li><em>base package</em> is always the <em>last</em>.</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search</span>()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;.GlobalEnv&quot;</span>        <span class="st">&quot;package:plyr&quot;</span>      <span class="st">&quot;package:stats&quot;</span>    </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>] <span class="st">&quot;package:graphics&quot;</span>  <span class="st">&quot;package:grDevices&quot;</span> <span class="st">&quot;package:utils&quot;</span>    </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;package:datasets&quot;</span>  <span class="st">&quot;package:methods&quot;</span>   <span class="st">&quot;Autoloads&quot;</span>        </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;package:base&quot;</span>     </span></code></pre></div>
<p><strong>Notice 1</strong>: The <strong>order</strong> of the packages
on the list <strong>matters!</strong>.</p>
<ul>
<li><p>Users can <em>configure</em> which packages get loaded on
startup.</p></li>
<li><p>When a user <em>loads a package with library()</em> the namespace
of that package gets put in <em>position 2</em> by default and
everything else gets shifted down the list.</p></li>
<li><p>So we cannot assume that there will be a set list of packages
available or that packages will be in any sort of order. All depends on
what the user has decided to do in a given session.</p></li>
</ul>
<p><strong>Notice 2</strong>: R has separate namespaces for
<em>functions</em> and <em>non-functions</em>.</p>
<ul>
<li>So it’s possible to have an <em>object</em> named <em>c</em> and a
function named <em>c()</em>.</li>
</ul>
</div>
<div id="scoping-rules-in-r.-lexical-aka-static-scoping."
class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Scoping rules in R.
Lexical (aka static) scoping.</h2>
<p>Scoping rules seem like an esoteric aspect of R, but it’s one of its
more interesting and useful features.</p>
<p>Definition of <strong>scoping rule</strong>.</p>
<ul>
<li>A scoping rule of a language determines <em>how a value</em> is
associated with a <em>free variable</em> in a function.
<ul>
<li>Free variables are those who are <em>not formal arguments</em> and
<em>not local variables</em> (assigned inside the function body).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y <span class="sc">/</span> z</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">5.5</span></span></code></pre></div>
<ul>
<li>So in this example:
<ul>
<li><em>x</em> and <em>y</em> are <em>formal arguments</em>.<br />
</li>
<li><em>z</em> is a <em>free variable</em>.</li>
</ul></li>
</ul>
<p>R uses <strong>lexical scoping</strong> or <strong>static
scoping</strong>.</p>
<ul>
<li><p>Besides R, numerous languages support <em>lexical scoping</em>,
such as:</p>
<ul>
<li>Scheme, Perl, Python, Common Lisp.<br />
</li>
</ul></li>
<li><p>This kind of scoping turns out to be <em>particularly useful</em>
for <em>simplifying satistical</em> <em>computations</em>.</p></li>
<li><p>Lexical scoping means that the <em>values of free variables</em>
are searched for in the <em>environment in which the function was
defined</em>.</p>
<ul>
<li>Every environment has a <em>parent environment</em>.<br />
</li>
<li>The only environment without a parent is the <em>empty
environment</em>.<br />
</li>
<li>An environment can have <em>multiple children</em>.</li>
</ul></li>
<li><p>A function, together with an environment, makes up what is called
a <strong>closure</strong> or <strong>function closure</strong>.</p>
<ul>
<li>This “function closure” model can be used to create functions that
<em>carry arround</em> <em>data</em> with them.<br />
</li>
<li>Closures are <em>key</em> to a lot of different types of interesting
operations in R.</li>
</ul></li>
<li><p>So the <strong>search process</strong> that associate a value to
a free variable, goes as follows:</p>
<ol style="list-style-type: decimal">
<li>The value of a symbol (free variable in a function) is first
searched for in the <em>environment in which the function was
defined</em>.<br />
</li>
<li>If it is not found there, the search continues in the <em>parent
environment</em>: that is the <em>next thing down on the search
list</em>.<br />
</li>
<li>If not found, the search continues along the <em>sequence of parent
environments</em> in the search list, until we hit the <em>top-level
environment</em>. It can be:
<ul>
<li>the <em>global environment</em> -workspace-, or<br />
</li>
<li>the <em>namespace of a package</em> (if the function is defined in
that package).<br />
</li>
</ul></li>
<li>If not found, the search continues along the search list until the
<em>empty environment</em> (after the base package, there is the empty
environment).<br />
</li>
<li>If not found, an error is thrown.</li>
</ol></li>
</ul>
</div>
<div id="lexical-scoping-why-does-it-matter" class="section level2"
number="3.3">
<h2><span class="header-section-number">3.3</span> Lexical scoping: why
does it matter?</h2>
<p><em>Tipically</em>, a function is defined in the <em>global
environment</em>.</p>
<ul>
<li>So usually, when we can’t find the value of a variable inside the
function itself, that is, when we have a <em>free variable</em>, then
its value is just found in the <em>user’s workspace</em>.<br />
</li>
<li>The idea in this tipical situation is that we can define things like
<em>global variables</em>, that will be <em>common</em> to a lot of
different functions that we might be defining in our workspace.</li>
</ul>
<p>However, <strong>unlike languages like C</strong>, in R we can have,
as we saw:</p>
<ul>
<li><em>functions defined inside other functions</em> and, furthermore,
the <em>outer function</em> can <em>return the function defined inside
of it</em>.</li>
<li>In this case, the <strong>environment</strong> of the <strong>nested
function</strong> is where it was defined, that is, <strong>the body of
another function!</strong> (not the global environment, for instance).
This is it’s <em>closure environment</em>.<br />
</li>
<li>So this is when things get interesting and when the scoping rules
really have an impact on what we can do.</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>make.power <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    pow <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        x<span class="sc">^</span>n</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    pow                     <span class="co"># make.power() function returns another function.</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>cube <span class="ot">&lt;-</span> <span class="fu">make.power</span>(<span class="dv">3</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>cube</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) {</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        x<span class="sc">^</span>n</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab55da8910</span><span class="sc">&gt;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">make.power</span>(<span class="dv">2</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>square</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) {</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        x<span class="sc">^</span>n</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x55ab81603bc0</span><span class="sc">&gt;</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab55797d20</span><span class="sc">&gt;</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cube</span>(<span class="dv">3</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">27</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">square</span>(<span class="dv">3</span>)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">9</span></span></code></pre></div>
<blockquote>
<p>The <em>make.power()</em> function is a kind of
<strong><em>constructor function</em></strong> that constructs other
functions.</p>
</blockquote>
<blockquote>
<ul>
<li>So the value of the free variable <em>n</em> of cube() [and
square()] is taken from the environment where cube() [or square()] was
defined: statement <em>cube &lt;- make.power(3)</em> [or <em>square
&lt;- make.power(2)</em>].</li>
</ul>
</blockquote>
</div>
<div id="exploring-a-function-closure-the-functions-environment."
class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Exploring a function
closure (the function’s environment).</h2>
<p>The closure environment or the function’s environment, is the
environment in which the function was defined.</p>
<p>We use the <strong>environment()</strong> function, together with
<strong>ls()</strong> and <strong>get()</strong> functions, to see what
objects are there in the environment of a function and what values they
have.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="fu">environment</span>(cube))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;n&quot;</span>   <span class="st">&quot;pow&quot;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get</span>(<span class="st">&quot;n&quot;</span>, <span class="fu">environment</span>(cube))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">3</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="fu">environment</span>(square))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;n&quot;</span>   <span class="st">&quot;pow&quot;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">get</span>(<span class="st">&quot;n&quot;</span>, <span class="fu">environment</span>(square))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
</div>
<div id="lexical-vs.-dynamic-scoping." class="section level2"
number="3.5">
<h2><span class="header-section-number">3.5</span> Lexical vs. dynamic
scoping.</h2>
<p>Let’s see the difference with an example.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    y<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">g</span>(x)                     <span class="co"># &quot;g()&quot; is a free variable.</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">*</span> y                          <span class="co"># &#39;y&#39; is a free variable.</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">3</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">34</span></span></code></pre></div>
<ul>
<li>Lexical scoping:
<ul>
<li>The value of <em>y</em> in function g() is in the <em>environment
where g() was defined</em>.
<ul>
<li>g() was defined in the global environment.<br />
</li>
<li>therefore, the value of y is 10, so g(3) is 30 and f(3) 34.</li>
</ul></li>
</ul></li>
<li>Dynamic scoping:
<ul>
<li>The value of <em>y</em> in function g() is looked up in the
<em>calling environment</em> (in R it is known as the <em>parent
frame</em>).
<ul>
<li>g() was called inside f().<br />
</li>
<li>therefore, the value of y is 2, so g(3) is 6 and f(3) 10.</li>
</ul></li>
</ul></li>
</ul>
<blockquote>
<p><strong>Notice</strong>: when a function is <em>defined</em> in the
global environment and <em>called</em> from the global environment, then
it may give the false appearance of dynamic scoping.</p>
</blockquote>
</div>
<div id="lexical-scoping-consecuences-beyond-binding-free-variables."
class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Lexical scoping
consecuences beyond binding free variables.</h2>
<p>Lexical scoping is <strong><em>the reason why all objects must be
stored in physical memory</em></strong> in R.</p>
<ul>
<li><p>Because of the nature of the scoping rules and because of the
complexity of the environments and the way they are all linked together,
it’s difficult to implement this type of model outside of physical
memory.</p></li>
<li><p>When R was originally designed, everything was stored in memory.
But things are getting complicated now, because of very large types of
datasets, and being able to read them into R is a challenge, because
everything has to be stored in memory.</p></li>
<li><p>In particular, we can notice that all functions must <em>carry a
pointer</em> to their <em>respective</em> <em>defining
environments</em>, which could be <em>anywhere</em>.</p>
<ul>
<li>There could be functions within functions and, if one function
retuns another function, then there has to be a pointer to that piece of
memory where the defining environment is sotred.</li>
</ul></li>
<li><p>In S language, instead, free variables are always looked up in
the golbal workspace, so everything can be stored on <em>hard disk</em>
(the <em>defining environment</em> of all functions is the
same).</p></li>
</ul>
</div>
<div id="application-of-lexical-scoping-optimization."
class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Application of
lexical scoping: Optimization.</h2>
<p>The scoping rules of R allow us to <strong>abstract away much of the
complexity</strong> involved in the following kinds of problems.</p>
<ul>
<li>In R we have <em>optimization routines</em>, like
<strong>optim()</strong>, <strong>nlm()</strong> and
<strong>optimize()</strong>, that require us to <strong><em>pass a
function whose argument is a vector of parameters</em></strong>: e.g., a
log-likelihood or a cost function, in general called the
<strong>objective function</strong> that we want to minimize or maximize
over a range of parameters via those optimizations routines.</li>
<li>However, the <strong>objective function</strong> that we want to
optimize <strong><em>might depend on other things</em></strong> besides
just the parameters we are optimizing over (like data).
<ul>
<li>So, the question is <strong>how do we specify a function that
depends on parameters and data and</strong> <strong>perhaps many other
things, in a clean and readable programming style</strong>, making it
easier for the user to use these type of functions.<br />
</li>
<li>Well, in R we can construct objective functions cointaining all of
the necessary data for evaulating the funcion, in a clean and readable
way.<br />
</li>
<li>There’s no need to carry arround long arguments lists.<br />
</li>
</ul></li>
<li>Furthermore, it may also be desirable, when writing sofware which
does optimization, to <strong><em>allow the user to hold certain
parameters fixed</em></strong>.</li>
</ul>
<div id="example-maximizing-a-normal-likelihood." class="section level3"
number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Example: maximizing
a normal likelihood.</h3>
<p>Let’s write a constructor function that creates <em>objective
functions</em> as <em>negative log-likelihood</em> functions, which
we’ll then <em>try to maximize via the optimization routines</em>, that
is, try to find maximun likelihood estimates in a statistical model.</p>
<ul>
<li><p>Why we want <em>negative</em> log-likelihood functions as
objective functions? Because we want to <em>maximize</em> normal
likelihood distributions and what happens is that, in R,
<em>optimization</em> <em>routines attempt to</em> <strong><em>minimize
objective functions by default</em></strong>.</p></li>
<li><p>So, when we write our objective functions, if they are designed
to be maximized, then we have to take the negative of those functions
and minimize them.</p></li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>make.NegLogLik <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">fixed =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>)) {</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>        params <span class="ot">&lt;-</span> fixed</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span> (p) {                  <span class="co"># p is the parameter vector we want to optimize over.</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                params[<span class="sc">!</span>fixed] <span class="ot">&lt;-</span> p</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                mu <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                sigma <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                <span class="do">## Calculate the Normal density (define the law of likelihood and</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                <span class="do">## take the negative of it).</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">length</span>(data)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                b <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">sum</span>((data <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span>(a <span class="sc">+</span> b)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>The make.NegLogLik() function returns a negative log-likelihood for
a normal distribution.<br />
</li>
<li>What we want is to fit our data to this normal distribution. As we
know, a normal distribution has <em>two parameters</em>, so the two
parameters that we want to optimize over are <strong>mu</strong> (the
mean) and <strong>sigma</strong> (the standard deviation).</li>
</ul>
<p>So we can now <strong>generate some data</strong>.</p>
<ul>
<li>We’ll simulate some normal random variables with
<strong>rnorm()</strong> function, with <strong>mean</strong> 1 and
<strong>standard deviation</strong> 2.<br />
</li>
<li>Notice that these two mu and sigma, are the <em>real</em> mu and
sigma that later we are going to estimate using the optimization
routines.</li>
</ul>
<p>Then, we <strong>construct our negative log-likelihood</strong>
objective function, first of all <strong>without</strong> <strong>fixing
any of both parameters</strong>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>normals <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>nLL <span class="ot">&lt;-</span> <span class="fu">make.NegLogLik</span>(normals)                  <span class="co"># no fixed parameters.</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>nLL</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (p) {                  <span class="co"># p is the parameter vector we want to optimize over.</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                params[<span class="sc">!</span>fixed] <span class="ot">&lt;-</span> p</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                mu <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                sigma <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                <span class="do">## Calculate the Normal density (define the law of likelihood and</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                <span class="do">## take the negative of it).</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">length</span>(data)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                b <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">sum</span>((data <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span>(a <span class="sc">+</span> b)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x55ab8479ad60</span><span class="sc">&gt;</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab84baaf08</span><span class="sc">&gt;</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="do">## What&#39;s in the function environment?</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="fu">environment</span>(nLL))</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data&quot;</span>   <span class="st">&quot;fixed&quot;</span>  <span class="st">&quot;params&quot;</span></span></code></pre></div>
<ul>
<li><strong>Notice</strong> that when we define a function in the global
environment, there’s not a special <em>environment tag</em> as we can
see in the output of nLL function.<br />
</li>
<li>We can see then that, when we define a function inside of another
function, there has to be a <em>pointer to that defining
environment</em> so that R can remember what the values of all the free
variables are going to be. The hexadecimal number specified for the
environment tag is, then, the <strong>address where the closure
environment -or defining environment- is located</strong> in memory.
<ul>
<li>In particular here, <em>data</em> is a free variable.<br />
</li>
<li>It comes from the make.NegLogLik() constructor function which
originally passed the <em>data</em>.</li>
<li>So R can look up the <em>data</em> in the closure environment, we
don’t have to tell what the <em>data</em> are, it’s already fixed in the
function, as we can see by exploring the nLL() environment.</li>
</ul></li>
</ul>
<p>Now we can try to <strong>minimize</strong> our nLL() function with
<strong>optim()</strong>, to <strong>estimate both</strong>
<strong>parameters</strong> <em>mu</em> and <em>sigma</em>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>), nLL)<span class="sc">$</span>par</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>      mu    sigma </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fl">1.218239</span> <span class="fl">1.787343</span> </span></code></pre></div>
<p><strong>Conclusion</strong>: the algorithm converged and obtained an
esimate of <em>mu</em> and <em>sigma</em>, pretty close to the truth
(which was mu 1 and sigma 2).</p>
<p>We can also try to estimate one parameter while holding another
parameter fixed. So we have to create our nLL() function this time
fixing, let say, <strong>sigma to its true value of 2</strong>.</p>
<ul>
<li>Notice that, by fixing one parameter, we have now a
<strong>one-dimensional problem</strong>, so we can use the
<strong>simpler optimize() function</strong> rathen than
<em>optim()</em>.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>nLL <span class="ot">&lt;-</span> <span class="fu">make.NegLogLik</span>(normals, <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="dv">2</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(nLL, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))<span class="sc">$</span>minimum</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.217775</span></span></code></pre></div>
<p>Now we can go wild and try to estimate <em>sigma</em> while holding
<em>mu</em> fixed at its tru value of 1.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>nLL <span class="ot">&lt;-</span> <span class="fu">make.NegLogLik</span>(normals, <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">FALSE</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(nLL, <span class="fu">c</span>(<span class="fl">1e-6</span>, <span class="dv">10</span>))<span class="sc">$</span>minimum</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.800596</span></span></code></pre></div>
</div>
<div id="plotting-the-likelihood." class="section level3"
number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Plotting the
likelihood.</h3>
<p>Let us plot the negative log-likelihood to see <strong>how peaked or
flat</strong> it is.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Construct the function by fixing sigma to 2 (we estimated before</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="do">## mu to be 1.217775).</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>nLL <span class="ot">&lt;-</span> <span class="fu">make.NegLogLik</span>(normals, <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="dv">2</span>))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Evaluate nLL() at every point in x.</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, nLL)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">exp</span>(<span class="sc">-</span>(y <span class="sc">-</span> <span class="fu">min</span>(y))), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="2_R_Module2_Resumen_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Construct the function by fixing mu to 1 (we estimated before</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="do">## a sigma of 1.800596).</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>nLL <span class="ot">&lt;-</span> <span class="fu">make.NegLogLik</span>(normals, <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">FALSE</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.7</span>, <span class="fl">1.9</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Evaluate nLL() at every point in x.</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, nLL)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">exp</span>(<span class="sc">-</span>(y <span class="sc">-</span> <span class="fu">min</span>(y))), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="2_R_Module2_Resumen_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div
id="another-application-of-lexical-scoping-preserve-state-inside-an-r-object--caching-time-consuming-computations-."
class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Another application
of Lexical Scoping: Preserve state inside an R object -caching time
consuming computations-.</h2>
<p>If we take, for example, the mean of a numeric vector, this is
typically a fast operation.</p>
<p>However, for a very long vector, it may take too long to compute the
mean, especially if it has to be computed repeatedly (e.g. in a
loop).</p>
<p>If the contents of a vector are not changing, it may make sense to
<strong>cache the value of</strong> <strong>the mean</strong> so that
when we need it again, it can be looked up in the cache rather than
recomputed.</p>
<p>So, we can <strong>take advantage</strong> of the <strong>scoping
rules</strong> of the R language and <strong>manipulate</strong> them to
<strong>preserve state inside of an R object</strong>.</p>
<div id="caching-the-mean-of-a-vector.-the---assign-operator."
class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Caching the
<code>mean</code> of a vector. The <code>&lt;&lt;-</code> assign
operator.</h3>
<p>To achieve our goal of preserving the state inside an R object, we
are going to introduce the <strong><code>&lt;&lt;-</code> assign
operator</strong>.</p>
<ul>
<li>It can be used to assign a value to an object <strong>in an
environment that is different</strong> <strong>from the current
environment</strong>.<br />
</li>
<li>The R documentation for <em>assignOps</em> states that:
<ul>
<li>This opertor is normally <strong>only used in
functions</strong>.</li>
<li>It causes a <strong>search</strong> to be made <strong>through
parent environments</strong> for an existing definition of the variable
being assigned.<br />
- If such a variable is found (and its binding is not locked) then its
value is <strong>redefined</strong>.<br />
- Otherwise assignment takes place in the <strong>global
environment</strong>.</li>
</ul></li>
</ul>
<p>Below are two functions that are used to create a special object that
stores a numeric vector and caches its mean.</p>
<p>The first function, <code>makeVector()</code>, gets a numeric vector
as input and creates a special “vector” which is really a <strong>list
containing four functions</strong>:</p>
<ol style="list-style-type: decimal">
<li><code>set()</code> function, to set the value of the vector.<br />
</li>
<li><code>get()</code> function, to get the value of the vector.<br />
</li>
<li><code>setmean()</code> function, to set the value of the mean.<br />
</li>
<li><code>getmean()</code> function, to get the value of the mean.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>makeVector <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">numeric</span>()) {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>        set <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                x <span class="ot">&lt;&lt;-</span> y                             <span class="co"># operator &lt;&lt;- </span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                m <span class="ot">&lt;&lt;-</span> <span class="cn">NULL</span>                          <span class="co"># operator &lt;&lt;-</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>        get <span class="ot">&lt;-</span> <span class="cf">function</span>() x</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>        setmean <span class="ot">&lt;-</span> <span class="cf">function</span>(mean) m <span class="ot">&lt;&lt;-</span> mean        <span class="co"># operator &lt;&lt;- </span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>        getmean <span class="ot">&lt;-</span> <span class="cf">function</span>() m</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">set =</span> set, <span class="at">get =</span> get,  <span class="co"># this is how a function can return more than one function</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">setmean =</span> setmean,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">getmean =</span> getmean)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The second function, <code>cachemean()</code>, calculates the mean of
the special “vector” created with the above function.<br />
However, it first checks to see if the mean has already been
calculated.</p>
<ul>
<li>If so, it <code>get</code>s the mean from the cache and skips the
computation.<br />
</li>
<li>Otherwise, it calculates the mean of the data and sets the value of
the mean in the cache via the <code>setmean</code> function.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cachemean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> x<span class="sc">$</span><span class="fu">getmean</span>()</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(m)) {</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">message</span>(<span class="st">&quot;getting cached data&quot;</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>(m)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> x<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> <span class="fu">mean</span>(data, ...)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>        x<span class="sc">$</span><span class="fu">setmean</span>(m)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>        m</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So, let’s use now these functions:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and inspect a &quot;cached&quot; vector object.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>c_vector <span class="ot">&lt;-</span> <span class="fu">makeVector</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(c_vector)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>List of <span class="dv">4</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> set    <span class="sc">:</span><span class="cf">function</span> (y)  </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcref&quot;</span>)<span class="ot">=</span> <span class="st">&#39;srcref&#39;</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="dv">4</span> <span class="dv">16</span> <span class="dv">7</span> <span class="dv">9</span> <span class="dv">16</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcfile&quot;</span>)<span class="ot">=</span>Classes <span class="st">&#39;srcfilecopy&#39;</span>, <span class="st">&#39;srcfile&#39;</span> <span class="sc">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab85a5c9e0</span><span class="sc">&gt;</span> </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> get    <span class="sc">:</span><span class="cf">function</span> ()  </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcref&quot;</span>)<span class="ot">=</span> <span class="st">&#39;srcref&#39;</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="dv">9</span> <span class="dv">16</span> <span class="dv">9</span> <span class="dv">27</span> <span class="dv">16</span> <span class="dv">27</span> <span class="dv">9</span> <span class="dv">9</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcfile&quot;</span>)<span class="ot">=</span>Classes <span class="st">&#39;srcfilecopy&#39;</span>, <span class="st">&#39;srcfile&#39;</span> <span class="sc">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab85a5c9e0</span><span class="sc">&gt;</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> setmean<span class="sc">:</span><span class="cf">function</span> (mean)  </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcref&quot;</span>)<span class="ot">=</span> <span class="st">&#39;srcref&#39;</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="dv">11</span> <span class="dv">20</span> <span class="dv">11</span> <span class="dv">44</span> <span class="dv">20</span> <span class="dv">44</span> <span class="dv">11</span> <span class="dv">11</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcfile&quot;</span>)<span class="ot">=</span>Classes <span class="st">&#39;srcfilecopy&#39;</span>, <span class="st">&#39;srcfile&#39;</span> <span class="sc">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab85a5c9e0</span><span class="sc">&gt;</span> </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> getmean<span class="sc">:</span><span class="cf">function</span> ()  </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcref&quot;</span>)<span class="ot">=</span> <span class="st">&#39;srcref&#39;</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="dv">13</span> <span class="dv">20</span> <span class="dv">13</span> <span class="dv">31</span> <span class="dv">20</span> <span class="dv">31</span> <span class="dv">13</span> <span class="dv">13</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;srcfile&quot;</span>)<span class="ot">=</span>Classes <span class="st">&#39;srcfilecopy&#39;</span>, <span class="st">&#39;srcfile&#39;</span> <span class="sc">&lt;</span>environment<span class="sc">:</span> <span class="dv">0x55ab85a5c9e0</span><span class="sc">&gt;</span> </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(c_vector<span class="sc">$</span><span class="fu">get</span>())</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span> ...</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(c_vector<span class="sc">$</span><span class="fu">get</span>())</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.0</span>   <span class="fl">250.8</span>   <span class="fl">500.5</span>   <span class="fl">500.5</span>   <span class="fl">750.2</span>  <span class="fl">1000.0</span> </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>c_vector<span class="sc">$</span><span class="fu">getmean</span>()</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean over our &quot;cached&quot; vector.</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>c_vector_mean <span class="ot">&lt;-</span> <span class="fu">cachemean</span>(c_vector)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>c_vector_mean</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">500.5</span></span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="coding-standards-for-r." class="section level1" number="4">
<h1><span class="header-section-number">4</span> Coding Standards for
R.</h1>
<div id="always-use-text-files-text-editor." class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Always use text files
/ text editor.</h2>
<ul>
<li>This one is obvious, no one writes code in Microsoft Word.</li>
</ul>
</div>
<div
id="indent-your-code-8-spaces-and-limit-the-witdth-of-your-code-80-columns"
class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Indent your code (8
spaces) and limit the witdth of your code (80 columns)</h2>
<ul>
<li><p>Some programming languages require this as part of their syntax,
but R does not.</p></li>
<li><p>For obious reasons of readability, indent should be a minimum of
4 spaces and ideally 8 spaces.</p></li>
</ul>
<blockquote>
<p>As we can read from the <a
href="https://www.kernel.org/doc/Documentation/process/coding-style.rst">Linux
kernal coding style document</a>, <em>“Tabs are 8 characters, and thus
indentations are also 8 characters.</em> <strong><em>There are heretic
movements</em></strong> <em>that try to make indentations 4 (or even 2!)
characters deep, and that is akin to trying to define the value of PI to
be 3”.</em></p>
</blockquote>
<ul>
<li><p>Then, limiting the width of your code (80 columns), along with
the 8 space indentation, forces you to write code that is clean,
readable and naturally broken down into modular units.</p>
<ul>
<li>Also, if someone ever needs to read your code on a PDP/11 you’ll be
A-okay.</li>
</ul></li>
</ul>
<div id="an-example." class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> An example.</h3>
<p>Jenny Bryan gave a wonderful talk about <a
href="https://youtu.be/7oyiPBjLAWY">“Code Smells and Feels”</a> and she
made there the following example of a piece of code with <em>excessive
<code>if-else</code> statements</em> using 2 space indent and 8 space
indent.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>get_some_data <span class="ot">&lt;-</span> <span class="cf">function</span>(config, outfile) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">config_ok</span>(config)) {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">can_write</span>(outfile)) {</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">can_open_network_connection</span>(config)) {</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> <span class="fu">parse_something_from_network</span>()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">makes_sense</span>(data)) {</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>          data <span class="ot">&lt;-</span> <span class="fu">beautify</span>(data)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">write_it</span>(data, outfile)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t access network&quot;</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>      <span class="do">## uhm. What was this else for again?</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="do">## maybe, some bad news about ... the config?</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s take a look at it with 8 space indents.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>get_some_data <span class="ot">&lt;-</span> <span class="cf">function</span>(config, outfile) {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">config_ok</span>(config)) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="fu">can_write</span>(outfile)) {</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (<span class="fu">can_open_network_connection</span>(config)) {</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                data <span class="ot">&lt;-</span> <span class="fu">parse_something_from_network</span>()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span>(<span class="fu">makes_sense</span>(data)) {</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                                        data <span class="ot">&lt;-</span> <span class="fu">beautify</span>(data)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">write_it</span>(data, outfile)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                                } <span class="cf">else</span> {</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                                }</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                        } <span class="cf">else</span> {</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t access network&quot;</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>                } <span class="cf">else</span> {</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>                        <span class="do">## That&#39;s better.</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>                  <span class="do">## Yeah.</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Although the code looks better with 8 space indentation, it looks
downright absurd, practically crying out for refactoring! The five
levels of nesting become unreadable as soon as you blink your eyes.</li>
</ul>
</div>
</div>
<div id="limit-the-length-of-individual-functions."
class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Limit the length of
individual functions.</h2>
<ul>
<li>The purpose of a function is to perform one activity or idea.<br />
</li>
<li>Rule of thumb: a function should not take up more than a page of the
text editor in a standard monitor.</li>
</ul>
</div>
<div id="conclusion." class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Conclusion.</h2>
<p>There are practically zero downsides to using an 8 space indent and a
number of upsides, including cleaner, more modular code.</p>
<p>Because the visual indicator penalizes against lots of indenting, you
are usually forced to write out separate functions to handle different
tasks rather than go one more level in. This not only has the benefit of
being modular, but it’s also useful for things like profiling (it can be
very uninformative to profile a single monolithic function).</p>
<hr />
</div>
</div>
<div id="dates-and-times." class="section level1" number="5">
<h1><span class="header-section-number">5</span> Dates and Times.</h1>
<p>R has developed a special representation for dates and times.</p>
<p>Dates and Times can be helpful:</p>
<ul>
<li>if we are working with <em>data that show something changes over
time</em> (i.e. time-series data);<br />
</li>
<li>if our data contain some other <em>temporal information</em> (like
dates of birth).</li>
</ul>
<div id="dates-in-r." class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Dates in R.</h2>
<p>Dates are represented by the <em>Date</em> class.</p>
<ul>
<li>Dates are internally stored as the number of
<strong><em>days</em></strong> since 1970-01-01.</li>
</ul>
<p>A common way to end up with a Date object, is by coercion using the
<strong>as.Date()</strong> function.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;1970-01-01&quot;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;1970-01-01&quot;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Date&quot;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(x)                          <span class="co"># internally, day number zero!</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
<p>What about dates <strong>before 1970-01-01</strong>?</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;1969-01-01&quot;</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>x2</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;1969-01-01&quot;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(x2)                         <span class="co"># internally, a negative integer.</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="dv">365</span></span></code></pre></div>
<p>There’s a <strong>Sys.Date()</strong> function that returns the
current Date of our system.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.Date</span>()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18&quot;</span></span></code></pre></div>
</div>
<div id="times-in-r." class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Times in R.</h2>
<p>Times are represented by the <em>POSIXct</em> or the <em>POSIXlt</em>
class.</p>
<ul>
<li><em>POSIX</em> is a family of computer standards for how things
should be done on certain types of computers or how data should be
represented.<br />
</li>
<li><em>POSIXct</em>:
<ul>
<li>It is just a <em>very large integer</em> under the hood.<br />
</li>
<li>A POSIXct time is internally stored as the <em>number</em> of
<strong><em>seconds</em></strong> since 1970-01-01.<br />
</li>
<li>It use a useful class when we want to store times in somthing like a
<em>data frame</em>.<br />
</li>
</ul></li>
<li><em>POSIXlt</em>:
<ul>
<li>It is a <em>list</em> underneath.<br />
</li>
<li>A POSIXlt time is internally stored as a <em>list</em> of
<strong><em>seconds, minutes, hours, etc.</em></strong></li>
<li>It stores useful metadata like: day of the week, day of the year,
month, day of the month.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()             <span class="co"># returns the current system date and time as a POSIXct object.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18 08:03:02 -03&quot;</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;POSIXct&quot;</span> <span class="st">&quot;POSIXt&quot;</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(x)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1676718183</span></span></code></pre></div>
<p>Times can be coerced from a character string using the
<strong>as.POSIXct()</strong> or <strong>as.POSIXlt()</strong>
functions.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(x)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>p                     <span class="co"># The printed format is identical to that of an POISXct object.</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18 08:03:02 -03&quot;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(p)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;POSIXlt&quot;</span> <span class="st">&quot;POSIXt&quot;</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># unclass(p) give us the underneath list representation.</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">unclass</span>(p))     <span class="co"># with names() we take only the names of the elements of that list.</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;sec&quot;</span>    <span class="st">&quot;min&quot;</span>    <span class="st">&quot;hour&quot;</span>   <span class="st">&quot;mday&quot;</span>   <span class="st">&quot;mon&quot;</span>    <span class="st">&quot;year&quot;</span>   <span class="st">&quot;wday&quot;</span>   <span class="st">&quot;yday&quot;</span>  </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] <span class="st">&quot;isdst&quot;</span>  <span class="st">&quot;zone&quot;</span>   <span class="st">&quot;gmtoff&quot;</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">unclass</span>(p))       <span class="co"># a more complete view, but no so long as the entire list &quot;unclass(p)&quot;</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>List of <span class="dv">11</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> sec   <span class="sc">:</span> num <span class="fl">2.8</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> min   <span class="sc">:</span> int <span class="dv">3</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> hour  <span class="sc">:</span> int <span class="dv">8</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> mday  <span class="sc">:</span> int <span class="dv">18</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> mon   <span class="sc">:</span> int <span class="dv">1</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> year  <span class="sc">:</span> int <span class="dv">123</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> wday  <span class="sc">:</span> int <span class="dv">6</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> yday  <span class="sc">:</span> int <span class="dv">48</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> isdst <span class="sc">:</span> int <span class="dv">0</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> zone  <span class="sc">:</span> chr <span class="st">&quot;-03&quot;</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> gmtoff<span class="sc">:</span> int <span class="sc">-</span><span class="dv">10800</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;tzone&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="st">&quot;&quot;</span> <span class="st">&quot;-03&quot;</span> <span class="st">&quot;-03&quot;</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>wday                <span class="co"># values of &#39;wday&#39; element (the day of the week), &#39;sec&#39; and &#39;zone&#39;.</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>sec</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.804271</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>zone</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;-03&quot;</span></span></code></pre></div>
</div>
<div
id="dates-and-times-in-a-format-that-r-does-not-recongnize.-the-strptime-function."
class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Dates and times in a
format that R does not recongnize. The strptime() function.</h2>
<p>If dates and times in a dataset happen to be in a format that R does
not recongnize, then the <strong>strptime()</strong> function can be
heplpful.</p>
<ul>
<li><p>strptime() converts character vectors into POSIXlt.</p></li>
<li><p>It is similar to as.POISXlt(), except that the input doesn’t have
to be in a particular format (YYYY-MM-DD).</p></li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>datestring <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Enero 10, 2012 10:40&quot;</span>, <span class="st">&quot;Diciembre 9, 2011 9:10&quot;</span>) <span class="co"># My current local is SPANISH!!</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">strptime</span>(datestring, <span class="st">&quot;%B %d, %Y %H:%M&quot;</span>)              <span class="co"># see formating strings in ?strptime()</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>t</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2012-01-10 10:40:00 -03&quot;</span> <span class="st">&quot;2011-12-09 09:10:00 -03&quot;</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(t)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;POSIXlt&quot;</span> <span class="st">&quot;POSIXt&quot;</span> </span></code></pre></div>
</div>
<div id="generic-functions-that-work-with-dates-and-times."
class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Generic functions
that work with Dates and Times.</h2>
<p>There are several functions that help us extract pieces of dates
and/or times:</p>
<p><strong>weekdays()</strong>, give the day of the week:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18&quot;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>(x)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;sábado&quot;</span></span></code></pre></div>
<p><strong>months()</strong>, give the month name:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18 08:03:02 -03&quot;</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">months</span>(x)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;febrero&quot;</span></span></code></pre></div>
<p><strong>quarters()</strong>, give the quarter of the year (Q1, Q2, Q3
or Q4).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2023-02-18 08:03:02 -03&quot;</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quarters</span>(x)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Q1&quot;</span></span></code></pre></div>
</div>
<div id="operations-on-dates-and-times." class="section level2"
number="5.5">
<h2><span class="header-section-number">5.5</span> Operations on Dates
and Times.</h2>
<p>We can use <em>+ and -</em> on dates and times. Also, do
<em>comparisons</em>.</p>
<ul>
<li>We don’t have to worry about leap years, leap seconds, daylight
savings and time zones.<br />
</li>
<li>Date/time classes keep track of all of this annoying things!!</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2012-01-01&quot;</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">strptime</span>(<span class="st">&quot;9 Ene 2011 11:34:21&quot;</span>, <span class="st">&quot;%d %b %Y %H:%M:%S&quot;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">-</span> y                                         <span class="co"># operands must be of the same class.</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Métodos <span class="fu">incompatibles</span> (<span class="st">&quot;-.Date&quot;</span>, <span class="st">&quot;-.POSIXt&quot;</span>) para <span class="st">&quot;-&quot;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> x <span class="sc">-</span> y<span class="sc">:</span> argumento no<span class="sc">-</span>numérico para operador binario</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(x)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>t <span class="sc">-</span> y</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>Time difference of <span class="fl">356.3928</span> days</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2012-03-01&quot;</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2012-02-28&quot;</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">-</span> y                                         <span class="co"># leap year!!</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Time difference of <span class="dv">2</span> days</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2012-10-25 01:00:00&quot;</span>)                <span class="co"># My local time zone is -3</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2012-10-25 06:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;GMT&quot;</span>)    <span class="co"># GMT zone is 0</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>y <span class="sc">-</span> x</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>Time difference of <span class="dv">2</span> hours</span></code></pre></div>
<p>Lastly, <strong>difftime()</strong> function can be used if we want
more control over the units (‘units’ parameter) when finding the time
difference.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), t, <span class="at">units =</span> <span class="st">&#39;days&#39;</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Time difference of <span class="fl">4066.46</span> days</span></code></pre></div>
</div>
<div id="the-lubridate-package." class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> The lubridate
package.</h2>
<p>If you find yourself working with dates and times often, you may want
to check out the <em>lubridate package by Hadley Wickham</em>.</p>
<hr />
</div>
</div>
<div id="session-info." class="section level1" number="6">
<h1><span class="header-section-number">6</span> Session Info.</h1>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>R version <span class="dv">3</span>.<span class="fl">6.3</span> (<span class="dv">2020-02-29</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>pc<span class="sc">-</span>linux<span class="sc">-</span><span class="fu">gnu</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>Running under<span class="sc">:</span> Ubuntu <span class="dv">18</span>.<span class="fl">04.6</span> LTS</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>blas<span class="sc">/</span>libblas.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>lapack<span class="sc">/</span>liblapack.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] LC_CTYPE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       LC_NUMERIC<span class="ot">=</span>C              </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>] LC_TIME<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>        LC_COLLATE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>    </span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] LC_MONETARY<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>    LC_MESSAGES<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>   </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] LC_PAPER<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       LC_NAME<span class="ot">=</span>C                 </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] LC_ADDRESS<span class="ot">=</span>C               LC_TELEPHONE<span class="ot">=</span>C            </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] LC_MEASUREMENT<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span> LC_IDENTIFICATION<span class="ot">=</span>C       </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] plyr_1.<span class="fl">8.6</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] Rcpp_1.<span class="fl">0.7</span>       highr_0<span class="fl">.9</span>        formatR_1<span class="fl">.14</span>     pillar_1.<span class="fl">7.0</span>    </span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] compiler_3.<span class="fl">6.3</span>   bslib_0.<span class="fl">3.0</span>      jquerylib_0.<span class="fl">1.4</span>  tools_3.<span class="fl">6.3</span>     </span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] digest_0.<span class="fl">6.29</span>    jsonlite_1.<span class="fl">7.2</span>   evaluate_0<span class="fl">.19</span>    lifecycle_1.<span class="fl">0.3</span> </span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] tibble_3.<span class="fl">1.8</span>     gtable_0.<span class="fl">3.0</span>     lattice_0<span class="fl">.20</span><span class="dv">-45</span>  pkgconfig_2.<span class="fl">0.3</span> </span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] rlang_1.<span class="fl">0.6</span>      DBI_1.<span class="fl">1.1</span>        cli_3.<span class="fl">6.0</span>        rstudioapi_0<span class="fl">.13</span> </span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] yaml_2.<span class="fl">2.1</span>       xfun_0<span class="fl">.36</span>        fastmap_1.<span class="fl">1.0</span>    stringr_1.<span class="fl">4.0</span>   </span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] dplyr_1.<span class="fl">0.8</span>      httr_1.<span class="fl">4.2</span>       knitr_1<span class="fl">.41</span>       sass_0.<span class="fl">4.0</span>      </span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">29</span>] generics_0.<span class="fl">1.2</span>   vctrs_0.<span class="fl">5.2</span>      grid_3.<span class="fl">6.3</span>       tidyselect_1.<span class="fl">2.0</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">33</span>] glue_1.<span class="fl">6.2</span>       R6_2.<span class="fl">5.1</span>         fansi_1.<span class="fl">0.2</span>      rmarkdown_2<span class="fl">.11</span>  </span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] ggplot2_3.<span class="fl">3.5</span>    magrittr_2.<span class="fl">0.2</span>   scales_1.<span class="fl">1.1</span>     ellipsis_0.<span class="fl">3.2</span>  </span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">41</span>] htmltools_0.<span class="fl">5.2</span>  assertthat_0.<span class="fl">2.1</span> colorspace_2<span class="fl">.0</span><span class="dv">-3</span> utf8_1.<span class="fl">2.2</span>      </span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">45</span>] stringi_1.<span class="fl">7.6</span>    munsell_0.<span class="fl">5.0</span>    crayon_1.<span class="fl">5.0</span>    </span></code></pre></div>
<hr />
</div>

<div style="width: 100%; padding: 10px; box-sizing: border-box; text-align: justify; border: 1px solid gray;">
  <p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
</div>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>


<!--
<p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>
-->


<!--
<p style="font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
-->




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
