<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Getting and Cleaning Data Course - Module 2</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Aprendiendo ciencia de datos con R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-hand-spock"></span>
     
    Resumen del contenido
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bars"></span>
     
    Contenido
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Data Science Toolbox</li>
    <li class="divider"></li>
    <li>
      <a href="1_DataScienceToolBox_Resumen.html">Módulo único</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">R</li>
    <li class="divider"></li>
    <li>
      <a href="2_R_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="2_R_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt_PrevPract.html">_práctica</a>
    </li>
    <li>
      <a href="2_R_Module2_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="2_R_Module3_ProgAssmt.html">_ejercicio</a>
    </li>
    <li>
      <a href="2_R_Module4_Resumen.html">Módulo 4</a>
    </li>
    <li>
      <a href="2_R_Module4_ProgAssmt.html">Ejercicio final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Getting &amp; Cleaning Data</li>
    <li class="divider"></li>
    <li>
      <a href="3_GettingAndCleaningData_Module1_Resumen.html">Módulo 1</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Resumen.html">Módulo 2</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module2_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Resumen.html">Módulo 3</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module3_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_Module4_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="3_GettingAndCleaningData_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Exploratory Data Analysis</li>
    <li class="divider"></li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module1_Ejercicios.html">_ejercicios</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="4_ExploratoryDataAnalysis_FinalProj.html">Proyecto final</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Reproducible Research</li>
    <li class="divider"></li>
    <li>
      <a href="5_ReproducibleResearch_Module1.html">Módulo 1</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module2.html">Módulo 2</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module3.html">Módulo 3</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_Module4.html">Módulo 4</a>
    </li>
    <li>
      <a href="5_ReproducibleResearch_FinalProj.html">Proyectos finales</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html">
    <span class="fa fa-gears"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Getting and Cleaning Data Course - Module
2</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#reading-from-mysql." id="toc-reading-from-mysql."><span
class="toc-section-number">1</span> Reading from MySQL.</a>
<ul>
<li><a href="#example-of-the-data-structrue-in-a-mysql-database."
id="toc-example-of-the-data-structrue-in-a-mysql-database."><span
class="toc-section-number">1.1</span> Example of the data structrue in a
MySQL database.</a></li>
<li><a href="#installing-mysql." id="toc-installing-mysql."><span
class="toc-section-number">1.2</span> Installing MySQL.</a></li>
<li><a href="#installing-rmysql." id="toc-installing-rmysql."><span
class="toc-section-number">1.3</span> Installing RMySQL.</a></li>
<li><a href="#example-of-a-web-facing-version-of-a-mysql-database."
id="toc-example-of-a-web-facing-version-of-a-mysql-database."><span
class="toc-section-number">1.4</span> Example of a web-facing version of
a MySQL database.</a></li>
<li><a
href="#connecting-to-a-mysql-server-and-listing-databases-dbconnect-dbgetquery-dbdisconnect."
id="toc-connecting-to-a-mysql-server-and-listing-databases-dbconnect-dbgetquery-dbdisconnect."><span
class="toc-section-number">1.5</span> Connecting to a MySQL server and
listing databases: <code>dbConnect()</code>, <code>dbGetQuery()</code>,
<code>dbDisconnect()</code>.</a></li>
<li><a
href="#connecting-to-a-specific-database-and-listing-its-tables-dblisttables."
id="toc-connecting-to-a-specific-database-and-listing-its-tables-dblisttables."><span
class="toc-section-number">1.6</span> Connecting to a specific database
and listing its tables: <code>dbListTables()</code>.</a></li>
<li><a
href="#getting-the-dimensions-of-a-specific-table-its-fields-columns-and-records-rows-dblistfields-dbgetquery."
id="toc-getting-the-dimensions-of-a-specific-table-its-fields-columns-and-records-rows-dblistfields-dbgetquery."><span
class="toc-section-number">1.7</span> Getting the dimensions of a
specific table, its fields (columns) and records (rows):
<code>dbListFields()</code>, <code>dbGetQuery()</code>.</a></li>
<li><a href="#read-from-the-table-dbreadtable."
id="toc-read-from-the-table-dbreadtable."><span
class="toc-section-number">1.8</span> Read from the table:
<code>dbReadTable()</code>.</a></li>
<li><a
href="#what-if-the-table-is-gigantic-select-a-specific-subset-with-dbsendquery-fetch-dbclearresult."
id="toc-what-if-the-table-is-gigantic-select-a-specific-subset-with-dbsendquery-fetch-dbclearresult."><span
class="toc-section-number">1.9</span> What if the table is gigantic?
Select a specific subset with <code>dbSendQuery()</code>,
<code>fetch()</code>, <code>dbClearResult()</code>.</a>
<ul>
<li><a href="#importance-of-mysql-queries."
id="toc-importance-of-mysql-queries."><span
class="toc-section-number">1.9.1</span> Importance of MySQL
queries.</a></li>
</ul></li>
<li><a href="#general-advices-about-public-databases."
id="toc-general-advices-about-public-databases."><span
class="toc-section-number">1.10</span> General advices about public
databases.</a></li>
<li><a href="#further-resources-about-mysql."
id="toc-further-resources-about-mysql."><span
class="toc-section-number">1.11</span> Further resources about
MySQL.</a></li>
</ul></li>
<li><a
href="#manipulating-a-data-frame-with-sql-commands-the-sqldf-package."
id="toc-manipulating-a-data-frame-with-sql-commands-the-sqldf-package."><span
class="toc-section-number">2</span> Manipulating a data frame with SQL
commands: the <code>sqldf</code> package.</a></li>
<li><a href="#reading-from-hdf5." id="toc-reading-from-hdf5."><span
class="toc-section-number">3</span> Reading from HDF5.</a>
<ul>
<li><a href="#rhdf5-package." id="toc-rhdf5-package."><span
class="toc-section-number">3.1</span> <code>rhdf5</code>
package.</a></li>
<li><a href="#creating-hdf5-files-h5createfile."
id="toc-creating-hdf5-files-h5createfile."><span
class="toc-section-number">3.2</span> Creating HDF5 files:
<code>h5createFile()</code>.</a></li>
<li><a
href="#creating-a-group-hierarchy-in-an-hdf5-file-and-listing-the-content-h5creategroup-h5ls."
id="toc-creating-a-group-hierarchy-in-an-hdf5-file-and-listing-the-content-h5creategroup-h5ls."><span
class="toc-section-number">3.3</span> Creating a group hierarchy in an
HDF5 file and listing the content: <code>h5createGroup()</code>,
<code>h5ls()</code>.</a></li>
<li><a
href="#writing-and-deleting-datasets-in-hfd5-files-h5write-h5delete."
id="toc-writing-and-deleting-datasets-in-hfd5-files-h5write-h5delete."><span
class="toc-section-number">3.4</span> Writing and deleting datasets in
HFD5 files: <code>h5write()</code>, <code>h5delete()</code>.</a>
<ul>
<li><a href="#writing-to-groups." id="toc-writing-to-groups."><span
class="toc-section-number">3.4.1</span> Writing to groups.</a></li>
<li><a href="#writing-directly-to-the-top-level."
id="toc-writing-directly-to-the-top-level."><span
class="toc-section-number">3.4.2</span> Writing directly to the top
level.</a></li>
<li><a href="#deleting-datasets-or-groups-h5delete."
id="toc-deleting-datasets-or-groups-h5delete."><span
class="toc-section-number">3.4.3</span> Deleting datasets or groups:
<code>h5delete()</code>.</a></li>
</ul></li>
<li><a href="#reading-data-from-a-hdf5-file-h5read."
id="toc-reading-data-from-a-hdf5-file-h5read."><span
class="toc-section-number">3.5</span> Reading data from a HDF5 file:
<code>h5read()</code>.</a></li>
<li><a href="#writing-and-reading-chunks."
id="toc-writing-and-reading-chunks."><span
class="toc-section-number">3.6</span> Writing and reading
chunks.</a></li>
<li><a href="#deleting-an-hdf5-file-itself-file.remove."
id="toc-deleting-an-hdf5-file-itself-file.remove."><span
class="toc-section-number">3.7</span> Deleting an HDF5 file itself:
<code>file.remove()</code>.</a></li>
<li><a href="#further-resources-about-hdf5."
id="toc-further-resources-about-hdf5."><span
class="toc-section-number">3.8</span> Further resources about
HDF5.</a></li>
</ul></li>
<li><a href="#reading-data-from-the-web."
id="toc-reading-data-from-the-web."><span
class="toc-section-number">4</span> Reading data from the Web.</a>
<ul>
<li><a href="#webscraping." id="toc-webscraping."><span
class="toc-section-number">4.1</span> Webscraping.</a></li>
<li><a
href="#scraping-webpages-using-readlines-to-get-unstructured-data-off-htmltreeparse-to-get-a-structuredparsed-document-and-xpathsaplly-to-extract-specific-information."
id="toc-scraping-webpages-using-readlines-to-get-unstructured-data-off-htmltreeparse-to-get-a-structuredparsed-document-and-xpathsaplly-to-extract-specific-information."><span
class="toc-section-number">4.2</span> Scraping webpages using
<code>readLines()</code> to get unstructured data off,
<code>htmlTreeParse()</code> to get a structured/parsed document and
<code>xpathSAplly()</code> to extract specific information.</a></li>
<li><a href="#using-the-httr-package-to-get-the-web-data."
id="toc-using-the-httr-package-to-get-the-web-data."><span
class="toc-section-number">4.3</span> Using the <code>httr</code>
package to get the web data.</a>
<ul>
<li><a
href="#the-get-function-and-its-use-with-content-add_headers-set_cookies-functions."
id="toc-the-get-function-and-its-use-with-content-add_headers-set_cookies-functions."><span
class="toc-section-number">4.3.1</span> The <code>GET()</code> function
and its use with <code>content()</code>, <code>add_headers()</code>,
<code>set_cookies()</code> functions.</a></li>
<li><a
href="#accessing-websites-with-passwords-the-authenticate-configuration-function."
id="toc-accessing-websites-with-passwords-the-authenticate-configuration-function."><span
class="toc-section-number">4.3.2</span> Accessing websites with
passwords: the <code>authenticate()</code> configuration
function.</a></li>
<li><a href="#using-handles-handle-function."
id="toc-using-handles-handle-function."><span
class="toc-section-number">4.3.3</span> Using handles:
<code>handle()</code> function.</a></li>
</ul></li>
<li><a href="#further-resources-about-httr-package-and-webscrapping."
id="toc-further-resources-about-httr-package-and-webscrapping."><span
class="toc-section-number">4.4</span> Further resources about
<code>httr</code> package and webscrapping.</a></li>
</ul></li>
<li><a href="#reading-data-from-apis-with-the-httr-package."
id="toc-reading-data-from-apis-with-the-httr-package."><span
class="toc-section-number">5</span> Reading data from APIs, with the
<code>httr</code> package.</a>
<ul>
<li><a href="#twitter-api." id="toc-twitter-api."><span
class="toc-section-number">5.1</span> Twitter API.</a>
<ul>
<li><a
href="#creating-a-twitter-application.-requirements-for-accessing-twitter-api."
id="toc-creating-a-twitter-application.-requirements-for-accessing-twitter-api."><span
class="toc-section-number">5.1.1</span> Creating a Twitter application.
Requirements for accessing Twitter API.</a></li>
<li><a
href="#source-code-and-version-control-security-warning-store-api-keys-in-environment-variables."
id="toc-source-code-and-version-control-security-warning-store-api-keys-in-environment-variables."><span
class="toc-section-number">5.1.2</span> Source code and version control
<em>security warning:</em> store API keys in environment variables.</a>
<ul>
<li><a
href="#storing-my-twitter-api-keys-and-tokens-as-environment-variables-in-r-and-retreiving-them-with-sys.getenv."
id="toc-storing-my-twitter-api-keys-and-tokens-as-environment-variables-in-r-and-retreiving-them-with-sys.getenv."><span
class="toc-section-number">5.1.2.1</span> Storing my Twitter API keys
and tokens as environment variables in R, and retreiving them with
<code>Sys.getenv()</code>.</a></li>
<li><a href="#adding-.renviron-to-.gitignore-file."
id="toc-adding-.renviron-to-.gitignore-file."><span
class="toc-section-number">5.1.2.2</span> Adding <code>.Renviron</code>
to <code>.gitignore</code> file.</a></li>
<li><a
href="#using-the-gitignore-r-package-to-get-very-useful-templates-from-gitignore.io-api."
id="toc-using-the-gitignore-r-package-to-get-very-useful-templates-from-gitignore.io-api."><span
class="toc-section-number">5.1.2.3</span> Using the
<code>gitignore R package</code> to get very useful templates from
<code>gitignore.io API</code>.</a>
<ul>
<li><a
href="#two-useful-functions-gi_available_templates-and-gi_fetch_templates."
id="toc-two-useful-functions-gi_available_templates-and-gi_fetch_templates."><span
class="toc-section-number">5.1.2.3.1</span> Two useful functions:
<code>gi_available_templates()</code> and
<code>gi_fetch_templates()</code>.</a></li>
</ul></li>
</ul></li>
<li><a
href="#accessing-twitter-api-from-r-with-httr-package-oauth_app-sign_oauth1.0-and-sign_oauth2.0."
id="toc-accessing-twitter-api-from-r-with-httr-package-oauth_app-sign_oauth1.0-and-sign_oauth2.0."><span
class="toc-section-number">5.1.3</span> Accessing Twitter API from R
with <code>httr</code> package: <code>oauth_app()</code>,
<code>sign_oauth1.0()</code> and <code>sign_oauth2.0()</code>.</a></li>
<li><a
href="#api-endpoints-urls-as-input-for-get-a-useful-oauth_endpoints-function."
id="toc-api-endpoints-urls-as-input-for-get-a-useful-oauth_endpoints-function."><span
class="toc-section-number">5.1.4</span> API endpoints’ URLs as input for
<code>GET()</code>: a useful <code>oauth_endpoints()</code>
function.</a></li>
</ul></li>
<li><a href="#github-api." id="toc-github-api."><span
class="toc-section-number">5.2</span> GitHub API.</a>
<ul>
<li><a
href="#installing-the-httpuv-package-to-make-httr-package-properly-work."
id="toc-installing-the-httpuv-package-to-make-httr-package-properly-work."><span
class="toc-section-number">5.2.1</span> Installing the
<code>httpuv</code> package to make <code>httr</code> package properly
work.</a></li>
<li><a
href="#accessing-github-api-from-r-with-httr-package-oauth_app-oauth2.0_token-config-and-stop_for_status."
id="toc-accessing-github-api-from-r-with-httr-package-oauth_app-oauth2.0_token-config-and-stop_for_status."><span
class="toc-section-number">5.2.2</span> Accessing GitHub API from R with
<code>httr</code> package: <code>oauth_app()</code>,
<code>oauth2.0_token()</code>, <code>config()</code> and
<code>stop_for_status()</code>.</a></li>
</ul></li>
</ul></li>
<li><a href="#reading-from-other-sources."
id="toc-reading-from-other-sources."><span
class="toc-section-number">6</span> Reading from other sources.</a>
<ul>
<li><a
href="#interacting-more-directly-with-files-file-url-gzfile-bzfile."
id="toc-interacting-more-directly-with-files-file-url-gzfile-bzfile."><span
class="toc-section-number">6.1</span> Interacting more directly with
files: <code>file()</code>, <code>url()</code>, <code>gzfile()</code>,
<code>bzfile()</code>.</a></li>
<li><a href="#the-foreing-package." id="toc-the-foreing-package."><span
class="toc-section-number">6.2</span> The <code>foreing</code>
package.</a></li>
<li><a
href="#reading-fixed-format-files-read.fortran-read.fwf-from-the-utils-package."
id="toc-reading-fixed-format-files-read.fortran-read.fwf-from-the-utils-package."><span
class="toc-section-number">6.3</span> Reading fixed-format files:
<code>read.fortran()</code>, <code>read.fwf()</code> from the
<code>utils</code> package.</a></li>
<li><a
href="#examples-of-other-databases-packages-rpostgresql-rodbc-rmongodb."
id="toc-examples-of-other-databases-packages-rpostgresql-rodbc-rmongodb."><span
class="toc-section-number">6.4</span> Examples of other databases
packages: <code>RPostgreSQL</code>, <code>RODBC</code>,
<code>rmongodb</code>.</a></li>
<li><a href="#reading-images." id="toc-reading-images."><span
class="toc-section-number">6.5</span> Reading images.</a>
<ul>
<li><a href="#example-readjpeg-from-jpeg-package."
id="toc-example-readjpeg-from-jpeg-package."><span
class="toc-section-number">6.5.1</span> Example: <code>readJPEG()</code>
from <code>jpeg</code> package.</a></li>
</ul></li>
<li><a href="#reading-gis-data." id="toc-reading-gis-data."><span
class="toc-section-number">6.6</span> Reading GIS data.</a></li>
<li><a href="#reading-music-data." id="toc-reading-music-data."><span
class="toc-section-number">6.7</span> Reading music data.</a></li>
</ul></li>
<li><a href="#session-info." id="toc-session-info."><span
class="toc-section-number">7</span> Session Info.</a></li>
</ul>
</div>

<hr />
<div id="reading-from-mysql." class="section level1" number="1">
<h1><span class="header-section-number">1</span> Reading from
MySQL.</h1>
<p>MySQL’s one of the most widely used open source databases.</p>
<ul>
<li>Basically because it’s free but also because it works really
well.</li>
</ul>
<p>It’s widely used in <strong>Internet-based applications</strong>.</p>
<p>Data are <strong>structured</strong> in <em>databases</em>.</p>
<ul>
<li><p>Within each database, there’s a series of
<em>tables</em>.</p></li>
<li><p>And within the tables, there a series of
<em>fields</em>.</p></li>
<li><p>Each row is called a <em>record</em>.</p></li>
</ul>
<p>So, we can think of <strong>each table</strong> of a datbase as a
<em>dataset</em>, where:</p>
<ul>
<li><p><strong>each field</strong> of the table is one of it’s
<em>columns</em>;</p></li>
<li><p><strong>each record</strong> is one <em>row</em>.</p></li>
</ul>
<div id="example-of-the-data-structrue-in-a-mysql-database."
class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Example of the data
structrue in a MySQL database.</h2>
<p>As an example structure that we would get for a particular database,
we can see this the following <a
href="https://dev.mysql.com/doc/employee/en/sakila-structure.html">database
of employees</a>.</p>
<div class="figure">
<img src="3_data/employees-schema.png" alt="" />
<p class="caption">Employees schema from MySQL documentation</p>
</div>
<ul>
<li>We can see there several different tables that are all linked
together, for example we might have all these tables:
<ul>
<li><em>departments that the employees are employed in</em>;<br />
</li>
<li>the <em>employees themselves</em>;<br />
</li>
<li>information about employees <em>salaries</em> in a different
table;<br />
</li>
<li>information about who their <em>managers</em> are in yet another
table;<br />
</li>
<li>and information about their <em>titles</em> in yet another
table.<br />
</li>
</ul></li>
<li>For <strong>each table</strong>, we get a slightly <strong>different
kind of data type</strong>.</li>
</ul>
<p>We can think that <strong>one box</strong> corresponds to <strong>one
data frame in R</strong>, so to speak.</p>
<p>And we can think all of the <strong>variables listed inside the
box</strong>, as the <strong>column names</strong> for that data frame
in R.</p>
<p>We can also <strong>notice</strong> that there are <strong>linked
tables</strong>, because of the <strong>common ids
(<code>emp_no</code>)</strong> that appear in all of them.</p>
<ul>
<li><p>Therefore it’s possible to access for an employee, which
department he belongs to, what his salary is, what title he has and
who’s his department manager.</p></li>
<li><p>The department managers are then organized into departments, so
we could follow that back and find out who the employees are.</p></li>
</ul>
</div>
<div id="installing-mysql." class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Installing
MySQL.</h2>
<p>At the time of writing these notes, we find in MySQL web site:</p>
<ul>
<li><p>the <a
href="https://dev.mysql.com/doc/refman/5.7/en/installing.html">MySQL
version 5.7 install webpage</a></p></li>
<li><p>the <a
href="https://dev.mysql.com/doc/refman/8.0/en/installing.html">MySQL
version 8.0 install webpage</a></p></li>
</ul>
<p>We can see in both pages that there’s a version of MySQL for just
about every kind of operating system that we might be interested in
installing it on.</p>
<ul>
<li><p>The instructions are pretty explicit on how to install
MySQL.</p></li>
<li><p>I’ve decided to install the latest MySQL version (8.15), instead
of that that has been used in the course (version 5.7). I hope no
compatibility problems arise.</p></li>
</ul>
</div>
<div id="installing-rmysql." class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Installing
RMySQL.</h2>
<p>RMySQL is a <strong>database interface</strong> and a <strong>MySQL
driver</strong> implementing the R database (DBI) API.</p>
<p>How to <strong>install RMySQL</strong>:</p>
<ul>
<li><p>On Mac/Unix we can just do
<code>install.packages("RMySQL")</code>.</p></li>
<li><p>For Windows, it’s actually a little bit more complicated because
of the way that the database drivers need to be set up and so forth.</p>
<ul>
<li><p>See the <a
href="http://biostat.mc.vanderbilt.edu/wiki/Main/RMySQL">official
instructions here</a></p></li>
<li><p><a
href="http://http://www.ahschulz.de/2013/07/23/installing-rmysql-under-windows/">This
guide</a> is quite a bit more intuitive and useful.</p></li>
</ul></li>
</ul>
</div>
<div id="example-of-a-web-facing-version-of-a-mysql-database."
class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Example of a
web-facing version of a MySQL database.</h2>
<p>We’re going to use a <strong>web-facing version of a MySQL
database</strong>, so that we can just concentrate on how the <em>R</em>
part of <code>RMySQL package</code> works, that is to say, how can we
work with a database without having to actually build it.</p>
<p>As data scientists we’ll likely have to collect data from a database
and maybe later we’re going to put some data back in it. But usually,
the basic data collection has already been formed before, so we’ll
usually be handed a database to get data out of it.</p>
<p>The University of California Santa Cruz has <strong>one of the most
famous databases about the human genome</strong>.</p>
<p>And they have a <a
href="https://genome.ucsc.edu/goldenPath/help/mysql.html">public facing
MySQL page</a>, a sort of MySQL server that gives us the
<strong>information on how to connect to it</strong>.</p>
<div class="figure">
<img src="3_data/ucsc-genome-browser.png" alt="" />
<p class="caption">UCSC Genome Browser</p>
</div>
<p>So, we’ll connect to this MySQL sever and try to access the database
and <strong>collect some information</strong> about a <strong>particular
genome</strong> that we’re interested in.</p>
</div>
<div
id="connecting-to-a-mysql-server-and-listing-databases-dbconnect-dbgetquery-dbdisconnect."
class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Connecting to a MySQL
server and listing databases: <code>dbConnect()</code>,
<code>dbGetQuery()</code>, <code>dbDisconnect()</code>.</h2>
<p>Once we’ve loaded RMySQL package in R, we can use the
<strong><code>dbConnect()</code> command</strong> to connect to a
database server.</p>
<ul>
<li><p>It connects to a DBMS going through the appropriate
authentication procedure.</p></li>
<li><p>And it <strong>returns</strong> an object, called
<strong>handle</strong>, that is <strong>used to communicate</strong>
with the <strong>database engine</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RMySQL)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">&#39;RMySQL&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>The following object is masked from <span class="st">&#39;package:RSQLite&#39;</span><span class="sc">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    isIdCurrent</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dbConnect)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Formal class <span class="st">&#39;standardGeneric&#39;</span> [package <span class="st">&quot;methods&quot;</span>] with <span class="dv">8</span> slots</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> .Data     <span class="sc">:</span><span class="cf">function</span> (drv, ...)  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> generic   <span class="sc">:</span> chr <span class="st">&quot;dbConnect&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;package&quot;</span>)<span class="ot">=</span> chr <span class="st">&quot;DBI&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> package   <span class="sc">:</span> chr <span class="st">&quot;DBI&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> group     <span class="sc">:</span> <span class="fu">list</span>()</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> valueClass<span class="sc">:</span> chr <span class="st">&quot;DBIConnection&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> signature <span class="sc">:</span> chr <span class="st">&quot;drv&quot;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> default   <span class="sc">:</span> <span class="cn">NULL</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">@</span> skeleton  <span class="sc">:</span> <span class="fu">language</span> (<span class="cf">function</span> (drv, ...)  <span class="fu">stop</span>(<span class="st">&quot;invalid call in method dispatch to &#39;dbConnect&#39; (no default method)&quot;</span>,  ...</span></code></pre></div>
<p>So, we’ll connect to the <strong>genomic MySQL database of
UCSC</strong>. By the time of writing these notes, there are indeed
<strong>two database servers</strong> available for public access.</p>
<ul>
<li><p>One located in the US:
<code>genome-mysql.soe.ucsc.edu</code>.</p></li>
<li><p>The other located in Europe:
<code>genome-euro-mysql.soe.ucsc.edu</code>.</p></li>
</ul>
<p>We are going to do <strong>three things</strong> in a continous
series of commands (open a connection with a db server, make a query and
disconnect us from the server).</p>
<ol style="list-style-type: decimal">
<li>In order to connect to a db server (we are going to use the first
one), we <strong>have to pass</strong> to <code>dbConnect</code> these
arguments:
<ul>
<li>The <code>MySQL()</code> function, because we want to connect to a
MySQL server (it returns a singlenton that allows us to connect to
MySQL).
<ul>
<li>We can also use <code>dbConnect</code> to connect <strong>not only
to MySQL servers</strong>, but also to other kinds as well.<br />
</li>
</ul></li>
<li>Other <strong>authentication arguments</strong> needed by the DBMS
instance (typically, <code>user</code>, <code>password</code>,
<code>host</code>, <code>port</code>, <code>dbname</code>, etc.). In our
example, we need to specify:
<ul>
<li>The <code>user</code>: as we can see in the UCSC webpage, it is
<code>genome</code>.<br />
</li>
<li>The <code>host</code>: we choose the MySQL server in the US,
<code>genome-mysql.soe.ucsc.edu</code>.<br />
</li>
</ul></li>
</ul></li>
<li>Once a connection is established and passed to a handle (that we’ll
call <code>ucscDb</code>), we can then <strong>apply a query to the
database</strong>. And we can do that with the <code>dbGetQuery()</code>
function, that takes the following arguments:
<ul>
<li>The handle that is in charge of the communication with the database
engine.</li>
<li>And the <code>MySQL</code> command that we want to send to the
database through this <code>dbGetQuery()</code> function, in this case,
we issue the <code>show databases;</code> command because we want to see
the list of the databases available in the host.<br />
</li>
</ul></li>
<li>Finally, after we’ve done with our queries, we use
<code>dbDisconnect()</code>.
<ul>
<li>It’s <strong>very important</strong> that, whenever we’re done
analyzing data or collecting data from a MySQL server, we disconnect
from that server.<br />
</li>
<li>We should get a <code>TRUE</code> response, that is coming from
<code>dbDisconnect</code> confirming that we did, in fact, disconnect
from the server.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ucscDb <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user =</span> <span class="st">&quot;genome&quot;</span>, <span class="at">host =</span> <span class="st">&quot;genome-mysql.soe.ucsc.edu&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(ucscDb, <span class="st">&quot;show databases;&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(ucscDb)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(result)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">340</span> obs. of  <span class="dv">1</span> variable<span class="sc">:</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> Database<span class="sc">:</span> chr  <span class="st">&quot;acaChl1&quot;</span> <span class="st">&quot;ailMel1&quot;</span> <span class="st">&quot;allMis1&quot;</span> <span class="st">&quot;allSin1&quot;</span> ...</span></code></pre></div>
<ul>
<li>So <code>result</code> is a data frame that shows a list of all the
databases that are available within the MySQL server.</li>
</ul>
</div>
<div
id="connecting-to-a-specific-database-and-listing-its-tables-dblisttables."
class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Connecting to a
specific database and listing its tables:
<code>dbListTables()</code>.</h2>
<p>We’ll now focus on one particular database: the
<code>hg19</code>.</p>
<ul>
<li>This is a particular build of the human genome, <strong>the 19th
build of the human genome</strong>.</li>
</ul>
<p>In order to connect to a specific database within a server, we’ll run
<code>dbConnect</code> command again, but instead of just passing it the
<code>user</code>, we’ll <strong>also pass</strong> the <strong>database
name</strong> through to the <strong><code>db</code>
parameter</strong>.</p>
<p>One more time, then, we’ll <em>make the connection</em> to the
database, <em>issue the query</em> we want (this time we want to see all
the tables that exist in that database, with the
<code>dbListTables()</code> function), and <em>close the
connection</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hg19 <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user =</span> <span class="st">&quot;genome&quot;</span>, <span class="at">db =</span> <span class="st">&quot;hg19&quot;</span>, <span class="at">host =</span> <span class="st">&quot;genome-mysql.soe.ucsc.edu&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>allTables <span class="ot">&lt;-</span> <span class="fu">dbListTables</span>(hg19)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(hg19)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(allTables)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">12603</span>] <span class="st">&quot;HInv&quot;</span> <span class="st">&quot;HInvGeneMrna&quot;</span> <span class="st">&quot;acembly&quot;</span> <span class="st">&quot;acemblyClass&quot;</span> <span class="st">&quot;acemblyPep&quot;</span> ...</span></code></pre></div>
<ul>
<li><p>So <code>allTables</code> is a large character vector with 12603
table names (all of them in a single database).</p></li>
<li><p>Those tables correspond to various different elements that
describe components of the human genome. <strong>Each table</strong>
corresponds to a <strong>different kind of dataset</strong>.</p></li>
<li><p>So, we can think about it in the <strong>same way that the tidy
data principle is</strong>. We saw that each dataset corresponds to its
own file. It’s the same way here, <strong>each different data
type</strong> gets its <strong>own table</strong>.</p></li>
</ul>
</div>
<div
id="getting-the-dimensions-of-a-specific-table-its-fields-columns-and-records-rows-dblistfields-dbgetquery."
class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Getting the
dimensions of a specific table, its fields (columns) and records (rows):
<code>dbListFields()</code>, <code>dbGetQuery()</code>.</h2>
<p>Suppose we are interested in this specific table:
<code>affyU133Plus2</code> within <code>hg19</code> database.</p>
<ul>
<li>This table is for a particular kind of micro-array, which is a
measurement technology used to measure something about the genome.</li>
</ul>
<p>More precisely, suppose we’re interested in two things:</p>
<ul>
<li><p>Look at <strong>all the fields</strong> in that particular table
(as we said, the fields correspond to something like the <em>column
names</em> of a <em>data frame</em>).</p>
<ul>
<li>We can do this through the <code>dbListFields()</code> command, to
which we give the db connection handle and the name of the table we
want.</li>
</ul></li>
<li><p>Find out <strong>how many records</strong> (different rows) there
are in the table.</p>
<ul>
<li>We just send another query to the database, through
<code>dbGetQuery</code> again, passing to it the corrisponding
<code>MySQL</code> command in quotes:
<code>"select count(*) from affyU133Plus2"</code> (something like
<em>select all records and count them, from the table</em>).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hg19 <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user =</span> <span class="st">&quot;genome&quot;</span>, <span class="at">db =</span> <span class="st">&quot;hg19&quot;</span>, <span class="at">host =</span> <span class="st">&quot;genome-mysql.soe.ucsc.edu&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(hg19, <span class="st">&quot;affyU133Plus2&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;bin&quot;</span>         <span class="st">&quot;matches&quot;</span>     <span class="st">&quot;misMatches&quot;</span>  <span class="st">&quot;repMatches&quot;</span>  <span class="st">&quot;nCount&quot;</span>     </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;qNumInsert&quot;</span>  <span class="st">&quot;qBaseInsert&quot;</span> <span class="st">&quot;tNumInsert&quot;</span>  <span class="st">&quot;tBaseInsert&quot;</span> <span class="st">&quot;strand&quot;</span>     </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">&quot;qName&quot;</span>       <span class="st">&quot;qSize&quot;</span>       <span class="st">&quot;qStart&quot;</span>      <span class="st">&quot;qEnd&quot;</span>        <span class="st">&quot;tName&quot;</span>      </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] <span class="st">&quot;tSize&quot;</span>       <span class="st">&quot;tStart&quot;</span>      <span class="st">&quot;tEnd&quot;</span>        <span class="st">&quot;blockCount&quot;</span>  <span class="st">&quot;blockSizes&quot;</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] <span class="st">&quot;qStarts&quot;</span>     <span class="st">&quot;tStarts&quot;</span>    </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(hg19, <span class="st">&quot;select count(*) from affyU133Plus2&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="sc">*</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">58463</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(hg19)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<ul>
<li><p>So <code>dbListFields</code> returns a character vector with all
the fields names (columns) of the table.</p></li>
<li><p>And the MySQL query we issued in second place, the number of the
records (rows) of the table.</p></li>
</ul>
</div>
<div id="read-from-the-table-dbreadtable." class="section level2"
number="1.8">
<h2><span class="header-section-number">1.8</span> Read from the table:
<code>dbReadTable()</code>.</h2>
<p>Now suppose we want to <strong>get one of the tables out</strong>.
Basically <strong>get a data frame out</strong> from a table.</p>
<p>We can use for this the <code>dbReadTable()</code> function, just
passing to it, besides the usual db connection handle, the table name
that we’re interested in.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hg19 <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user =</span> <span class="st">&quot;genome&quot;</span>, <span class="at">db =</span> <span class="st">&quot;hg19&quot;</span>, <span class="at">host =</span> <span class="st">&quot;genome-mysql.soe.ucsc.edu&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>affyData <span class="ot">&lt;-</span> <span class="fu">dbReadTable</span>(hg19, <span class="st">&quot;affyU133Plus2&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(hg19)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(affyData)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">58463</span> obs. of  <span class="dv">22</span> variables<span class="sc">:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> bin        <span class="sc">:</span> num  <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">585</span> <span class="dv">73</span> <span class="dv">585</span> ...</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> matches    <span class="sc">:</span> num  <span class="dv">530</span> <span class="dv">3355</span> <span class="dv">4156</span> <span class="dv">4667</span> <span class="dv">5180</span> ...</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> misMatches <span class="sc">:</span> num  <span class="dv">4</span> <span class="dv">17</span> <span class="dv">14</span> <span class="dv">9</span> <span class="dv">14</span> <span class="dv">5</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">21</span> <span class="dv">23</span> ...</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> repMatches <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> nCount     <span class="sc">:</span> num  <span class="dv">23</span> <span class="dv">109</span> <span class="dv">83</span> <span class="dv">68</span> <span class="dv">167</span> <span class="dv">14</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">56</span> <span class="dv">75</span> ...</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qNumInsert <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">9</span> <span class="dv">16</span> <span class="dv">21</span> <span class="dv">10</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">22</span> ...</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qBaseInsert<span class="sc">:</span> num  <span class="dv">41</span> <span class="dv">67</span> <span class="dv">18</span> <span class="dv">42</span> <span class="dv">38</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">41</span> ...</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tNumInsert <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">9</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span> ...</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tBaseInsert<span class="sc">:</span> num  <span class="dv">898</span> <span class="dv">11621</span> <span class="dv">93</span> <span class="dv">5743</span> <span class="dv">29</span> ...</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> strand     <span class="sc">:</span> chr  <span class="st">&quot;-&quot;</span> <span class="st">&quot;-&quot;</span> <span class="st">&quot;-&quot;</span> <span class="st">&quot;-&quot;</span> ...</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qName      <span class="sc">:</span> chr  <span class="st">&quot;225995_x_at&quot;</span> <span class="st">&quot;225035_x_at&quot;</span> <span class="st">&quot;226340_x_at&quot;</span> <span class="st">&quot;1557034_s_at&quot;</span> ...</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qSize      <span class="sc">:</span> num  <span class="dv">637</span> <span class="dv">3635</span> <span class="dv">4318</span> <span class="dv">4834</span> <span class="dv">5399</span> ...</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStart     <span class="sc">:</span> num  <span class="dv">5</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">48</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">12</span> <span class="dv">3</span> ...</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qEnd       <span class="sc">:</span> num  <span class="dv">603</span> <span class="dv">3548</span> <span class="dv">4274</span> <span class="dv">4834</span> <span class="dv">5399</span> ...</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tName      <span class="sc">:</span> chr  <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> ...</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tSize      <span class="sc">:</span> num  <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> ...</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStart     <span class="sc">:</span> num  <span class="dv">14361</span> <span class="dv">14381</span> <span class="dv">14399</span> <span class="dv">14406</span> <span class="dv">19688</span> ...</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tEnd       <span class="sc">:</span> num  <span class="dv">15816</span> <span class="dv">29483</span> <span class="dv">18745</span> <span class="dv">24893</span> <span class="dv">25078</span> ...</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockCount <span class="sc">:</span> num  <span class="dv">5</span> <span class="dv">17</span> <span class="dv">18</span> <span class="dv">23</span> <span class="dv">11</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">24</span> ...</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockSizes <span class="sc">:</span> chr  <span class="st">&quot;93,144,229,70,21,&quot;</span> <span class="st">&quot;73,375,71,165,303,360,198,661,201,1,260,250,74,73,98,155,163,&quot;</span> <span class="st">&quot;690,10,32,33,376,4,5,15,5,11,7,41,277,859,141,51,443,1253,&quot;</span> <span class="st">&quot;99,352,286,24,49,14,6,5,8,149,14,44,98,12,10,355,837,59,8,1500,133,624,58,&quot;</span> ...</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStarts    <span class="sc">:</span> chr  <span class="st">&quot;34,132,278,541,611,&quot;</span> <span class="st">&quot;87,165,540,647,818,1123,1484,1682,2343,2545,2546,2808,3058,3133,3206,3317,3472,&quot;</span> <span class="st">&quot;44,735,746,779,813,1190,1195,1201,1217,1223,1235,1243,1285,1564,2423,2565,2617,3062,&quot;</span> <span class="st">&quot;0,99,452,739,764,814,829,836,842,851,1001,1016,1061,1160,1173,1184,1540,2381,2441,2450,3951,4103,4728,&quot;</span> ...</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStarts    <span class="sc">:</span> chr  <span class="st">&quot;14361,14454,14599,14968,15795,&quot;</span> <span class="st">&quot;14381,14454,14969,15075,15240,15543,15903,16104,16853,17054,17232,17492,17914,17988,18267,24736,29320,&quot;</span> <span class="st">&quot;14399,15089,15099,15131,15164,15540,15544,15549,15564,15569,15580,15587,15628,15906,16857,16998,17049,17492,&quot;</span> <span class="st">&quot;14406,20227,20579,20865,20889,20938,20952,20958,20963,20971,21120,21134,21178,21276,21288,21298,21653,22492,225&quot;</span><span class="sc">|</span> __truncated__ ...</span></code></pre></div>
<ul>
<li><p>So it returns, directly from a database in the MySQL server, the
specific <code>data.frame</code> (table) we wanted.</p></li>
<li><p>In this manner, we can extract the data <strong>one table at a
time</strong>.</p></li>
</ul>
</div>
<div
id="what-if-the-table-is-gigantic-select-a-specific-subset-with-dbsendquery-fetch-dbclearresult."
class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> What if the table is
gigantic? Select a specific subset with <code>dbSendQuery()</code>,
<code>fetch()</code>, <code>dbClearResult()</code>.</h2>
<p>When working with MySQL databases, there’ll often be a huge amount of
data stored. Any particular table might be enormous and might be
<strong>too big to read into R</strong>.</p>
<p>One thing we might want to do is <strong>select only a subset of the
data</strong>.</p>
<ul>
<li><p>In particular, suppose that we want only the observations in the
<code>affy/133Plus2</code> table that meet this condition: the
<code>misMatches</code> field (variable/column) has to be in the range
of 1 to 3.</p></li>
<li><p>The corrisponding <code>MySQL</code> command for that selection
is as follows:
<code>select * from affyU133Plus2 where misMatches between 1 and 3</code></p></li>
</ul>
<p>Now, instead of sending that query and getting inmediatly the
response via the <code>dbGetQuery()</code> command, we can make those
two steps separately, as follows:</p>
<ol style="list-style-type: decimal">
<li><p>First, use the <strong><code>dbSendQuery()</code>
command</strong> just to send the query to the database, to store the
query remotely at the database.</p>
<ul>
<li>It has basically the same arguments than
<code>dbGetQuery()</code>.</li>
</ul></li>
<li><p>Then, when we want to get the records of that query, we use the
<strong><code>fetch()</code> command</strong> all the times that we want
while the connection is still on.</p>
<ul>
<li><p>It’s first argument is the object (handle) created by
<code>dbSendQuery()</code>.</p></li>
<li><p>And we can also specify as <strong>second argument</strong> the
number of records (observations/rows) we want from the previously
executed query.</p></li>
<li><p>This function <strong>retruns a
<code>data.frame</code></strong>.</p></li>
</ul></li>
<li><p>Finally, it’s important to <strong>clear the query</strong> with
<code>dbClearResult()</code> command.</p>
<ul>
<li><p>The query we sent out to the MySQL server, is still sitting out
there. When we fetch the data back, it doesn’t stop that query from
still being out there, at the MySQL Server.</p></li>
<li><p>So <code>dbClearResult()</code> frees all resources (local and
remote) associated with a result set. In some cases (e.g., very large
result sets) this can be a critical step to avoid exhausting resources
(memory, file descriptors, etc.).</p></li>
<li><p>It should return <code>TRUE</code> again.</p></li>
</ul></li>
</ol>
<p>This technique is <strong>useful</strong> when we just want to see a
little bit of the data and make sure that we don’t accidentally bring
down to our computer a gigantic table.</p>
<ul>
<li>We can just use the fetch command, telling it only bring back a
small number of records.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hg19 <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user =</span> <span class="st">&quot;genome&quot;</span>, <span class="at">db =</span> <span class="st">&quot;hg19&quot;</span>, <span class="at">host =</span> <span class="st">&quot;genome-mysql.soe.ucsc.edu&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="fu">dbSendQuery</span>(hg19, <span class="st">&quot;select * from affyU133Plus2 where misMatches between 1 and 3&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>affyMis <span class="ot">&lt;-</span> <span class="fu">fetch</span>(query)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>affyMisSmall <span class="ot">&lt;-</span> <span class="fu">fetch</span>(query, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dbClearResult</span>(query)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(hg19)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(affyMis)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">500</span> obs. of  <span class="dv">22</span> variables<span class="sc">:</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> bin        <span class="sc">:</span> num  <span class="dv">585</span> <span class="dv">586</span> <span class="dv">73</span> <span class="dv">587</span> <span class="dv">587</span> <span class="dv">587</span> <span class="dv">588</span> <span class="dv">588</span> <span class="dv">589</span> <span class="dv">589</span> ...</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> matches    <span class="sc">:</span> num  <span class="dv">723</span> <span class="dv">740</span> <span class="dv">986</span> <span class="dv">741</span> <span class="dv">985</span> ...</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> misMatches <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> repMatches <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> nCount     <span class="sc">:</span> num  <span class="dv">6</span> <span class="dv">26</span> <span class="dv">17</span> <span class="dv">26</span> <span class="dv">17</span> <span class="dv">0</span> <span class="dv">11</span> <span class="dv">76</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qNumInsert <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">13</span> <span class="dv">24</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qBaseInsert<span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">5</span> <span class="dv">0</span> <span class="dv">13</span> <span class="dv">28</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tNumInsert <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tBaseInsert<span class="sc">:</span> num  <span class="dv">2</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">836</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> strand     <span class="sc">:</span> chr  <span class="st">&quot;+&quot;</span> <span class="st">&quot;-&quot;</span> <span class="st">&quot;+&quot;</span> <span class="st">&quot;+&quot;</span> ...</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qName      <span class="sc">:</span> chr  <span class="st">&quot;228609_at&quot;</span> <span class="st">&quot;225899_x_at&quot;</span> <span class="st">&quot;1569609_at&quot;</span> <span class="st">&quot;225899_x_at&quot;</span> ...</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qSize      <span class="sc">:</span> num  <span class="dv">733</span> <span class="dv">851</span> <span class="dv">1075</span> <span class="dv">851</span> <span class="dv">1075</span> ...</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStart     <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">70</span> <span class="dv">23</span> <span class="dv">70</span> <span class="dv">23</span> <span class="dv">0</span> <span class="dv">20</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">0</span> ...</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qEnd       <span class="sc">:</span> num  <span class="dv">733</span> <span class="dv">838</span> <span class="dv">1031</span> <span class="dv">838</span> <span class="dv">1031</span> ...</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tName      <span class="sc">:</span> chr  <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> ...</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tSize      <span class="sc">:</span> num  <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> ...</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStart     <span class="sc">:</span> num  <span class="dv">28444</span> <span class="dv">134772</span> <span class="dv">261364</span> <span class="dv">327813</span> <span class="dv">347276</span> ...</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tEnd       <span class="sc">:</span> num  <span class="dv">29178</span> <span class="dv">135540</span> <span class="dv">262370</span> <span class="dv">328581</span> <span class="dv">348281</span> ...</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockCount <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">17</span> <span class="dv">25</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockSizes <span class="sc">:</span> chr  <span class="st">&quot;145,125,462,&quot;</span> <span class="st">&quot;768,&quot;</span> <span class="st">&quot;597,54,355,&quot;</span> <span class="st">&quot;768,&quot;</span> ...</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStarts    <span class="sc">:</span> chr  <span class="st">&quot;0,145,271,&quot;</span> <span class="st">&quot;13,&quot;</span> <span class="st">&quot;23,621,676,&quot;</span> <span class="st">&quot;70,&quot;</span> ...</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStarts    <span class="sc">:</span> chr  <span class="st">&quot;28444,28591,28716,&quot;</span> <span class="st">&quot;134772,&quot;</span> <span class="st">&quot;261364,261961,262015,&quot;</span> <span class="st">&quot;327813,&quot;</span> ...</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(affyMis<span class="sc">$</span>misMatches)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">%  25%</span>  <span class="dv">50</span><span class="sc">%  75%</span> <span class="dv">100</span>% </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">2</span>    <span class="dv">3</span> </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(affyMisSmall)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">10</span> obs. of  <span class="dv">22</span> variables<span class="sc">:</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> bin        <span class="sc">:</span> num  <span class="dv">866</span> <span class="dv">866</span> <span class="dv">866</span> <span class="dv">866</span> <span class="dv">866</span> <span class="dv">866</span> <span class="dv">866</span> <span class="dv">874</span> <span class="dv">874</span> <span class="dv">874</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> matches    <span class="sc">:</span> num  <span class="dv">1065</span> <span class="dv">1846</span> <span class="dv">932</span> <span class="dv">932</span> <span class="dv">1543</span> ...</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> misMatches <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> repMatches <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> nCount     <span class="sc">:</span> num  <span class="dv">18</span> <span class="dv">9</span> <span class="dv">35</span> <span class="dv">35</span> <span class="dv">68</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">3</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qNumInsert <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">3</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qBaseInsert<span class="sc">:</span> num  <span class="dv">14</span> <span class="dv">22</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">3</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tNumInsert <span class="sc">:</span> num  <span class="dv">1</span> <span class="dv">10</span> <span class="dv">8</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">16</span> <span class="dv">5</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tBaseInsert<span class="sc">:</span> num  <span class="dv">3613</span> <span class="dv">26349</span> <span class="dv">7715</span> <span class="dv">7715</span> <span class="dv">6960</span> ...</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> strand     <span class="sc">:</span> chr  <span class="st">&quot;-&quot;</span> <span class="st">&quot;-&quot;</span> <span class="st">&quot;+&quot;</span> <span class="st">&quot;+&quot;</span> ...</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qName      <span class="sc">:</span> chr  <span class="st">&quot;225593_at&quot;</span> <span class="st">&quot;227359_at&quot;</span> <span class="st">&quot;223291_at&quot;</span> <span class="st">&quot;223292_s_at&quot;</span> ...</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qSize      <span class="sc">:</span> num  <span class="dv">1131</span> <span class="dv">1878</span> <span class="dv">972</span> <span class="dv">972</span> <span class="dv">1658</span> ...</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStart     <span class="sc">:</span> num  <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qEnd       <span class="sc">:</span> num  <span class="dv">1100</span> <span class="dv">1878</span> <span class="dv">972</span> <span class="dv">972</span> <span class="dv">1614</span> ...</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tName      <span class="sc">:</span> chr  <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> <span class="st">&quot;chr1&quot;</span> ...</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tSize      <span class="sc">:</span> num  <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> <span class="fl">2.49e+08</span> ...</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStart     <span class="sc">:</span> num  <span class="dv">36859020</span> <span class="dv">36881416</span> <span class="dv">36921278</span> <span class="dv">36921278</span> <span class="dv">36921374</span> ...</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tEnd       <span class="sc">:</span> num  <span class="dv">36863719</span> <span class="dv">36909621</span> <span class="dv">36929963</span> <span class="dv">36929963</span> <span class="dv">36929946</span> ...</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockCount <span class="sc">:</span> num  <span class="dv">3</span> <span class="dv">13</span> <span class="dv">10</span> <span class="dv">10</span> <span class="dv">6</span> <span class="dv">11</span> <span class="dv">17</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">4</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> blockSizes <span class="sc">:</span> chr  <span class="st">&quot;734,131,221,&quot;</span> <span class="st">&quot;578,350,64,140,70,45,8,76,104,81,168,155,17,&quot;</span> <span class="st">&quot;248,192,59,85,49,12,64,45,208,8,&quot;</span> <span class="st">&quot;248,192,59,85,49,12,64,45,208,8,&quot;</span> ...</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> qStarts    <span class="sc">:</span> chr  <span class="st">&quot;31,765,910,&quot;</span> <span class="st">&quot;0,598,948,1012,1152,1222,1268,1277,1353,1457,1538,1706,1861,&quot;</span> <span class="st">&quot;1,249,441,500,585,634,647,711,756,964,&quot;</span> <span class="st">&quot;1,249,441,500,585,634,647,711,756,964,&quot;</span> ...</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> tStarts    <span class="sc">:</span> chr  <span class="st">&quot;36859020,36863367,36863498,&quot;</span> <span class="st">&quot;36881416,36883506,36884591,36886076,36887750,36888368,36888413,36888421,36888963,36897402,36898022,36904356,36909604,&quot;</span> <span class="st">&quot;36921278,36921787,36923523,36926292,36926864,36927688,36927700,36929406,36929746,36929955,&quot;</span> <span class="st">&quot;36921278,36921787,36923523,36926292,36926864,36927688,36927700,36929406,36929746,36929955,&quot;</span> ...</span></code></pre></div>
<ul>
<li><p>The quantiles of <code>misMatches</code> is only to verify that
we selected the records with <code>misMatches</code> between one and
three.</p></li>
<li><p>We can see that <code>fetch</code> retruns the result of the
previously excecuted query as <code>data.frame</code>.</p></li>
</ul>
<div id="importance-of-mysql-queries." class="section level3"
number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> Importance of MySQL
queries.</h3>
<p>We can basically send <strong>any MySQL query</strong> that we would
like to a database.</p>
<p>It’s <strong>beyond the scope</strong> of this course to
<strong>teach all of the different queries</strong>. We’ve seen the most
important ones.</p>
<p>But if we go to the <strong>MySQL documentation</strong>, we can
<strong>actually come up with a query</strong> that will allow us to
very flexibly <strong>select almost any sort of subset of rows or
columns</strong> from a dataset that we’re interested in selecting.</p>
</div>
</div>
<div id="general-advices-about-public-databases." class="section level2"
number="1.10">
<h2><span class="header-section-number">1.10</span> General advices
about public databases.</h2>
<p>All that what we’ve done in this lecture is <strong>only
<code>select</code></strong> data from a public MySQL server.</p>
<ul>
<li><p>When dealing with this kind of public resources, it’s very
important that we <strong>do not access</strong> the server to
<strong>delete, add or join</strong> things.</p></li>
<li><p>In other words, <strong>don’t push anything back</strong> into
the server, <strong>only retrieve or select things out</strong> of the
server. We should only be using the select command.</p></li>
</ul>
<p>Another issue regards the access to a web-facing MySQL server like
that we’ve been working with, and it’s this:</p>
<ul>
<li><p>As an <strong>act of good citizenship</strong> to the world, we
should <strong>not contribute to a massive access</strong> to a
server.</p></li>
<li><p>It’s better if we <strong>create a MySQL database on our own
system</strong> and then play around with it.</p></li>
</ul>
</div>
<div id="further-resources-about-mysql." class="section level2"
number="1.11">
<h2><span class="header-section-number">1.11</span> Further resources
about MySQL.</h2>
<p>To know more about <strong>MySQL structure</strong>, we can look
at:</p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/MySQL">the Wikipedia
page</a></p></li>
<li><p>the extensive documentation at <a
href="https://dev.mysql.com/doc/">MySQL website</a></p></li>
</ul>
<p>The <a
href="http://cran.r-project.org/web/packages/RMySQL/RMySQL.pdf">RMySQL
vignette</a> is very good:</p>
<ul>
<li>It gives access to a <strong>bunch of other MySQL commands</strong>
that might be useful for selecting data.</li>
</ul>
<p>There’s also <a
href="http://www.pantz.org/software/mysql/mysqlcommands.html">this
collection of MySQL commands</a>, very nicely organized.</p>
<hr />
</div>
</div>
<div id="manipulating-a-data-frame-with-sql-commands-the-sqldf-package."
class="section level1" number="2">
<h1><span class="header-section-number">2</span> Manipulating a data
frame with SQL commands: the <code>sqldf</code> package.</h1>
<p>The <strong><code>sqldf()</code> function</strong> of this package,
is typically passed a <strong>single argument</strong> which is an
<strong>SQL select statement</strong> where the table names are ordinary
R data frame names.</p>
<ul>
<li><p>It transparently sets up a database, imports the data frames into
that database, performs the SQL select or other statement and returns
the result using a heuristic to determine which class to assign to each
column of the returned data frame.</p></li>
<li><p><code>RSQLite</code>, <code>RH2</code>, <code>RMySQL</code> and
<code>RPostgreSQL</code> backends are supported.</p></li>
<li><p>More information on the <a
href="https://cran.r-project.org/web/packages/sqldf/index.html">CRAN web
page</a> of this package.</p></li>
</ul>
<p>Let’s install from CRAN this package:
<code>install.packages("sqldf")</code>.</p>
<ul>
<li><p><strong>Notice:</strong> to use <code>sqldf</code> package we
need to load only that package, it doesn’t need <code>RMySQL</code> or
any other like that.</p></li>
<li><p>If both <code>sqldf</code> and <code>RMySQL</code> are loaded,
there could be problems so we should better deattach
<code>RMySQL</code>.</p></li>
</ul>
<p>Let’s make the following example.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">&quot;RMySQL&quot;</span> <span class="sc">%in%</span> (<span class="fu">.packages</span>())) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">detach</span>(<span class="st">&quot;package:RMySQL&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the American Survey data and load it into an R object.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>acs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(acs)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(acs)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">14931</span>   <span class="dv">239</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL command to select only the data for the probability weights &quot;pwgtp1&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># with ages less than 50.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sqldf</span>(<span class="st">&quot;select pwgtp1 from acs where AGEP &lt; 50&quot;</span>), <span class="dv">30</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>   pwgtp1</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">87</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">88</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">94</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">91</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">539</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     <span class="dv">192</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>     <span class="dv">153</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>     <span class="dv">232</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>     <span class="dv">205</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">226</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>    <span class="dv">225</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>    <span class="dv">109</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>    <span class="dv">129</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>    <span class="dv">115</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>    <span class="dv">162</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>    <span class="dv">190</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>    <span class="dv">192</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>    <span class="dv">185</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>    <span class="dv">186</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>     <span class="dv">26</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span>    <span class="dv">157</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>     <span class="dv">15</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="dv">23</span>     <span class="dv">36</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span>    <span class="dv">307</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>     <span class="dv">18</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span>     <span class="dv">43</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>    <span class="dv">137</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span>     <span class="dv">49</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span>     <span class="dv">69</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>     <span class="dv">71</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Just checking.</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sqldf</span>(<span class="st">&quot;select pwgtp1, AGEP from acs where AGEP &lt; 50&quot;</span>), <span class="dv">30</span>)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>   pwgtp1 AGEP</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">87</span>   <span class="dv">43</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">88</span>   <span class="dv">42</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">94</span>   <span class="dv">16</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">91</span>   <span class="dv">14</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">539</span>   <span class="dv">29</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     <span class="dv">192</span>   <span class="dv">40</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>     <span class="dv">153</span>   <span class="dv">15</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>     <span class="dv">232</span>   <span class="dv">28</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>     <span class="dv">205</span>   <span class="dv">30</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>    <span class="dv">226</span>    <span class="dv">4</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>    <span class="dv">225</span>    <span class="dv">1</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>    <span class="dv">109</span>   <span class="dv">40</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>    <span class="dv">129</span>   <span class="dv">42</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>    <span class="dv">115</span>   <span class="dv">18</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>    <span class="dv">162</span>   <span class="dv">16</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>    <span class="dv">190</span>   <span class="dv">37</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>    <span class="dv">192</span>   <span class="dv">39</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>    <span class="dv">185</span>    <span class="dv">4</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>    <span class="dv">186</span>    <span class="dv">3</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>     <span class="dv">26</span>   <span class="dv">28</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span>    <span class="dv">157</span>   <span class="dv">49</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>     <span class="dv">15</span>   <span class="dv">45</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="dv">23</span>     <span class="dv">36</span>   <span class="dv">37</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span>    <span class="dv">307</span>   <span class="dv">15</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>     <span class="dv">18</span>   <span class="dv">39</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span>     <span class="dv">43</span>   <span class="dv">40</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>    <span class="dv">137</span>   <span class="dv">39</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span>     <span class="dv">49</span>   <span class="dv">35</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span>     <span class="dv">69</span>   <span class="dv">12</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>     <span class="dv">71</span>   <span class="dv">49</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(acs<span class="sc">$</span>AGEP)</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.00</span>   <span class="fl">16.00</span>   <span class="fl">37.00</span>   <span class="fl">37.05</span>   <span class="fl">55.00</span>   <span class="fl">93.00</span> </span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">&quot;SELECT count(pwgtp1) FROM acs WHERE AGEP &lt; 50&quot;</span>)</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pwgtp1)</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">10093</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">&quot;SELECT count(pwgtp1) FROM acs&quot;</span>)</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pwgtp1)</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">14931</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL command equivalent to &quot;unique(acs$AGEP)&quot;.</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(acs<span class="sc">$</span>AGEP)</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">43</span> <span class="dv">42</span> <span class="dv">16</span> <span class="dv">14</span> <span class="dv">29</span> <span class="dv">40</span> <span class="dv">15</span> <span class="dv">28</span> <span class="dv">30</span>  <span class="dv">4</span>  <span class="dv">1</span> <span class="dv">18</span> <span class="dv">37</span> <span class="dv">39</span>  <span class="dv">3</span> <span class="dv">87</span> <span class="dv">70</span> <span class="dv">49</span> <span class="dv">45</span> <span class="dv">50</span> <span class="dv">60</span> <span class="dv">59</span> <span class="dv">61</span> <span class="dv">64</span> <span class="dv">35</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>[<span class="dv">26</span>] <span class="dv">12</span> <span class="dv">19</span> <span class="dv">31</span>  <span class="dv">9</span>  <span class="dv">0</span> <span class="dv">33</span> <span class="dv">32</span> <span class="dv">20</span> <span class="dv">88</span> <span class="dv">53</span> <span class="dv">58</span> <span class="dv">69</span> <span class="dv">68</span> <span class="dv">48</span> <span class="dv">24</span> <span class="dv">27</span> <span class="dv">74</span> <span class="dv">56</span> <span class="dv">75</span> <span class="dv">17</span> <span class="dv">38</span> <span class="dv">55</span> <span class="dv">26</span> <span class="dv">23</span> <span class="dv">86</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>[<span class="dv">51</span>] <span class="dv">81</span> <span class="dv">77</span>  <span class="dv">7</span> <span class="dv">51</span> <span class="dv">13</span> <span class="dv">11</span> <span class="dv">82</span> <span class="dv">47</span> <span class="dv">46</span> <span class="dv">80</span> <span class="dv">21</span> <span class="dv">54</span> <span class="dv">78</span> <span class="dv">67</span> <span class="dv">22</span>  <span class="dv">2</span> <span class="dv">76</span>  <span class="dv">6</span> <span class="dv">71</span> <span class="dv">34</span> <span class="dv">10</span>  <span class="dv">5</span> <span class="dv">65</span> <span class="dv">62</span> <span class="dv">63</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>[<span class="dv">76</span>] <span class="dv">57</span> <span class="dv">52</span> <span class="dv">79</span> <span class="dv">83</span> <span class="dv">66</span> <span class="dv">25</span> <span class="dv">93</span>  <span class="dv">8</span> <span class="dv">36</span> <span class="dv">41</span> <span class="dv">44</span> <span class="dv">84</span> <span class="dv">72</span> <span class="dv">73</span> <span class="dv">85</span> <span class="dv">89</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>unique_df <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">&quot;SELECT distinct AGEP FROM acs&quot;</span>)</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(unique_df)</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>   <span class="dv">91</span> obs. of  <span class="dv">1</span> variable<span class="sc">:</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> AGEP<span class="sc">:</span> int  <span class="dv">43</span> <span class="dv">42</span> <span class="dv">16</span> <span class="dv">14</span> <span class="dv">29</span> <span class="dv">40</span> <span class="dv">15</span> <span class="dv">28</span> <span class="dv">30</span> <span class="dv">4</span> ...</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>unique_df<span class="sc">$</span>AGEP</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">43</span> <span class="dv">42</span> <span class="dv">16</span> <span class="dv">14</span> <span class="dv">29</span> <span class="dv">40</span> <span class="dv">15</span> <span class="dv">28</span> <span class="dv">30</span>  <span class="dv">4</span>  <span class="dv">1</span> <span class="dv">18</span> <span class="dv">37</span> <span class="dv">39</span>  <span class="dv">3</span> <span class="dv">87</span> <span class="dv">70</span> <span class="dv">49</span> <span class="dv">45</span> <span class="dv">50</span> <span class="dv">60</span> <span class="dv">59</span> <span class="dv">61</span> <span class="dv">64</span> <span class="dv">35</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>[<span class="dv">26</span>] <span class="dv">12</span> <span class="dv">19</span> <span class="dv">31</span>  <span class="dv">9</span>  <span class="dv">0</span> <span class="dv">33</span> <span class="dv">32</span> <span class="dv">20</span> <span class="dv">88</span> <span class="dv">53</span> <span class="dv">58</span> <span class="dv">69</span> <span class="dv">68</span> <span class="dv">48</span> <span class="dv">24</span> <span class="dv">27</span> <span class="dv">74</span> <span class="dv">56</span> <span class="dv">75</span> <span class="dv">17</span> <span class="dv">38</span> <span class="dv">55</span> <span class="dv">26</span> <span class="dv">23</span> <span class="dv">86</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>[<span class="dv">51</span>] <span class="dv">81</span> <span class="dv">77</span>  <span class="dv">7</span> <span class="dv">51</span> <span class="dv">13</span> <span class="dv">11</span> <span class="dv">82</span> <span class="dv">47</span> <span class="dv">46</span> <span class="dv">80</span> <span class="dv">21</span> <span class="dv">54</span> <span class="dv">78</span> <span class="dv">67</span> <span class="dv">22</span>  <span class="dv">2</span> <span class="dv">76</span>  <span class="dv">6</span> <span class="dv">71</span> <span class="dv">34</span> <span class="dv">10</span>  <span class="dv">5</span> <span class="dv">65</span> <span class="dv">62</span> <span class="dv">63</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>[<span class="dv">76</span>] <span class="dv">57</span> <span class="dv">52</span> <span class="dv">79</span> <span class="dv">83</span> <span class="dv">66</span> <span class="dv">25</span> <span class="dv">93</span>  <span class="dv">8</span> <span class="dv">36</span> <span class="dv">41</span> <span class="dv">44</span> <span class="dv">84</span> <span class="dv">72</span> <span class="dv">73</span> <span class="dv">85</span> <span class="dv">89</span></span></code></pre></div>
<hr />
</div>
<div id="reading-from-hdf5." class="section level1" number="3">
<h1><span class="header-section-number">3</span> Reading from HDF5.</h1>
<p>HDF5 (short for <em>Hierarchical Data Format</em>) is used for
<strong>storing large data sets</strong> and also used for
<strong>storing structured datasets</strong>.</p>
<ul>
<li>It supports storing a <em>range of datatypes</em>.</li>
</ul>
<p>The format of the data is <em>Hierarchical</em>:</p>
<ul>
<li><p>There are <strong>groups</strong>: the <strong>data</strong> is
<strong>stored in groups</strong> which contains zero or more
<strong>datasets</strong>, along <strong>with their
metadata</strong>.</p>
<ul>
<li><p>Each of these groups has a <strong>group header</strong>, with
the <em>group name</em> and a <em>list of attributes</em> corresponding
to that group.</p></li>
<li><p>Each group also has a <strong>group symbol table</strong> which
has a <em>list of the objects</em> in the group.</p></li>
</ul></li>
<li><p>There are then <strong>datasets</strong>:
<strong>multidimensional arrays of data elements along with
metadata</strong>.</p>
<ul>
<li><p>They have a <strong>header</strong> with <em>name</em>,
<em>datatype</em>, <em>dataspace</em>, <em>storage layout</em>.</p></li>
<li><p>And they also have a <strong>data array</strong>, which is
actually a <strong>sort of a data frame</strong> of the HDF5
element.</p></li>
</ul></li>
</ul>
<p>HDF5 can be used to <strong>optimize reading and writing from
disc</strong> in R.</p>
<div id="rhdf5-package." class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> <code>rhdf5</code>
package.</h2>
<p>This package is an <strong>R interface for HDF5 files</strong>.</p>
<ul>
<li>It provides <strong>high level convenience functions on R
level</strong> to make a usage of HDF5 files more esasy.</li>
</ul>
<p>We can install the <code>rhdf5</code> package from Bioconductor.</p>
<ul>
<li><p>Bioconductor, primiarily used for genomics, also has <strong>good
“big data” packages</strong>.</p></li>
<li><p>I’m currently running <code>R v. 3.6.3</code> so I’m using
<code>BiocManager</code> to install packages from Bioconductor.</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;rhdf5&quot;</span>)</span></code></pre></div>
<p>Once we’ve installed the package, we can just load it with the
<code>library</code> command as always.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rhdf5)</span></code></pre></div>
</div>
<div id="creating-hdf5-files-h5createfile." class="section level2"
number="3.2">
<h2><span class="header-section-number">3.2</span> Creating HDF5 files:
<code>h5createFile()</code>.</h2>
<p>First we’ll create HDF5 files, and then interact with them.</p>
<ul>
<li>We could actually use the <code>rhdf5</code> file package to access
data and pull it out of HDF5 datasets without having to create them
ourselves, but it’s easier in terms of lecturing just to show what it
looks like when we create them ourselves.</li>
</ul>
<p>So we’ll use the <code>h5createFile()</code> command to create an
empty <strong>HDF5 file</strong>, which we’re going to name
<code>example.h5</code>.</p>
<ul>
<li><p>It returns <code>TRUE</code> is the file is created
successfully.</p></li>
<li><p>If the file <strong>already exists</strong>, it <strong>does not
create</strong> the file and returns <code>FALSE</code>.</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>created <span class="ot">&lt;-</span> <span class="fu">h5createFile</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>created</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div
id="creating-a-group-hierarchy-in-an-hdf5-file-and-listing-the-content-h5creategroup-h5ls."
class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Creating a group
hierarchy in an HDF5 file and listing the content:
<code>h5createGroup()</code>, <code>h5ls()</code>.</h2>
<p>A HDF5 file can contain a group hierarchy that we can create with
<code>h5createGroup()</code> function.</p>
<ul>
<li>If the group already exists, it is not created and <code>FASE</code>
is returned.</li>
</ul>
<p>So let’s create some groups and list the file content afterwards.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5createGroup</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">h5createGroup</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;baa&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">h5createGroup</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/foobaa&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">h5ls</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  group   name     otype dclass dim</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>     <span class="sc">/</span>    baa H5I_GROUP           </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="sc">/</span>    foo H5I_GROUP           </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="sc">/</span>foo foobaa H5I_GROUP           </span></code></pre></div>
<ul>
<li>So we created within the file, three empty groups: <code>foo</code>,
<code>baa</code> and <code>foobaa</code>. This last one, is a
<em>sub-group</em> of a group.</li>
</ul>
</div>
<div id="writing-and-deleting-datasets-in-hfd5-files-h5write-h5delete."
class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Writing and deleting
datasets in HFD5 files: <code>h5write()</code>,
<code>h5delete()</code>.</h2>
<div id="writing-to-groups." class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Writing to
groups.</h3>
<p>We can write to the specific groups using the <code>h5write()</code>
command.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(h5write)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (obj, file, name, ...)  </span></code></pre></div>
<ul>
<li><p>If a dataset with the given <code>name</code> does <strong>not
yet exist</strong>, a <strong>dataset is created</strong> in the HDF5
<code>file</code> and the <strong>object <code>obj</code> is written to
the HDF5 <code>file</code></strong>.</p></li>
<li><p>If a dataset with the given <code>name</code> <strong>already
exists</strong> and the <strong>datatype</strong> and the
<strong>dimensions</strong> are <strong>the same as for the object
<code>obj</code></strong>, the <strong>data in the file is</strong>
<strong><em>overwritten</em></strong>.</p></li>
<li><p>If the dataset <strong>already exists</strong> and <strong>either
the datatype or the dimensions are different</strong>,
<code>h5write()</code> fails.</p></li>
<li><p>For datasets of <code>compound</code> datatype, if it
<strong>already exists</strong> <code>h5write()</code> fails. As we’ll
see, <code>data.frames</code> are a <code>compound</code> datatype in
HDF5 files.</p></li>
</ul>
<p>For example:</p>
<ul>
<li><p>Let’s create a matrix <code>A</code> and then write it to a
particular group. We just have to give as arguments the matrix, the file
and the specific group where we want to write in.</p></li>
<li><p>We can do the same thing with multidimensional arrays. Let’s also
create one as an example and write it in our <code>foobaa</code>
subgroup.</p></li>
<li><p>Attributes attached to an object are written as well, if
<code>write.attributes = TRUE</code>. So, let’s also add some
attributes, some metadata, to our multidimensional array: the
<code>liter</code> attribute, referred to the units.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">nr =</span> <span class="dv">5</span>, <span class="at">nc =</span> <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">h5write</span>(A, <span class="at">file =</span> <span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="at">name =</span> <span class="st">&quot;foo/A&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">2.0</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(B, <span class="st">&quot;scale&quot;</span>) <span class="ot">&lt;-</span> <span class="st">&quot;liter&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">h5write</span>(B, <span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/foobaa/B&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">h5ls</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        group   name       otype  dclass       dim</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>           <span class="sc">/</span>    baa   H5I_GROUP                  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="sc">/</span>    foo   H5I_GROUP                  </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        <span class="sc">/</span>foo      A H5I_DATASET INTEGER     <span class="dv">5</span> x <span class="dv">2</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="sc">/</span>foo foobaa   H5I_GROUP                  </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">/</span>foo<span class="sc">/</span>foobaa      B H5I_DATASET   FLOAT <span class="dv">5</span> x <span class="dv">2</span> x <span class="dv">2</span></span></code></pre></div>
<ul>
<li>We have now two gropus, <code>foo</code> and <code>foobaa</code>
that are no empty any more, they have the datasets we’ve created.
<ul>
<li><code>A</code> is an <strong>H5 dataset</strong>, it consists of
integers in two dimensions.<br />
</li>
<li><code>B</code> is an <strong>H5 dataset</strong> which consists of
floats in three dimensions.</li>
</ul></li>
</ul>
<p>A longer list of information is given if the parameter
<code>all</code> is <code>TRUE</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5ls</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        group   name         ltype corder_valid corder cset       otype</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>           <span class="sc">/</span>    baa H5L_TYPE_HARD        <span class="cn">FALSE</span>      <span class="dv">0</span>    <span class="dv">0</span>   H5I_GROUP</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="sc">/</span>    foo H5L_TYPE_HARD        <span class="cn">FALSE</span>      <span class="dv">0</span>    <span class="dv">0</span>   H5I_GROUP</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        <span class="sc">/</span>foo      A H5L_TYPE_HARD        <span class="cn">FALSE</span>      <span class="dv">0</span>    <span class="dv">0</span> H5I_DATASET</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="sc">/</span>foo foobaa H5L_TYPE_HARD        <span class="cn">FALSE</span>      <span class="dv">0</span>    <span class="dv">0</span>   H5I_GROUP</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">/</span>foo<span class="sc">/</span>foobaa      B H5L_TYPE_HARD        <span class="cn">FALSE</span>      <span class="dv">0</span>    <span class="dv">0</span> H5I_DATASET</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  num_attrs  dclass          dtype  stype rank       dim    maxdim</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         <span class="dv">0</span>                                  <span class="dv">0</span>                    </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">0</span>                                  <span class="dv">0</span>                    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         <span class="dv">0</span> INTEGER  H5T_STD_I32LE SIMPLE    <span class="dv">2</span>     <span class="dv">5</span> x <span class="dv">2</span>     <span class="dv">5</span> x <span class="dv">2</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">0</span>                                  <span class="dv">0</span>                    </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">0</span>   FLOAT H5T_IEEE_F64LE SIMPLE    <span class="dv">3</span> <span class="dv">5</span> x <span class="dv">2</span> x <span class="dv">2</span> <span class="dv">5</span> x <span class="dv">2</span> x <span class="dv">2</span></span></code></pre></div>
</div>
<div id="writing-directly-to-the-top-level." class="section level3"
number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Writing directly to
the top level.</h3>
<p>Suppose we want to write a dataset, say a data frame <code>df</code>,
to the top level group.</p>
<p>We can also do that with the <code>h5write()</code> command. We just
specify, without any group, the name (for example <code>"df"</code>) we
want to give to the object <code>df</code> that we want to write in
-passed as first argument-.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(1L<span class="sc">:</span>5L, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">5</span>), <span class="fu">c</span>(<span class="st">&quot;ab&quot;</span>, <span class="st">&quot;cde&quot;</span>, <span class="st">&quot;fghi&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;s&quot;</span>),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">h5write</span>(df, <span class="at">file =</span> <span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="at">name =</span> <span class="st">&quot;df&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5ls</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>        group   name       otype   dclass       dim</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>           <span class="sc">/</span>    baa   H5I_GROUP                   </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="sc">/</span>     df H5I_DATASET COMPOUND         <span class="dv">5</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>           <span class="sc">/</span>    foo   H5I_GROUP                   </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="sc">/</span>foo      A H5I_DATASET  INTEGER     <span class="dv">5</span> x <span class="dv">2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        <span class="sc">/</span>foo foobaa   H5I_GROUP                   </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">/</span>foo<span class="sc">/</span>foobaa      B H5I_DATASET    FLOAT <span class="dv">5</span> x <span class="dv">2</span> x <span class="dv">2</span></span></code></pre></div>
<ul>
<li>So we can see at the top level group (sort of the root group), the
<code>df</code> <strong>H5 dataset</strong>.</li>
</ul>
</div>
<div id="deleting-datasets-or-groups-h5delete." class="section level3"
number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Deleting datasets
or groups: <code>h5delete()</code>.</h3>
<p>According to Bioconductor documentation, this function should be part
of the HDF5 package interface.</p>
<p>By the time of writing these notes and downloading the
<code>hdf5</code> package, <code>h5delete()</code> was not available
(version 2.22.0 was installed).</p>
<p>Nevertheless, we are going to see how it works because this function
resolves a <strong>huge problem</strong> regarding <strong>properly
deleting content of HDF5 files</strong>, especially considering that
this kind of files is ment to be used to handle large volumes of
data.</p>
<ul>
<li><p>Indeed, HDF5 did not provide an easy mechanism to remove a
dataset from a file or to reclaim the storage space occupied by a
deleted object.</p></li>
<li><p>Removing a dataset and reclaiming the space it used were -and is
still now- done with the <code>H5Ldelete()</code> function and the
<code>h5repack</code> utility program.</p></li>
<li><p>With the <code>H5Ldelete()</code> function, links to a dataset
can be removed from the file structure. After all the links have been
removed, the <strong>dataset becomes inaccessible</strong> to any
application and is effectively removed from the file.</p></li>
<li><p>The way to recover the space occupied by an unlinked dataset is
to write all of the objects of the file into a new file. Any unlinked
object is inaccessible to the application and will not be included in
the new file. Writing objects to a new file can be done with a custom
program or with the <code>h5repack</code> utility program.</p></li>
</ul>
<p>Nowadays, this problem is <em>theoretically</em> solved by
<strong>the <code>h5delete()</code> function</strong>.</p>
<p>We reproduce here what is explained about this funciton in <a
href="https://bioconductor.riken.jp/packages/devel/bioc/vignettes/rhdf5/inst/doc/rhdf5.html#removing-content-from-an-hdf5-file">this
Bioconductor documentation</a>.</p>
<p>So, as well as adding content to an HDF5 file, it is possible to
remove entries using the function <code>h5delete()</code>. We can remove
either <strong>datasets</strong> or <strong>groups</strong>.</p>
<p>The way we can <strong>remove a dataset</strong> is by providing the
<code>file</code> name and the <code>name</code> of the dataset.</p>
<ul>
<li>Let’s remove the data frame <code>df</code> that we’ve written at
the top level of our HDF5 file.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5delete</span>(<span class="at">file =</span> <span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="at">name =</span> <span class="st">&quot;df&quot;</span>)</span></code></pre></div>
<ul>
<li>If we list the content of the file
(<code>h5ls("./3_data/example.h5")</code>), we should see that
<code>df</code> is gone.</li>
</ul>
<p>And we can also <strong>remove a group</strong>. If it’s not empty,
<code>h5delete()</code> <strong>will remove children</strong> of the
deleted entry too.</p>
<ul>
<li><p><strong>Notice</strong>: <code>h5delete()</code> does not
explicitly traverse the tree to remove child nodes. It only removes the
named entry, and HDF5 will then remove child nodes if they are now
orphaned. Hence it <strong>won’t delete child nodes</strong> if we have
a more complex structure where a child node has <strong>multiple
parents</strong> and only one of these is removed.</p></li>
<li><p>In our example, let’s remove the <code>foo</code> group.</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5delete</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo&quot;</span>)</span></code></pre></div>
<ul>
<li>Listing again, <code>foo</code> should be erased along with all that
was inside: the dataset <code>A</code>, the sub-group
<code>foobaa</code> the dataset <code>B</code> cointained in that
sub-group.</li>
</ul>
<p>To further verify all this, we could examine with the
<code>file.size()</code> function the size of the file in bytes before
and after deleting.</p>
</div>
</div>
<div id="reading-data-from-a-hdf5-file-h5read." class="section level2"
number="3.5">
<h2><span class="header-section-number">3.5</span> Reading data from a
HDF5 file: <code>h5read()</code>.</h2>
<p>We can read data from an HDF5 file using the <code>h5read()</code>
command.</p>
<ul>
<li>We have to tell it what file it has to look in and the dataset we
want to read in, specifying where it is within the hierarchy.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>readA <span class="ot">&lt;-</span> <span class="fu">h5read</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/A&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>readB <span class="ot">&lt;-</span> <span class="fu">h5read</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/foobaa/B&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>readdf <span class="ot">&lt;-</span> <span class="fu">h5read</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;df&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>readA</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">6</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">7</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">8</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]    <span class="dv">4</span>    <span class="dv">9</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]    <span class="dv">5</span>   <span class="dv">10</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>readB</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>, , <span class="dv">1</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">0.1</span>  <span class="fl">0.6</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.2</span>  <span class="fl">0.7</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">0.3</span>  <span class="fl">0.8</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.4</span>  <span class="fl">0.9</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]  <span class="fl">0.5</span>  <span class="fl">1.0</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>, , <span class="dv">2</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">1.1</span>  <span class="fl">1.6</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">1.2</span>  <span class="fl">1.7</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">1.3</span>  <span class="fl">1.8</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">1.4</span>  <span class="fl">1.9</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]  <span class="fl">1.5</span>  <span class="fl">2.0</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>readdf</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  X1L<span class="fl">.5</span>L seq.<span class="dv">0</span>..<span class="dv">1</span>..length.out...<span class="fl">5.</span> c..ab....cde....fghi....a....s..</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">1</span>                      <span class="fl">0.00</span>                               ab</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">2</span>                      <span class="fl">0.25</span>                              cde</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">3</span>                      <span class="fl">0.50</span>                             fghi</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">4</span>                      <span class="fl">0.75</span>                                a</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      <span class="dv">5</span>                      <span class="fl">1.00</span>                                s</span></code></pre></div>
</div>
<div id="writing-and-reading-chunks." class="section level2"
number="3.6">
<h2><span class="header-section-number">3.6</span> Writing and reading
chunks.</h2>
<p>Another advantage of the HDF5 file format is that we can
<strong>easily read and write</strong> <strong><em>by
chunks</em></strong>, using the same <code>h5read()</code> and
<code>h5write()</code> functions.</p>
<p>Example: suppose we want to write a “chunk of information” into a
dataset within a HDF5 file. In particular, let’s write the <em>elements
12, 13, and 14</em> into the <code>A</code> dataset that is inside the
<code>foo</code> group and, more specifically, in the <em>first three
rows</em> of the <em>first column</em> of <code>A</code>.</p>
<ul>
<li>Again, besides the usual arguments we give to <code>h5write()</code>
(the object we want to write, the file, the group and dataset), we have
to <strong>specific the part of the “target” dataset</strong> where we
want to write and we do that through the <code>index</code> parameter
that takes a <strong>list with the indexes</strong> for each of the
dimensions (the first dimension are the rows, and the second dimension
are the columns).</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">h5write</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>), <span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/A&quot;</span>, <span class="at">index =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">h5read</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/A&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]   <span class="dv">12</span>    <span class="dv">6</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]   <span class="dv">13</span>    <span class="dv">7</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]   <span class="dv">14</span>    <span class="dv">8</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]    <span class="dv">4</span>    <span class="dv">9</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]    <span class="dv">5</span>   <span class="dv">10</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">h5read</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>, <span class="st">&quot;foo/A&quot;</span>, <span class="at">index =</span> <span class="fu">list</span>(<span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]   <span class="dv">13</span>    <span class="dv">7</span></span></code></pre></div>
</div>
<div id="deleting-an-hdf5-file-itself-file.remove."
class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Deleting an HDF5 file
itself: <code>file.remove()</code>.</h2>
<p>So, in order to be able to reproduce from scratch all the code chunks
in this topic if the generating rmarkdonw script is excecuted again,
we’ll delete from disk our <code>example.h5</code> HDF5 file.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.remove</span>(<span class="st">&quot;./3_data/example.h5&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="further-resources-about-hdf5." class="section level2"
number="3.8">
<h2><span class="header-section-number">3.8</span> Further resources
about HDF5.</h2>
<p>To know more about the <strong>HDF5 storage structure</strong>, we
can go to the <a href="https://www.hdfgroup.org/solutions/hdf5/">HDF5
group’s website</a>.</p>
<p>Most of the content of this topic is based on <a
href="https://bioconductor.riken.jp/packages/devel/bioc/vignettes/rhdf5/inst/doc/rhdf5.html">this
bioconductor rhdf5 tutorial</a></p>
<ul>
<li>That’s the same tutorial we get with
<code>browseVignettes("rhdf5")</code>.</li>
</ul>
<p>The <strong>reference manual</strong> is <a
href="http://www.bioconductor.org/packages/release/bioc/manuals/rhdf5/man/rhdf5.pdf">here</a></p>
<hr />
</div>
</div>
<div id="reading-data-from-the-web." class="section level1" number="4">
<h1><span class="header-section-number">4</span> Reading data from the
Web.</h1>
<p>There are a <strong>large number of ways</strong> that we can read
data from the web. We are primarily going to <strong>focus
on</strong>:</p>
<ul>
<li><p><strong>Scraping data out</strong> of websites.</p></li>
<li><p>Working with <strong>APIs</strong>.</p></li>
</ul>
<div id="webscraping." class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Webscraping.</h2>
<p>Webscraping is <strong>programatically extracting data</strong> from
<strong>HTML code</strong> of websites or <strong>from
URLs</strong>.</p>
<p>It can be a great way to get data.</p>
<ul>
<li><p>For example, there’s an article on the web (“How Netflix
Rerverse-Engineered Hollywood) about <strong>how somebody
scraped</strong> all of the categories that <strong>Netflix</strong>
assigns movies to and then analyzed them in a very interesting
way.</p></li>
<li><p>That ended up being a story that went viral because it collected
an interesting set of data just by programmatically extracting data from
websites.</p></li>
</ul>
<p>Almost all websites have information that we might want to
programmatically read in some way if we’re interested in getting the
data off that site.</p>
<ul>
<li><p>In <strong>some cases</strong> this is against the terms of
service for the website. So some websites <strong>don’t</strong>
<strong>specifically say</strong> that they do not wanna be scraped and,
when we try to scrape the data from them, we’re at our <strong>own
risk</strong>.</p></li>
<li><p>We should consider also that if we attempt to <strong>read too
many pages too quickly</strong>, a very common consequence is that we
can have our IP address blocked.</p></li>
<li><p>And if we read a lot of proprietary information off of websites,
we can get into even bigger trouble.</p></li>
</ul>
<p>We should then be a little bit careful when we’re deciding to scrape
data off of websites. But in general, it can be a very good way to
collect a lot of data very quickly.</p>
</div>
<div
id="scraping-webpages-using-readlines-to-get-unstructured-data-off-htmltreeparse-to-get-a-structuredparsed-document-and-xpathsaplly-to-extract-specific-information."
class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Scraping webpages
using <code>readLines()</code> to get unstructured data off,
<code>htmlTreeParse()</code> to get a structured/parsed document and
<code>xpathSAplly()</code> to extract specific information.</h2>
<p>Let’s make an example of how to programmatically extract some data
from <a
href="http://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en">Jeff
Leek’s Google Scholar page</a>.</p>
<p><img src="3_data/GoogleScholar_JeffLeek.png" /></p>
<ul>
<li>This page tells us about the <strong>papers</strong> that Jeff Leek
has <strong>published</strong> and something about <strong>how</strong>
<strong>often</strong> they’ve been <strong>cited</strong>, which is the
kind of data that academics care about.</li>
</ul>
<p>So, as we know, one way to <strong>get data off</strong> this webpage
is:</p>
<ul>
<li><p>Open a connection to a particular URL using the
<code>url()</code> function.</p></li>
<li><p>Then, use the <code>readLines</code>() function to read out the
data from that connection.</p></li>
<li><p>And finally, <code>close()</code> the connection after we’ve used
it.</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">url</span>(<span class="st">&quot;http://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>htmlCode <span class="ot">&lt;-</span> <span class="fu">readLines</span>(con)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">readLines</span>(con)<span class="sc">:</span> incomplete final line found on <span class="st">&#39;http://</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&#39;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(htmlCode)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">77</span>] <span class="st">&quot;&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Jeff Leek - Google Scholar&lt;/title&gt;&lt;meta http-equiv=</span><span class="sc">\&quot;</span><span class="st">Content-Type</span><span class="sc">\&quot;</span><span class="st"> content=</span><span class="sc">\&quot;</span><span class="st">| __truncated__ ...</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">htmlCode[3]                   # Let&#39;s see a specific line.</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">[1] &quot;</span> Copyright The Closure Library Authors.<span class="st">&quot;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">htmlCode[10:12]               # And a range of lines.</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="st">[1] &quot;</span><span class="fu">g</span>(\<span class="st">&quot;String.prototype.at</span><span class="sc">\&quot;</span><span class="st">,function(a){return a?a:la});var ma=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}};var p=function(){this.H=this.H;this.O=this.O};p.prototype.H=!1;p.prototype.isDisposed=function(){return this.H};p.prototype.ba=function(){this.H||(this.H=!0,this.S())};p.prototype.S=function(){if(this.O)for(;this.O.length;)this.O.shift()()};var na=function(){};function oa(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};function q(a,b){a.classList.add(b)}function r(a,b){a.classList.remove(b)}function u(a,b){return a.classList?a.classList.contains(b):!1}function v(a,b,c){c=void 0!==c?c:!u(a,b);(c?q:r)(a,b)};function x(a){return 0&lt;=(navigator.userAgent||</span><span class="sc">\&quot;\&quot;</span><span class="st">).indexOf(a)}var pa=x(</span><span class="sc">\&quot;</span><span class="st">iPhone</span><span class="sc">\&quot;</span><span class="st">)||x(</span><span class="sc">\&quot;</span><span class="st">iPad</span><span class="sc">\&quot;</span><span class="st">)||x(</span><span class="sc">\&quot;</span><span class="st">iPod</span><span class="sc">\&quot;</span><span class="st">),qa=x(</span><span class="sc">\&quot;</span><span class="st">iPhone</span><span class="sc">\&quot;</span><span class="st">)||x(</span><span class="sc">\&quot;</span><span class="st">Android</span><span class="sc">\&quot;</span><span class="st">)&amp;&amp;x(</span><span class="sc">\&quot;</span><span class="st">Mobile</span><span class="sc">\&quot;</span><span class="st">);function sa(){if(void 0===b){var a=window.screen;a={width:window.innerWidth,height:window.innerHeight,va:a.width,ua:a.height}}else a=b;var b=a;a=b.width;var c=b.height,d=b.va;b=b.ua;var e=4;if(600&gt;a||48E4&gt;d*b||qa)e=1;else if(982&gt;a)e=2;else if(1136&gt;a||590&gt;c)e=3;return e}var ta,ua=/[?&amp;]tc=([01])/.exec(location.search||</span><span class="sc">\&quot;\&quot;</span><span class="st">);&quot;</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>] <span class="st">&quot;ta=ua?0&lt;+ua[1]:x(</span><span class="sc">\&quot;</span><span class="st">Android</span><span class="sc">\&quot;</span><span class="st">)?!0:window.matchMedia&amp;&amp;window.matchMedia(</span><span class="sc">\&quot;</span><span class="st">(pointer)</span><span class="sc">\&quot;</span><span class="st">).matches?window.matchMedia(</span><span class="sc">\&quot;</span><span class="st">(pointer:coarse)</span><span class="sc">\&quot;</span><span class="st">).matches:!x(</span><span class="sc">\&quot;</span><span class="st">Firefox</span><span class="sc">\&quot;</span><span class="st">)||x(</span><span class="sc">\&quot;</span><span class="st">Mobile</span><span class="sc">\&quot;</span><span class="st">)||x(</span><span class="sc">\&quot;</span><span class="st">Tablet</span><span class="sc">\&quot;</span><span class="st">)?pa||</span><span class="sc">\&quot;</span><span class="st">ontouchstart</span><span class="sc">\&quot;</span><span class="st">in window||0&lt;(navigator.msMaxTouchPoints||0):!1;function va(){if(void 0==wa){wa=!1;try{var a=Object.defineProperty({},</span><span class="sc">\&quot;</span><span class="st">passive</span><span class="sc">\&quot;</span><span class="st">,{get:function(){wa=!0}});window.addEventListener(</span><span class="sc">\&quot;</span><span class="st">testPassive</span><span class="sc">\&quot;</span><span class="st">,na,a);window.removeEventListener(</span><span class="sc">\&quot;</span><span class="st">testPassive</span><span class="sc">\&quot;</span><span class="st">,na,a)}catch(b){}}return wa}var wa;var xa=function(a){this.ga=a},ya=new xa(</span><span class="sc">\&quot;</span><span class="st">INPUT</span><span class="sc">\&quot;</span><span class="st">),za=new xa(</span><span class="sc">\&quot;</span><span class="st">TABLE</span><span class="sc">\&quot;</span><span class="st">);function A(a){return document.getElementById(a)}function Aa(a){return a.id||(a.id=</span><span class="sc">\&quot;</span><span class="st">gs_id</span><span class="sc">\&quot;</span><span class="st">+Ba++)}function Ca(a){a=(void 0===a?null:a)||document.body;return</span><span class="sc">\&quot;</span><span class="st">rtl</span><span class="sc">\&quot;</span><span class="st">==(a?window.getComputedStyle(a,null):null).direction}&quot;</span>                                                                                                                                                                                                                                                                                                                                                                                                                                          </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>] <span class="st">&quot;function Da(a){var b=[];a=a.elements;for(var c=a.length,d=0;d&lt;c;d++){var e=a[d],f=encodeURIComponent(e.name||</span><span class="sc">\&quot;\&quot;</span><span class="st">),h=e.type;!f||e.disabled||!(</span><span class="sc">\&quot;</span><span class="st">checkbox</span><span class="sc">\&quot;</span><span class="st">!=h&amp;&amp;</span><span class="sc">\&quot;</span><span class="st">radio</span><span class="sc">\&quot;</span><span class="st">!=h||e.checked)||b.push(f+</span><span class="sc">\&quot;</span><span class="st">=</span><span class="sc">\&quot;</span><span class="st">+encodeURIComponent(e.value||</span><span class="sc">\&quot;\&quot;</span><span class="st">))}return b.join(</span><span class="sc">\&quot;</span><span class="st">&amp;</span><span class="sc">\&quot;</span><span class="st">)}function Ea(a,b){var c=a.elements[b];c||(c=document.createElement(ya.ga),c.type=</span><span class="sc">\&quot;</span><span class="st">hidden</span><span class="sc">\&quot;</span><span class="st">,c.name=b,a.appendChild(c));return c}function Fa(a){A(</span><span class="sc">\&quot;</span><span class="st">gsc_md_cbyd_c</span><span class="sc">\&quot;</span><span class="st">).href=a&amp;&amp;a.match(Ga)?a:</span><span class="sc">\&quot;</span><span class="st">javascript:void(0)</span><span class="sc">\&quot;</span><span class="st">}function Ha(a){a.match(Ga)&amp;&amp;(window.location.href=a)}&quot;</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(htmlCode[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>])        <span class="co"># And count the characters.</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1181</span>  <span class="dv">745</span>  <span class="dv">499</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(htmlCode[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>)])</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1181</span>  <span class="dv">499</span></span></code></pre></div>
<ul>
<li>As we know, <code>readLines</code> returns a <strong>character
vector long the number of lines read</strong>, that is
<strong>unformatted text</strong> containing the html code of the
page.</li>
</ul>
<p>The next step that we already know about, is to get structured html
data using <strong>the <code>htmlTreeParse()</code></strong>
<strong>function</strong> of the <code>XML</code> package.</p>
<ul>
<li><p><code>htmlTreeParse()</code> can also take an URL, so we
<strong>could’ve think of avoiding the previous step of</strong>
<strong>reading with <code>readLines()</code></strong> by giving the
same URL to <code>htmlTreeParse</code> in order to get the complete
structure of the page out at once.</p></li>
<li><p>But in this case, it happens that our expample
<strong><code>http</code></strong> URL is nowadays translated into
<strong><code>https</code></strong>, and we know that <code>XML</code>
package’s functions doesn’t work well with <code>htpps</code>.</p></li>
<li><p>So we can give to <code>htmlTreeParse()</code> the content (the
character vector) previously downloaded from the page with
<code>readLines</code>.</p></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XML)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">htmlTreeParse</span>(htmlCode, <span class="at">useInternalNodes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(html)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;HTMLInternalDocument&quot;</span> <span class="st">&quot;HTMLInternalDocument&quot;</span> <span class="st">&quot;XMLInternalDocument&quot;</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>] <span class="st">&quot;XMLAbstractDocument&quot;</span> </span></code></pre></div>
<p>We can now <strong>extract the specific information that we
want</strong> using <code>xpathSApply()</code>.</p>
<ul>
<li>For example, let’s get the <code>title</code> of the page (look for
the node with that tag) and the number of times the papers were cited by
looking at the nodes with a tag that has the particular attribute that
we’ve inspected before in the html code.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xpathSApply</span>(html, <span class="st">&quot;//title&quot;</span>, xmlValue)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Jeff Leek - Google Scholar&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xpathSApply</span>(html, <span class="st">&quot;//td[@class=&#39;gsc_a_c&#39;]&quot;</span>, xmlValue) <span class="co"># also &quot;//a[@class=&#39;gsc_a_ac gs_ibl&#39;]&quot; works.</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;3619&quot;</span> <span class="st">&quot;3356&quot;</span> <span class="st">&quot;1875&quot;</span> <span class="st">&quot;1840&quot;</span> <span class="st">&quot;720&quot;</span>  <span class="st">&quot;710&quot;</span>  <span class="st">&quot;632&quot;</span>  <span class="st">&quot;581&quot;</span>  <span class="st">&quot;415&quot;</span>  <span class="st">&quot;412&quot;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">&quot;389&quot;</span>  <span class="st">&quot;332&quot;</span>  <span class="st">&quot;327&quot;</span>  <span class="st">&quot;311&quot;</span>  <span class="st">&quot;307&quot;</span>  <span class="st">&quot;306&quot;</span>  <span class="st">&quot;251&quot;</span>  <span class="st">&quot;243&quot;</span>  <span class="st">&quot;218&quot;</span>  <span class="st">&quot;217&quot;</span> </span></code></pre></div>
</div>
<div id="using-the-httr-package-to-get-the-web-data."
class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Using the
<code>httr</code> package to get the web data.</h2>
<p>The <code>httr</code> package can be <strong>very useful</strong> for
<strong>not open nor easily accessible websites</strong>.</p>
<p>It provides useful tools for working with HTTP <strong>organised by
HTTP verbs</strong> (<code>GET()</code>, <code>POST()</code>, etc).</p>
<ul>
<li>It also has <strong>configuration functions</strong> that make it
easy to control additional request components, like
<code>authenticate()</code>, <code>add_headers()</code> and so on.</li>
</ul>
<div
id="the-get-function-and-its-use-with-content-add_headers-set_cookies-functions."
class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> The
<code>GET()</code> function and its use with <code>content()</code>,
<code>add_headers()</code>, <code>set_cookies()</code> functions.</h3>
<p>So another approach to getting data is with <strong>the
<code>GET()</code> command</strong> from the <code>httr</code>
package.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(GET)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">url =</span> <span class="cn">NULL</span>, <span class="at">config =</span> <span class="fu">list</span>(), ..., <span class="at">handle =</span> <span class="cn">NULL</span>)  </span></code></pre></div>
<ul>
<li>This function takes the <code>url</code> to the page to retrieve and
<strong>retruns a <code>response</code> object</strong>, which provides
easy access to status code, cookies, headers, timings, other useful info
and, of course, the content.<br />
</li>
<li>In other words, <code>GET</code> means retrieve whatever information
(in the form of an entity) is identify by the <code>Request-URI</code>.
<ul>
<li>If the <code>Request-URI</code> refers to a data-producing process,
it is the produced data which shall be returned as the entity in the
response and not the source text of the process, unless that text
happens to be the output of the process.</li>
</ul></li>
</ul>
<p>Just for simplicity let’s take the same URL we’ve been using before
and “GET the URL”.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&quot;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>html2 <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>html2</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>Response [https<span class="sc">:</span><span class="er">//</span>scholar.google.com<span class="sc">/</span>citations?user<span class="ot">=</span>HI<span class="sc">-</span>I6C0AAAAJ<span class="sc">&amp;</span>hl<span class="ot">=</span>en]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> text<span class="sc">/</span>html; charset<span class="ot">=</span>ISO<span class="dv">-8859-1</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">147</span> kB</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!</span>doctype html<span class="sc">&gt;</span><span class="er">&lt;</span>html<span class="sc">&gt;</span><span class="er">&lt;</span>head<span class="sc">&gt;</span><span class="er">&lt;</span>title<span class="sc">&gt;</span>Jeff Leek <span class="sc">-</span> Google Scholar<span class="sc">&lt;</span><span class="er">/</span>title<span class="sc">&gt;</span><span class="er">&lt;</span>meta htt...</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a> Copyright The Closure Library Authors.</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a> SPDX<span class="sc">-</span>License<span class="sc">-</span>Identifier<span class="sc">:</span> Apache<span class="fl">-2.0</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span><span class="er">/</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>var aa<span class="ot">=</span><span class="st">&quot;function&quot;</span><span class="sc">==</span>typeof Object.create?Object.create<span class="sc">:</span><span class="cf">function</span>(a){var b<span class="ot">=</span>funct...</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>},da<span class="ot">=</span><span class="fu">ca</span>(this),g<span class="ot">=</span><span class="cf">function</span>(a,b){<span class="cf">if</span>(b)a<span class="sc">:</span>{var c<span class="ot">=</span>da;a<span class="ot">=</span><span class="fu">a.split</span>(<span class="st">&quot;.&quot;</span>);<span class="cf">for</span>(var <span class="at">d=</span><span class="dv">0</span>;d<span class="sc">&lt;</span>a...</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>var <span class="at">ja=</span>ea,<span class="at">ka=</span><span class="cf">function</span>(a,b){a.prototype<span class="ot">=</span><span class="fu">aa</span>(b.prototype);a.prototype.constructo...</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>var la<span class="ot">=</span><span class="cf">function</span>(a){a<span class="ot">=</span><span class="fu">Math.trunc</span>(a)<span class="sc">||</span><span class="dv">0</span>;<span class="dv">0</span><span class="sc">&gt;</span>a<span class="sc">&amp;&amp;</span>(a<span class="sc">+</span><span class="er">=</span>this.length);<span class="cf">if</span>(<span class="sc">!</span>(<span class="dv">0</span><span class="sc">&gt;</span>a<span class="sc">||</span>a<span class="sc">&gt;=</span>this...</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(<span class="st">&quot;String.prototype.at&quot;</span>,<span class="cf">function</span>(a){return a?a<span class="sc">:</span>la});var <span class="at">ma=</span><span class="cf">function</span>(a,b){var ...</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(html2)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;url&quot;</span>         <span class="st">&quot;status_code&quot;</span> <span class="st">&quot;headers&quot;</span>     <span class="st">&quot;all_headers&quot;</span> <span class="st">&quot;cookies&quot;</span>    </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;content&quot;</span>     <span class="st">&quot;date&quot;</span>        <span class="st">&quot;times&quot;</span>       <span class="st">&quot;request&quot;</span>     <span class="st">&quot;handle&quot;</span>     </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(html2)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>List of <span class="dv">10</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> url        <span class="sc">:</span> chr <span class="st">&quot;https://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&quot;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> status_code<span class="sc">:</span> int <span class="dv">200</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> headers    <span class="sc">:</span>List of <span class="dv">14</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> date                  <span class="sc">:</span> chr <span class="st">&quot;Sat, 18 Feb 2023 11:03:53 GMT&quot;</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> expires               <span class="sc">:</span> chr <span class="st">&quot;Fri, 01 Jan 1990 00:00:00 GMT&quot;</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> cache<span class="sc">-</span>control         <span class="sc">:</span> chr <span class="st">&quot;no-cache, must-revalidate&quot;</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> pragma                <span class="sc">:</span> chr <span class="st">&quot;no-cache&quot;</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> content<span class="sc">-</span>type          <span class="sc">:</span> chr <span class="st">&quot;text/html; charset=ISO-8859-1&quot;</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> p3p                   <span class="sc">:</span> chr <span class="st">&quot;CP=</span><span class="sc">\&quot;</span><span class="st">This is not a P3P policy! See g.co/p3phelp for more info.</span><span class="sc">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> x<span class="sc">-</span>content<span class="sc">-</span>type<span class="sc">-</span>options<span class="sc">:</span> chr <span class="st">&quot;nosniff&quot;</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> content<span class="sc">-</span>encoding      <span class="sc">:</span> chr <span class="st">&quot;gzip&quot;</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> server                <span class="sc">:</span> chr <span class="st">&quot;citations&quot;</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> x<span class="sc">-</span>xss<span class="sc">-</span>protection      <span class="sc">:</span> chr <span class="st">&quot;0&quot;</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> x<span class="sc">-</span>frame<span class="sc">-</span>options       <span class="sc">:</span> chr <span class="st">&quot;SAMEORIGIN&quot;</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> set<span class="sc">-</span>cookie            <span class="sc">:</span> chr <span class="st">&quot;NID=511=WElHAYawU2pPyM-3kyXkOywLfzXAudAhbvG31fDgjnpvcIjMrnqgg2z9wfkT4VHlb8GibNPOvhjDdRwv1q1jNc3ckUwNAGyZn1rPpx1&quot;</span><span class="sc">|</span> __truncated__</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> alt<span class="sc">-</span>svc               <span class="sc">:</span> chr <span class="st">&quot;h3=</span><span class="sc">\&quot;</span><span class="st">:443</span><span class="sc">\&quot;</span><span class="st">; ma=2592000,h3-29=</span><span class="sc">\&quot;</span><span class="st">:443</span><span class="sc">\&quot;</span><span class="st">; ma=2592000&quot;</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> transfer<span class="sc">-</span>encoding     <span class="sc">:</span> chr <span class="st">&quot;chunked&quot;</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="st">&quot;insensitive&quot;</span> <span class="st">&quot;list&quot;</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> all_headers<span class="sc">:</span>List of <span class="dv">2</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span>List of <span class="dv">3</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> status <span class="sc">:</span> int <span class="dv">302</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> version<span class="sc">:</span> chr <span class="st">&quot;HTTP/1.1&quot;</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> headers<span class="sc">:</span>List of <span class="dv">9</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> location              <span class="sc">:</span> chr <span class="st">&quot;https://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&quot;</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> cache<span class="sc">-</span>control         <span class="sc">:</span> chr <span class="st">&quot;private&quot;</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> content<span class="sc">-</span>type          <span class="sc">:</span> chr <span class="st">&quot;text/html; charset=UTF-8&quot;</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>content<span class="sc">-</span>type<span class="sc">-</span>options<span class="sc">:</span> chr <span class="st">&quot;nosniff&quot;</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> date                  <span class="sc">:</span> chr <span class="st">&quot;Sat, 18 Feb 2023 11:03:53 GMT&quot;</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> server                <span class="sc">:</span> chr <span class="st">&quot;citations&quot;</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> content<span class="sc">-</span>length        <span class="sc">:</span> chr <span class="st">&quot;261&quot;</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>xss<span class="sc">-</span>protection      <span class="sc">:</span> chr <span class="st">&quot;0&quot;</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>frame<span class="sc">-</span>options       <span class="sc">:</span> chr <span class="st">&quot;SAMEORIGIN&quot;</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="st">&quot;insensitive&quot;</span> <span class="st">&quot;list&quot;</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> <span class="er">:</span>List of <span class="dv">3</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> status <span class="sc">:</span> int <span class="dv">200</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> version<span class="sc">:</span> chr <span class="st">&quot;HTTP/1.1&quot;</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> headers<span class="sc">:</span>List of <span class="dv">14</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> date                  <span class="sc">:</span> chr <span class="st">&quot;Sat, 18 Feb 2023 11:03:53 GMT&quot;</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> expires               <span class="sc">:</span> chr <span class="st">&quot;Fri, 01 Jan 1990 00:00:00 GMT&quot;</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> cache<span class="sc">-</span>control         <span class="sc">:</span> chr <span class="st">&quot;no-cache, must-revalidate&quot;</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> pragma                <span class="sc">:</span> chr <span class="st">&quot;no-cache&quot;</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> content<span class="sc">-</span>type          <span class="sc">:</span> chr <span class="st">&quot;text/html; charset=ISO-8859-1&quot;</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> p3p                   <span class="sc">:</span> chr <span class="st">&quot;CP=</span><span class="sc">\&quot;</span><span class="st">This is not a P3P policy! See g.co/p3phelp for more info.</span><span class="sc">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>content<span class="sc">-</span>type<span class="sc">-</span>options<span class="sc">:</span> chr <span class="st">&quot;nosniff&quot;</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> content<span class="sc">-</span>encoding      <span class="sc">:</span> chr <span class="st">&quot;gzip&quot;</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> server                <span class="sc">:</span> chr <span class="st">&quot;citations&quot;</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>xss<span class="sc">-</span>protection      <span class="sc">:</span> chr <span class="st">&quot;0&quot;</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> x<span class="sc">-</span>frame<span class="sc">-</span>options       <span class="sc">:</span> chr <span class="st">&quot;SAMEORIGIN&quot;</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> set<span class="sc">-</span>cookie            <span class="sc">:</span> chr <span class="st">&quot;NID=511=WElHAYawU2pPyM-3kyXkOywLfzXAudAhbvG31fDgjnpvcIjMrnqgg2z9wfkT4VHlb8GibNPOvhjDdRwv1q1jNc3ckUwNAGyZn1rPpx1&quot;</span><span class="sc">|</span> __truncated__</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> alt<span class="sc">-</span>svc               <span class="sc">:</span> chr <span class="st">&quot;h3=</span><span class="sc">\&quot;</span><span class="st">:443</span><span class="sc">\&quot;</span><span class="st">; ma=2592000,h3-29=</span><span class="sc">\&quot;</span><span class="st">:443</span><span class="sc">\&quot;</span><span class="st">; ma=2592000&quot;</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">$</span> transfer<span class="sc">-</span>encoding     <span class="sc">:</span> chr <span class="st">&quot;chunked&quot;</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>  .. .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="st">&quot;insensitive&quot;</span> <span class="st">&quot;list&quot;</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> cookies    <span class="sc">:</span><span class="st">&#39;data.frame&#39;</span><span class="sc">:</span>    <span class="dv">1</span> obs. of  <span class="dv">7</span> variables<span class="sc">:</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> domain    <span class="sc">:</span> chr <span class="st">&quot;#HttpOnly_.google.com&quot;</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> flag      <span class="sc">:</span> logi <span class="cn">TRUE</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> path      <span class="sc">:</span> chr <span class="st">&quot;/&quot;</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> secure    <span class="sc">:</span> logi <span class="cn">FALSE</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> expiration<span class="sc">:</span> POSIXct[<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>], format<span class="sc">:</span> <span class="st">&quot;2023-08-20 08:03:53&quot;</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> name      <span class="sc">:</span> chr <span class="st">&quot;NID&quot;</span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> value     <span class="sc">:</span> chr <span class="st">&quot;511=WElHAYawU2pPyM-3kyXkOywLfzXAudAhbvG31fDgjnpvcIjMrnqgg2z9wfkT4VHlb8GibNPOvhjDdRwv1q1jNc3ckUwNAGyZn1rPpx1ied-&quot;</span><span class="sc">|</span> __truncated__</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> content    <span class="sc">:</span> raw [<span class="dv">1</span><span class="sc">:</span><span class="dv">146832</span>] 3c <span class="dv">21</span> <span class="dv">64</span> 6f ...</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> date       <span class="sc">:</span> POSIXct[<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>], format<span class="sc">:</span> <span class="st">&quot;2023-02-18 11:03:53&quot;</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> times      <span class="sc">:</span> Named num [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="fl">0.7826</span> <span class="fl">0.00708</span> <span class="fl">0.0724</span> <span class="fl">0.13699</span> <span class="fl">1.67216</span> ...</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;names&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>] <span class="st">&quot;redirect&quot;</span> <span class="st">&quot;namelookup&quot;</span> <span class="st">&quot;connect&quot;</span> <span class="st">&quot;pretransfer&quot;</span> ...</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> request    <span class="sc">:</span>List of <span class="dv">7</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> method    <span class="sc">:</span> chr <span class="st">&quot;GET&quot;</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> url       <span class="sc">:</span> chr <span class="st">&quot;http://scholar.google.com/citations?user=HI-I6C0AAAAJ&amp;hl=en&quot;</span></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> headers   <span class="sc">:</span> Named chr <span class="st">&quot;application/json, text/xml, application/xml, */*&quot;</span></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;names&quot;</span>)<span class="ot">=</span> chr <span class="st">&quot;Accept&quot;</span></span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> fields    <span class="sc">:</span> <span class="cn">NULL</span></span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> options   <span class="sc">:</span>List of <span class="dv">2</span></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> useragent<span class="sc">:</span> chr <span class="st">&quot;libcurl/7.58.0 r-curl/4.3.2 httr/1.4.2&quot;</span></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">$</span> httpget  <span class="sc">:</span> logi <span class="cn">TRUE</span></span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> auth_token<span class="sc">:</span> <span class="cn">NULL</span></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">$</span> output    <span class="sc">:</span> <span class="fu">list</span>()</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>  .. ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="st">&quot;write_memory&quot;</span> <span class="st">&quot;write_function&quot;</span></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>  ..<span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr <span class="st">&quot;request&quot;</span></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> handle     <span class="sc">:</span>Class <span class="st">&#39;curl_handle&#39;</span> <span class="sc">&lt;</span>externalptr<span class="sc">&gt;</span> </span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr <span class="st">&quot;response&quot;</span></span></code></pre></div>
<ul>
<li>So the <code>response</code> object returned, is a list of 10
elements. Notice for instance that the <code>content</code> is one of
them (a big <code>raw</code> vector) and the <code>handle</code> is the
last one (we’ll talk about it in a second).</li>
</ul>
<p>We can now <strong>extract the content</strong> from that HTML page
using <strong>the <code>content()</code> function</strong>.</p>
<ul>
<li><p>We could extract the content as a <code>raw</code> vector, but
also as text (<code>character</code> vector) or even parsed into an R
object (html, xml, json, png, jpeg).</p>
<ul>
<li>These alternatives can be specified by setting the <code>as</code>
parameter to <code>raw</code>, <code>text</code> or
<code>parsed</code>.</li>
</ul></li>
<li><p>The content <strong>as a text</strong> returned by
<code>content()</code> is <strong>one single string</strong> (a
character vector of length one), <code>readLines()</code> that divides
or splits the text by lines (a character vector of length the number of
lines read).</p></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>rawContent <span class="ot">&lt;-</span> <span class="fu">content</span>(html2, <span class="at">as =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(rawContent)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a> raw [<span class="dv">1</span><span class="sc">:</span><span class="dv">146832</span>] 3c <span class="dv">21</span> <span class="dv">64</span> 6f ...</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>rawContent <span class="ot">&lt;-</span> html2<span class="sc">$</span>content</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(rawContent)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a> raw [<span class="dv">1</span><span class="sc">:</span><span class="dv">146832</span>] 3c <span class="dv">21</span> <span class="dv">64</span> 6f ...</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>textContent <span class="ot">&lt;-</span> <span class="fu">content</span>(html2, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(textContent)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a> chr <span class="st">&quot;&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Jeff Leek - Google Scholar&lt;/title&gt;&lt;meta http-equiv=</span><span class="sc">\&quot;</span><span class="st">Content-Type</span><span class="sc">\&quot;</span><span class="st"> content=</span><span class="sc">\&quot;</span><span class="st">| __truncated__</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="st">length(textContent)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="st">[1] 1</span></span></code></pre></div>
<ul>
<li>Notice how we can also get the <code>raw content</code> by just
subsetting.</li>
</ul>
<p>Once we have our big text string of html code, we can:</p>
<ul>
<li><p>Use <strong><code>htmlParse()</code> command</strong> to parse
out that text and get the parsed HTML.</p>
<ul>
<li><p><code>htmlParse()</code> and <code>xmlParse()</code>, both also
from the <code>XML</code> package, are equivalent to
<code>htmlTreeParse()</code> and <code>xmlTreeParse()</code>
respectively, except they both <strong>use a default value</strong> for
the <strong><code>useInternalNodes</code> parameter of
<code>TRUE</code></strong>.</p></li>
<li><p>We have to set the <code>asText</code> parameter to
<code>TRUE</code>.</p></li>
</ul></li>
<li><p>And finally, we can <strong>use
<code>xpathSApply()</code></strong> to extract out the
<code>title</code> of the page again.</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>parsedHtml <span class="ot">&lt;-</span> <span class="fu">htmlParse</span>(textContent, <span class="at">asText =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xpathSApply</span>(parsedHtml, <span class="st">&quot;//title&quot;</span>, xmlValue)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Jeff Leek - Google Scholar&quot;</span></span></code></pre></div>
<p>Finally, let’s take <a href="http://httpbin.org/get">this test
website</a> to make some examples on how <code>GET()</code> works with
<code>add_headers()</code> and <code>set_cookies()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://httpbin.org/get&quot;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GET</span>(url)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>get]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">367</span> B</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;args&quot;</span><span class="sc">:</span> {}, </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;headers&quot;</span><span class="sc">:</span> {</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Accept&quot;</span><span class="sc">:</span> <span class="st">&quot;application/json, text/xml, application/xml, */*&quot;</span>, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Accept-Encoding&quot;</span><span class="sc">:</span> <span class="st">&quot;deflate, gzip&quot;</span>, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Host&quot;</span><span class="sc">:</span> <span class="st">&quot;httpbin.org&quot;</span>, </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;User-Agent&quot;</span><span class="sc">:</span> <span class="st">&quot;libcurl/7.58.0 r-curl/4.3.2 httr/1.4.2&quot;</span>, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X-Amzn-Trace-Id&quot;</span><span class="sc">:</span> <span class="st">&quot;Root=1-63f0b09a-58c7d99a42ab1eec4bb695f5&quot;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  }, </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;origin&quot;</span><span class="sc">:</span> <span class="st">&quot;181.118.206.7&quot;</span>, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">GET</span>(url, <span class="fu">add_headers</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>), <span class="fu">set_cookies</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span><span class="dv">2</span>))</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>get]</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">423</span> B</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;args&quot;</span><span class="sc">:</span> {}, </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;headers&quot;</span><span class="sc">:</span> {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;A&quot;</span><span class="sc">:</span> <span class="st">&quot;1&quot;</span>, </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Accept&quot;</span><span class="sc">:</span> <span class="st">&quot;application/json, text/xml, application/xml, */*&quot;</span>, </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Accept-Encoding&quot;</span><span class="sc">:</span> <span class="st">&quot;deflate, gzip&quot;</span>, </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;B&quot;</span><span class="sc">:</span> <span class="st">&quot;2&quot;</span>, </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Cookie&quot;</span><span class="sc">:</span> <span class="st">&quot;a=1;b=2&quot;</span>, </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Host&quot;</span><span class="sc">:</span> <span class="st">&quot;httpbin.org&quot;</span>, </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;User-Agent&quot;</span><span class="sc">:</span> <span class="st">&quot;libcurl/7.58.0 r-curl/4.3.2 httr/1.4.2&quot;</span>, </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
</div>
<div
id="accessing-websites-with-passwords-the-authenticate-configuration-function."
class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Accessing websites
with passwords: the <code>authenticate()</code> configuration
function.</h3>
<p>If we just try to <code>GET</code> a webpage that requires a username
and a password, we’ll get a response with a <code>401 Status</code>,
because we’ll not be able to authenticate and login.</p>
<p>Let’s try to do so on <a
href="http://httpbin.org/basic-auth/user/passwd">this test
website</a></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pg1 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&quot;http://httpbin.org/basic-auth/user/passwd&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pg1</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>basic<span class="sc">-</span>auth<span class="sc">/</span>user<span class="sc">/</span>passwd]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">401</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> <span class="er">&lt;</span>unknown<span class="sc">&gt;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>EMPTY BODY<span class="sc">&gt;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pg1)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;url&quot;</span>         <span class="st">&quot;status_code&quot;</span> <span class="st">&quot;headers&quot;</span>     <span class="st">&quot;all_headers&quot;</span> <span class="st">&quot;cookies&quot;</span>    </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;content&quot;</span>     <span class="st">&quot;date&quot;</span>        <span class="st">&quot;times&quot;</span>       <span class="st">&quot;request&quot;</span>     <span class="st">&quot;handle&quot;</span>     </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>pg1<span class="sc">$</span>content</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">raw</span>(<span class="dv">0</span>)</span></code></pre></div>
<p>So with the <code>httr</code> package we can authenticate ourselves
for websites, by using <strong>the <code>authenticate()</code></strong>
<strong>command</strong> with the username and the password.</p>
<ul>
<li>In our test website, the username is <code>user</code> and the
password is <code>passwd</code>.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pg2 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&quot;http://httpbin.org/basic-auth/user/passwd&quot;</span>, <span class="fu">authenticate</span>(<span class="st">&quot;user&quot;</span>, <span class="st">&quot;passwd&quot;</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pg2</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>basic<span class="sc">-</span>auth<span class="sc">/</span>user<span class="sc">/</span>passwd]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">47</span> B</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;authenticated&quot;</span><span class="sc">:</span> true, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;user&quot;</span><span class="sc">:</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pg2)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;url&quot;</span>         <span class="st">&quot;status_code&quot;</span> <span class="st">&quot;headers&quot;</span>     <span class="st">&quot;all_headers&quot;</span> <span class="st">&quot;cookies&quot;</span>    </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;content&quot;</span>     <span class="st">&quot;date&quot;</span>        <span class="st">&quot;times&quot;</span>       <span class="st">&quot;request&quot;</span>     <span class="st">&quot;handle&quot;</span>     </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>pg2<span class="sc">$</span>content</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] 7b 0a <span class="dv">20</span> <span class="dv">20</span> <span class="dv">22</span> <span class="dv">61</span> <span class="dv">75</span> <span class="dv">74</span> <span class="dv">68</span> <span class="dv">65</span> 6e <span class="dv">74</span> <span class="dv">69</span> <span class="dv">63</span> <span class="dv">61</span> <span class="dv">74</span> <span class="dv">65</span> <span class="dv">64</span> <span class="dv">22</span> 3a <span class="dv">20</span> <span class="dv">74</span> <span class="dv">72</span> <span class="dv">75</span> <span class="dv">65</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">26</span>] 2c <span class="dv">20</span> 0a <span class="dv">20</span> <span class="dv">20</span> <span class="dv">22</span> <span class="dv">75</span> <span class="dv">73</span> <span class="dv">65</span> <span class="dv">72</span> <span class="dv">22</span> 3a <span class="dv">20</span> <span class="dv">22</span> <span class="dv">75</span> <span class="dv">73</span> <span class="dv">65</span> <span class="dv">72</span> <span class="dv">22</span> 0a 7d 0a</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>textpg2 <span class="ot">&lt;-</span> <span class="fu">content</span>(pg2, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>No encoding supplied<span class="sc">:</span> defaulting to UTF<span class="fl">-8.</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>textpg2</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;{</span><span class="sc">\n</span><span class="st">  </span><span class="sc">\&quot;</span><span class="st">authenticated</span><span class="sc">\&quot;</span><span class="st">: true, </span><span class="sc">\n</span><span class="st">  </span><span class="sc">\&quot;</span><span class="st">user</span><span class="sc">\&quot;</span><span class="st">: </span><span class="sc">\&quot;</span><span class="st">user</span><span class="sc">\&quot;\n</span><span class="st">}</span><span class="sc">\n</span><span class="st">&quot;</span></span></code></pre></div>
<ul>
<li><code>Status: 200</code> means we actually were able to get access
to the file and to even authenticate it.</li>
</ul>
</div>
<div id="using-handles-handle-function." class="section level3"
number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Using handles:
<code>handle()</code> function.</h3>
<p><code>handle()</code> function creates a <strong>handle tied to a
particular host</strong>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(handle)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (url, <span class="at">cookies =</span> <span class="cn">TRUE</span>)  </span></code></pre></div>
<ul>
<li><p>It <strong>preserves settings and cookies</strong> across
multiple requests.</p></li>
<li><p>The <code>httr</code> manual states literally this: <em>“It is
the foundation of all requests performed through<em> </em>the
<code>httr</code> package, although it will mostly be hidden from the
user”</em>.</p></li>
</ul>
<p>For example, we might want to manually specify the handle so we can
have multiple independent logins to the same website, like this:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>google <span class="ot">&lt;-</span> <span class="fu">handle</span>(<span class="st">&quot;http://google.com&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(google)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>List of <span class="dv">2</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a> <span class="sc">$</span> handle<span class="sc">:</span>Class <span class="st">&#39;curl_handle&#39;</span> <span class="sc">&lt;</span>externalptr<span class="sc">&gt;</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a> <span class="er">$</span> url   <span class="sc">:</span> chr <span class="st">&quot;http://google.com&quot;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span> <span class="fu">attr</span>(<span class="sc">*</span>, <span class="st">&quot;class&quot;</span>)<span class="ot">=</span> chr <span class="st">&quot;handle&quot;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>pg1 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">handle =</span> google, <span class="at">path =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>pg1<span class="sc">$</span>cookies</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                 domain flag path secure          expiration   name</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           .google.com <span class="cn">TRUE</span>    <span class="sc">/</span>   <span class="cn">TRUE</span> <span class="dv">2023-03-20</span> <span class="dv">08</span><span class="sc">:</span><span class="dv">03</span><span class="sc">:</span><span class="dv">56</span> 1P_JAR</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="co">#HttpOnly_.google.com TRUE    /   TRUE 2023-08-17 08:03:56    AEC</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="co">#HttpOnly_.google.com TRUE    /  FALSE 2023-08-20 08:03:56    NID</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                                                                                                                                                                            value</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                                                                                                                                                                   <span class="dv">2023-02-18-11</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                                                                                                                      ARSKqsJGEBuuvuFefwtdcadzS_9jqLm6b6c3prVOevuPIyJsjme7OGYf8w</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">511</span><span class="ot">=</span>E8lIidtj8wItTO_4cBV_bEbL4SD<span class="sc">-</span>vP6gEL5BgUgkgAd7bbbYKUDk<span class="sc">-</span>0cVB4jgiolr7JShIeCITPKxBynUFtDaGwtdScpisb9ikkUAFUMs_sqeeIJ6nkauTtkDIrjndeQJvW<span class="sc">-</span>i1a26IwRxGcm9E0KIb1NBuk2G8<span class="sc">-</span>yTfHxqpcO<span class="sc">-</span>zJc</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>pg2 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">handle =</span> google, <span class="at">path =</span><span class="st">&quot;search&quot;</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>pg2<span class="sc">$</span>cookies</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>                 domain flag path secure          expiration   name</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           .google.com <span class="cn">TRUE</span>    <span class="sc">/</span>   <span class="cn">TRUE</span> <span class="dv">2023-03-20</span> <span class="dv">08</span><span class="sc">:</span><span class="dv">03</span><span class="sc">:</span><span class="dv">56</span> 1P_JAR</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="co">#HttpOnly_.google.com TRUE    /   TRUE 2023-08-17 08:03:56    AEC</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="co">#HttpOnly_.google.com TRUE    /  FALSE 2023-08-20 08:03:56    NID</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                                                                                                                                                                            value</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                                                                                                                                                                   <span class="dv">2023-02-18-11</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                                                                                                                      ARSKqsLI8DFnEntfC<span class="sc">-</span>YrJfuSiHRKcVVVZ8wyZ9xMfUQtYDD<span class="sc">-</span>kHbGNvj8TA</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">511</span><span class="ot">=</span>E8lIidtj8wItTO_4cBV_bEbL4SD<span class="sc">-</span>vP6gEL5BgUgkgAd7bbbYKUDk<span class="sc">-</span>0cVB4jgiolr7JShIeCITPKxBynUFtDaGwtdScpisb9ikkUAFUMs_sqeeIJ6nkauTtkDIrjndeQJvW<span class="sc">-</span>i1a26IwRxGcm9E0KIb1NBuk2G8<span class="sc">-</span>yTfHxqpcO<span class="sc">-</span>zJc</span></code></pre></div>
<ul>
<li>So if we set a handle for google website, then we can tell
<code>GET</code> to go and get that handle and tell it, for instance, to
get it for a specific path.</li>
</ul>
<p>As we said, with a handle we can sort of save the authentication
across multiple accesses to a website. So, let’s do again our previous
example by <strong>authenticating a handle one time</strong>. This way,
the cookies will stay with that handle and we won’t have to keep
authenticating over and over again as we access that website.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">handle</span>(<span class="st">&quot;http://httpbin.org/basic-auth/user/passwd&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pg3 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">handle =</span> h, <span class="at">config =</span> <span class="fu">authenticate</span>(<span class="st">&quot;user&quot;</span>, <span class="st">&quot;passwd&quot;</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>pg3</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>basic<span class="sc">-</span>auth<span class="sc">/</span>user<span class="sc">/</span>passwd]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">47</span> B</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;authenticated&quot;</span><span class="sc">:</span> true, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;user&quot;</span><span class="sc">:</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>pg4 <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">handle =</span> h, <span class="at">path =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>pg4</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>Response [http<span class="sc">:</span><span class="er">//</span>httpbin.org<span class="sc">/</span>]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">03</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> text<span class="sc">/</span>html; charset<span class="ot">=</span>utf<span class="dv">-8</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="fl">9.59</span> kB</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!</span>DOCTYPE html<span class="sc">&gt;</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>html lang<span class="ot">=</span><span class="st">&quot;en&quot;</span><span class="sc">&gt;</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>head<span class="sc">&gt;</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="er">&lt;</span>meta charset<span class="ot">=</span><span class="st">&quot;UTF-8&quot;</span><span class="sc">&gt;</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="er">&lt;</span>title<span class="sc">&gt;</span>httpbin.org<span class="sc">&lt;</span><span class="er">/</span>title<span class="sc">&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="er">&lt;</span>link href<span class="ot">=</span><span class="st">&quot;https://fonts.googleapis.com/css?family=Open+Sans:400,700|Sou...</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="st">        rel=&quot;</span>stylesheet<span class="st">&quot;&gt;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;link rel=&quot;</span>stylesheet<span class="st">&quot; type=&quot;</span>text<span class="sc">/</span>css<span class="st">&quot; href=&quot;</span><span class="sc">/</span>flasgger_static<span class="sc">/</span>swagger<span class="sc">-</span>ui....</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&lt;</span>link rel<span class="ot">=</span><span class="st">&quot;icon&quot;</span> type<span class="ot">=</span><span class="st">&quot;image/png&quot;</span> href<span class="ot">=</span><span class="st">&quot;/static/favicon.ico&quot;</span> sizes<span class="ot">=</span><span class="st">&quot;64x64...</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="st">...</span></span></code></pre></div>
<ul>
<li><p><strong>Notice</strong>: because of the way argument dispatch
works in R, using a <code>handle</code> in a http method (like
<code>GET()</code>), will cause problems when trying to <strong>pass
configuration arguments</strong>:</p>
<ul>
<li><p>Using the preferred way of configuring the http methods:<br />
like <code>GET(handle = h, timeout(10)</code>,<br />
<strong>will not work</strong>.</p></li>
<li><p>We solve this problem by <strong>passing named
arguments</strong>:<br />
like <code>GET(handle = h, config = verbose())</code><br />
or
<code>GET(handle = h, config = list(timeout(10), add_headers(Accept = "")))</code>;<br />
<strong>this will work properly</strong>.</p></li>
</ul></li>
</ul>
</div>
</div>
<div id="further-resources-about-httr-package-and-webscrapping."
class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Further resources
about <code>httr</code> package and webscrapping.</h2>
<p>The <a
href="http://cran.r-project.org/web/packages/httr/httr.pdf"><code>httr</code>
help file</a> has useful examples.</p>
<p>Then <strong>R-bloggers</strong> has a <strong>lot of good examples
on how to scrape data</strong> from the Web.</p>
<ul>
<li>Making a “Web Scraping” search on <a
href="http://www.r-bloggers.com/">R-bloggers</a>, will give us all the
available tutorials.</li>
</ul>
<hr />
</div>
</div>
<div id="reading-data-from-apis-with-the-httr-package."
class="section level1" number="5">
<h1><span class="header-section-number">5</span> Reading data from APIs,
with the <code>httr</code> package.</h1>
<p>Most internet companies like Twitter or Facebook have an
<strong>Application Programming Interface</strong>, where we can
download data.</p>
<ul>
<li>For example, we can get data about which users are tweeting, or what
they’re tweeting about.</li>
</ul>
<p>We can usually get these data using <strong><code>GET</code>
requests</strong> on <strong>specific URLs</strong> (aka
<strong>endpoints’ URLS</strong>).</p>
<p>Infact, <code>httr</code> package <strong>works well</strong> with
<strong>Facebook, Google, Twitter, GitHub</strong> and so forth.</p>
<ul>
<li>If we go to <code>r-lib/httr/demo</code> on GitHub, we can see a
bunch of examples of how we access the different APIs for the different
websites.</li>
</ul>
<p>In these notes we’re going to <strong>use the <code>httr</code>
package</strong> to be able to get data from two APIs:</p>
<ul>
<li><p>First, <strong>Twitter API</strong>.</p></li>
<li><p>Then <strong>GitHub API</strong>.</p></li>
</ul>
<div id="twitter-api." class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Twitter API.</h2>
<div
id="creating-a-twitter-application.-requirements-for-accessing-twitter-api."
class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Creating a Twitter
application. Requirements for accessing Twitter API.</h3>
<p>With our twitter credentials we’re going to login to <a
href="https://developer.twitter.com/"
class="uri">https://developer.twitter.com/</a> and we’re going to create
a twitter application.</p>
<p>If it’s our first time using twitter’s API or creating a twitter
application, we’ll have to go through an “apply” process (some questions
that helps twitter to prevent abuse of their platform) to get a
<strong>developer account</strong>.</p>
<p>Once the developer account is created, we can go to the <a
href="https://developer.twitter.com/en/portal">developer portal</a> and
create a new application. The Twitter developer
<strong>dashboard</strong> allows developers to quickly and easily
perform the following tasks:</p>
<ul>
<li><p>View our existing apps and their associated app ID.</p></li>
<li><p>Create a new app (if we have an approved developer
account).</p></li>
<li><p>Delete an unused app by clicking the three dots to the right of
an app’s “Details” button.</p></li>
<li><p>Open up a specific app’s settings by clicking the “Details”
button. Within the settings, we can see the app details, keys and
tokens, and permissions.</p></li>
</ul>
<p>I’ve created the <strong><em>Estadisticando</em></strong> application
(a project app) which gave me the following keys and tokens to be able
to <strong>authenticate the application through R and access
data</strong>.</p>
<ul>
<li><p>An <code>API Key</code> and an
<code>API Secret Key</code>.</p></li>
<li><p>A <code>Bearer token</code>.</p></li>
<li><p>An <code>Access token</code> and an
<code>Access token secret</code>.</p></li>
</ul>
<p>Accessing the Twitter APIs requires a <strong>set of credentials that
we must pass with each request</strong>.</p>
<ul>
<li><p>These credentials can come in different forms depending on the
type of authentication that is required by the specific endpoint that we
are using.</p></li>
<li><p>For example, user context requires an
<code>API key and secret</code> and a <code>set of access tokens</code>
that are <em>specific</em> to the <em>user that we are making the
request on behalf of</em>.</p></li>
<li><p>Each Twitter app will be able to generate its own
<code>API key</code> and <code>API secret key</code> that we will use to
make <strong>requests on behalf of the app</strong>, as well as an
<code>access token</code> and <code>access token secret</code> that we
will use to make <strong>requests on behalf of the owning user</strong>
(tokens represent the twitter account that owns the twitter developer
app).</p></li>
<li><p>In addition to generating the keys and tokens necessary to make
Twitter API requests, we will also be able to <em>set access
permissions</em>, <em>document the use case or purpose for the app</em>,
and <em>modify other</em> <em>settings</em> related to your app
developer environment from within the app management dashboard.</p></li>
</ul>
</div>
<div
id="source-code-and-version-control-security-warning-store-api-keys-in-environment-variables."
class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Source code and
version control <em>security warning:</em> store API keys in environment
variables.</h3>
<p>The <strong>most common security mistakes</strong> made by developers
are <strong>having API keys and tokens committed</strong> to
<strong>source code in accessible version control systems</strong> like
GitHub and BitBucket.</p>
<ul>
<li>Many of these code repositories are publicly accessible. This
mistake is made so often in public code repositories that <strong>there
are lucrative bots that scrape for API keys</strong>.</li>
</ul>
<p>So, we must follow these <strong>rules of thumb</strong>:</p>
<ul>
<li><p>Use <strong>server environment variables</strong>. By storing API
keys in environment variables, we keep them out of our code and version
control. This also allows you to use different keys for different
environments easily.</p></li>
<li><p>Use a <strong>configuration file excluded from source
control</strong>. Add the filename to your <strong>.gitignore
file</strong> to exclude the file from being tracked by version
control.</p></li>
<li><p>If we remove the API keys from our code <em>after</em> we have
used version control, the API keys are likely still accessible by
accessing previous versions of your codebase.
<strong>Regenerate</strong> the API keys.</p></li>
</ul>
<div
id="storing-my-twitter-api-keys-and-tokens-as-environment-variables-in-r-and-retreiving-them-with-sys.getenv."
class="section level4" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Storing my
Twitter API keys and tokens as environment variables in R, and
retreiving them with <code>Sys.getenv()</code>.</h4>
<p><strong>Step 1</strong>.</p>
<ul>
<li>Open a <strong>text file</strong> (if in RStudio, <em>File &gt; New
File &gt; Text file</em>) and put the following lines:<br />
</li>
</ul>
<pre><code>TWITTER_API_KEY=xxxxxxxxxxxxxxxxxx
TWITTER_API_SECRET_KEY=xxxxxxxxxxxxx
TWITTER_BEARER_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWITTER_ACCESS_TOKEN=xxxxxxxxxxxxxxxxxxxxxxx
TWITTER_SECRET_ACCESS_TOKEN=xxxxxxxxxxxxxxxxxxxxxx
</code></pre>
<ul>
<li>Don’t forget to put a <strong>line break at the end</strong> (an
empty final line).</li>
</ul>
<p><strong>Step 2</strong>.</p>
<ul>
<li><strong>Save</strong> the file in your <strong>home
directory</strong> (<code>normalizePath("~/")</code>) as
<code>.Renviron</code>.<br />
</li>
<li>We define environment variables via <code>.Renvirion</code> instead
of in <code>.bash_profile</code> or <code>.bashrc</code>, because there
are many combinations of OS and ways of running R where the
<code>.Renviron</code> approach <em>just works</em> and the
<code>bash stuff</code> <em>does not</em>. When R is a child process of,
say, Emacs or RStudio, we can’t always count on environment variables
being passed to R. So we put them in an R-specific start-up file and
save ourselves some grief.</li>
</ul>
<p><strong>Step 3</strong>.</p>
<ul>
<li><strong>Restart R</strong> (<code>.Renvirion</code> is processed
only at the start of an R session).<br />
</li>
<li><strong>Use</strong> <code>Sys.getenv()</code> to access the API
keys stored as environment variables.</li>
</ul>
</div>
<div id="adding-.renviron-to-.gitignore-file." class="section level4"
number="5.1.2.2">
<h4><span class="header-section-number">5.1.2.2</span> Adding
<code>.Renviron</code> to <code>.gitignore</code> file.</h4>
<p>As we know, the <code>.gitignore</code> file is a text file that
tells Git which files or folder to ingnore in a project.</p>
<p>A <strong>local</strong> <code>.gitignore</code> file is usually
placed in the root directory of a project. We can also create a
<strong>global</strong> <code>.gitignore</code> file and any entries in
that file will be ignored in all of our Git repositories.</p>
<p>The entries in this file can also follow a matching pattern.</p>
<ul>
<li><code>*</code> is used as a wildcard match.<br />
</li>
<li>the slash <code>/</code> is used as the directory separator.
Separators may occur at the beginning, middle or end of the
<code>.gitignore</code> search pattern.
<ul>
<li>If there is a separator at the <strong>beginning or middle (or both)
of the pattern</strong>, then the pattern is relative to the directory
level of the particular <code>.gitignore</code> file itself. Otherwise
the pattern may also match at any level below the
<code>.gitignore</code> level.<br />
</li>
<li>If there is a separator at the <strong>end of the pattern</strong>
then the pattern will only match directories. Otherwise the pattern can
match both files and directories.<br />
</li>
<li>For example:
<ul>
<li>A pattern <code>doc/frotz/</code> matches <code>doc/frotz</code>
directory, but not <code>a/doc/frotz</code> directory.<br />
</li>
<li>However <code>frotz/</code> matches <code>frotz</code> and
<code>a/frotz</code> that is a directory (<strong>all paths are
relative</strong> <strong>from the <code>.gitignore</code>
file</strong>).<br />
</li>
<li>The pattern <code>hello.*</code> matches any file or folder whose
name begins with hello. If one wants to <strong>restrict this only to
the directory and not in its subdirectories</strong>, one can
<strong>prepend</strong> the pattern with a slash,
i.e. <code>/hello.*</code>; the pattern now matches
<code>hello.txt</code>, <code>hello.c</code> but not
<code>a/hello.java</code>.<br />
</li>
</ul></li>
</ul></li>
<li><code>#</code> is used to add comments.<br />
</li>
<li>A blank line matches no files, so it can serve as a separator for
readability.<br />
</li>
<li>More details in <a href="https://git-scm.com/docs/gitignore">git
documentation</a>.</li>
</ul>
<p>To <strong>add</strong> a <strong>global <code>.gitignore</code>
file</strong>, run the following command:</p>
<pre><code>    touch ~/.gitignore_global
    
    git config --global core.excludesfile ~/.gitignore_global</code></pre>
<ul>
<li><p>This will <strong>create the file
<code>~/.gitignore_global</code></strong>.</p></li>
<li><p>The <code>core.excludesfile</code> configuration variable
indicates a path to a file containing patterns of file names to
exclude.</p></li>
<li><p>Now we can edit that file the same way as a local
<code>.gitignore</code> file. All of our Git repositories will ignore
the files and folders listed in the <code>.gitignore_global</code>
file.</p></li>
</ul>
<p>I <strong>chose the “global” aproach</strong>, so I added
<code>.Renviron</code> to <code>~/.gitignore_global</code>.</p>
</div>
<div
id="using-the-gitignore-r-package-to-get-very-useful-templates-from-gitignore.io-api."
class="section level4" number="5.1.2.3">
<h4><span class="header-section-number">5.1.2.3</span> Using the
<code>gitignore R package</code> to get very useful templates from
<code>gitignore.io API</code>.</h4>
<p>This package <strong>provides a simple R interface to the</strong> <a
href="https://www.toptal.com/developers/gitignore">gitignore.io
API</a>.</p>
<p>It can be used to <strong>fetch gitignore templates</strong> that can
be included into the .gitignore file of our git repository.</p>
<ul>
<li><p>Notice that <strong>by default</strong>, the <code>usethis</code>
R package <strong>populates</strong> the <code>.gitignore</code> file
for the <strong>R</strong> language <strong>when we create a R
project</strong>.</p></li>
<li><p>However, it is common to use <strong>many different programming
languages in a project</strong> such as LaTeX, python, matlab, julia and
so one.</p></li>
<li><p>This is where the <code>gitignore package</code>
<strong>shines</strong> as it can be used to <strong>programmatically
modify</strong> the <code>.gitignore</code> file of our
project.</p></li>
</ul>
<p>I’ve installed it from CRAN:
<code>install.packages("gitignore")</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gitignore)</span></code></pre></div>
<div
id="two-useful-functions-gi_available_templates-and-gi_fetch_templates."
class="section level5" number="5.1.2.3.1">
<h5><span class="header-section-number">5.1.2.3.1</span> Two useful
functions: <code>gi_available_templates()</code> and
<code>gi_fetch_templates()</code>.</h5>
<p>We can see all the supported gitignore templeates that are available.
Let’s see only the first 25 templates:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">gi_available_templates</span>(), <span class="dv">25</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;1c&quot;</span>                   <span class="st">&quot;1c-bitrix&quot;</span>            <span class="st">&quot;a-frame&quot;</span>             </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>] <span class="st">&quot;actionscript&quot;</span>         <span class="st">&quot;ada&quot;</span>                  <span class="st">&quot;adobe&quot;</span>               </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;advancedinstaller&quot;</span>    <span class="st">&quot;adventuregamestudio&quot;</span>  <span class="st">&quot;agda&quot;</span>                </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;al&quot;</span>                   <span class="st">&quot;alteraquartusii&quot;</span>      <span class="st">&quot;altium&quot;</span>              </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">&quot;amplify&quot;</span>              <span class="st">&quot;android&quot;</span>              <span class="st">&quot;androidstudio&quot;</span>       </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] <span class="st">&quot;angular&quot;</span>              <span class="st">&quot;anjuta&quot;</span>               <span class="st">&quot;ansible&quot;</span>             </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">&quot;ansibletower&quot;</span>         <span class="st">&quot;apachecordova&quot;</span>        <span class="st">&quot;apachehadoop&quot;</span>        </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">22</span>] <span class="st">&quot;appbuilder&quot;</span>           <span class="st">&quot;appceleratortitanium&quot;</span> <span class="st">&quot;appcode&quot;</span>             </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] <span class="st">&quot;appcode+all&quot;</span>         </span></code></pre></div>
<p>There’s of course a <strong>template for R</strong> that we can
<strong>fectch</strong>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gi_fetch_templates</span>(<span class="st">&quot;R&quot;</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Created by https://www.toptal.com/developers/gitignore/api/r</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit at https://www.toptal.com/developers/gitignore?templates=r</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">### R </span><span class="al">###</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># History files</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>.Rhistory</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>.Rapp.history</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Session Data files</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>.RData</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>.RDataTmp</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># User-specific files</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>.Ruserdata</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Example code in package build process</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="sc">*-</span>Ex.R</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Output files from R CMD build</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">*</span>.tar.gz</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Output files from R CMD check</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span><span class="er">*</span>.Rcheck<span class="sc">/</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co"># RStudio files</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>.Rproj.user<span class="sc">/</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># produced vignettes</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>vignettes<span class="sc">/</span><span class="er">*</span>.html</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>vignettes<span class="sc">/</span><span class="er">*</span>.pdf</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="co"># OAuth2 token, see https://github.com/hadley/httr/releases/tag/v0.3</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>.httr<span class="sc">-</span>oauth</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr and R markdown default cache directories</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>_cache<span class="sc">/</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="er">/</span>cache<span class="sc">/</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Temporary files created by R markdown</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="er">*</span>.utf8.md</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.knit.md</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="co"># R Environment Variables</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>.Renviron</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="co"># pkgdown site</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>docs<span class="sc">/</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="co"># translation temp files</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>po<span class="sc">/</span><span class="er">*~</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="co"># RStudio Connect folder</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>rsconnect<span class="sc">/</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="do">### R.Bookdown Stack </span><span class="al">###</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="co"># R package: bookdown caching files</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="er">/*</span>_files<span class="sc">/</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co"># End of https://www.toptal.com/developers/gitignore/api/r</span></span></code></pre></div>
<p>And we can fetch multiple templates like this:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gi_fetch_templates</span>(<span class="fu">c</span>(<span class="st">&quot;java&quot;</span>, <span class="st">&quot;c++&quot;</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Created by https://www.toptal.com/developers/gitignore/api/java,c++</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit at https://www.toptal.com/developers/gitignore?templates=java,c++</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="do">### C++ </span><span class="al">###</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prerequisites</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.d</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiled Object files</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.slo</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.lo</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.o</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.obj</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Precompiled Headers</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.gch</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.pch</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiled Dynamic libraries</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.so</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.dylib</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.dll</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Fortran module files</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.mod</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.smod</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiled Static libraries</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.lai</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.la</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.a</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.lib</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Executables</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.exe</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.out</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.app</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="do">### Java </span><span class="al">###</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiled class file</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.class</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Log file</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.log</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a><span class="co"># BlueJ files</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.ctxt</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Mobile Tools for Java (J2ME)</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>.mtj.tmp<span class="sc">/</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Package Files #</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="er">*</span>.jar</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.war</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.nar</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.ear</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.zip</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.tar.gz</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>.rar</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="co"># virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>hs_err_pid<span class="sc">*</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>replay_pid<span class="sc">*</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a><span class="co"># End of https://www.toptal.com/developers/gitignore/api/java,c++</span></span></code></pre></div>
</div>
</div>
</div>
<div
id="accessing-twitter-api-from-r-with-httr-package-oauth_app-sign_oauth1.0-and-sign_oauth2.0."
class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Accessing Twitter
API from R with <code>httr</code> package: <code>oauth_app()</code>,
<code>sign_oauth1.0()</code> and <code>sign_oauth2.0()</code>.</h3>
<p><code>OAuth</code> is a <strong>protocol for generating a user- or
session-specific authentication token</strong> to use in subsequent
requests.</p>
<ul>
<li><p>An <em>early standard</em>, <strong>OAuth 1.0</strong>, is not
terribly common any more.</p></li>
<li><p>The <em>current</em> <strong>OAuth 2.0 standard</strong> is very
common in modern web apps.</p>
<ul>
<li>It involves a <strong>round trip between the client and
server</strong> to establish if the API client has the authority to
access the data.</li>
</ul></li>
<li><p><strong>Notice</strong>: It’s ok to publish the
<code>app ID</code> and <code>app “secret”</code>, these are <strong>not
actually important </strong>for security of user data**.</p></li>
</ul>
<p>Let’s <strong>access Twitter API</strong>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiate authentication process, authenticate twitter app.</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>myapp <span class="ot">&lt;-</span> <span class="fu">oauth_app</span>(<span class="st">&quot;twitter&quot;</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">key =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;TWITTER_API_KEY&quot;</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">secret =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;TWITTER_API_SECRET_KEY&quot;</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete authentication process, sign in (authenticate owner&#39;s app).</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>credentials <span class="ot">&lt;-</span> <span class="fu">sign_oauth1.0</span>(myapp,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">token =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;TWITTER_ACCESS_TOKEN&quot;</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">token_secret =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;TWITTER_SECRET_ACCESS_TOKEN&quot;</span>))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Access API through an endpoint URL.</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>homeTL <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&quot;https://api.twitter.com/1.1/statuses/home_timeline.json&quot;</span>, credentials)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>homeTL</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Response [https<span class="sc">:</span><span class="er">//</span>api.twitter.com<span class="sc">/</span><span class="fl">1.1</span><span class="sc">/</span>statuses<span class="sc">/</span>home_timeline.json]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">04</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json;charset<span class="ot">=</span>utf<span class="dv">-8</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="fl">35.8</span> kB</span></code></pre></div>
<ul>
<li><p><code>oauth_app()</code> <strong>starts the authorization
process</strong> for our application.</p>
<ul>
<li><p>We first set an application name, this isn’t actually going to
get sent to the API, this is just for our convenience. We’ve named it
<code>twitter</code> because it’s going to be the twitter APP.</p></li>
<li><p>We then input the <em>API key</em> and the <em>API secret
key</em> (aka as <em>consumer key</em> and <em>consumer secret</em>)
that we’ve got from the application website.</p></li>
</ul></li>
<li><p>The next step is use of <code>sign_oauth1.0()</code> to
<strong>sign in</strong> with that application and using the <em>access
token</em> and the <em>access token secret</em> which represent our
twitter deveolper account that is the owner of that application.</p>
<ul>
<li>There’s a <strong>prompt about using a local
<code>.httr-oauth</code> file</strong> to cache OAuth access between R
sessions: I usually do not accept, but in case of accepting it’s
important to include this file in our <code>.gitignore</code> file or
our <code>.gitignore_global</code> file (by the way, the “R” template
from “gitignore.io” includes that file).</li>
</ul></li>
<li><p>With those two steps, we’ve <em>created the credentials that will
allow us to access data</em> that is <em>privately held by Twitter</em>,
that’s <em>only available to people with an application</em>.</p></li>
<li><p>So we then <strong>use the <code>GET</code> command</strong>
with:</p>
<ul>
<li><p>An <strong>endpoint’s URL</strong>, that is, a <strong>very
specific URL</strong> that <strong>corresponds to the twitter
API</strong>, which components are:</p>
<ul>
<li><p>The <strong>version of the twitter API</strong> that we’re using
is <code>1.1</code> (the current version is <code>2</code>).</p></li>
<li><p>Which data we’d like to get out, in this case, <strong>the
statuses on our home timeline</strong>.</p></li>
<li><p>We get the data out <strong>as a JSON file</strong>.</p>
<ul>
<li>Twitter API provides data in JSON format.</li>
</ul></li>
</ul></li>
<li><p>Our credentials.</p></li>
</ul></li>
<li><p>So, finally, <strong>we get back</strong> the
<code>response</code> object, in summary, the <strong>page that
corresponds to</strong> <strong>that url</strong> which actually is
going to be just <strong>some JSON data</strong>.</p>
<ul>
<li><p>We can use the <code>content()</code> function to extract the
content, it will recognize that it’s JSON data.</p></li>
<li><p>We can then take the R structure returned by
<code>content()</code> and convert it back into JSON with
<code>toJSON()</code> function.</p></li>
<li><p>And then use the <code>jsonlite</code> package and it’s
<code>fromJSON()</code> function, to reformat that JSON object
<strong>into a data frame</strong>.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>json1 <span class="ot">&lt;-</span> <span class="fu">content</span>(homeTL)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(json1)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;list&quot;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>json2 <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="fu">toJSON</span>(json1))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(json2)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(json2)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">15</span> <span class="dv">25</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(json2)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;created_at&quot;</span>                    <span class="st">&quot;id&quot;</span>                           </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>] <span class="st">&quot;id_str&quot;</span>                        <span class="st">&quot;text&quot;</span>                         </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] <span class="st">&quot;truncated&quot;</span>                     <span class="st">&quot;entities&quot;</span>                     </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;source&quot;</span>                        <span class="st">&quot;in_reply_to_status_id&quot;</span>        </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] <span class="st">&quot;in_reply_to_status_id_str&quot;</span>     <span class="st">&quot;in_reply_to_user_id&quot;</span>          </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">&quot;in_reply_to_user_id_str&quot;</span>       <span class="st">&quot;in_reply_to_screen_name&quot;</span>      </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">&quot;user&quot;</span>                          <span class="st">&quot;geo&quot;</span>                          </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="st">&quot;coordinates&quot;</span>                   <span class="st">&quot;place&quot;</span>                        </span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] <span class="st">&quot;contributors&quot;</span>                  <span class="st">&quot;is_quote_status&quot;</span>              </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">&quot;retweet_count&quot;</span>                 <span class="st">&quot;favorite_count&quot;</span>               </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] <span class="st">&quot;favorited&quot;</span>                     <span class="st">&quot;retweeted&quot;</span>                    </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span>] <span class="st">&quot;lang&quot;</span>                          <span class="st">&quot;possibly_sensitive&quot;</span>           </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] <span class="st">&quot;possibly_sensitive_appealable&quot;</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(json2, class)</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>                   created_at                            id </span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>                       id_str                          text </span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>                    truncated                      entities </span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>                       source         in_reply_to_status_id </span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    in_reply_to_status_id_str           in_reply_to_user_id </span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;data.frame&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>      in_reply_to_user_id_str       in_reply_to_screen_name </span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;data.frame&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>                         user                           geo </span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;data.frame&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>                  coordinates                         place </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;data.frame&quot;</span>                  <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>                 contributors               is_quote_status </span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;data.frame&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>                retweet_count                favorite_count </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>                    favorited                     retweeted </span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>                         lang            possibly_sensitive </span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span>                        <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>possibly_sensitive_appealable </span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;list&quot;</span> </span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>json2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>                      created_at           id              id_str</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Sat Feb <span class="dv">18</span> <span class="dv">02</span><span class="sc">:</span><span class="dv">34</span><span class="sc">:</span><span class="dv">02</span> <span class="sc">+</span><span class="dv">0000</span> <span class="dv">2023</span> <span class="fl">1.626772e+18</span> <span class="dv">1626771996049801217</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Sun Feb <span class="dv">12</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">44</span><span class="sc">:</span><span class="dv">34</span> <span class="sc">+</span><span class="dv">0000</span> <span class="dv">2023</span> <span class="fl">1.624782e+18</span> <span class="dv">1624781513291366403</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Sun Feb <span class="dv">05</span> <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">38</span> <span class="sc">+</span><span class="dv">0000</span> <span class="dv">2023</span> <span class="fl">1.622022e+18</span> <span class="dv">1622022348265390081</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>                                                                                                                                            text</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                                                          If you think the AI is sentient, you just failed the Turing Test from the other side.</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> My conversation with Professor David Deutsch.\n\nHis work combines the theories of knowledge, computation, evolution,… https<span class="sc">:</span><span class="er">//</span>t.co<span class="sc">/</span>7YI69Gk0ur</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Great artists don’t study art history to figure out what art to create. \n\nGreat founders don’t analyze the market t… https<span class="sc">:</span><span class="er">//</span>t.co<span class="sc">/</span>rlBSMPzHmT</span></code></pre></div>
<ul>
<li><p>We can see that the data frame <code>json2</code> has 15 rows and
25 columns, and that it’s variables/columns are either
<strong>lists</strong> or <strong>data frames</strong>.</p></li>
<li><p><strong>Each row</strong> of this data frame <strong>corresponds
to a tweet</strong> in my home timeline.</p></li>
<li><p>The <strong>first four columns are lists</strong>:
<code>created_at</code> is the time that the tweet was created; the
<code>id</code> number for the tweet; the <code>id_str</code> and the
<code>text</code> of the tweet.</p></li>
<li><p>So the first line is the tweet that was the most recent tweet
when we collected the data off the internet.</p></li>
</ul>
</div>
<div
id="api-endpoints-urls-as-input-for-get-a-useful-oauth_endpoints-function."
class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> API endpoints’ URLs
as input for <code>GET()</code>: a useful <code>oauth_endpoints()</code>
function.</h3>
<p>There’s a bunch of different data that we can get access to through
an API, like Twitter’s API. So, <strong>how do we know what URL to
use?</strong></p>
<p>We actually have to go into the <strong>documentation for the API we
are interested in</strong> and find there the <strong>available
endpoints (aka resources)</strong>.</p>
<p>There’s a <strong>useful function</strong> though,
<code>oauth_endpoints()</code>, that provides some
<strong>common</strong> OAuth endpoints (linkedin, twitter, vimeo,
google, facebook, github, azure).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">oauth_endpoints</span>(<span class="st">&quot;twitter&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>oauth_endpoint<span class="sc">&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a> request<span class="sc">:</span>   https<span class="sc">:</span><span class="er">//</span>api.twitter.com<span class="sc">/</span>oauth<span class="sc">/</span>request_token</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a> authorize<span class="sc">:</span> https<span class="sc">:</span><span class="er">//</span>api.twitter.com<span class="sc">/</span>oauth<span class="sc">/</span>authenticate</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a> access<span class="sc">:</span>    https<span class="sc">:</span><span class="er">//</span>api.twitter.com<span class="sc">/</span>oauth<span class="sc">/</span>access_token</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">oauth_endpoints</span>(<span class="st">&quot;github&quot;</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>oauth_endpoint<span class="sc">&gt;</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a> authorize<span class="sc">:</span> https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>login<span class="sc">/</span>oauth<span class="sc">/</span>authorize</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a> access<span class="sc">:</span>    https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>login<span class="sc">/</span>oauth<span class="sc">/</span>access_token</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">oauth_endpoints</span>(<span class="st">&quot;azure&quot;</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>oauth_endpoint<span class="sc">&gt;</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a> authorize<span class="sc">:</span> https<span class="sc">:</span><span class="er">//</span>login.windows.net<span class="sc">/</span>common<span class="sc">/</span>oauth2<span class="sc">/</span>authorize</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a> access<span class="sc">:</span>    https<span class="sc">:</span><span class="er">//</span>login.windows.net<span class="sc">/</span>common<span class="sc">/</span>oauth2<span class="sc">/</span>token</span></code></pre></div>
<p>So, we can access the <strong>Twitter API endpoints</strong>
documentation, as follows:</p>
<ul>
<li><p>In the “Dashboard” of our “developer portal”, we can find the
ling to Twitter’s <a
href="https://developer.twitter.com/en/docs">documentation
homepage</a>.</p></li>
<li><p>There’s an <strong>API reference index</strong>, where we can
browse all the endpoints.</p>
<ul>
<li><p>The endpoint we used in our example, is under <em>Tweets</em>
section, within <em>Get Tweet timelines</em> sub-section, <em>Get
statuses/home_timeline</em> link.</p></li>
<li><p>It’s a page with <strong>all the information about that endpoint
or resource</strong>:</p>
<ul>
<li><p>The <strong>Resource URL</strong>.</p></li>
<li><p>Other <strong>Resource information</strong>: response format
(JSON), if it requires authentication, etc.</p></li>
<li><p><strong>Resource parameters</strong> (<code>count</code> is to
specify how many tweets to collect, <code>since_id</code> to indicate
from what time to collect, etc.) and <strong>examples</strong>.</p></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="github-api." class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> GitHub API.</h2>
<p>In our GitHub <em>personal settings</em> page, there’s the
<strong>“Developer settings” tab</strong> that allows us to create:</p>
<ul>
<li><p>GitHub Apps.</p></li>
<li><p>OAuth Apps.</p></li>
<li><p>Personal access tokens.</p></li>
</ul>
<p><strong>OAuth Apps</strong> allows us to <strong><em>access GitHub
API</em></strong>.</p>
<ul>
<li><p>I’ve created the <em>Coursering</em> OAuth app.</p></li>
<li><p>It has a <strong>Client ID</strong> (aka <strong>consumer
key</strong>) and a <strong>Client secret</strong> (aka <strong>consumer
secret</strong>).</p></li>
<li><p>I wrote those keys in the <code>~/.Renviron</code> file and it’s
already included in the <code>~/.gitignore_global</code> file.</p></li>
</ul>
<div
id="installing-the-httpuv-package-to-make-httr-package-properly-work."
class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Installing the
<code>httpuv</code> package to make <code>httr</code> package properly
work.</h3>
<p>As said, we are going to use <code>httr</code> package to access
GitHub API.</p>
<p>There’s <strong>an issue</strong> though: when I tried to
authenticate my <em>Coursering</em> app (we’ll see how to do that right
away), a <em>connection error</em> arised regarding a mismatch between
<code>redirect_uri</code> and the registered callback URL for the
application.</p>
<p>After some research, I found that the way that apparently best solves
the problem is installing the <code>httpuv</code> R package.</p>
<ul>
<li><p>So I did <code>install.packages("httpuv")</code> and, indeed,
everything worked perfectly.</p></li>
<li><p>As we can see at <a
href="https://cran.r-project.org/web/packages/httpuv/index.html"><code>httpuv</code>
CRAN page</a>, this package:</p>
<ul>
<li><p>is an <strong>HTTP and WebSoket Server Library</strong>;</p></li>
<li><p>provides low-level socket and protocol support for handling HTTP
and WebSocket requests directly from within R;</p></li>
<li><p>it is <strong>primarily intended as a building block</strong> for
other packages, so we’ll <strong>only have</strong> <strong>to load the
<code>httpuv</code></strong> package and <strong>just use
<code>httr</code> package as always</strong>.</p></li>
</ul></li>
</ul>
</div>
<div
id="accessing-github-api-from-r-with-httr-package-oauth_app-oauth2.0_token-config-and-stop_for_status."
class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Accessing GitHub
API from R with <code>httr</code> package: <code>oauth_app()</code>,
<code>oauth2.0_token()</code>, <code>config()</code> and
<code>stop_for_status()</code>.</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httpuv)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an OAuth app.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>myGhApp <span class="ot">&lt;-</span> <span class="fu">oauth_app</span>(<span class="st">&quot;github&quot;</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">key =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;GITHUB_API_KEY&quot;</span>),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">secret =</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;GITHUB_API_SECRET_KEY&quot;</span>))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get OAuth credentials.</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>github_token <span class="ot">&lt;-</span> <span class="fu">oauth2.0_token</span>(<span class="fu">oauth_endpoints</span>(<span class="st">&quot;github&quot;</span>), myGhApp)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>gtoken <span class="ot">&lt;-</span> <span class="fu">config</span>(<span class="at">token =</span> github_token)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Access API: Get request from an endpoint URL (Jeff Leek&#39;s repositories).</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&quot;https://api.github.com/users/jtleek/repos&quot;</span>, gtoken)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>Response [https<span class="sc">:</span><span class="er">//</span>api.github.com<span class="sc">/</span>users<span class="sc">/</span>jtleek<span class="sc">/</span>repos]</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  Date<span class="sc">:</span> <span class="dv">2023-02-18</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">04</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  Status<span class="sc">:</span> <span class="dv">200</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  Content<span class="sc">-</span>Type<span class="sc">:</span> application<span class="sc">/</span>json; charset<span class="ot">=</span>utf<span class="dv">-8</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  Size<span class="sc">:</span> <span class="dv">169</span> kB</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>[</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="sc">:</span> <span class="dv">155565363</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;node_id&quot;</span><span class="sc">:</span> <span class="st">&quot;MDEwOlJlcG9zaXRvcnkxNTU1NjUzNjM=&quot;</span>,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="sc">:</span> <span class="st">&quot;2018&quot;</span>,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;full_name&quot;</span><span class="sc">:</span> <span class="st">&quot;jtleek/2018&quot;</span>,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;private&quot;</span><span class="sc">:</span> false,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;owner&quot;</span><span class="sc">:</span> {</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;login&quot;</span><span class="sc">:</span> <span class="st">&quot;jtleek&quot;</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;id&quot;</span><span class="sc">:</span> <span class="dv">1571674</span>,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert http errors to R errors or warnings.</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="fu">stop_for_status</span>(res)</span></code></pre></div>
<ul>
<li><p>The firs step, <code>oauth_app()</code>, is the same as Twitter
API.</p></li>
<li><p>The next step differs a little:</p>
<ul>
<li><p>We don’t use <code>sign_oauth1.0()</code> or
<code>sign_oauth2.0()</code> to <strong>sign in</strong>, because we
have to give those functions access <strong><em>tokens</em></strong>.
But when we created our <em>Coursering</em> OAuth app, it only genereted
the consumer <em>keys</em> and no <em>tokens</em> at all.</p></li>
<li><p>That’s why we use instead <code>oauth2.0_token()</code> to
complete the authentication process.</p></li>
<li><p><strong>Again</strong>, here’s the same <strong>prompt about
using a local <code>.httr-oauth</code> file</strong> to cache OAuth
access between R sessions.</p></li>
<li><p>Immediately afterwards, redirection for <strong>authentication
via browser</strong> (localhost registered as callback URL) is
<strong>triggered</strong>.</p></li>
</ul></li>
<li><p>One last thing that we have to do, is to use
<code>config()</code> to configure our token.</p></li>
<li><p>That completes the authentication process and we get the
<em>token</em> or <em>credentials</em> that allow us to <strong>access
GitHub API</strong>.</p></li>
</ul>
<p>Let’s <strong>convert the response object</strong>, <code>res</code>,
<strong>into a <code>data.frame</code></strong> and make some data
manipulation.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Extract content from the response object.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>json1 <span class="ot">&lt;-</span> <span class="fu">content</span>(res)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(json1)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;list&quot;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert it to data.frame.</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>gitdf <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="fu">toJSON</span>(json1))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gitdf)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;data.frame&quot;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gitdf)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">30</span> <span class="dv">80</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gitdf)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;id&quot;</span>                          <span class="st">&quot;node_id&quot;</span>                    </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>] <span class="st">&quot;name&quot;</span>                        <span class="st">&quot;full_name&quot;</span>                  </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] <span class="st">&quot;private&quot;</span>                     <span class="st">&quot;owner&quot;</span>                      </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;html_url&quot;</span>                    <span class="st">&quot;description&quot;</span>                </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] <span class="st">&quot;fork&quot;</span>                        <span class="st">&quot;url&quot;</span>                        </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] <span class="st">&quot;forks_url&quot;</span>                   <span class="st">&quot;keys_url&quot;</span>                   </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">&quot;collaborators_url&quot;</span>           <span class="st">&quot;teams_url&quot;</span>                  </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="st">&quot;hooks_url&quot;</span>                   <span class="st">&quot;issue_events_url&quot;</span>           </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] <span class="st">&quot;events_url&quot;</span>                  <span class="st">&quot;assignees_url&quot;</span>              </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">&quot;branches_url&quot;</span>                <span class="st">&quot;tags_url&quot;</span>                   </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] <span class="st">&quot;blobs_url&quot;</span>                   <span class="st">&quot;git_tags_url&quot;</span>               </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">23</span>] <span class="st">&quot;git_refs_url&quot;</span>                <span class="st">&quot;trees_url&quot;</span>                  </span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] <span class="st">&quot;statuses_url&quot;</span>                <span class="st">&quot;languages_url&quot;</span>              </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">27</span>] <span class="st">&quot;stargazers_url&quot;</span>              <span class="st">&quot;contributors_url&quot;</span>           </span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">29</span>] <span class="st">&quot;subscribers_url&quot;</span>             <span class="st">&quot;subscription_url&quot;</span>           </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">31</span>] <span class="st">&quot;commits_url&quot;</span>                 <span class="st">&quot;git_commits_url&quot;</span>            </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">33</span>] <span class="st">&quot;comments_url&quot;</span>                <span class="st">&quot;issue_comment_url&quot;</span>          </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">35</span>] <span class="st">&quot;contents_url&quot;</span>                <span class="st">&quot;compare_url&quot;</span>                </span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] <span class="st">&quot;merges_url&quot;</span>                  <span class="st">&quot;archive_url&quot;</span>                </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">39</span>] <span class="st">&quot;downloads_url&quot;</span>               <span class="st">&quot;issues_url&quot;</span>                 </span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">41</span>] <span class="st">&quot;pulls_url&quot;</span>                   <span class="st">&quot;milestones_url&quot;</span>             </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">43</span>] <span class="st">&quot;notifications_url&quot;</span>           <span class="st">&quot;labels_url&quot;</span>                 </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">45</span>] <span class="st">&quot;releases_url&quot;</span>                <span class="st">&quot;deployments_url&quot;</span>            </span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">47</span>] <span class="st">&quot;created_at&quot;</span>                  <span class="st">&quot;updated_at&quot;</span>                 </span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">49</span>] <span class="st">&quot;pushed_at&quot;</span>                   <span class="st">&quot;git_url&quot;</span>                    </span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">51</span>] <span class="st">&quot;ssh_url&quot;</span>                     <span class="st">&quot;clone_url&quot;</span>                  </span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">53</span>] <span class="st">&quot;svn_url&quot;</span>                     <span class="st">&quot;homepage&quot;</span>                   </span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">55</span>] <span class="st">&quot;size&quot;</span>                        <span class="st">&quot;stargazers_count&quot;</span>           </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">57</span>] <span class="st">&quot;watchers_count&quot;</span>              <span class="st">&quot;language&quot;</span>                   </span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>[<span class="dv">59</span>] <span class="st">&quot;has_issues&quot;</span>                  <span class="st">&quot;has_projects&quot;</span>               </span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>[<span class="dv">61</span>] <span class="st">&quot;has_downloads&quot;</span>               <span class="st">&quot;has_wiki&quot;</span>                   </span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>[<span class="dv">63</span>] <span class="st">&quot;has_pages&quot;</span>                   <span class="st">&quot;has_discussions&quot;</span>            </span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>[<span class="dv">65</span>] <span class="st">&quot;forks_count&quot;</span>                 <span class="st">&quot;mirror_url&quot;</span>                 </span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>[<span class="dv">67</span>] <span class="st">&quot;archived&quot;</span>                    <span class="st">&quot;disabled&quot;</span>                   </span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>[<span class="dv">69</span>] <span class="st">&quot;open_issues_count&quot;</span>           <span class="st">&quot;license&quot;</span>                    </span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>[<span class="dv">71</span>] <span class="st">&quot;allow_forking&quot;</span>               <span class="st">&quot;is_template&quot;</span>                </span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>[<span class="dv">73</span>] <span class="st">&quot;web_commit_signoff_required&quot;</span> <span class="st">&quot;topics&quot;</span>                     </span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>[<span class="dv">75</span>] <span class="st">&quot;visibility&quot;</span>                  <span class="st">&quot;forks&quot;</span>                      </span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>[<span class="dv">77</span>] <span class="st">&quot;open_issues&quot;</span>                 <span class="st">&quot;watchers&quot;</span>                   </span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>[<span class="dv">79</span>] <span class="st">&quot;default_branch&quot;</span>              <span class="st">&quot;permissions&quot;</span>                </span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a><span class="do">## Subsetting &quot;datasharing&quot; repo and extracting the info we want.</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>datasharing_repo <span class="ot">&lt;-</span> gitdf[<span class="fu">which</span>(gitdf<span class="sc">$</span>full_name<span class="sc">==</span><span class="st">&quot;jtleek/datasharing&quot;</span>), ]</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(datasharing_repo, class)</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>                         id                     node_id </span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>                       name                   full_name </span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>                    private                       owner </span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>                   html_url                 description </span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>                       fork                         url </span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>                  forks_url                    keys_url </span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>          collaborators_url                   teams_url </span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>                  hooks_url            issue_events_url </span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>                 events_url               assignees_url </span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>               branches_url                    tags_url </span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>                  blobs_url                git_tags_url </span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>               git_refs_url                   trees_url </span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>               statuses_url               languages_url </span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>             stargazers_url            contributors_url </span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>            subscribers_url            subscription_url </span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>                commits_url             git_commits_url </span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>               comments_url           issue_comment_url </span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>               contents_url                 compare_url </span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>                 merges_url                 archive_url </span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>              downloads_url                  issues_url </span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>                  pulls_url              milestones_url </span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>          notifications_url                  labels_url </span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>               releases_url             deployments_url </span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>                 created_at                  updated_at </span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>                  pushed_at                     git_url </span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>                    ssh_url                   clone_url </span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>                    svn_url                    homepage </span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a>                       size            stargazers_count </span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a>             watchers_count                    language </span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>                 has_issues                has_projects </span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a>              has_downloads                    has_wiki </span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a>                  has_pages             has_discussions </span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a>                forks_count                  mirror_url </span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb48-125"><a href="#cb48-125" aria-hidden="true" tabindex="-1"></a>                   archived                    disabled </span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a>          open_issues_count                     license </span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a>              allow_forking                 is_template </span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a>web_commit_signoff_required                      topics </span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a>                 visibility                       forks </span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a>                open_issues                    watchers </span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                      <span class="st">&quot;list&quot;</span> </span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a>             default_branch                 permissions </span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;list&quot;</span>                <span class="st">&quot;data.frame&quot;</span> </span>
<span id="cb48-139"><a href="#cb48-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-140"><a href="#cb48-140" aria-hidden="true" tabindex="-1"></a>datasharing_repo<span class="sc">$</span>created_at</span>
<span id="cb48-141"><a href="#cb48-141" aria-hidden="true" tabindex="-1"></a>[[<span class="dv">1</span>]]</span>
<span id="cb48-142"><a href="#cb48-142" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2013-11-07T13:25:07Z&quot;</span></span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="reading-from-other-sources." class="section level1" number="6">
<h1><span class="header-section-number">6</span> Reading from other
sources.</h1>
<p>So far we’ve covered reading data from a large number of sources:</p>
<ul>
<li><p>Whether it’s <strong>from different file types</strong> (like the
XML or JSON files).</p></li>
<li><p>Or whether it’s <strong>different sources</strong> (like HDFI, or
MySQL).</p></li>
</ul>
<p>There’s a large number of other places where we might want be able to
get data from,</p>
<ul>
<li><p>Basically, <strong>there are R packages for most things that
we’ll want to access</strong>.</p></li>
<li><p>In general, the best way to find out if an R package exists is to
google<br />
<code>"data_storage_mechanism R package"</code>, for example,
<code>"MySQL R package"</code>.</p></li>
<li><p>Here we’ll see a few useful R packages.</p></li>
</ul>
<div id="interacting-more-directly-with-files-file-url-gzfile-bzfile."
class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Interacting more
directly with files: <code>file()</code>, <code>url()</code>,
<code>gzfile()</code>, <code>bzfile()</code>.</h2>
<p>If we want to interact directly with files, we’ve seen how to use R
in getting data so far, but we can <strong>also use the
<code>file()</code> function</strong> to open a <strong>connection to a
particular file</strong> that’s <strong>already localized on our
computer</strong>.</p>
<p>We could also use <code>gzfile()</code> and <code>bzfile()</code> to
open a connection to <strong>zipped files</strong> that might be laying
<strong>on our computer</strong>.</p>
<p>Fore more information about <strong>connections to files locally and
remotely</strong>, see <code>Module 1</code> of
<code>R Programming course</code>.</p>
</div>
<div id="the-foreing-package." class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> The
<code>foreing</code> package.</h2>
<p>The foreign package is <strong>very useful</strong> if we work with
<strong>people who use other programming languages</strong> or other
<strong>statistical programming languages</strong>.</p>
<p>It <strong>loads data</strong> from files for <code>Minitab</code>,
<code>S</code>, <code>SAS</code>, <code>SPSS</code>, <code>Systat</code>
and a bunch of others.</p>
<p>The <strong>basic functions</strong> are:</p>
<ul>
<li><code>read.arff()</code>, for <code>Weka</code> files.<br />
</li>
<li><code>read.dta()</code>, for <code>Stata</code> files.<br />
</li>
<li><code>read.mtp()</code>, for <code>Minitab</code> files.<br />
</li>
<li><code>read.octave()</code>, for <code>Octave</code> files.<br />
</li>
<li><code>read.spss()</code>, for <code>SPSS</code> files.<br />
</li>
<li><code>read.xport()</code>, for <code>SAS</code> files.</li>
</ul>
<p>More details in <a
href="https://cran.r-project.org/web/packages/foreign/foreign.pdf">foreing
Cran manual</a>.</p>
</div>
<div
id="reading-fixed-format-files-read.fortran-read.fwf-from-the-utils-package."
class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Reading fixed-format
files: <code>read.fortran()</code>, <code>read.fwf()</code> from the
<code>utils</code> package.</h2>
<p>The <code>utils</code> R package has specific functions to read
fixed-format files.</p>
<ul>
<li><p>For example, the <code>read.fortran()</code> function reads
fortran files (<code>.for</code> extension).</p></li>
<li><p>There’s also the <code>read.fwf()</code> function, which can be
used to <strong>read in general</strong> <em>Fixed Width</em>
<em>Format</em> files.</p></li>
<li><p>Both functions **return a <code>data.frame</code> object (they
internally call <code>read.table()</code> function).</p></li>
</ul>
<p>Let’s make an example of <strong><code>read.fwf()</code>
function</strong>.</p>
<ul>
<li><p>It’s <strong>first argument</strong> can be the name of the
<strong>file</strong> or a <strong>connection</strong> (which will be
<strong>opened if necessary</strong>, and if so <strong>closed at the
end</strong> of the function call).</p></li>
<li><p>See <a
href="https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/read.fwf">here
the complete R documentation</a></p></li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read.fwf)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (file, widths, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">skip =</span> 0L, row.names, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    col.names, <span class="at">n =</span> <span class="sc">-</span>1L, <span class="at">buffersize =</span> <span class="dv">2000</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;&quot;</span>, ...)  </span></code></pre></div>
<p>The file we want to read is <a
href="https://www.cpc.ncep.noaa.gov/data/indices/wksst8110.for">in this
US National Weather Service website</a>.</p>
<p>Let’s <strong>first read the entire file</strong> specifying
accordingly the <strong>witdths</strong> of <em>each column</em>, of
<em>white spaces</em> between columns (negative numbers) and the
<strong>number of initial lines to skip</strong>.</p>
<ul>
<li><p>We can only do that, by <strong>looking thoroughly at the file on
the web</strong> and applying the instructions given in the
documentation about the <code>widths</code> parameter.</p>
<div class="figure">
<img src="3_data/sst_data.png" alt="" />
<p class="caption">Sea Surface Temperature (SST) measurments dataset</p>
</div></li>
<li><p>To make things easier, we should use a <strong>file
editor</strong> that can <strong>display the column number</strong> at
which the cursor is located as we navigate the file.</p>
<ul>
<li>For example, Notepad++ (for Windows), Atom, UltraEdit,
RecordEditor.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.cpc.ncep.noaa.gov/data/indices/wksst8110.for&quot;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fwf_full_Df <span class="ot">&lt;-</span> <span class="fu">read.fwf</span>(url, <span class="at">widths =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">9</span>,<span class="sc">-</span><span class="dv">5</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fwf_full_Df)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1622</span>    <span class="dv">9</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fwf_full_Df)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>         V1   V2   V3   V4   V5   V6   V7   V8  V9</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> 03JAN1990 <span class="fl">23.4</span> <span class="sc">-</span><span class="fl">0.4</span> <span class="fl">25.1</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="fl">26.6</span>  <span class="fl">0.0</span> <span class="fl">28.6</span> <span class="fl">0.3</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> 10JAN1990 <span class="fl">23.4</span> <span class="sc">-</span><span class="fl">0.8</span> <span class="fl">25.2</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="fl">26.6</span>  <span class="fl">0.1</span> <span class="fl">28.6</span> <span class="fl">0.3</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> 17JAN1990 <span class="fl">24.2</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="fl">25.3</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="fl">26.5</span> <span class="sc">-</span><span class="fl">0.1</span> <span class="fl">28.6</span> <span class="fl">0.3</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> 24JAN1990 <span class="fl">24.4</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="fl">25.5</span> <span class="sc">-</span><span class="fl">0.4</span> <span class="fl">26.5</span> <span class="sc">-</span><span class="fl">0.1</span> <span class="fl">28.4</span> <span class="fl">0.2</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> 31JAN1990 <span class="fl">25.1</span> <span class="sc">-</span><span class="fl">0.2</span> <span class="fl">25.8</span> <span class="sc">-</span><span class="fl">0.2</span> <span class="fl">26.7</span>  <span class="fl">0.1</span> <span class="fl">28.4</span> <span class="fl">0.2</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> 07FEB1990 <span class="fl">25.8</span>  <span class="fl">0.2</span> <span class="fl">26.1</span> <span class="sc">-</span><span class="fl">0.1</span> <span class="fl">26.8</span>  <span class="fl">0.1</span> <span class="fl">28.4</span> <span class="fl">0.3</span></span></code></pre></div>
<p>Now let’s read just the <strong>fourth column</strong> (of those nine
columns that the hole file has).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fwf_4th_Df <span class="ot">&lt;-</span> <span class="fu">read.fwf</span>(url, <span class="at">widths =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">28</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="dv">4</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="sc">-</span><span class="dv">30</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fwf_4th_Df)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1622</span>    <span class="dv">1</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fwf_4th_Df)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    V1</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="fl">25.1</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="fl">25.2</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="fl">25.3</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="fl">25.5</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="fl">25.8</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="fl">26.1</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fwf_4th_Df<span class="sc">$</span>V1)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;numeric&quot;</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(fwf_4th_Df<span class="sc">$</span>V1)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">42069.2</span></span></code></pre></div>
</div>
<div
id="examples-of-other-databases-packages-rpostgresql-rodbc-rmongodb."
class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Examples of other
databases packages: <code>RPostgreSQL</code>, <code>RODBC</code>,
<code>rmongodb</code>.</h2>
<p>There’s also a large number of other database packages, for example
<code>RPostgreSQL</code> that provides <strong>DB-compliant database
connection from R</strong>.</p>
<ul>
<li><p>We have <a href="https://code.google.com/p/rpostgresql">a
tutorial here</a>.</p></li>
<li><p>And <a
href="https://cran.r-project.org/web/packages/RPostgreSQL/RPostgreSQL.pdf">the
Cran manual</a>.</p></li>
</ul>
<p>There’s also the <code>RODBC</code> for <code>OBDC</code>
connectivity, which provides <strong>interfaces for multiple
databases</strong> including PostgreSQL, MySQL, Microsoft Access, and
SQLite.</p>
<ul>
<li><p>There’s <a
href="https://cran.r-project.org/web/packages/RODBC/vignettes/RODBC.pdf">this
nice tutorial</a>.</p></li>
<li><p>And <a
href="https://cran.r-project.org/web/packages/RODBC/RODBC.pdf">the
manual</a>.</p></li>
</ul>
<p>If we use <code>MongoDb</code>, there’s a very nice package called
<code>RMongo</code>, and there’s also another package,
<code>rmongodb</code>, which can be used to interface with MongoDb and
extract data from that database.</p>
<ul>
<li><p>Here we send queries very similar to the way we were doing with
the <code>RMySQL</code> package.</p></li>
<li><p>There’s an example of <code>Rmongo</code> <a
href="http://www.r-bloggers.com/r-and-mongodb">here in
R-Bloggers</a>.</p></li>
<li><p>See <a
href="https://www.rdocumentation.org/packages/rmongodb/versions/1.8.0">the
R documentation</a>.</p></li>
</ul>
</div>
<div id="reading-images." class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Reading images.</h2>
<p>We can also read other things that aren’t necessarily data in the
traditional format in terms of text files and so forth.</p>
<p>We can <strong>read directly images</strong> with these packages:</p>
<ul>
<li><p><code>jpeg</code>, see <a
href="https://cran.r-project.org/web/packages/jpeg/index.html">the Cran
webpage</a>.</p></li>
<li><p><code>readbitmap</code>, see <a
href="https://cran.r-project.org/web/packages/readbitmap/index.html">the
Cran webpage</a>.</p></li>
<li><p><code>png</code>, see <a
href="https://cran.r-project.org/web/packages/png/index.html">the Cran
webpage</a>.</p></li>
<li><p><code>EBImage</code>, see <a
href="https://www.bioconductor.org/packages/2.13/bioc/html/EBImage.html">the
Bioconductor webpage</a>.</p></li>
</ul>
<div id="example-readjpeg-from-jpeg-package." class="section level3"
number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Example:
<code>readJPEG()</code> from <code>jpeg</code> package.</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jpeg)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;./3_data&quot;</span>)) { <span class="fu">dir.create</span>(<span class="st">&quot;./3_data&quot;</span>) }</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>fileUrl <span class="ot">&lt;-</span> <span class="st">&quot;https://d396qusza40orc.cloudfront.net/getdata%2Fjeff.jpg&quot;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(fileUrl, <span class="at">destfile =</span> <span class="st">&quot;./3_data/jeff.jpg&quot;</span>, <span class="at">method =</span> <span class="st">&quot;curl&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>jeffImmage <span class="ot">&lt;-</span> <span class="fu">readJPEG</span>(<span class="st">&quot;./3_data/jeff.jpg&quot;</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">### What are the 30th and 80th quantiles of the resulting data? (some Linux systems may</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="do">### produce an answer 638 different for the 30th quantile)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(jeffImmage, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">30</span><span class="sc">%       80%</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">15258512</span> <span class="sc">-</span><span class="dv">10575416</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(jeffImmage, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>))[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">638</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>      <span class="dv">30</span>% </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">15259150</span> </span></code></pre></div>
</div>
</div>
<div id="reading-gis-data." class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Reading GIS
data.</h2>
<p>We can read <code>GIS</code> data (stands for <strong>Geographic
Information Systems</strong> data).</p>
<p>There are a variety of different packages that will allow us to
access and play with different kinds of GIS data that are exported by
proprietary and not proprietary software, such as:</p>
<ul>
<li><p><code>rgdal</code>, see <a
href="https://cran.r-project.org/web/packages/rgdal/index.html">the Cran
webpage</a>.</p></li>
<li><p><code>rgeos</code>, see <a
href="https://cran.r-project.org/web/packages/rgeos/index.html">the Cran
webpage</a>.</p></li>
<li><p><code>raster</code>, see <a
href="https://cran.r-project.org/web/packages/raster/index.html">the
Cran webpage</a>.</p></li>
</ul>
</div>
<div id="reading-music-data." class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Reading music
data.</h2>
<p>Another cool thing that we can read is <strong>directly from
mp3</strong>.</p>
<p>We can use the following packages to read musical data and o
analysis:</p>
<ul>
<li><p>The <code>tuneR</code> package, see <a
href="https://cran.r-project.org/web/packages/tuneR/">this Cran
page</a>.</p></li>
<li><p>Or the <code>seewave</code> package, see <a
href="http://rug.mnhn.fr/seewave/">this webpage</a>.</p></li>
</ul>
<p>There’s a <strong>lot of nice musical processing software in
R</strong> that we can use to <strong>analyze those data</strong>, and
come up with interesting cool new analysis, as well.</p>
<hr />
</div>
</div>
<div id="session-info." class="section level1" number="7">
<h1><span class="header-section-number">7</span> Session Info.</h1>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>R version <span class="dv">3</span>.<span class="fl">6.3</span> (<span class="dv">2020-02-29</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>pc<span class="sc">-</span>linux<span class="sc">-</span><span class="fu">gnu</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>Running under<span class="sc">:</span> Ubuntu <span class="dv">18</span>.<span class="fl">04.6</span> LTS</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>blas<span class="sc">/</span>libblas.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>lapack<span class="sc">/</span>liblapack.so.<span class="dv">3</span>.<span class="fl">7.1</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] LC_CTYPE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          LC_NUMERIC<span class="ot">=</span>C                 </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a> [<span class="dv">3</span>] LC_TIME<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>           LC_COLLATE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] LC_MONETARY<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>       LC_MESSAGES<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>      </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] LC_PAPER<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          LC_NAME<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>          </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] LC_ADDRESS<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>        LC_TELEPHONE<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>     </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] LC_MEASUREMENT<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span>    LC_IDENTIFICATION<span class="ot">=</span>es_AR.UTF<span class="dv">-8</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] jpeg_0<span class="fl">.1-8.1</span>      gitignore_0.<span class="fl">1.3</span>   rhdf5_2.<span class="fl">30.1</span>      httr_1.<span class="fl">4.2</span>       </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] httpuv_1.<span class="fl">6.3</span>      sqldf_0<span class="fl">.4</span><span class="dv">-11</span>      RSQLite_2.<span class="fl">2.0</span>     gsubfn_0<span class="fl">.7</span>       </span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] proto_1.<span class="fl">0.0</span>       DBI_1.<span class="fl">1.1</span>         data.table_1.<span class="fl">14.0</span> jsonlite_1.<span class="fl">7.2</span>   </span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] XML_3<span class="fl">.99-0.3</span>      xlsx_0.<span class="fl">6.3</span>        plyr_1.<span class="fl">8.6</span>       </span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] Rcpp_1.<span class="fl">0.7</span>       lattice_0<span class="fl">.20</span><span class="dv">-45</span>  xlsxjars_0.<span class="fl">6.1</span>   assertthat_0.<span class="fl">2.1</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] digest_0.<span class="fl">6.29</span>    utf8_1.<span class="fl">2.2</span>       R6_2.<span class="fl">5.1</span>         chron_2<span class="fl">.3</span><span class="dv">-55</span>    </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] evaluate_0<span class="fl">.19</span>    highr_0<span class="fl">.9</span>        pillar_1.<span class="fl">7.0</span>     rlang_1.<span class="fl">0.6</span>     </span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] curl_4.<span class="fl">3.2</span>       rstudioapi_0<span class="fl">.13</span>  jquerylib_0.<span class="fl">1.4</span>  blob_1.<span class="fl">2.2</span>      </span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] rmarkdown_2<span class="fl">.11</span>   stringr_1.<span class="fl">4.0</span>    bit_4.<span class="fl">0.4</span>        munsell_0.<span class="fl">5.0</span>   </span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] compiler_3.<span class="fl">6.3</span>   xfun_0<span class="fl">.36</span>        pkgconfig_2.<span class="fl">0.3</span>  askpass_1<span class="fl">.1</span>     </span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] clipr_0.<span class="fl">7.1</span>      htmltools_0.<span class="fl">5.2</span>  tcltk_3.<span class="fl">6.3</span>      openssl_2.<span class="fl">0.5</span>   </span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">29</span>] tidyselect_1.<span class="fl">2.0</span> tibble_3.<span class="fl">1.8</span>     fansi_1.<span class="fl">0.2</span>      crayon_1.<span class="fl">5.0</span>    </span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">33</span>] tzdb_0.<span class="fl">3.0</span>       withr_2.<span class="fl">5.0</span>      later_1.<span class="fl">3.0</span>      grid_3.<span class="fl">6.3</span>      </span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] gtable_0.<span class="fl">3.0</span>     lifecycle_1.<span class="fl">0.3</span>  magrittr_2.<span class="fl">0.2</span>   formatR_1<span class="fl">.14</span>    </span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">41</span>] scales_1.<span class="fl">1.1</span>     cli_3.<span class="fl">6.0</span>        stringi_1.<span class="fl">7.6</span>    promises_1.<span class="dv">2</span>.<span class="fl">0.1</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">45</span>] bslib_0.<span class="fl">3.0</span>      ellipsis_0.<span class="fl">3.2</span>   generics_0.<span class="fl">1.2</span>   vctrs_0.<span class="fl">5.2</span>     </span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">49</span>] Rhdf5lib_1.<span class="fl">8.0</span>   tools_3.<span class="fl">6.3</span>      bit64_4.<span class="fl">0.5</span>      glue_1.<span class="fl">6.2</span>      </span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">53</span>] purrr_0.<span class="fl">3.4</span>      hms_1.<span class="fl">1.0</span>        fastmap_1.<span class="fl">1.0</span>    yaml_2.<span class="fl">2.1</span>      </span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">57</span>] colorspace_2<span class="fl">.0</span><span class="dv">-3</span> memoise_1.<span class="fl">1.0</span>    rJava_0<span class="fl">.9</span><span class="dv">-13</span>     knitr_1<span class="fl">.41</span>      </span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">61</span>] sass_0.<span class="fl">4.0</span>      </span></code></pre></div>
<hr />
</div>

<div style="width: 100%; padding: 10px; box-sizing: border-box; text-align: justify; border: 1px solid gray;">
  <p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
</div>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>


<!--
<p style="font-family: 'Playfair Display', serif; font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
</style>
-->


<!--
<p style="font-style: italic;">Copyright &copy; 2020 por <b>Christian A. Karanicolas</b>.  Todos los derechos reservados.  La elaboración de este sitio ha tenido como fuente principal de información el curso de <b>Especialización en Ciencias de Datos</b> brindado por la <b>Johns Hopkins University</b> a través de <b>Coursera</b>.</p>
-->




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
